<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quantum Fourier Transformation and Phase Estimation · Documentation | Yao</title><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.044/juliamono.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/indigo.css" rel="stylesheet" type="text/css"/><link href="https://yaoquantum.org/assets/favicon-light.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../index.html"><img src="../../../assets/logo.png" alt="Documentation | Yao logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../index.html">Documentation | Yao</a></span></div><form class="docs-search" action="../../../search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../index.html">Home</a></li><li><a class="tocitem" href="../../../quick-start.html">Quick Start</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../../man/registers.html">Quantum Registers</a></li><li><a class="tocitem" href="../../../man/blocks.html">Blocks</a></li><li><a class="tocitem" href="../../../man/symbolic.html">Symbolic Computation</a></li><li><a class="tocitem" href="../../../man/automatic_differentiation.html">Automatic Differentiation</a></li><li><a class="tocitem" href="../../../man/simplification.html">Simplification</a></li><li><a class="tocitem" href="../../../man/bitbasis.html">BitBasis</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../1.prepare-ghz-state/index.html">Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a></li><li class="is-active"><a class="tocitem" href="index.html">Quantum Fourier Transformation and Phase Estimation</a><ul class="internal"><li><a class="tocitem" href="#Quantum-Fourier-Transformation"><span>Quantum Fourier Transformation</span></a></li><li><a class="tocitem" href="#Wrap-QFT-to-an-external-block"><span>Wrap QFT to an external block</span></a></li><li><a class="tocitem" href="#Phase-Estimation"><span>Phase Estimation</span></a></li></ul></li><li><a class="tocitem" href="../3.grover-search/index.html">Grover Search</a></li><li><a class="tocitem" href="../4.shor-algorithm/index.html">Shor&#39;s Algorithm</a></li><li><a class="tocitem" href="../5.shor-9-code/index.html">Shor&#39;s 9 qubit code</a></li><li><a class="tocitem" href="../6.quantum-circuit-born-machine/index.html">Quantum Circuit Born Machine</a></li><li><a class="tocitem" href="../7.variation-quantum-eigen-solver/index.html">Variational Quantum Eigen Solver</a></li></ul></li><li><a class="tocitem" href="../../../performancetips.html">Performance Tips</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/QuantumBFS/Yao.jl/blob/master/docs/src/examples/2.qft-phase-estimation/main.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><p><a href="https://mybinder.org/v2/gh/QuantumBFS/Yao.jl/gh-pages?filepath=v0.8.0/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a> <a href="https://nbviewer.jupyter.org/github/QuantumBFS/Yao.jl/blob/gh-pages/v0.8.0/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://img.shields.io/badge/show-nbviewer-579ACA.svg" alt/></a> <a href="https://minhaskamal.github.io/DownGit/#/home?url=https://github.com/QuantumBFS/tutorials/tree/gh-pages/dev/generated/examples/2.qft-phase-estimation"><img src="https://img.shields.io/badge/download-project-orange" alt/></a></p><h1 id="example-qft"><a class="docs-heading-anchor" href="#example-qft">Quantum Fourier Transformation and Phase Estimation</a><a id="example-qft-1"></a><a class="docs-heading-anchor-permalink" href="#example-qft" title="Permalink"></a></h1><p>Let&#39;s use Yao first</p><pre><code class="language-julia hljs">using Yao</code></pre><h2 id="Quantum-Fourier-Transformation"><a class="docs-heading-anchor" href="#Quantum-Fourier-Transformation">Quantum Fourier Transformation</a><a id="Quantum-Fourier-Transformation-1"></a><a class="docs-heading-anchor-permalink" href="#Quantum-Fourier-Transformation" title="Permalink"></a></h2><p>The Quantum Fourier Transformation (QFT) circuit is to repeat two kinds of blocks repeatly:</p><p><img src="assets/qft.png" alt="qft-circuit"/></p><p>The basic building block control phase shift gate is defined as</p><p class="math-container">\[R(k)=\begin{bmatrix}
1 &amp; 0\\
0 &amp; \exp\left(\frac{2\pi i}{2^k}\right)
\end{bmatrix}\]</p><p>Let&#39;s define block <code>A</code> and block <code>B</code>, block <code>A</code> is actually a control block.</p><pre><code class="language-julia hljs">A(i, j) = control(i, j=&gt;shift(2π/(1&lt;&lt;(i-j+1))))</code></pre><pre><code class="nohighlight hljs">A (generic function with 1 method)</code></pre><p>Once you construct the blockl you can inspect its matrix using <code>mat</code> function. Let&#39;s construct the circuit in dash box A, and see the matrix of <span>$R_4$</span> gate.</p><pre><code class="language-julia hljs">R4 = A(4, 1)</code></pre><pre><code class="nohighlight hljs">(n -&gt; control(n, 4, 1 =&gt; shift(0.39269908169872414)))</code></pre><p>If you have read about <a href="generated/examples/2.qft-phase-estimation/@ref example-ghz">preparing GHZ state</a>, you probably know that in Yao, we could just leave the number of qubits, and it will be evaluated when possible.</p><pre><code class="language-julia hljs">R4(5)</code></pre><pre><code class="nohighlight hljs">nqubits: 5
control(4)
└─ (1,) shift(0.39269908169872414)</code></pre><p>its matrix will be</p><pre><code class="language-julia hljs">mat(R4(5))</code></pre><pre><code class="nohighlight hljs">32×32 Diagonal{ComplexF64, Vector{ComplexF64}}:
 1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im</code></pre><p>Then we repeat this control block over and over on different qubits, and put a Hadamard gate to <code>i</code>th qubit to construct <code>i</code>-th <code>B</code> block.</p><pre><code class="language-julia hljs">B(n, k) = chain(n, j==k ? put(k=&gt;H) : A(j, k) for j in k:n)</code></pre><pre><code class="nohighlight hljs">B (generic function with 1 method)</code></pre><p>We need to input the total number of qubits <code>n</code> here because we have to iterate through from <code>k</code>-th location to the last.</p><p>Now, let&#39;s construct the circuit by chaining all the <code>B</code> blocks together</p><pre><code class="language-julia hljs">qft(n) = chain(B(n, k) for k in 1:n)
qft(4)</code></pre><pre><code class="nohighlight hljs">nqubits: 4
chain
├─ chain
│  ├─ put on (1)
│  │  └─ H
│  ├─ control(2)
│  │  └─ (1,) shift(1.5707963267948966)
│  ├─ control(3)
│  │  └─ (1,) shift(0.7853981633974483)
│  └─ control(4)
│     └─ (1,) shift(0.39269908169872414)
├─ chain
│  ├─ put on (2)
│  │  └─ H
│  ├─ control(3)
│  │  └─ (2,) shift(1.5707963267948966)
│  └─ control(4)
│     └─ (2,) shift(0.7853981633974483)
├─ chain
│  ├─ put on (3)
│  │  └─ H
│  └─ control(4)
│     └─ (3,) shift(1.5707963267948966)
└─ chain
   └─ put on (4)
      └─ H
</code></pre><h2 id="Wrap-QFT-to-an-external-block"><a class="docs-heading-anchor" href="#Wrap-QFT-to-an-external-block">Wrap QFT to an external block</a><a id="Wrap-QFT-to-an-external-block-1"></a><a class="docs-heading-anchor-permalink" href="#Wrap-QFT-to-an-external-block" title="Permalink"></a></h2><p>In most cases, <code>function</code>s are enough to wrap quantum circuits, like <code>A</code> and <code>B</code> we defined above, but sometimes, we need to dispatch specialized methods on certain kinds of quantum circuit, or we want to define an external block to export, thus, it&#39;s useful to be able to wrap circuit to custom blocks.</p><p>First, we define a new type as subtype of <code>PrimitiveBlock</code> since we are not going to use the subblocks of <code>QFT</code>, if you need to use its subblocks, it&#39;d be better to define it under <code>CompositeBlock</code>.</p><pre><code class="language-julia hljs">struct QFT &lt;: PrimitiveBlock{2}
    n::Int
end

YaoBlocks.nqudits(q::QFT) = q.n</code></pre><p>Now, let&#39;s define its circuit</p><pre><code class="language-julia hljs">circuit(q::QFT) = qft(q.n)</code></pre><pre><code class="nohighlight hljs">circuit (generic function with 1 method)</code></pre><p>And forward <code>mat</code> to its circuit&#39;s matrix</p><pre><code class="language-julia hljs">YaoBlocks.mat(::Type{T}, x::QFT) where T = mat(T, circuit(x))</code></pre><p>You may notice, it is a little ugly to print <code>QFT</code> at the moment, this is because we print the type summary by default, you can define your own printing by overloading <code>print_block</code></p><pre><code class="language-julia hljs">YaoBlocks.print_block(io::IO, x::QFT) = print(io, &quot;QFT($(x.n))&quot;)</code></pre><p>Since it is possible to use FFT to simulate the results of QFT (like cheating), we could define our custom <code>apply!</code> method:</p><pre><code class="language-julia hljs">using FFTW, LinearAlgebra

function YaoBlocks.apply!(r::ArrayReg, x::QFT)
    α = sqrt(length(statevec(r)))
    invorder!(r)
    lmul!(α, ifft!(statevec(r)))
    return r
end</code></pre><p>Now let&#39;s check if our <code>apply!</code> method is correct:</p><pre><code class="language-julia hljs">r = rand_state(5)
r1 = r |&gt; copy |&gt; QFT(5)
r2 = r |&gt; copy |&gt; circuit(QFT(5))
r1 ≈ r2</code></pre><pre><code class="nohighlight hljs">true</code></pre><p>We can get iQFT (inverse QFT) directly by calling <code>adjoint</code></p><pre><code class="language-julia hljs">QFT(5)&#39;</code></pre><pre><code class="nohighlight hljs"> [†]QFT(5)</code></pre><p>QFT and iQFT are different from FFT and IFFT in three ways,</p><ol><li>they are different by a factor of <span>$\sqrt{2^n}$</span> with <span>$n$</span> the number of qubits.</li><li>the <a href="https://quantumbfs.github.io/BitBasis.jl/stable/tutorial/#Conventions-1">bit numbering</a> will exchange after applying QFT or iQFT.</li><li>due to the convention, QFT is more related to IFFT rather than FFT.</li></ol><h2 id="Phase-Estimation"><a class="docs-heading-anchor" href="#Phase-Estimation">Phase Estimation</a><a id="Phase-Estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Phase-Estimation" title="Permalink"></a></h2><p>Since we have QFT and iQFT blocks we can then use them to realize phase estimation circuit, what we want to realize is the following circuit:</p><p><img src="assets/phaseest.png" alt="phase estimation"/></p><p>First we call Hadamard gates repeatly on first <code>n</code> qubits.</p><pre><code class="language-julia hljs">Hadamards(n) = repeat(H, 1:n)</code></pre><pre><code class="nohighlight hljs">Hadamards (generic function with 1 method)</code></pre><p>Then in dashed box <code>B</code>, we have controlled unitaries:</p><pre><code class="language-julia hljs">ControlU(n, m, U) = chain(n+m, control(k, n+1:n+m=&gt;matblock(U^(2^(k-1)))) for k in 1:n)</code></pre><pre><code class="nohighlight hljs">ControlU (generic function with 1 method)</code></pre><p>each of them is a <code>U</code> of power <span>$2^{(k-1)}$</span>.</p><p>Since we will only apply the qft and Hadamard on first <code>n</code> qubits, we could use <code>Subroutine</code>, which creates a context of a sub-scope of the qubits.</p><pre><code class="language-julia hljs">PE(n, m, U) =
    chain(n+m, # total number of the qubits
        subroutine(Hadamards(n), 1:n), # apply H in local scope
        ControlU(n, m, U),
        subroutine(QFT(n)&#39;, 1:n))</code></pre><pre><code class="nohighlight hljs">PE (generic function with 1 method)</code></pre><p>we use the first <code>n</code> qubits as the output space to store phase <span>$ϕ$</span>, and the other <code>m</code> qubits as the input state which corresponds to an eigenvector of oracle matrix <code>U</code>.</p><p>The subroutine here uses <code>focus!</code> and <code>relax!</code> to manage a local scope of quantum circuit, and only activate the first <code>n</code> qubits while applying the block inside the subroutine context, and the scope will be <code>relax!</code>ed back, after the context. This is equivalent to manually <code>focus!</code> then <code>relax!</code></p><p>fullly activated</p><pre><code class="language-julia hljs">r = rand_state(5)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>first 3 qubits activated</p><pre><code class="language-julia hljs">focus!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 3/5
    nlevel: 2</code></pre><p>relax back to the original</p><pre><code class="language-julia hljs">relax!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>In this way, we will be able to apply small operator directly on the subset of the qubits.</p><p>Details about the algorithm can be found here: <a href="https://en.wikipedia.org/wiki/Quantum_phase_estimation_algorithm">Quantum Phase Estimation Algorithm</a></p><p>Now let&#39;s check the results of our phase estimation.</p><p>First we need to set up a unitary with known phase, we set the phase to be 0.75, which is <code>0.75 * 2^3 == 6 == 0b110</code> .</p><pre><code class="language-julia hljs">N, M = 3, 5
P = eigen(rand_unitary(1&lt;&lt;M)).vectors
θ = Int(0b110) / 1&lt;&lt;N
phases = rand(1&lt;&lt;M)
phases[0b010+1] = θ
U = P * Diagonal(exp.(2π * im * phases)) * P&#39;</code></pre><pre><code class="nohighlight hljs">32×32 Matrix{ComplexF64}:
    0.164608-0.11693im     0.00920085+0.0986938im       -0.170617-0.115641im     -0.071864+0.0610526im  -0.0890855+0.0723054im      -0.244203+0.0829173im   -0.00845115-0.195274im      -0.278468-0.039909im      -0.103731+0.0758789im     -0.156578-0.0446533im     0.0358251+0.149728im        0.150515+0.241953im      -0.171842-0.181429im     -0.0141162+0.000773203im    0.0781746+0.0141812im     0.156899+0.274431im    -0.00150898+0.0548479im      0.163031+0.0361482im    -0.0715314-0.148724im       -0.120647+0.103205im    -0.0645572-0.146231im     -0.0463146+0.236413im     -0.0418491+0.0289056im       -0.1212+0.0399404im      -0.12475+0.157401im     -0.0303071+0.0204224im         0.17-0.140248im     -0.0491829+0.103971im     -0.0545288+0.163913im       0.185804+0.0324334im      -0.01363-0.0419844im     0.0179773-0.165058im
   -0.128314+0.0288042im   -0.0454689-0.252686im        0.0449161-0.0742078im    -0.060076+0.0905836im   -0.187562+0.00558562im    -0.0784032+0.0145373im     0.0867986-0.253195im       0.181635+0.114353im      0.0245928+0.0612561im   -0.00771123-0.107175im       0.212949+0.0103663im     -0.0377046+0.0287387im     -0.085287+0.0974435im      0.174077-0.0585513im     -0.0493021-0.0343649im    -0.157015+0.118224im      0.0496283+0.0438271im      0.049962+0.0399049im    -0.0798395-0.0319609im       0.182448-0.0330891im    -0.118097+0.142065im     0.00513469+0.167751im      -0.166484-0.117597im       0.015665+0.275397im     -0.0974589-0.0646522im     0.0577441-0.0186881im     0.159606+0.128197im      -0.154852-0.295197im       0.127553-0.0456479im      -0.10763-0.0512069im     0.0833291-0.312201im      -0.209933+0.0143155im
  -0.0159271-0.0197551im     0.195341-0.0827564im       -0.108488-0.10477im       0.214572+0.256367im   -0.0166334+0.0999728im      0.0175048-0.00236592im    -0.056075-0.0656384im       0.12421-0.152129im       0.237402-0.0166865im     -0.128636+0.025974im       0.016083-0.0152853im       0.164185+0.00994541im    -0.141305+0.0414684im     -0.081187+0.115505im        -0.15423+0.141238im     0.0421514-0.257215im      -0.112863+0.131939im     -0.0128739+0.00741521im   0.00785203+0.21689im        -0.014111+0.104747im      0.192826+0.036662im       -0.30947+0.143301im       -0.11082-0.126551im      0.0520754-0.181635im      -0.132857+0.0683212im    -0.0551066-0.174006im    -0.0477178+0.0885938im     0.0243524-0.198347im     0.00665798+0.243401im       0.040258+0.131038im    0.000538808+0.0285678im     0.0981527+0.0826666im
   0.0338226-0.0744503im    -0.105447+0.0837514im       -0.104949+0.136404im    -0.0400668+0.0650031im  -0.0807059+0.177206im       0.0212003+0.00993456im   -0.0727842-0.00569931im    -0.189924-0.207032im      -0.101733-0.214226im       0.206544-0.047488im      0.0486239+0.0429402im       0.189997+0.197733im      -0.159809-0.0934764im      0.210938-0.135515im       -0.250202+0.130624im     -0.126204-0.0510651im    -0.0542763+0.0614668im      0.174355+0.034206im      0.0768274-1.06623e-5im      0.181735-0.102137im     -0.309595+0.117369im    -0.00586553-0.142062im      0.0579692-0.0191453im     0.0878621-0.138061im      0.0802943-0.120314im      -0.147621+0.0630322im    -0.247732+0.0909462im     0.0242132+0.0197957im     0.0515317+0.0659222im     -0.225702+0.0542729im     -0.076862-0.0533584im     0.0141717-0.0771247im
    0.210225+0.0353214im    0.0104612+0.0547775im      -0.0400709+0.104322im     0.0412174-0.0666346im   -0.142346-0.144426im       0.0609739-0.0144947im    0.00308485+0.0364675im    -0.0551582+0.145853im      0.0231045-0.0415466im     0.0341933+0.225419im     -0.0236019+0.118458im      -0.0251695-0.0355947im     -0.156745-0.23555im       0.0445609-0.0732302im     -0.0165723-0.00871012im  -0.0247051-0.362698im       0.140616+0.110708im      -0.053597-0.0116343im     -0.213546-0.235432im       -0.126637-0.157173im      0.127274+0.0239214im    -0.0618146-0.00235193im    -0.154144+0.0939222im    -0.0842789-0.171104im    -0.00280883-0.0302128im     -0.160716-0.0742327im    0.0924095-0.039098im      -0.101626-0.142754im      -0.204493-0.1393im       -0.0295501-0.0375173im     -0.200594-0.108285im      -0.341218+0.0131836im
  -0.0135661-0.110429im     -0.050648+0.0947609im        0.177499-0.148488im      0.104925-0.0682148im    0.183647-0.0874039im      -0.372727+0.188051im        -0.1477-0.209912im      0.0335136-0.196928im     -0.0131742-0.0171747im      0.124929-0.070879im      0.0568479-0.0177416im       0.103613-0.126069im       0.117127-0.150176im       0.131598-0.0182131im      -0.122526+0.0605307im   -0.0343035-0.0919376im     0.0519713-0.0439172im     -0.224803-0.40329im      -0.0544533+0.0454806im      0.0898049-0.00830335im   0.0369841-0.178737im      0.0630319+0.0672663im    -0.0729894-0.107096im     -0.0219052+0.0930592im   -0.00229933-0.217389im    0.000968934+0.0129387im   -0.0519387+0.115375im      0.0922054+0.075964im      -0.228468+0.0288342im     0.0935053-0.0679189im    -0.0182484+0.00412085im   -0.0907355+0.0226916im
  -0.0308531+0.00897421im   0.0590247+0.153205im     -0.000188127+0.177591im    -0.0291364-0.0428298im   -0.141452-0.195706im        -0.24993-0.139555im     -0.0297172+0.0856872im    -0.0230686-0.0289557im     -0.109441+0.0321211im     0.0906588+0.0645022im    -0.0346115-0.123198im        0.230865-0.122796im      0.0787202+0.0882576im    -0.0387915+0.114619im      -0.0395695-0.126973im     0.0034202+0.135577im      0.0791016-0.0666268im    -0.0458325+0.172257im     -0.0445853+0.0554707im      0.0167128+0.0960346im    -0.213186-0.0185425im     -0.189238+0.195344im      -0.162184-0.208029im       0.131295-0.200659im      0.0116907-0.0627193im    -0.0661693-0.0122997im     0.198095-0.0803003im      0.230538-0.00993234im     0.139769-0.184511im     -0.0359041-0.122338im      -0.241402-0.0436168im     0.0996041+0.248479im
   -0.251376-0.0694065im    -0.158113-0.00568644im      0.0239275-0.00329115im    0.137896+0.0502596im   -0.107813-0.000987766im     0.100977+0.00726502im     0.071965-0.0739772im     -0.119887-0.0574712im      0.207442-0.00632753im     0.258169-0.129975im      0.0335261+0.266178im      -0.0461731-0.11257im       -0.130399+0.0440109im     -0.093543+0.0279729im     -0.0352247-0.237777im    -0.0096456-0.0260862im      0.193779-0.0162771im    -0.0105913-0.140306im       0.170775-0.0539238im     -0.0669359-0.0372064im    0.0694688+0.0189475im     -0.207883-0.0433724im      0.104294+0.213138im       0.196267+0.129808im      -0.164903+0.0740644im    -0.0411927+0.137531im     0.0590116-0.0395078im      0.180181-0.0586033im    -0.0304638-0.0734256im      0.133107-0.0659233im     -0.246316-0.12573im        0.207078-0.186361im
   -0.106914-0.0934091im    -0.146901+0.0655831im       0.0833846+0.162922im     -0.156861+0.047712im   -0.0194705-0.119392im        0.078918-0.181437im      -0.226774+0.0877351im       0.24437+0.191705im      -0.122399-0.0226068im    -0.0555894+0.0597527im     0.0483378-0.0936271im      0.0154826-0.0444051im     0.0177482-0.232542im      0.0642159-0.0531768im     -0.0707727+0.00655535im   0.0868856+0.0531556im     -0.175799+0.127956im     -0.0790271-0.101486im     -0.0803147-0.0620229im       0.173436-0.128949im      0.044397-0.0612383im     -0.297306+0.0686487im     -0.168664+0.0468825im     0.0677974+0.177567im     -0.0313088+0.111156im      -0.203338+0.208911im    -0.0192642-0.0276519im     -0.187479-0.00627723im    0.0113593+0.120279im      0.0227647-0.0891729im     0.0647246+0.207994im       0.242472-0.146946im
     0.27755-0.187286im         0.195-0.0399742im        0.108987-0.0150229im      0.14103+0.0111715im  -0.0679749-0.051358im       0.0714259-0.0699781im      0.135722+0.208813im     -0.0981349-0.0392341im    -0.0871469+0.161018im      -0.250975+0.118841im       0.183494-0.184935im      -0.0195236+0.000469359im    0.177169+0.0778203im      0.227763-0.0961476im      -0.148351+0.071813im    -0.0563545-0.0995877im    0.00770468-0.128001im     0.00247127-0.0749728im     -0.102727+0.116575im      -0.0922873+0.0784125im    -0.116756-0.100911im      0.0658842-0.0727588im      0.129584+0.0494554im      0.199333+0.140919im    -0.00983687+0.0289933im    -0.0587144+0.130791im      0.145244+0.0811132im   -0.00131365-0.134239im     -0.0641751-0.00207581im     0.065867+0.13074im       -0.163363-0.180263im        0.18625-0.219587im
    0.122517-0.0324875im    -0.200445-0.0403275im     -0.00715919-0.141504im    0.00541154+0.112094im    -0.069711-0.0321704im     -0.0317712+0.174988im      0.0437491+0.0712866im      0.142882+0.16293im       -0.286615+0.00333894im     -0.14104-0.0836848im     -0.146573-0.125552im      -0.0559801+0.0429443im    -0.0201076+0.0635559im     0.0353271-0.0323239im     -0.0432825+0.0854288im   -0.0826228-0.120699im       0.434421-0.0681078im      0.108359+0.0356321im    -0.0227303+0.00533425im      0.337581+0.0151425im    0.0605248-0.125972im      -0.194101-0.102619im      0.0200643+0.0264403im    -0.0621386-0.154673im      -0.199283+0.0324346im      0.206993-0.110169im     -0.195794-0.099902im      0.0650001+0.0779665im      0.111088-0.00262084im     0.148232-0.096509im     -0.0843327-0.0184643im     0.0426156-0.066285im
    0.267722-0.0625111im    -0.249784-0.0822944im        0.269976+0.0194644im    -0.188065+0.128573im    0.0914694+0.0636076im      0.0519496+0.0118343im     -0.069467-0.112452im      -0.169429-0.0264251im    -0.0343462+0.15164im       0.0159408+0.00284135im   -0.0122956-0.0917011im     -0.0566384-0.0817674im     0.0615499-0.00521141im    -0.335366-0.101662im       -0.121549-0.109939im     -0.180548-0.180577im     -0.0503606+0.140331im      0.0481257-0.0201231im      0.090924-0.120927im     0.000272332-0.0407659im    0.0107526-0.0491378im     0.0618889+0.162069im    -0.00334423+0.00228791im  -3.09423e-5+0.0509498im      0.204728+0.0914384im      0.101048-0.185222im      0.187031+0.00516634im     0.183548-0.0736612im      0.114899+0.255188im      -0.233002-0.0731603im    -0.0870852+0.0445468im     0.0716903-0.00729951im
  -0.0840864+0.0664602im    0.0535855+0.0529526im        0.226701-0.0446885im   -0.0133014+0.305319im    0.0666003+0.0145966im      0.0466033+0.161598im       0.154435-0.152023im     -0.0616005+0.128658im      -0.182817-0.144713im      0.0272682+0.135467im     -0.0373366+0.173821im       0.0257944-0.0939934im     0.0755985-0.0398775im     0.0589441+0.346079im       0.0945275+0.0901633im   -0.0927761-0.0198284im      -0.13883+0.0492619im     -0.203144+0.138444im      -0.105129+0.0597421im       0.108125-0.182143im    -0.0611027+0.111138im      0.0474008-0.0016777im      0.173002-0.129213im     -0.0053221-0.0495794im      0.094444+0.24078im      0.00102896+0.0223694im    0.0371778+0.0247314im     -0.161872+0.190434im       -0.10348+0.058353im      0.0602603-0.00710845im     -0.21568-0.21138im        0.117085+0.0315277im
    0.207088-0.0826565im     0.118249+0.316573im        -0.049107+0.00677939im   0.0977391-0.183765im    -0.112168+0.136505im       0.0357699+0.0600885im      0.071764-0.188706im       0.161133+0.0338155im     -0.147181+0.0256633im     0.0852918+0.12692im      -0.0818165+0.0058121im      0.0463571+0.0882635im     -0.128929+0.242298im     -0.0473419-0.0697116im       0.124132-0.166425im    0.00820102-0.105237im      0.0183174+0.0470142im     -0.255935-0.0624829im      0.168544-0.204168im       0.0663351+0.052433im       0.11456+0.133141im       0.132099+0.0137654im     0.0137988-0.235379im      0.0976107-0.0159932im     -0.126628-0.174013im    -0.00665355+0.00707603im   0.0226419-0.0826018im      -0.19698-0.0346603im     0.0261247+0.0688775im     -0.114945-0.054523im       0.103868-0.0284435im      0.290588-0.113219im
  -0.0014486+0.0948835im   -0.0884149-0.0892255im       -0.250261-0.0773966im    -0.111999+0.091731im    -0.105796+0.248856im      -0.0320134-0.0513131im    -0.0267252+0.0666064im    -0.0448727-0.188514im      -0.238825+0.292625im    -0.00504145-0.0424002im      0.113652-0.038086im      -0.0952251-0.235281im     -0.0269081-0.0700687im      -0.10952+0.104673im     -0.00765644-0.0610003im    -0.075659+0.0797884im    -0.0917521+0.089945im     -0.0512742-0.115189im      -0.145985+0.103304im       0.0756915+0.0457221im       0.1973+0.0308163im     0.0722619-0.150689im       0.212644-0.0534305im    -0.0346525-0.226593im      0.0273806-0.101101im      -0.310394+0.0991385im    0.0587648-0.00775747im   -0.0117737-0.112149im      0.0308513-0.0503017im      0.119876-0.297165im      0.0909187-0.0857639im    -0.0413587-0.0303468im
 -0.00370896-0.0374136im   0.00614059+0.0202488im       -0.136065-0.108051im     -0.283097+0.146763im     0.405066+0.0753543im      -0.111358+0.0960886im      0.116619+0.0748455im      0.019857-0.124053im     -0.0409041+0.0571757im     0.0942886+0.115274im     -0.0427558-0.0290254im      -0.106685+0.0695181im     -0.108399+0.190061im       0.378383+0.00855104im      0.169879+0.079245im    -0.0980369-0.0808593im     -0.134898+5.39532e-5im   -0.0455812+0.0224493im    -0.0494629-0.267693im       0.0127265+0.158351im      0.111058+0.0955773im     -0.156332+0.0862195im    -0.0191655+0.191183im       0.206632+0.0781843im    0.00342296+0.0204167im    -0.0281081-0.0154784im    0.0524634-0.043296im       0.121499-0.0885123im      0.035956-0.121668im     -0.0145967-0.0215727im     -0.110272+0.167776im     -0.0195006+0.0783598im
   0.0963642+0.0249045im     0.117858+0.0274706im      0.00399609-0.0783478im     0.186461-0.0387574im   0.0215437-0.078506im       -0.181911+0.182314im      0.0847008+0.1052im         0.134689-0.0726083im      0.116302-0.0901426im       0.10705-0.0450032im      0.192861-0.258136im     -0.00469693-0.116081im      -0.144598-0.19622im      -0.0902638+0.0628353im       0.242115-0.254568im     -0.101024+0.122722im      -0.131996-0.0403429im      0.166838-0.17367im       -0.117252-0.205736im       0.0627011+0.0383188im   -0.0637504-0.0419105im    -0.0685142-0.243146im     -0.0295706+0.0411546im    -0.0501127-0.152783im      0.0295877+0.287299im       0.103798+0.0227895im    -0.045265+0.146568im      -0.108753-0.0513737im      0.147026+0.0421312im     -0.195475+0.0446276im    -0.0821786-0.0250498im     0.0716168-0.0190278im
    0.098231+0.203898im     0.0845212-0.0761099im        0.031326-0.138744im     0.0285343+0.128318im    -0.104754+0.112512im        0.136966-0.134242im      -0.184785+0.215461im     -0.0581538+0.139495im      0.0790041+0.0828324im      0.482089-0.0907048im     -0.094257-0.117932im       0.0747452+0.0639363im    -0.0233245+0.0971964im    0.00757531-0.0489975im      0.0694845+0.186014im      0.136509+0.0175719im     -0.212537+0.0051508im    -0.0556607-0.106563im     -0.0709128-0.0879717im      0.0748146+0.0602893im    -0.112871-0.254736im     -0.0227797+0.0825022im     0.0786813-0.0266648im     -0.148188+0.0913928im    -0.0877624-0.101784im      0.0957561-0.252755im     0.0453361+0.0256163im     -0.112515+0.0298571im    -0.0322774-0.115352im      0.0759633-0.0712834im     -0.137663-0.0954001im      0.069282-0.0906877im
   -0.162917+0.106507im     -0.109143-0.0678078im        0.180649+0.0326113im    0.0889701-0.117435im    -0.203122+0.225117im        0.117904+0.157241im     -0.0715971+0.156881im     0.00315409-0.0728702im      0.181748+0.113705im       -0.15055+0.0273639im   -0.00665885+0.221238im       0.0274628+0.17309im       0.0793134-0.0188879im      0.138027-0.0521327im      0.0694886+0.123162im     -0.174367-0.0621745im     0.0626497+0.144707im     0.00161197-0.187356im       -0.25566-0.19931im        0.0489535+0.126863im    -0.0727417-0.00572108im   -0.0415609-0.0873254im      -0.04217-0.249884im      0.0214339-0.0930939im     0.0356624+0.114191im      0.0535149+0.0679104im     0.242669-0.084535im        0.15297+0.166062im     -0.0084454-0.0900206im    -0.0409648+0.0302588im      0.155506+0.106234im       0.147418+0.120332im
    0.185333-0.0300895im     0.186345-0.0802949im       -0.198352+0.0827487im   0.00790637+0.12066im     -0.129622+0.00420822im    -0.0779908-0.0413624im    -0.0978884+0.248622im      -0.101224-0.0167821im       0.12748-0.0847417im     0.0931066+0.159452im      -0.027528+0.0318721im      -0.138758+0.00235622im     0.246465-0.0356667im     0.0480234+0.0784056im      -0.125186-0.0517641im    -0.114359+0.276651im       0.236204+0.0399889im    -0.0745506-0.180995im    -0.00932863-0.139519im    -0.000667136-0.0738594im    0.0687729+0.397348im       -0.05057+0.125477im      0.0366159-0.0136489im     0.0429401+0.118088im     -0.0048562+0.00783655im     0.170891-0.0828649im    -0.115392+0.0812952im    -0.0161202+0.105873im     -0.0463811+0.266114im      0.0690966-0.165756im      0.0292794+0.0353932im    -0.0173027+0.0714627im
  -0.0653679-0.0304628im      0.10246-0.121112im         0.217153-0.0185883im    -0.225158-0.106556im    0.0953264-0.0188101im       0.167939+0.0673431im     0.0108496+0.13832im       -0.130992-0.120472im       0.143439+0.124147im      -0.138892-0.164512im      0.0271001-0.0689976im       0.205324-0.0292516im      -0.13019-0.18636im        0.120388+0.115795im        0.179247-0.160244im    -0.0302607-0.0607278im      0.184962-0.100984im       0.177202+0.0117343im     0.0680656-0.0273072im     -0.0533636-0.135034im     0.0501231-0.028519im     -0.0664327+0.189815im       0.144877-0.187473im        0.17886-0.025703im      0.0490342-0.253785im     -0.0285675-0.128869im     -0.129434-0.0655758im     -0.356794+0.0253348im     0.0008044+0.0292444im     0.0458832-0.112872im     -0.0538097+0.0226986im     0.0647967+0.0512941im
    0.102114+0.0587881im     0.112561+0.0105081im       0.0225407-0.0113642im   -0.0796568-0.0298819im  -0.0950289+0.0923064im      -0.141756-0.0115234im   -0.00584881-0.22402im       0.0197964-0.0478359im       0.16199-0.155763im      -0.113654+0.0567857im    -0.0599901+0.0688442im     -0.0275577-0.304904im       0.128342-0.0297356im      0.131848-0.255757im       0.0218261+0.0976593im    0.0503411+0.00404706im   -0.0378814+0.108584im     -0.0618635+0.0236589im     -0.136713-0.063527im       -0.191189-0.203908im    -0.0385094-0.116641im      -0.142151-0.0642236im      0.330932-0.0296111im     -0.115847+0.119074im      -0.107843-0.0444588im     -0.013916-0.0212681im    -0.167555-0.220793im      0.0497711-0.0683138im      0.426288-0.0378168im    -0.0151522-0.0005579im    -0.0510213+0.00382273im    0.0733861+0.0887185im
   0.0804875-0.0523184im    -0.226106+0.0126235im      -0.0538687+0.0682407im   -0.0158252-0.0091711im  0.00260079-0.144349im         0.03117+0.00595836im    0.0423317-0.0727252im   -0.00550533-0.2367im        0.0959403-0.123517im    -0.00133501+0.0574898im     0.0495986+0.0674593im       0.070919-0.00961764im   0.00216523+0.13661im       -0.115065+0.195194im        0.057437+0.175352im      0.102348-0.102705im     -0.0536952-0.0601573im       0.13636+0.128507im      -0.372067+0.0316987im     -0.0878169-0.053365im    -0.0486945+0.117592im      0.0645889-0.148676im       -0.10474+0.0118489im    -0.0602666+0.0587133im    -0.0865835-0.255277im       0.293229+0.0815728im     0.127822+0.170205im      -0.115486-0.0671858im      0.072014+0.027166im      0.0830117-0.295264im     -0.0684544+0.214712im       0.138965-0.175537im
   -0.217608-0.393841im    -0.0512008+0.0729468im      -0.0216289-0.336705im    -0.0241168+0.10049im     -0.144301-0.0060621im      -0.034746-0.138658im     -0.0313371+0.194335im     -0.0951711-0.159243im     0.00705757-0.169062im     -0.0350897+0.0163458im      0.232955-0.0565637im     -0.0432846-0.0235489im      0.109419+0.134108im      0.0126032-0.139585im       0.0840741-0.0518998im       0.2845-0.155397im      0.0612255-0.00499243im  -0.00905174+0.143503im      0.0871901-0.160975im        0.143767-0.0856215im    0.0979254+0.0368863im    -0.0323767+0.0111438im     0.0890705-0.108936im      -0.303742+0.00798888im     0.150503+0.0493054im     0.0151224+0.0386408im     0.094333-0.0112983im     -0.036177-0.000260678im   -0.117636-0.0286064im     -0.114833-0.0237257im   -0.00472527-0.0337852im     0.0100249+0.138287im
    0.244649+0.0549203im     -0.15001-0.249088im       -0.0475104-0.122509im      0.185022-0.0582982im   0.0416985-0.0861332im     -0.0743874+0.069808im      -0.071179+0.163626im     -0.0733361-0.000439241im  -0.0780084+0.0567025im      0.100502+0.138626im       0.125719+0.143894im        0.191646-0.0265456im    -0.0790484-0.0427211im    -0.0769722+0.110687im       -0.137266-0.128404im    -0.0453512-0.0880074im     -0.222652-0.222318im     -0.0442122+0.110191im        0.05058-0.00350731im      0.169596-0.18789im      0.0731448+0.08674im      -0.0904745+0.081649im       0.174417-0.0913036im     0.0491844+0.137166im      -0.186328-0.0264298im      0.101285+0.194725im     0.0716126-0.230541im     0.00171051+0.0673227im     0.0724154-0.129954im     -0.0298325+0.232291im       0.161232+0.149435im      -0.121287+0.0555475im
  -0.0553786+0.0197178im     -0.15018+0.0658341im       0.0697238+0.176787im     0.0750374+0.0921855im   -0.131063-0.0760605im       0.211427+0.0663375im    0.00476648+0.0594137im      0.126041-0.242251im     0.00349229-0.0749226im     -0.124649+0.00421355im   -0.0893461-0.218136im        0.143466-0.0899328im    -0.0159308-0.126657im    -0.00841972+0.0346964im       0.104449+0.0307715im    -0.124961+0.138643im     -0.0938845+0.0387127im    -0.0629743+0.130893im    -0.00931199-0.136848im       0.0153222+0.340116im      0.190417+0.106318im      0.0845656+0.139812im       0.123775-0.0989439im      -0.19773+0.236358im      -0.122343-0.0848808im    -0.0259434+0.0394064im    -0.171826-0.102076im       0.190449+0.0198202im    -0.0994707+0.000931962im  -0.0778221+0.0952671im     -0.208358-0.0766139im     -0.179641-0.177434im
    0.126093+0.189798im    -0.0473267+0.294024im         0.145395-0.052212im     -0.064188+0.0273438im  -0.0749332-0.0647725im    -0.00483793+0.293105im       0.161958+0.0590294im    -0.0556775-0.0161513im      0.212313+0.0377222im      0.188622-0.045508im      0.0949744-0.0645694im     -0.0836172+0.00779002im     0.143127+0.109034im     -0.0663992-0.12847im        -0.108347+0.0474956im    0.0489324-0.0901373im     0.0197438-0.134901im       0.104372+0.13956im       0.0340768+0.0401226im      0.0427912+0.123819im     0.0630854+0.119817im      -0.150371-0.0319294im     -0.104961-0.127353im     -0.0192307+0.123022im       0.105354+0.0605507im     -0.381091+0.0549945im    0.0370158+0.0482528im     -0.123889+0.163606im       0.206806+0.0884446im      0.254999-0.0111385im      0.081846+0.0354443im     -0.171059-0.065211im
   0.0393705-0.029899im    -0.0668371+0.000595854im    -0.0280853-0.0634865im     0.106651+0.194287im   -0.0155172+0.10277im       -0.0169963+0.0975644im   -0.00833242+0.148396im     0.00525139+0.0149932im     -0.120602-0.0718419im    -0.0499877-0.092796im      -0.283988+0.211009im        0.311498-0.213949im      0.0550138+0.0374937im      0.072117-0.131416im       -0.137186-0.0814972im   -0.0881572+0.0906043im    -0.0446445-0.0925954im    -0.0519143+0.0687832im      0.117056-0.045469im       -0.253684+0.192566im     0.0506712-0.125162im      -0.136324-0.212693im      -0.177958-0.0149138im     0.0378866+0.102978im       0.294414+0.0461558im      0.169163+0.0658227im   0.00343128-0.0449782im      -0.25852-0.162469im      -0.054998-0.0239539im    -0.0491189-0.167524im      0.0998961-0.0435206im    -0.0690429+0.0113183im
  -0.0148701+0.103564im      0.162164-0.0748625im       -0.127514-0.0774419im     -0.15451-0.0315833im    0.139738-0.197752im        0.178658+0.0526993im      0.200469-0.0149227im      0.168159-0.138242im      -0.106852-0.0726198im      0.172043+0.0862345im     0.0285039+0.000963655im     0.118682-0.144895im     -0.0581865-0.00409269im    -0.106074+0.0260622im      -0.194584+0.315043im      0.121475+0.117854im       0.292168+0.089542im       0.176285-0.165531im      0.0914945-0.0314871im     -0.0362525-0.0188728im   -0.0251642-0.0870811im     0.0491622-0.077564im      0.0933291-0.208395im       0.026099+0.109148im     -0.0729251+0.189833im     -0.0871562+0.00780372im    0.217241-0.16821im     -0.00508958-0.0313238im     -0.127195+0.0217223im     -0.244372-0.0401178im     0.0282063+0.0951829im   -0.00903696-0.0221007im
   0.0367807-0.0147871im    -0.169639-0.0142417im      -0.0854588-0.165993im    -0.0604248-0.228126im    0.0197686+0.0515924im     -0.0237656+0.110258im      -0.215605+0.00711599im    0.0598383+0.200772im      0.0762331-0.0637059im      0.100275+0.0552604im      -0.30682-0.00732519im    -0.0162663-0.13845im        0.125509+0.104881im      0.0702371+0.0733822im       0.155757+0.0142717im     0.105765+0.0161644im     0.0372024-0.0960129im      0.245533+0.060688im      -0.197697+0.0634899im     -0.0469463+0.0214113im     0.060252+0.00491332im      -0.1259+0.161879im       0.174274-0.0442921im      0.121296-0.0983373im     0.0410021-0.0538496im     -0.100947+0.222592im     0.0488207+0.164303im       0.100704-0.0647219im     -0.140622+0.257104im      -0.234473+0.122649im      0.0602093-0.251407im    -0.00374194-0.0978098im
   0.0693222-0.00743444im    0.102232-0.0462591im       -0.111123+0.159047im     -0.202763+0.111903im    -0.244436+0.00727853im     -0.214655+0.158287im     -0.0382993+0.0787895im     0.0561403+0.107843im       0.171472-0.13708im       -0.142846+0.0563611im      0.129512+0.115925im      -0.0135404-0.0733939im     -0.127806+0.17477im       -0.104339-0.0112339im       0.168511+0.102754im     -0.127218+0.135794im     -0.0549321+0.00134942im    0.0154022+0.0186672im       0.14317+0.0763921im       0.177323-0.183614im      0.210719-0.259786im      0.0010278-0.103613im     -0.0177237-0.0756171im      0.150286+0.052626im       0.229999-0.182935im     -0.0138033-0.101574im     0.0839435+0.0565971im      0.110786+0.0775262im      -0.15655-0.0882682im    -0.0331357+0.123765im      -0.103653+0.116746im     -0.0122537-0.22604im
 -0.00337305+0.0953615im     -0.11375-0.0919641im      -0.0451035-0.226263im     -0.142687-0.120132im    -0.211836-0.0726038im      0.0275974+0.123628im       0.187809+0.0354419im    -0.0922025+0.064648im     -0.0773227+0.148988im    -0.00259053+0.0869578im      0.139997+0.0924561im       0.236691+0.188541im       0.274705+0.0996622im     -0.066525+0.131946im       0.0694796-0.00306631im   0.0885755+0.0223528im     0.0160386+0.268627im      -0.170097-0.140411im      0.0494326+0.0690311im      -0.111455+0.0489731im    0.0651972-0.0962046im    -0.0329933+0.0530602im     -0.093843+0.124126im      0.0128781+0.00738175im   -0.0186244-0.00614559im   -0.0270408+0.125881im     -0.329361+0.177131im      -0.064588-0.0339696im       0.13228-0.0291193im     -0.232365+0.0580738im     -0.215155+0.13014im      -0.0460077+0.0454394im</code></pre><p>and then generate the state <span>$ψ$</span></p><pre><code class="language-julia hljs">psi = P[:, 3]</code></pre><pre><code class="nohighlight hljs">32-element Vector{ComplexF64}:
     0.368889194737841 + 0.0im
 -0.003967276206662639 - 0.04628233579327489im
   0.25769450338864597 - 0.08051711375504579im
  -0.09319615446231701 - 0.046610307777454375im
  -0.06220546853669427 + 0.19838585167590925im
   0.05235209106032533 + 0.22546875647579306im
    0.1448755334836113 - 0.017691105930153956im
   0.03998906919549126 + 0.03205720066384035im
 -0.022883706091735068 + 0.1767145308587321im
   0.12815974162140947 + 0.18728459860220423im
   0.08218567407317033 - 0.05441762299591237im
  0.015561526424499301 - 0.04908080304252237im
   0.10076021573886774 + 0.16057400641188402im
 -0.018755597970385476 - 0.012736849831756235im
   0.10677952641660868 - 0.19764402763244385im
 -0.025710804953755263 - 0.07068016137851725im
  0.014808060851029606 - 0.053682438962253776im
    -0.287416985366409 + 0.17170747370449266im
  -0.22477910266174406 - 0.0038377853250892253im
  -0.11561384718138684 + 0.1394009054645004im
  0.010843790675106947 - 0.013758350043541909im
  -0.10808634805675015 + 0.03762828073233833im
  -0.09443856323010358 + 0.06033656683321027im
   0.18110695603778737 - 0.17565697770856262im
   -0.1742371034697354 - 0.003902043447033013im
 -0.016745389921950536 + 0.0999440061073696im
  -0.08099097600238452 - 0.00857615837348123im
  0.041976094665166455 - 0.12037776115312283im
  -0.27746823491397005 + 0.0879517633614349im
   0.06558856963377156 - 0.1402249744119712im
  -0.01600516850037687 + 0.06902691031758074im
  0.023901320675129775 + 0.05594345131433211im</code></pre><p>In the phase estimation process, we will feed the state to circuit and measure the first <code>n</code> qubits processed by iQFT.</p><pre><code class="language-julia hljs">r = join(ArrayReg(psi), zero_state(N))
r |&gt; PE(N, M, U)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 8/8
    nlevel: 2</code></pre><p>Since our phase can be represented by 3 qubits precisely, we only need to measure once</p><pre><code class="language-julia hljs">results = measure(r, 1:N; nshots=1)</code></pre><pre><code class="nohighlight hljs">1-element Vector{DitStr{2, 3, Int64}}:
 011 ₍₂₎</code></pre><p>Recall that our QFT&#39;s bit numbering is reversed, let&#39;s reverse it back</p><pre><code class="language-julia hljs">using BitBasis
estimated_phase = bfloat(results[]; nbits=N)</code></pre><pre><code class="nohighlight hljs">0.75</code></pre><p>the phase is exactly <code>0.75</code>!</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../1.prepare-ghz-state/index.html">« Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a><a class="docs-footer-nextpage" href="../3.grover-search/index.html">Grover Search »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.18 on <span class="colophon-date" title="Tuesday 31 May 2022 00:50">Tuesday 31 May 2022</span>. Using Julia version 1.7.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
