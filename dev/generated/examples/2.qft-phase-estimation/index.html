<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quantum Fourier Transformation and Phase Estimation · Documentation | Yao</title><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.044/juliamono.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/indigo.css" rel="stylesheet" type="text/css"/><link href="https://yaoquantum.org/assets/favicon-light.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../index.html"><img src="../../../assets/logo.png" alt="Documentation | Yao logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../index.html">Documentation | Yao</a></span></div><form class="docs-search" action="../../../search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../index.html">Home</a></li><li><a class="tocitem" href="../../../quick-start.html">Quick Start</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../../man/registers.html">Registers</a></li><li><a class="tocitem" href="../../../man/blocks.html">Blocks</a></li><li><a class="tocitem" href="../../../man/symbolic.html">Symbolic Computation</a></li><li><a class="tocitem" href="../../../man/automatic_differentiation.html">Automatic Differentiation</a></li><li><a class="tocitem" href="../../../man/simplification.html">Simplification</a></li><li><a class="tocitem" href="../../../man/bitbasis.html">BitBasis</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../1.prepare-ghz-state/index.html">Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a></li><li class="is-active"><a class="tocitem" href="index.html">Quantum Fourier Transformation and Phase Estimation</a><ul class="internal"><li><a class="tocitem" href="#Quantum-Fourier-Transformation"><span>Quantum Fourier Transformation</span></a></li><li><a class="tocitem" href="#Wrap-QFT-to-an-external-block"><span>Wrap QFT to an external block</span></a></li><li><a class="tocitem" href="#Phase-Estimation"><span>Phase Estimation</span></a></li></ul></li><li><a class="tocitem" href="../3.grover-search/index.html">Grover Search</a></li><li><a class="tocitem" href="../4.shor-algorithm/index.html">Shor&#39;s Algorithm</a></li><li><a class="tocitem" href="../5.shor-9-code/index.html">Shor&#39;s 9 qubit code</a></li><li><a class="tocitem" href="../6.quantum-circuit-born-machine/index.html">Quantum Circuit Born Machine</a></li><li><a class="tocitem" href="../7.variation-quantum-eigen-solver/index.html">Variational Quantum Eigen Solver</a></li></ul></li><li><a class="tocitem" href="../../../performancetips.html">Performance Tips</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/QuantumBFS/Yao.jl/blob/master/docs/src/examples/2.qft-phase-estimation/main.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><p><a href="https://mybinder.org/v2/gh/QuantumBFS/Yao.jl/gh-pages?filepath=dev/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a> <a href="https://nbviewer.jupyter.org/github/QuantumBFS/Yao.jl/blob/gh-pages/dev/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://img.shields.io/badge/show-nbviewer-579ACA.svg" alt/></a> <a href="https://minhaskamal.github.io/DownGit/#/home?url=https://github.com/QuantumBFS/tutorials/tree/gh-pages/dev/generated/examples/2.qft-phase-estimation"><img src="https://img.shields.io/badge/download-project-orange" alt/></a></p><h1 id="example-qft"><a class="docs-heading-anchor" href="#example-qft">Quantum Fourier Transformation and Phase Estimation</a><a id="example-qft-1"></a><a class="docs-heading-anchor-permalink" href="#example-qft" title="Permalink"></a></h1><p>Let&#39;s use Yao first</p><pre><code class="language-julia hljs">using Yao</code></pre><h2 id="Quantum-Fourier-Transformation"><a class="docs-heading-anchor" href="#Quantum-Fourier-Transformation">Quantum Fourier Transformation</a><a id="Quantum-Fourier-Transformation-1"></a><a class="docs-heading-anchor-permalink" href="#Quantum-Fourier-Transformation" title="Permalink"></a></h2><p>The Quantum Fourier Transformation (QFT) circuit is to repeat two kinds of blocks repeatly:</p><p><img src="assets/qft.png" alt="qft-circuit"/></p><p>The basic building block control phase shift gate is defined as</p><p class="math-container">\[R(k)=\begin{bmatrix}
1 &amp; 0\\
0 &amp; \exp\left(\frac{2\pi i}{2^k}\right)
\end{bmatrix}\]</p><p>Let&#39;s define block <code>A</code> and block <code>B</code>, block <code>A</code> is actually a control block.</p><pre><code class="language-julia hljs">A(i, j) = control(i, j=&gt;shift(2π/(1&lt;&lt;(i-j+1))))</code></pre><pre><code class="nohighlight hljs">A (generic function with 1 method)</code></pre><p>Once you construct the blockl you can inspect its matrix using <code>mat</code> function. Let&#39;s construct the circuit in dash box A, and see the matrix of <span>$R_4$</span> gate.</p><pre><code class="language-julia hljs">R4 = A(4, 1)</code></pre><pre><code class="nohighlight hljs">(n -&gt; control(n, 4, 1 =&gt; shift(0.39269908169872414)))</code></pre><p>If you have read about <a href="generated/examples/2.qft-phase-estimation/@ref example-ghz">preparing GHZ state</a>, you probably know that in Yao, we could just leave the number of qubits, and it will be evaluated when possible.</p><pre><code class="language-julia hljs">R4(5)</code></pre><pre><code class="nohighlight hljs">nqubits: 5
control(4)
└─ (1,) shift(0.39269908169872414)</code></pre><p>its matrix will be</p><pre><code class="language-julia hljs">mat(R4(5))</code></pre><pre><code class="nohighlight hljs">32×32 LinearAlgebra.Diagonal{ComplexF64, Vector{ComplexF64}}:
 1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im</code></pre><p>Then we repeat this control block over and over on different qubits, and put a Hadamard gate to <code>i</code>th qubit to construct <code>i</code>-th <code>B</code> block.</p><pre><code class="language-julia hljs">B(n, k) = chain(n, j==k ? put(k=&gt;H) : A(j, k) for j in k:n)</code></pre><pre><code class="nohighlight hljs">B (generic function with 1 method)</code></pre><p>We need to input the total number of qubits <code>n</code> here because we have to iterate through from <code>k</code>-th location to the last.</p><p>Now, let&#39;s construct the circuit by chaining all the <code>B</code> blocks together</p><pre><code class="language-julia hljs">qft(n) = chain(B(n, k) for k in 1:n)
qft(4)</code></pre><pre><code class="nohighlight hljs">nqubits: 4
chain
├─ chain
│  ├─ put on (1)
│  │  └─ H
│  ├─ control(2)
│  │  └─ (1,) shift(1.5707963267948966)
│  ├─ control(3)
│  │  └─ (1,) shift(0.7853981633974483)
│  └─ control(4)
│     └─ (1,) shift(0.39269908169872414)
├─ chain
│  ├─ put on (2)
│  │  └─ H
│  ├─ control(3)
│  │  └─ (2,) shift(1.5707963267948966)
│  └─ control(4)
│     └─ (2,) shift(0.7853981633974483)
├─ chain
│  ├─ put on (3)
│  │  └─ H
│  └─ control(4)
│     └─ (3,) shift(1.5707963267948966)
└─ chain
   └─ put on (4)
      └─ H
</code></pre><h2 id="Wrap-QFT-to-an-external-block"><a class="docs-heading-anchor" href="#Wrap-QFT-to-an-external-block">Wrap QFT to an external block</a><a id="Wrap-QFT-to-an-external-block-1"></a><a class="docs-heading-anchor-permalink" href="#Wrap-QFT-to-an-external-block" title="Permalink"></a></h2><p>In most cases, <code>function</code>s are enough to wrap quantum circuits, like <code>A</code> and <code>B</code> we defined above, but sometimes, we need to dispatch specialized methods on certain kinds of quantum circuit, or we want to define an external block to export, thus, it&#39;s useful to be able to wrap circuit to custom blocks.</p><p>First, we define a new type as subtype of <code>PrimitiveBlock</code> since we are not going to use the subblocks of <code>QFT</code>, if you need to use its subblocks, it&#39;d be better to define it under <code>CompositeBlock</code>.</p><pre><code class="language-julia hljs">struct QFT &lt;: PrimitiveBlock{2}
    n::Int
end

YaoBlocks.nqudits(q::QFT) = q.n</code></pre><p>Now, let&#39;s define its circuit</p><pre><code class="language-julia hljs">circuit(q::QFT) = qft(q.n)</code></pre><pre><code class="nohighlight hljs">circuit (generic function with 1 method)</code></pre><p>And forward <code>mat</code> to its circuit&#39;s matrix</p><pre><code class="language-julia hljs">YaoBlocks.mat(::Type{T}, x::QFT) where T = mat(T, circuit(x))</code></pre><p>You may notice, it is a little ugly to print <code>QFT</code> at the moment, this is because we print the type summary by default, you can define your own printing by overloading <code>print_block</code></p><pre><code class="language-julia hljs">YaoBlocks.print_block(io::IO, x::QFT) = print(io, &quot;QFT($(x.n))&quot;)</code></pre><p>Since it is possible to use FFT to simulate the results of QFT (like cheating), we could define our custom <code>apply!</code> method:</p><pre><code class="language-julia hljs">using FFTW, LinearAlgebra

function YaoBlocks.apply!(r::ArrayReg, x::QFT)
    α = sqrt(length(statevec(r)))
    invorder!(r)
    lmul!(α, ifft!(statevec(r)))
    return r
end</code></pre><p>Now let&#39;s check if our <code>apply!</code> method is correct:</p><pre><code class="language-julia hljs">r = rand_state(5)
r1 = r |&gt; copy |&gt; QFT(5)
r2 = r |&gt; copy |&gt; circuit(QFT(5))
r1 ≈ r2</code></pre><pre><code class="nohighlight hljs">true</code></pre><p>We can get iQFT (inverse QFT) directly by calling <code>adjoint</code></p><pre><code class="language-julia hljs">QFT(5)&#39;</code></pre><pre><code class="nohighlight hljs"> [†]QFT(5)</code></pre><p>QFT and iQFT are different from FFT and IFFT in three ways,</p><ol><li>they are different by a factor of <span>$\sqrt{2^n}$</span> with <span>$n$</span> the number of qubits.</li><li>the <a href="https://quantumbfs.github.io/BitBasis.jl/stable/tutorial/#Conventions-1">bit numbering</a> will exchange after applying QFT or iQFT.</li><li>due to the convention, QFT is more related to IFFT rather than FFT.</li></ol><h2 id="Phase-Estimation"><a class="docs-heading-anchor" href="#Phase-Estimation">Phase Estimation</a><a id="Phase-Estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Phase-Estimation" title="Permalink"></a></h2><p>Since we have QFT and iQFT blocks we can then use them to realize phase estimation circuit, what we want to realize is the following circuit:</p><p><img src="assets/phaseest.png" alt="phase estimation"/></p><p>First we call Hadamard gates repeatly on first <code>n</code> qubits.</p><pre><code class="language-julia hljs">Hadamards(n) = repeat(H, 1:n)</code></pre><pre><code class="nohighlight hljs">Hadamards (generic function with 1 method)</code></pre><p>Then in dashed box <code>B</code>, we have controlled unitaries:</p><pre><code class="language-julia hljs">ControlU(n, m, U) = chain(n+m, control(k, n+1:n+m=&gt;matblock(U^(2^(k-1)))) for k in 1:n)</code></pre><pre><code class="nohighlight hljs">ControlU (generic function with 1 method)</code></pre><p>each of them is a <code>U</code> of power <span>$2^{(k-1)}$</span>.</p><p>Since we will only apply the qft and Hadamard on first <code>n</code> qubits, we could use <code>Subroutine</code>, which creates a context of a sub-scope of the qubits.</p><pre><code class="language-julia hljs">PE(n, m, U) =
    chain(n+m, # total number of the qubits
        subroutine(Hadamards(n), 1:n), # apply H in local scope
        ControlU(n, m, U),
        subroutine(QFT(n)&#39;, 1:n))</code></pre><pre><code class="nohighlight hljs">PE (generic function with 1 method)</code></pre><p>we use the first <code>n</code> qubits as the output space to store phase <span>$ϕ$</span>, and the other <code>m</code> qubits as the input state which corresponds to an eigenvector of oracle matrix <code>U</code>.</p><p>The subroutine here uses <code>focus!</code> and <code>relax!</code> to manage a local scope of quantum circuit, and only activate the first <code>n</code> qubits while applying the block inside the subroutine context, and the scope will be <code>relax!</code>ed back, after the context. This is equivalent to manually <code>focus!</code> then <code>relax!</code></p><p>fullly activated</p><pre><code class="language-julia hljs">r = rand_state(5)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>first 3 qubits activated</p><pre><code class="language-julia hljs">focus!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 3/5
    nlevel: 2</code></pre><p>relax back to the original</p><pre><code class="language-julia hljs">relax!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>In this way, we will be able to apply small operator directly on the subset of the qubits.</p><p>Details about the algorithm can be found here: <a href="https://en.wikipedia.org/wiki/Quantum_phase_estimation_algorithm">Quantum Phase Estimation Algorithm</a></p><p>Now let&#39;s check the results of our phase estimation.</p><p>First we need to set up a unitary with known phase, we set the phase to be 0.75, which is <code>0.75 * 2^3 == 6 == 0b110</code> .</p><pre><code class="language-julia hljs">N, M = 3, 5
P = eigen(rand_unitary(1&lt;&lt;M)).vectors
θ = Int(0b110) / 1&lt;&lt;N
phases = rand(1&lt;&lt;M)
phases[0b010+1] = θ
U = P * Diagonal(exp.(2π * im * phases)) * P&#39;</code></pre><pre><code class="nohighlight hljs">32×32 Matrix{ComplexF64}:
   0.0141181-0.146159im     -0.0173975-0.10115im       0.165903-0.000833915im   0.0258062-0.0780242im    -0.344145+0.117271im    -0.0057962+0.156029im    -0.0191553+0.0394533im    -0.192054+0.117498im         0.140815+0.104671im      0.145276-0.11082im      -0.288936-0.0579302im      0.190001-0.0617169im       0.10844+0.124773im       0.024277-0.0248273im   -0.0668944-0.0392622im     -0.218305-0.202248im        0.187446-0.138385im          0.1292+0.1012im       -0.112865+0.0291608im     0.0831939+0.0332461im     -0.0380741+0.100274im    -0.0236312-0.0440077im     -0.145101-0.127184im        -0.1582-0.114686im     -0.103259-0.250003im       0.0318381-0.0341526im    0.0165328+0.0894891im   -0.0753029-0.033848im      -0.169597+0.0946442im  -0.00491217-0.119959im      -0.128635+0.00449335im    -0.137156-0.200532im
  -0.0874633-0.0534731im     0.0887945-0.349439im     0.0687679-0.0139584im     -0.258278+0.122367im     0.0811273+0.186854im      0.124174+0.079277im     -0.237662-0.0759625im     0.163786-0.0183502im       0.0453024+0.0102232im   -0.0916295-0.142532im     0.0185632-0.0514106im     0.0234466-0.101623im        0.11692+0.147251im       0.229015+0.290497im     -0.126869-0.056973im     -0.0702004-0.14084im       0.00755837+0.113552im    -0.000441881-0.0398621im    0.0760951+0.00869784im    0.0301062+0.0067591im   -0.000378236+0.0635297im    0.0869783-0.0713039im      0.216661+0.13648im      -0.0211978+0.142144im    -0.0323247+0.0106758im      0.0302749-0.109188im    -0.0777414+0.0356022im    0.0642138-0.149301im     -0.0560779-0.352931im    -0.0447728+0.0121944im    -0.0853154-0.0790196im       0.20907-0.012954im
   0.0410049+0.0420976im     -0.084944-0.289851im      0.186904-0.103066im       0.153693-0.13624im       0.120368-0.130416im      0.121662+0.0203029im    0.0569848-0.134018im      0.111802+0.0206093im        0.133029+0.0644596im    0.0521636-0.0744639im     -0.17716-0.0567297im     -0.226575+0.203397im      -0.130659+0.0403191im      0.100224+0.0581748im   -0.0144058-0.0337567im     0.0652772+0.00363663im     -0.101917-0.0405251im     -0.0210088+0.109875im       0.20052-0.127839im     -0.0974468+0.11367im       -0.0229165-0.168452im    -0.0586604+0.246357im    -0.00624133+0.160907im     -0.0359122+0.028008im     0.0508341-0.0537637im      0.0633839-0.0358728im     0.255283-0.20196im      -0.185012-0.127311im      0.0521215+0.112178im     -0.145106+0.050962im     0.00798779-0.223984im      -0.188726-0.158219im
   -0.089748-0.00382469im    -0.137531-0.0509298im    -0.111759-0.116101im       0.105821+0.0359574im   -0.0423488-0.2216im       0.0450812+0.112729im        0.1632+0.111278im     -0.278988+0.000964432im    -0.0488984-0.052791im      -0.17145-0.0746454im    -0.126918-0.117313im       -0.10007-0.146685im      0.0669576-0.0395393im   -0.00204357+0.309869im      0.161802-0.089508im      0.0315261-0.188556im        0.103177+0.101572im        0.200603-0.230157im     0.0610511+0.167347im     0.00948704-0.120404im       0.0729418-0.0937839im   -0.0469912-0.213124im      0.0110567+0.219658im      0.0535181-0.0272793im     0.252181-0.0309135im     -0.0972436-0.0949272im    0.0440229-0.0765351im   -0.0486442+0.068642im      0.0289481-0.0481192im    0.0982011-0.013689im     0.00392934+0.00212535im    -0.231407+0.190914im
   0.0450651-0.049914im      0.0582008-0.0317238im    -0.211268+0.0554726im    -0.0227152+0.261213im      0.212099-0.149112im     -0.268987+0.0399106im   -0.0689202-0.157813im    -0.0506047-0.129961im       -0.0162483+0.0270674im   -0.0779502-0.238108im    -0.0394703+0.0309584im     0.0919329+0.0212324im    -0.0993997-0.0649635im      0.233684+0.0583444im     0.144391+0.010737im      0.0996909+0.00213795im     0.0428441-0.229625im       -0.193853+0.00916734im   0.0893352+0.0806285im      0.122605-0.104898im       -0.054539+0.082747im    -0.0403198-0.199359im     -0.0456357+0.076047im     -0.0848429-0.0519842im    -0.292979-0.167561im         0.09575+0.0884911im     -0.10261-0.151124im     0.0389267+0.223614im       0.040833+0.156858im     -0.112214-0.0526434im     -0.015911-0.173348im     -0.0559007-0.116544im
  -0.0911374+0.114972im      -0.178288+0.0225214im     0.170596+0.23842im      -0.0500394-0.0415294im    -0.218479-0.0892415im   -0.0991101-0.0335345im     0.196274+0.0725546im   -0.0136403-0.0581159im       0.0378215-0.0269734im   -0.0464076+0.0308153im    -0.079062-0.120398im       0.084928+0.0279116im     0.0683254+0.0621737im    -0.0072213+0.27568im      0.0232311+0.13251im       0.0442911+0.416087im        0.131333+0.00184432im     0.0129522+0.341146im     0.0164385+0.00840545im     0.103191+0.0146986im      0.0213586+0.036639im    -0.0971074-0.00376754im    0.0670491+0.123453im       0.195546+0.258345im     -0.210016-0.0364521im     -0.0100583+0.122295im      0.129719-0.0687402im    0.0436988+0.0964588im   -0.00788667-0.180488im    -0.0402279-0.114415im     0.00893865+0.0764368im     0.0183405+0.0490602im
   -0.145139-0.0369104im   -0.00304728-0.0257005im   -0.0862843-0.112145im      0.0368602+0.0948061im    0.0194565+0.0106852im    0.0559468+0.184278im      0.332453-0.0958702im    0.0712188-0.115806im        -0.133205-0.041809im     -0.157916+0.0337011im     -0.08284+0.161522im      -0.139819+0.0828472im      0.147423+0.0292659im     -0.287841+0.182013im     0.0745201-0.167937im      0.0779953-0.104643im        0.117065-0.00290338im    -0.0815983+0.0696442im   -0.0153047-0.0665468im    -0.0863087+0.0365311im      0.0793475+0.0511849im    0.0693564-0.0268294im      0.100846-0.443641im     -0.0321563+0.180865im     -0.222958-0.0620948im       0.142954-0.0468597im   -0.0791522-0.0937849im   -0.0533878-0.225271im       0.100937+0.104863im       0.08516+0.0252353im    -0.0345964+0.0130616im      0.067764-0.0522308im
   -0.224857-0.121239im     -0.0768653+0.0655885im    0.0422136-0.204607im       0.191582+0.081454im     -0.142911-0.0644228im   -0.0622219-0.018725im     -0.110641-0.0240798im     0.231459-0.166704im     -0.000244352+0.146874im     0.0592692+0.0694723im   -0.0462877-0.188109im       0.114152-0.0292166im    -0.0144864-0.114748im      0.0108363+0.0498117im    -0.283495-0.0350689im      0.112355-0.0539291im     -0.0196947-0.0854042im      0.0263297-0.187796im      0.226888-0.141159im       0.204437+0.180888im      -0.0342157+0.272622im    -0.0323669+0.00658627im    0.0144096-0.01816im        0.044817+0.183936im       0.12123-0.0560861im       0.106493-0.082958im      0.036174+0.0728259im     0.206455+0.0541706im     0.0800588+0.189595im    -0.0565139-0.0700145im        0.2198+0.13547im      -0.0415162+0.102643im
    0.113362-0.177522im      0.0510721-0.143834im    -0.0561499-0.164556im      -0.119842+0.064464im     -0.167878-0.0682435im    0.0230144+0.0103528im   -0.0244554-0.0564194im    -0.152248-0.0216025im       0.0406176-0.541782im      0.160536+0.0864665im   -0.0246324+0.051308im      0.0968493+0.0378129im     -0.221667+0.118954im       0.146487+0.0285643im   -0.0352178+0.029177im      0.0142998+0.0728917im       0.139753-0.151814im       -0.202203+0.0118099im     0.203126+0.0418995im    -0.0604278+0.00743403im     0.0720539-0.111497im      0.170406-0.0575547im     0.0263867-0.0833003im     0.0667004+0.0529685im    0.0408544+0.189344im       -0.104665+0.0437152im     0.141139+0.16293im       0.102907-0.145416im       0.123613+0.0910454im      0.08925-0.128828im      0.0142538+0.0930681im    -0.0791225+0.00194167im
   -0.106807+0.101467im      -0.133981+0.112542im     0.0993559+0.185978im      -0.156032+0.0284512im    0.0718464-0.0890046im     0.323399+0.142809im      0.108895+0.109317im     0.0634663+0.105833im       -0.0992396-0.15037im       0.132627-0.337833im    -0.0855119-0.176117im    -0.00211515+0.0670281im     -0.242405-0.0423393im     0.0356539+0.0590968im   -0.0973405-0.00886872im  -0.00881135-0.223863im       -0.227106+0.0353196im       -0.11345+0.0353804im   -0.0753443+0.126704im       0.186617-0.0502654im    -0.00761527-0.0185596im   0.00598681+0.107653im       0.089602-0.159779im      0.0700592-0.0724702im   -0.0203779+0.115142im       0.0730907-0.100386im     0.0443535-0.0421979im   -0.0050536+0.262494im     -0.0147627+0.135897im     0.0949201-0.0882097im   0.000707635+0.152924im       0.154426-0.0513651im
   0.0739542+0.124713im      0.0164241+0.151286im     -0.023126+0.0960256im     0.0592889+0.0115545im   -0.0634702+0.05415im     -0.0927498+0.315077im     0.0209624-0.0828037im     0.146598-0.0753125im         0.12634-0.149436im     -0.146679-0.0615231im    0.0693615-0.107178im       0.140119+0.126507im      -0.067513-0.0496887im   -0.00662465-0.176366im     0.0556904-0.169116im      -0.257064+0.0971257im       -0.23003-0.0959973im       0.192439-0.0577976im    0.0600036+0.0579781im     -0.225557+0.136524im        0.177434+0.113337im      0.200837-0.21063im        0.138929+0.028009im         0.1184+0.0239972im    0.0930579-0.141218im      -0.0558659-0.0533147im    0.0513686-0.101234im     -0.166108-0.014738im    -0.00163962-0.121123im     0.0152958-0.165584im       0.215408-0.0392829im   -5.07088e-5-0.154853im
   -0.174629-0.0872882im    -0.0516214+0.00971681im   -0.124872+0.130734im     -0.0386799-0.145999im      -0.11893-0.115287im     0.0424595-0.0111941im     0.107692-0.179377im    0.00915873-0.124759im        0.0629321-0.161908im    -0.0301242-0.0607484im     0.341503-0.0908115im    -0.0360358-0.226424im       0.124078+0.14696im       -0.140976+0.0543193im   -0.0305181+0.0771748im     -0.106528-0.0264267im      0.0975116-0.158636im       0.0653186-0.130679im      0.206125-0.0666325im      0.117273-0.145776im      -0.0391018+0.0345308im   -0.0587035+0.323086im       0.107976-0.0121812im    -0.0495785-0.158815im     0.0411795+0.0777764im      -0.143437+0.124699im     -0.184517-0.0799589im   -0.0932439+0.0367033im     -0.067742-0.0124861im    -0.136386+0.0778947im      0.108657-0.0141263im    -0.0352777-0.314454im
  -0.0259652-0.152725im       0.152139-0.221552im    -0.0796251+0.00828899im    0.0930077+0.0409594im    -0.245043+0.0115672im    0.0658352+0.064023im    0.00265879+0.11184im       0.162355-0.146103im       -0.0840147-0.00321467im    0.103464+0.109179im     -0.107113+0.152259im       0.218196+0.163468im       0.272822-0.165739im      0.0369718+0.141735im    0.00910809+0.289203im      0.0631359+0.0441112im       -0.25084+0.0808291im     -0.0693443-0.00605376im   0.0542461+0.12125im       -0.308931-0.22733im       -0.0482265+0.0614774im    -0.116125+0.076325im      0.0779405+0.0307429im   -0.00440678-0.171279im    0.00503643-0.000816849im    -0.026261-0.0779793im     0.027403-0.0305232im    -0.120651+0.204529im      0.0162086+0.0625482im     0.158481+0.0522627im     0.0578813-0.00597668im    0.0424275-0.0598232im
   -0.059441+0.027138im       0.059147-0.117736im      0.111623+0.160103im      -0.163617-0.102051im   -0.00656394-0.00158223im   -0.283301+0.245894im       0.13146-0.0927675im   -0.0926594-0.0850954im       -0.291119-0.0546999im   -0.0554269+0.0256943im     0.115652+0.145349im      -0.061444+0.0591716im      0.141765-0.0308922im      0.129328-0.146807im     -0.118723+0.0503976im     -0.187956+0.0159881im      0.0410033+0.169488im      -0.0304558-0.0607529im   -0.0946208+0.122347im       0.178222+0.115589im        -0.22936-0.0589684im   0.00707416+0.0968075im    0.00953161+0.0855558im      0.143934+0.0834993im    0.0210992+0.0504281im      -0.030648-0.29091im      0.0659288+0.0114193im     0.138298-0.084407im     -0.0976515+0.267856im     0.0474492+0.013749im         0.1092-0.198801im      -0.118824+0.0505937im
    0.141589-0.0569352im     -0.158032+0.00245249im   0.0655252-0.0429967im      0.134521-0.179101im      0.119797-0.147983im      0.128962+0.128558im     -0.162092-0.0347767im    0.0788265-0.122373im        -0.107287-0.0665855im     0.227067+0.0318483im     0.124504-0.0623896im      0.010313+0.103242im       0.264182-0.069455im     -0.0293039+0.0493483im     0.203622-0.0187398im     -0.168212-0.0631744im     -0.0286195-0.0304578im     -0.0839208-0.0141029im   -0.0215532+0.0898803im    -0.0129438-0.114171im         0.05827-0.149872im      0.143193-0.00399239im    -0.122908-0.0106369im     0.0292274-0.0601393im    -0.137736-0.196467im       0.0173796-0.0025292im    0.0599422-0.162473im      0.411067-0.106801im      -0.115794-0.087783im     -0.258195+0.0129898im     0.0251567+0.253739im     0.00420973+0.0928123im
   0.0242338+0.0878491im     -0.160616-0.103186im       0.17296-0.0652183im     0.0823064-0.0762352im    0.0114394+0.0370745im   -0.0328185-0.131022im     0.0830014-0.204916im    -0.0985727-0.0618053im      -0.0223045+0.0404284im   -0.0918365-0.0771257im    0.0512866+0.0236233im     0.0436795-0.0589996im    -0.0540815-0.0167531im     -0.144869-0.030965im     -0.045205+0.213528im     -0.0917367-0.135968im       -0.147908-0.0196566im     -0.0149406-0.164673im     0.0271754+0.0855677im    -0.0435309+0.0793438im      -0.212225-0.126554im    -0.0436454-0.192754im       0.190743+0.11371im        0.266962-0.157769im     -0.196517-0.118022im        0.278444+0.217185im     0.0286018+0.295476im   -0.00195107-0.0997231im      0.211331-0.0406639im     0.134094+0.0875719im    -0.0382658+0.161912im     -0.0175613-0.121783im
    0.127742-0.0236014im    -0.0343932-0.060824im     0.0469523-0.0861221im      -0.24233-0.0232813im    -0.225375-0.172179im    -0.0583325+0.0295777im   -0.0450865+0.0137907im    0.0768512-0.0387665im        0.198122+0.0645316im    -0.082425-0.100471im      0.130585+0.0731911im     -0.254984-0.330258im       0.141073-0.19912im       0.0637323-0.13801im      -0.182059+0.00562877im     0.197129+0.0520808im      -0.147252+0.00882678im     -0.170056+0.145523im     -0.032912+0.13318im     -0.00632161-0.00531662im     0.0335992-0.209678im    -0.0273038-0.0109257im    -0.0927955-0.16635im       0.0363831-0.00556657im    0.140148-0.200668im        0.113503-0.0644556im    -0.152993-0.105219im    -0.0635132-0.0288003im      0.120453-0.088978im     0.0241598-0.268017im      0.0247888+0.0835958im     -0.085548+0.0200411im
  -0.0030829+0.0186962im    -0.0937966-0.100595im     0.0987073-0.102387im       0.108411-0.131406im     0.0361522+0.127254im      -0.31581-0.0215656im    -0.170948-0.0130998im    0.0301169-0.15046im         -0.131531+0.0372796im     0.116882-0.198987im      -0.13222-0.00311449im    -0.230934-0.00861425im    -0.145406-0.0118433im     -0.222695+0.0829123im    -0.217432-0.194154im     -0.0291884+0.0853232im      0.0203795-0.111297im       0.0519995-0.0164699im   -0.0468884-0.099532im      -0.208213-0.190757im       -0.138944-0.0727549im   -0.0721883-0.0776342im     0.0699698-0.0732266im     0.0653007-0.0678098im   -0.0918099+0.156381im       -0.372745-0.0876433im     -0.07354-0.0772335im     0.120425+0.145161im     -0.0171393-0.0711242im     0.114532-0.168156im     -0.0786478+0.0365749im     0.0289641-0.0547299im
    0.059389+0.092662im      -0.210425-0.0622329im   -0.0239663+0.213374im      -0.130221+0.142709im     -0.133953-0.0519552im      -0.0372+0.00837358im   -0.129539-0.110247im     0.0180597+0.167069im        -0.103126+0.0673202im    0.0963885-0.0392716im   -0.0222087+0.310456im      0.0231845+0.0427855im     -0.202728+0.0166135im     -0.208146+0.079695im    -0.0392997+0.00817773im     0.152514+0.0486725im       0.122056+0.173127im       -0.118992-0.153109im    -0.0404418-0.15885im       -0.104069-0.087078im        0.271296+0.105065im     0.0334595-0.0331125im      0.023965+0.217767im      0.0527521-0.0299834im    0.0486563-0.0850812im      0.0875807-0.2028im       -0.101755+0.0331002im    -0.062175-0.0987914im     -0.165144+0.0890443im    -0.173276+0.0305776im     0.0910962+0.247575im      -0.146035-0.163267im
   -0.160978+0.105193im     -0.0160669-0.0592961im    -0.212317+0.104536im      -0.198145+0.0789443im     0.105642+0.00386326im   -0.113125-0.11145im      -0.210298-0.0627698im   0.00757505+0.230718im        0.0732169+0.00296156im   0.0280476+0.266769im     -0.213611-0.109105im      0.0753646+0.0357691im      0.119249-0.0893517im    -0.0759727-0.00742502im  -0.0422368-0.0495008im     0.0468908-0.177401im      -0.0909935+0.12057im         0.171154+0.161765im    -0.0310703+0.176369im      0.0756252+0.0755942im      0.0478891-0.161402im    -0.0768568+0.0243214im      0.219932-0.078592im    -0.00525857-0.0437269im   -0.0990925-0.0299524im      -0.260158+0.130636im     0.0318337-0.108232im      0.146225-0.107346im       0.207241+0.106023im    -0.0197185-0.00327705im     0.189857+0.0806537im     -0.173261-0.175447im
   0.0381053+0.0429664im     0.0023058+0.159501im    -0.0337957-0.0874927im     -0.163168-0.0989355im    -0.100808+0.0515278im    -0.180377-0.0213218im    0.0556174-0.0219083im  0.000659755+0.0934693im      -0.0550493+0.190376im     0.0290046-0.166367im    -0.0087265-0.0584355im       0.15075+0.176537im       0.108917-0.115592im      -0.164104-0.102272im    -0.0035757+0.196149im     -0.0122855-0.201427im      0.00791571-0.0673284im      -0.141706-0.0491293im     0.393047+0.0902656im   -0.00772009+0.0303525im       0.234192-0.23323im     -0.0794503-0.0965251im     0.0358577-0.116896im     0.00976743+0.258099im     0.0638465+0.202069im      -0.0215403-0.0630898im    0.0635717+0.0227511im    0.0143095+0.0832805im     -0.142687-0.149991im     -0.123357+0.11195im       -0.227189-0.117715im     -0.0673828-0.0449537im
   0.0362114-0.291946im      -0.292236-0.0200093im    0.0655418+0.070902im     -0.0335256+0.0370946im    0.0574318+0.169163im     -0.115733-0.0300582im      0.19721+0.0632146im    -0.133672+0.0135946im        0.125956+0.154354im     -0.051017+0.144236im      0.167918+0.0576043im      0.150421+0.174265im     -0.0672892+0.0355471im     0.0689604+0.0882485im   -0.0969168-0.212412im      0.0548359+0.0846253im      -0.302719+0.103186im       0.0396242-0.111379im     0.0659925-0.100976im       0.227838-0.395558im       0.0336782-0.1982im        0.107479-0.0275608im    -0.0257432-0.104813im      -0.138312+0.0210227im    0.0251478-0.073207im        0.010488+0.0365323im     0.104515+0.0653951im    0.0396383-0.0543128im    -0.0059869-0.0189709im    0.0607214-0.0678514im     0.0650144-0.0939286im     0.0310804-0.0711258im
    0.376633-0.10995im      -0.0997979-0.0789939im    0.0553849+0.185929im      -0.217381+0.0212183im    0.0868451-0.0820791im    -0.063406-0.129564im      0.256158+0.138745im      0.048804+0.0721606im      -0.0187575-0.0781799im    -0.112935+0.0546321im    -0.017311-0.182052im      0.0747685-0.103443im       0.164573-0.165327im     -0.0135164+0.0508132im    -0.140214+0.0414944im    -0.0148498-0.196224im       0.0259122-0.116743im       0.0364928-0.119679im    -0.0584491-0.330109im      -0.183254+0.0966382im      0.0366171+0.181151im    -0.0109271-0.0385092im    -0.0839526+0.00591946im    0.0404294-0.151956im     -0.126885+0.0996786im     -0.0983234-0.132622im      0.128438-0.035288im     0.0341501-0.00999829im     0.228395+0.0345302im    -0.186787-0.0269392im    -0.0331935-0.0671876im     0.0677779+0.058633im
   -0.139855-0.0500423im    -0.0290087+0.0731698im    0.0704857+0.0423258im     -0.281967+0.0323785im     0.217587-0.167266im      0.160389-0.0419984im     0.160477-0.100229im     0.0232141-0.0809278im        0.126507+0.0195207im     0.311913-0.00242123im  -0.0259379+0.14128im      -0.0939735+0.108931im      0.0531919+0.123405im     -0.0253815-0.0640177im    0.0783573+0.0908683im    -0.0280589+0.057324im      -0.0825018-0.208725im        0.182697+0.130765im      0.082416-0.142953im     -0.0714714+0.00519122im     0.0329668+0.0849763im    -0.244262-0.216166im      0.0464653-0.0215499im    -0.0258117-0.0769287im    0.0987879-0.140466im      -0.0353725-0.190098im     -0.156819+0.210956im      0.202972-0.00266681im   -0.0345565-0.104165im      0.181644+0.0152591im     0.0966149-0.145129im      -0.150144+0.0996932im
   -0.203533+0.254008im       0.130334-0.0907493im     0.182719+0.0266707im     -0.101279-0.0490127im    -0.118278-0.157546im    -0.0488281-0.0432742im   0.00955005+0.0514169im  -0.00815837-0.0670023im       0.0151836+0.051491im    -0.0451823+0.248479im       0.17497+0.145792im     -0.0471445-0.117293im      -0.196947+0.0637598im   -0.00888221+0.0749737im   -0.0614075+0.159111im      0.0298546-0.161542im       -0.177116-0.119929im       0.0853191+0.00861248im    0.115037-0.0409047im    0.00225275+0.0308493im     -0.0383015+0.0149649im     0.189832-0.311624im     -0.0258413-0.052764im      -0.264894-0.101925im     -0.125502+0.0116687im      -0.103838+0.0259623im     0.209701-0.248203im    -0.0448312-0.0179305im      -0.23519+0.11193im     -0.0189742+0.0449568im    -0.0779091+0.104311im      0.0807317+0.125749im
   -0.103623+0.0416235im     -0.107841+0.0111585im    0.0123632+0.0502088im      0.112976+0.0469381im     0.066318-0.0475364im    -0.135597+0.121822im     0.0195991+0.0612774im    0.0344376+0.199084im        0.0285204+0.0344635im   -0.0198008-0.00106432im   -0.159632-0.136521im      0.0139595-0.0235276im      0.118279+0.221527im      0.0597918-0.0242937im    0.0928802+0.207988im       0.146457+0.177919im       -0.057373-0.0159465im     -0.0187117-0.211759im      0.221254-0.0445396im     0.0174834+0.238852im       0.0263604-0.236969im      0.213917+0.0997273im     -0.236079+0.0328654im    -0.0709675-0.155224im     -0.193187-0.01224im        -0.119198-0.24168im      -0.275846+0.0281373im   -0.0123912-0.0739479im     0.0559511-0.0233138im     0.231004-0.036802im      0.0120689+0.088022im       0.197337-0.0213724im
    0.106147+0.226622im     -0.0470027-0.0119226im    0.0239598-0.007681im      0.0221003+0.290546im     0.0607642+0.116323im      0.147344-0.00652785im   0.0701087+0.0156814im    -0.294015-0.151831im        0.0467117-0.0165447im   -0.0176473+0.0849069im   -0.0643026+0.00465333im     0.203781+0.00538288im    0.0684085-0.0129283im     -0.226956-0.108111im     -0.199682-0.0300652im     0.0553251-0.0609278im      0.0216035-0.297829im       -0.195984-0.0361303im   -0.0733195+0.0529828im    -0.0385396+0.0379567im       -0.19042-0.0838667im   -0.0188619+0.189567im      0.0338123+0.188564im       -0.21414+0.107511im     0.0475979+0.0313937im      0.0773398-0.110148im   0.000897886-0.244197im     0.0932335-0.0211597im     -0.093048-0.229522im      0.137384-0.0294124im      0.192519+0.0240952im    -0.0448924-0.00066064im
  -0.0457261-0.158501im       0.193404+0.119087im    -0.0216251+0.0771485im     0.0323686+0.1349im       -0.162756-0.0421284im     0.182094-0.0494347im   -0.0797841+0.212839im     -0.151963+0.174881im        0.0961115+0.131216im     0.0893397-0.058834im        0.1383+0.140277im      -0.237364+0.0718921im     0.0215105-0.0161092im      0.040539+0.0341842im    0.0749487+0.0456426im     0.0292347+0.0862992im   -0.000895889-0.0433278im      0.0578521-0.276328im    -0.0597619-0.0849166im   -0.00753992+0.123854im       -0.199318+0.00951706im    0.113133-0.0819971im     0.0411652-0.081713im       0.219521+0.152867im    -0.0944653-0.00013398im    -0.0202305-0.0741031im      0.17984-0.20714im       0.212898+0.0740517im        0.1257-0.121095im     0.0347076+0.0478797im    -0.0471317-0.0537861im    -0.0930316-0.364598im
     0.10802+0.12999im        0.090656-0.10455im      -0.152539-0.21225im       0.0519335-0.134196im   -0.00677476-0.0837812im    0.0427774+0.124021im      0.122059+0.0395691im     0.179668+0.19555im          -0.26756-0.025921im    -0.0764206-0.00361195im    0.157153-0.135626im       0.155796-0.00340339im    -0.258401-0.195309im       0.134819+0.0293258im   -0.0559365+0.214875im      0.0625462+0.114558im       0.0983084-0.102808im        0.224356+0.00444254im   -0.203077-0.13494im        0.068726-0.116786im      -0.0399351-0.131599im    -0.0842019+0.0157513im       0.10882-0.0634556im     -0.253103+0.126807im    -0.0600239-0.150731im     -0.00264874-0.134327im    -0.0509148+0.0918282im    0.0894431-0.0639033im     0.0131742-0.158512im     0.0674418+0.0197682im    -0.0013663+0.0588593im     -0.141859-0.155727im
  -0.0112185-0.137645im      0.0615354+0.119554im      0.187292-0.174734im      -0.174264-0.040596im     0.0877691-0.0464634im    0.0107367+0.0186509im    -0.113769+0.168005im      0.017769+0.0187221im       -0.263095+0.00896346im  -0.0840671+0.15007im      0.0765718+0.0380087im    -0.0151843+0.00139606im   -0.0620715+0.00331752im   0.00710552-0.0367074im    0.0226533-0.0175274im    -0.0614928-0.252508im       0.0101704+0.00386468im    -0.0259351+0.0251432im     0.122431-0.122137im     -0.0156948-0.0506663im       0.240795+0.0925726im   -0.0675464+0.211101im      -0.147698+0.231929im       0.183322+0.0876786im    -0.232252-0.126486im      -0.0190286+0.220746im    -0.0517135-0.112124im    -0.0709424+0.00269669im   -0.0813285-0.0558762im     0.387017-0.205909im      0.0646029-0.0461196im     -0.102788-0.09049im
 -0.00260974+0.153305im      -0.274698-0.145759im     -0.178044-0.249815im     -0.0335588+0.0767514im    -0.181042-0.104953im     0.0234837+0.0912465im    0.0472298-0.0306826im     0.169575+0.228165im        0.0514749-0.0161193im   -0.0172397+0.0215928im    0.0530265+0.0316704im     0.0247629-0.130226im    -0.00303757+0.031373im      -0.113006+0.0043542im     -0.08417-0.155516im     -0.0100787+0.0295138im     -0.0230773+0.0151858im     -0.0799392+0.0917126im    -0.072819+0.0485895im    -0.0472323+0.0551153im      0.0189331+0.0549675im    0.0867349-0.0315306im     -0.220872+0.0111281im      0.135868-0.129335im    -0.0634944+0.0360191im     0.00850106+0.127486im      0.118449+0.083939im      0.258287+0.189011im      -0.176901-0.0404822im     0.122815+0.278461im       0.124766-0.382348im       0.101318-0.0607106im
  -0.0652269+0.204389im     -0.0603712+0.174533im     0.0523471-0.166382im      -0.130373+0.0551035im   -0.0152392+0.0404417im    -0.109506-0.0407403im    0.0729057+0.265568im     0.0657244-0.0988103im       -0.143395-0.0594828im     0.120936+0.23311im      0.0149877+0.026387im      0.0963194-0.121077im     -0.0833482+0.0960726im     0.0541384+0.171256im      0.135022-0.250599im     -0.0225191+0.0190334im      -0.206965-0.111269im       -0.125284-0.0172644im    0.0378615+0.186115im     -0.0429658+0.0511049im      -0.149231+0.0605676im   -0.0844765+0.131546im     -0.0387866+0.0557701im     0.0672375-0.0203459im     0.073526-0.179302im       -0.067323-0.191714im    -0.0817796+0.135071im    -0.0562821-0.0644196im      0.147053-0.0193362im    -0.249644+0.0706623im     -0.306057-0.0327454im    -0.0480889-0.21581im</code></pre><p>and then generate the state <span>$ψ$</span></p><pre><code class="language-julia hljs">psi = P[:, 3]</code></pre><pre><code class="nohighlight hljs">32-element Vector{ComplexF64}:
   0.08860649953451101 + 0.06041024260212888im
   0.17050298496203434 + 0.04801204128672038im
   0.10497618248334847 + 0.06848475911992043im
   0.09158135401047501 - 0.17118205141459666im
 -0.007631519456551962 + 0.1994241581779867im
   0.01759234319500303 - 0.008736364165419246im
   -0.0997451389789235 + 0.1077104105579024im
   0.14287222469123145 + 0.1443957660562035im
    0.4647926168940588 + 0.0im
   0.10297614825077131 - 0.13527247997885045im
   0.11025418204617471 - 0.03157637471375397im
   0.12625727804506923 + 0.10699837030677277im
  -0.02413914110395144 + 0.22857827027520441im
  -0.11086440188054059 - 0.28892805473802763im
 -0.024407940226444113 + 0.005688478426639625im
  0.014916374736153846 + 0.007911499298825482im
   0.05068428461274314 + 0.14730136076364858im
  -0.00890606284598841 - 0.06683048461766151im
 -0.002672170840053475 - 0.15337205739177662im
   -0.1773257907914755 - 0.028957980948769422im
  -0.13543752850754828 - 0.2208454646406967im
  -0.11502164902996762 - 0.14295638345690573im
   -0.0862931813841862 + 0.04492878131812721im
   -0.1001603632974316 + 0.016340797808322424im
 -0.055665230256797496 + 0.06874263238058007im
   0.13810802654843274 - 0.1219500522142676im
   -0.1280464303457423 + 0.1295871724965822im
    0.0346459189314459 + 0.03125326114810278im
    0.1113090183932821 - 0.08978616684552332im
   0.09157678571714722 - 0.029678080883656758im
  -0.09945745987621862 + 0.08884223899477786im
   0.16782538679053094 + 0.08790453557372287im</code></pre><p>In the phase estimation process, we will feed the state to circuit and measure the first <code>n</code> qubits processed by iQFT.</p><pre><code class="language-julia hljs">r = join(ArrayReg(psi), zero_state(N))
r |&gt; PE(N, M, U)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 8/8
    nlevel: 2</code></pre><p>Since our phase can be represented by 3 qubits precisely, we only need to measure once</p><pre><code class="language-julia hljs">results = measure(r, 1:N; nshots=1)</code></pre><pre><code class="nohighlight hljs">1-element Vector{BitBasis.BitStr64{3}}:
 011 ₍₂₎</code></pre><p>Recall that our QFT&#39;s bit numbering is reversed, let&#39;s reverse it back</p><pre><code class="language-julia hljs">using BitBasis
estimated_phase = bfloat(results[]; nbits=N)</code></pre><pre><code class="nohighlight hljs">0.75</code></pre><p>the phase is exactly <code>0.75</code>!</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../1.prepare-ghz-state/index.html">« Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a><a class="docs-footer-nextpage" href="../3.grover-search/index.html">Grover Search »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.16 on <span class="colophon-date" title="Saturday 30 April 2022 03:23">Saturday 30 April 2022</span>. Using Julia version 1.7.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
