<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quantum Fourier Transformation and Phase Estimation · Documentation | Yao</title><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.044/juliamono.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/indigo.css" rel="stylesheet" type="text/css"/><link href="https://yaoquantum.org/assets/favicon-light.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../index.html"><img src="../../../assets/logo.png" alt="Documentation | Yao logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../index.html">Documentation | Yao</a></span></div><form class="docs-search" action="../../../search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../index.html">Home</a></li><li><a class="tocitem" href="../../../quick-start.html">Quick Start</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../../man/registers.html">Quantum Registers</a></li><li><a class="tocitem" href="../../../man/blocks.html">Blocks</a></li><li><a class="tocitem" href="../../../man/symbolic.html">Symbolic Computation</a></li><li><a class="tocitem" href="../../../man/automatic_differentiation.html">Automatic Differentiation</a></li><li><a class="tocitem" href="../../../man/simplification.html">Simplification</a></li><li><a class="tocitem" href="../../../man/bitbasis.html">BitBasis</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../1.prepare-ghz-state/index.html">Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a></li><li class="is-active"><a class="tocitem" href="index.html">Quantum Fourier Transformation and Phase Estimation</a><ul class="internal"><li><a class="tocitem" href="#Quantum-Fourier-Transformation"><span>Quantum Fourier Transformation</span></a></li><li><a class="tocitem" href="#Wrap-QFT-to-an-external-block"><span>Wrap QFT to an external block</span></a></li><li><a class="tocitem" href="#Phase-Estimation"><span>Phase Estimation</span></a></li></ul></li><li><a class="tocitem" href="../3.grover-search/index.html">Grover Search</a></li><li><a class="tocitem" href="../4.shor-algorithm/index.html">Shor&#39;s Algorithm</a></li><li><a class="tocitem" href="../5.shor-9-code/index.html">Shor&#39;s 9 qubit code</a></li><li><a class="tocitem" href="../6.quantum-circuit-born-machine/index.html">Quantum Circuit Born Machine</a></li><li><a class="tocitem" href="../7.variation-quantum-eigen-solver/index.html">Variational Quantum Eigen Solver</a></li></ul></li><li><a class="tocitem" href="../../../performancetips.html">Performance Tips</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/QuantumBFS/Yao.jl/blob/master/docs/src/examples/2.qft-phase-estimation/main.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><p><a href="https://mybinder.org/v2/gh/QuantumBFS/Yao.jl/gh-pages?filepath=dev/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a> <a href="https://nbviewer.jupyter.org/github/QuantumBFS/Yao.jl/blob/gh-pages/dev/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://img.shields.io/badge/show-nbviewer-579ACA.svg" alt/></a> <a href="https://minhaskamal.github.io/DownGit/#/home?url=https://github.com/QuantumBFS/tutorials/tree/gh-pages/dev/generated/examples/2.qft-phase-estimation"><img src="https://img.shields.io/badge/download-project-orange" alt/></a></p><h1 id="example-qft"><a class="docs-heading-anchor" href="#example-qft">Quantum Fourier Transformation and Phase Estimation</a><a id="example-qft-1"></a><a class="docs-heading-anchor-permalink" href="#example-qft" title="Permalink"></a></h1><p>Let&#39;s use Yao first</p><pre><code class="language-julia hljs">using Yao</code></pre><h2 id="Quantum-Fourier-Transformation"><a class="docs-heading-anchor" href="#Quantum-Fourier-Transformation">Quantum Fourier Transformation</a><a id="Quantum-Fourier-Transformation-1"></a><a class="docs-heading-anchor-permalink" href="#Quantum-Fourier-Transformation" title="Permalink"></a></h2><p>The Quantum Fourier Transformation (QFT) circuit is to repeat two kinds of blocks repeatly:</p><p><img src="assets/qft.png" alt="qft-circuit"/></p><p>The basic building block control phase shift gate is defined as</p><p class="math-container">\[R(k)=\begin{bmatrix}
1 &amp; 0\\
0 &amp; \exp\left(\frac{2\pi i}{2^k}\right)
\end{bmatrix}\]</p><p>Let&#39;s define block <code>A</code> and block <code>B</code>, block <code>A</code> is actually a control block.</p><pre><code class="language-julia hljs">A(i, j) = control(i, j=&gt;shift(2π/(1&lt;&lt;(i-j+1))))</code></pre><pre><code class="nohighlight hljs">A (generic function with 1 method)</code></pre><p>Once you construct the blockl you can inspect its matrix using <code>mat</code> function. Let&#39;s construct the circuit in dash box A, and see the matrix of <span>$R_4$</span> gate.</p><pre><code class="language-julia hljs">R4 = A(4, 1)</code></pre><pre><code class="nohighlight hljs">(n -&gt; control(n, 4, 1 =&gt; shift(0.39269908169872414)))</code></pre><p>If you have read about <a href="generated/examples/2.qft-phase-estimation/@ref example-ghz">preparing GHZ state</a>, you probably know that in Yao, we could just leave the number of qubits, and it will be evaluated when possible.</p><pre><code class="language-julia hljs">R4(5)</code></pre><pre><code class="nohighlight hljs">nqubits: 5
control(4)
└─ (1,) shift(0.39269908169872414)</code></pre><p>its matrix will be</p><pre><code class="language-julia hljs">mat(R4(5))</code></pre><pre><code class="nohighlight hljs">32×32 Diagonal{ComplexF64, Vector{ComplexF64}}:
 1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im</code></pre><p>Then we repeat this control block over and over on different qubits, and put a Hadamard gate to <code>i</code>th qubit to construct <code>i</code>-th <code>B</code> block.</p><pre><code class="language-julia hljs">B(n, k) = chain(n, j==k ? put(k=&gt;H) : A(j, k) for j in k:n)</code></pre><pre><code class="nohighlight hljs">B (generic function with 1 method)</code></pre><p>We need to input the total number of qubits <code>n</code> here because we have to iterate through from <code>k</code>-th location to the last.</p><p>Now, let&#39;s construct the circuit by chaining all the <code>B</code> blocks together</p><pre><code class="language-julia hljs">qft(n) = chain(B(n, k) for k in 1:n)
qft(4)</code></pre><pre><code class="nohighlight hljs">nqubits: 4
chain
├─ chain
│  ├─ put on (1)
│  │  └─ H
│  ├─ control(2)
│  │  └─ (1,) shift(1.5707963267948966)
│  ├─ control(3)
│  │  └─ (1,) shift(0.7853981633974483)
│  └─ control(4)
│     └─ (1,) shift(0.39269908169872414)
├─ chain
│  ├─ put on (2)
│  │  └─ H
│  ├─ control(3)
│  │  └─ (2,) shift(1.5707963267948966)
│  └─ control(4)
│     └─ (2,) shift(0.7853981633974483)
├─ chain
│  ├─ put on (3)
│  │  └─ H
│  └─ control(4)
│     └─ (3,) shift(1.5707963267948966)
└─ chain
   └─ put on (4)
      └─ H
</code></pre><h2 id="Wrap-QFT-to-an-external-block"><a class="docs-heading-anchor" href="#Wrap-QFT-to-an-external-block">Wrap QFT to an external block</a><a id="Wrap-QFT-to-an-external-block-1"></a><a class="docs-heading-anchor-permalink" href="#Wrap-QFT-to-an-external-block" title="Permalink"></a></h2><p>In most cases, <code>function</code>s are enough to wrap quantum circuits, like <code>A</code> and <code>B</code> we defined above, but sometimes, we need to dispatch specialized methods on certain kinds of quantum circuit, or we want to define an external block to export, thus, it&#39;s useful to be able to wrap circuit to custom blocks.</p><p>First, we define a new type as subtype of <code>PrimitiveBlock</code> since we are not going to use the subblocks of <code>QFT</code>, if you need to use its subblocks, it&#39;d be better to define it under <code>CompositeBlock</code>.</p><pre><code class="language-julia hljs">struct QFT &lt;: PrimitiveBlock{2}
    n::Int
end

YaoBlocks.nqudits(q::QFT) = q.n</code></pre><p>Now, let&#39;s define its circuit</p><pre><code class="language-julia hljs">circuit(q::QFT) = qft(q.n)</code></pre><pre><code class="nohighlight hljs">circuit (generic function with 1 method)</code></pre><p>And forward <code>mat</code> to its circuit&#39;s matrix</p><pre><code class="language-julia hljs">YaoBlocks.mat(::Type{T}, x::QFT) where T = mat(T, circuit(x))</code></pre><p>You may notice, it is a little ugly to print <code>QFT</code> at the moment, this is because we print the type summary by default, you can define your own printing by overloading <code>print_block</code></p><pre><code class="language-julia hljs">YaoBlocks.print_block(io::IO, x::QFT) = print(io, &quot;QFT($(x.n))&quot;)</code></pre><p>Since it is possible to use FFT to simulate the results of QFT (like cheating), we could define our custom <code>apply!</code> method:</p><pre><code class="language-julia hljs">using FFTW, LinearAlgebra

function YaoBlocks.apply!(r::ArrayReg, x::QFT)
    α = sqrt(length(statevec(r)))
    invorder!(r)
    lmul!(α, ifft!(statevec(r)))
    return r
end</code></pre><p>Now let&#39;s check if our <code>apply!</code> method is correct:</p><pre><code class="language-julia hljs">r = rand_state(5)
r1 = r |&gt; copy |&gt; QFT(5)
r2 = r |&gt; copy |&gt; circuit(QFT(5))
r1 ≈ r2</code></pre><pre><code class="nohighlight hljs">true</code></pre><p>We can get iQFT (inverse QFT) directly by calling <code>adjoint</code></p><pre><code class="language-julia hljs">QFT(5)&#39;</code></pre><pre><code class="nohighlight hljs"> [†]QFT(5)</code></pre><p>QFT and iQFT are different from FFT and IFFT in three ways,</p><ol><li>they are different by a factor of <span>$\sqrt{2^n}$</span> with <span>$n$</span> the number of qubits.</li><li>the <a href="https://quantumbfs.github.io/BitBasis.jl/stable/tutorial/#Conventions-1">bit numbering</a> will exchange after applying QFT or iQFT.</li><li>due to the convention, QFT is more related to IFFT rather than FFT.</li></ol><h2 id="Phase-Estimation"><a class="docs-heading-anchor" href="#Phase-Estimation">Phase Estimation</a><a id="Phase-Estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Phase-Estimation" title="Permalink"></a></h2><p>Since we have QFT and iQFT blocks we can then use them to realize phase estimation circuit, what we want to realize is the following circuit:</p><p><img src="assets/phaseest.png" alt="phase estimation"/></p><p>First we call Hadamard gates repeatly on first <code>n</code> qubits.</p><pre><code class="language-julia hljs">Hadamards(n) = repeat(H, 1:n)</code></pre><pre><code class="nohighlight hljs">Hadamards (generic function with 1 method)</code></pre><p>Then in dashed box <code>B</code>, we have controlled unitaries:</p><pre><code class="language-julia hljs">ControlU(n, m, U) = chain(n+m, control(k, n+1:n+m=&gt;matblock(U^(2^(k-1)))) for k in 1:n)</code></pre><pre><code class="nohighlight hljs">ControlU (generic function with 1 method)</code></pre><p>each of them is a <code>U</code> of power <span>$2^{(k-1)}$</span>.</p><p>Since we will only apply the qft and Hadamard on first <code>n</code> qubits, we could use <code>Subroutine</code>, which creates a context of a sub-scope of the qubits.</p><pre><code class="language-julia hljs">PE(n, m, U) =
    chain(n+m, # total number of the qubits
        subroutine(Hadamards(n), 1:n), # apply H in local scope
        ControlU(n, m, U),
        subroutine(QFT(n)&#39;, 1:n))</code></pre><pre><code class="nohighlight hljs">PE (generic function with 1 method)</code></pre><p>we use the first <code>n</code> qubits as the output space to store phase <span>$ϕ$</span>, and the other <code>m</code> qubits as the input state which corresponds to an eigenvector of oracle matrix <code>U</code>.</p><p>The subroutine here uses <code>focus!</code> and <code>relax!</code> to manage a local scope of quantum circuit, and only activate the first <code>n</code> qubits while applying the block inside the subroutine context, and the scope will be <code>relax!</code>ed back, after the context. This is equivalent to manually <code>focus!</code> then <code>relax!</code></p><p>fullly activated</p><pre><code class="language-julia hljs">r = rand_state(5)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>first 3 qubits activated</p><pre><code class="language-julia hljs">focus!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 3/5
    nlevel: 2</code></pre><p>relax back to the original</p><pre><code class="language-julia hljs">relax!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>In this way, we will be able to apply small operator directly on the subset of the qubits.</p><p>Details about the algorithm can be found here: <a href="https://en.wikipedia.org/wiki/Quantum_phase_estimation_algorithm">Quantum Phase Estimation Algorithm</a></p><p>Now let&#39;s check the results of our phase estimation.</p><p>First we need to set up a unitary with known phase, we set the phase to be 0.75, which is <code>0.75 * 2^3 == 6 == 0b110</code> .</p><pre><code class="language-julia hljs">N, M = 3, 5
P = eigen(rand_unitary(1&lt;&lt;M)).vectors
θ = Int(0b110) / 1&lt;&lt;N
phases = rand(1&lt;&lt;M)
phases[0b010+1] = θ
U = P * Diagonal(exp.(2π * im * phases)) * P&#39;</code></pre><pre><code class="nohighlight hljs">32×32 Matrix{ComplexF64}:
   0.206766+0.0736358im  -0.0856621+0.0623003im    -0.0890293+0.120779im       0.13398-0.0311135im       0.161869+0.0356623im     -0.102457+0.0648799im    -0.0890029-0.0458741im     0.166454-0.15823im      -0.0802183+0.151733im       -0.146341+0.126154im    0.000592502+0.201965im      0.100873-0.127727im      -0.109479+0.0934763im    -0.0153248-0.0299059im    -0.0220494-0.0885129im    0.0329123-0.14426im       0.155124+0.0514711im     0.0625956+0.0381667im     0.205974-0.10145im     0.0715865-0.138825im       0.244349-0.0283491im      -0.255394+0.203762im         0.24522-0.257392im     -0.249001+0.196908im      0.0443124-0.00546074im   -0.0338264+0.0492829im   -0.0748136+0.0149444im    -0.172023+0.0338741im      0.0511121-0.119702im     0.0992965+0.0101044im   0.0668003-0.111032im     0.115272-0.0732578im
  -0.069688+0.0408603im     0.27955+0.132768im     -0.0141575-0.0584266im   -0.0940106-0.127317im       -0.256526-0.175531im      0.0577516-0.0666077im     0.0465788-0.2045im        0.191087+0.123988im      -0.194759+0.202786im        0.051542+0.0661301im    -0.0760272+0.0581525im    0.0333156+0.126069im      0.0782079+0.0165822im      0.112659+0.0633172im     -0.123349-0.185431im    -0.0607092-0.00627751im    0.108477+0.190096im      0.0262402-0.00631772im   -0.294348+0.0856305im  0.00736991+0.255504im       0.131227+0.00944874im     0.0847932-0.0455806im      -0.153548-0.121689im    -0.0802657+0.0749625im      0.208326-0.0670625im    -0.0922599+0.161798im    -0.0191945-0.0783815im    -0.127831+0.0598307im       0.173237-0.0696003im   -0.0969318+0.0224534im  -0.0257329+0.0172248im    0.133367-0.150392im
  0.0855837-0.0413891im    0.161536+0.163274im       0.270292+0.363649im    -0.0460593+0.424085im       -0.064656-0.068361im     -0.0872468-0.0340677im     0.0735234+0.108459im     0.0752859-0.0811345im     0.0864196+0.0507677im     -0.0272331+0.0810724im     0.0840887-0.0353113im     0.116006-0.0186315im     -0.177113+0.0819778im      0.079653+0.0476169im     -0.118408+0.0453126im     0.170371+0.0295104im    -0.121607+0.00588966im   -0.0275516-0.0042458im   -0.0055696+0.229441im   -0.0450109+0.0293121im    -0.0600993+0.118594im        0.125081-0.123347im       0.0631881-0.248617im      0.146609-0.0648477im      -0.18839+0.0835939im     -0.162466-0.00478733im   -0.128199-0.133456im      -0.12615-0.00902184im    -0.0949855+0.0818383im   -0.0429079+0.0414899im   0.0610789-0.0869847im    0.103156+0.01363im
 -0.0175666-0.0225012im   0.0750412+0.118383im      -0.113894+0.122131im      0.125376-0.00745942im     -0.282735+0.178084im      0.0843294+0.0807574im      0.029993-0.0649725im   -0.0395081-0.00798357im    0.0574616-0.126325im       -0.115813+0.183538im     -0.0864667+0.0909692im    -0.144684-0.127815im      0.0293833-0.184919im       0.279148+0.0979846im     0.0334718+0.139701im     0.0726812-0.0970761im     0.195898-0.212379im       0.112546-0.0345068im    0.0371814-0.135545im    0.0102179-0.0703495im    -0.0065531+0.133674im      -0.0449789+0.0151534im     -0.0910828+0.185188im     -0.026769+0.198626im      -0.190971+0.0167103im     -0.186069-0.25492im      0.0293368-0.118706im    0.00679652+0.0422789im       0.173247+0.15486im      -0.229168+0.0350833im   -0.121881+0.0517941im    0.126958-0.0832247im
  0.0348222+0.160839im   -0.0608268+0.016053im    -0.00294253-0.121612im      0.193061+0.0926158im        0.21702-0.0173745im    -0.0761825+0.0234544im     -0.215691+0.0124545im    0.0560023-0.196151im     -0.0775168-0.0257743im       0.156126+0.0793054im     -0.110746-0.352761im   -0.00583252+0.0323988im      0.279059-0.0852869im    -0.0934164+0.0295024im     -0.193751-0.105326im     0.0575864+0.133748im    0.00299687-0.222229im     -0.0780194-0.122552im     -0.154216+0.0342677im  -0.0822494-0.10202im       0.0606991+0.1236im         -0.051768+0.0153004im     -0.0615151-0.098627im    -0.0762122+0.00884189im      0.05179-0.0222475im     0.0126083-0.0963731im   -0.0838847-0.257522im     0.0989096-0.0458113im      0.0235151+0.133608im     -0.113474+0.0170904im     0.26882+0.111552im     0.017993-0.241232im
  -0.016957+0.13543im     0.0156335-0.128148im       0.164642+0.103621im      0.118569-0.109525im        0.112679-0.163634im      0.0332909-0.000174424im  -0.0123188+0.123417im      0.197121+0.104278im      0.0339728-0.160338im       0.0483487+0.169395im     -0.0879098+0.13949im       0.140026-0.0592088im     0.0745762-0.101636im      -0.161424-0.0991129im     0.0297484-0.136056im       0.31918-0.0828069im    -0.080694-0.109832im     -0.0106393-0.151069im     0.0477695-0.130035im     0.222528+0.0988075im     -0.048522-0.214712im        0.146462-0.127398im       -0.191005+0.039627im     0.0324819-0.0441296im     -0.177048-0.0782554im     0.0425423-0.0835945im     0.150818+0.125176im     -0.101165-0.177374im        0.104933-0.243787im    -0.0271034-0.0537156im   0.0354549+0.0389799im    0.233512-0.0457703im
  0.0722467+0.215429im     0.125826+0.0236367im    -0.0457475-0.0486609im     0.020795+0.135281im       0.0615889+0.107018im       -0.17866+0.234083im      0.0924722+0.0940987im   -0.0122889-0.109854im     -0.0444592-0.124384im       0.0979781+0.0630041im     0.0248209-0.02329im       0.323287+0.0871051im     0.0825326+0.101647im      0.0468979+0.101732im     -0.0112791+0.121506im     -0.259245+0.0876618im     -0.17799+0.160568im      0.0825549+0.191879im    -0.0459809-0.207666im   -0.0250779-0.118955im       0.207508-0.0549976im       0.116223-0.237612im       0.0288967+0.110371im     0.0602914+0.128042im     -0.0811464-0.149769im      -0.132841+0.0166297im       0.1759-0.0877236im    0.0458715+0.0171175im        0.18138-0.142933im     -0.035966-0.191718im   -0.0776823-0.0694387im   -0.108505+0.0354375im
   -0.11784-0.0557083im    0.133617-0.13925im     -0.00835432+0.138777im      0.294797-0.0130481im    -0.00634378-0.014506im      -0.108164+0.0887545im     0.0260535+0.0144519im     0.174417+0.0353123im    -0.0894863-0.121646im      -0.0140591-0.260284im      -0.132888+0.156279im     -0.124093+0.113289im       0.134179+0.0390182im      0.139632+0.133138im     -0.0427926-0.15161im     -0.0126116+0.154878im    -0.0947699-0.112983im       0.034485+0.116942im    -0.0968868-0.0307547im     0.11656-0.114475im       0.167825+0.126447im        0.206765+0.198635im        0.102709-0.00363397im   -0.041223-0.109747im      -0.100918+0.00580366im    0.0938364-0.0737088im   -0.0558029+0.0979135im    -0.214994+0.185124im        -0.33077-0.101581im     -0.088988+0.0275352im   -0.110183+0.116998im    -0.154408+0.0130919im
  -0.117022-0.0740013im   0.0542539-0.0161622im     0.0471568-0.0737234im   -0.0604823-0.139055im        0.127496+0.133763im      0.0347117+0.101542im        0.12816-0.0481465im     0.223927-0.0239514im      0.415113+0.26357im       -0.0952967-0.0537873im    -0.0160298-0.0315679im     0.117207+0.0152825im   -0.00334027-0.224008im      -0.272462+0.0190177im      0.130262-0.0666648im    -0.038346+0.012974im     0.0762737-0.156976im      0.0936993+0.154373im     -0.125361-0.195223im   -0.0517442+0.0159896im      0.039991+0.17018im       -0.0986881-0.178437im      -0.0900097-0.152278im     0.0087293-0.1075im        0.0552665-0.00505406im    -0.282351-0.0845941im   -0.0445689+0.0139225im   -0.0798455-0.106617im       -0.134741-0.0103233im   -0.0674731+0.108131im   -0.0626869-0.109554im    -0.138571+0.0246525im
    0.19929-0.147938im    0.0686824+0.148695im      0.0141524+0.106606im    -0.0473618-0.0171343im      -0.140833+0.0851144im     0.0140784+0.105333im      -0.224499+0.0205256im    0.0958853-0.0707935im     0.0694374-0.176252im        0.225362+0.188032im      0.0599271+0.0518449im    0.0954844-0.037971im      0.0213794-0.189792im     -0.0810778-0.0378319im    -0.0336192+0.00404299im   0.0511306+0.0830953im     0.101689+0.194238im      -0.115203+0.0534355im      0.10049-0.161815im    -0.055811-0.0190464im   -0.00488001+0.0491349im      0.0938944+0.000205817im    0.0585302+0.0331713im   -0.0311366-0.091276im       0.226946+0.0853557im      0.169605+0.157035im     0.0843691+0.166541im      -0.24217-0.105228im       0.0456015+0.187295im     -0.234606+0.12055im      0.117852+0.229548im     -0.22262+0.177067im
    0.15935+0.227404im    0.0977784+0.112987im       0.228342-0.0200843im     0.122677+0.0252393im      -0.222223-0.0899757im     0.0115681-0.263682im       -0.15379-0.0361219im    0.0301239-0.00314663im    0.0184501+0.0800259im   -0.000229103-0.0682698im    -0.0272354+0.031548im    -0.0827749+0.0224632im    -0.0408771-0.0736116im    -0.0633854+0.281455im       0.201392-0.0316131im    -0.115814-0.164242im    -0.0876753+0.0267887im      0.384245-0.20979im       0.102483-0.0789754im  -0.0742715-0.0398572im      0.142546+0.0477865im     -0.0621697-0.0249459im      0.0317392-0.0539895im     0.154339-0.020127im      0.0404918-0.111842im       0.138849-0.0881196im    0.0243416+0.0316888im     0.250291-0.0525392im      -0.092548-0.120565im    -0.0591365+0.0810245im    0.166846+0.0574692im   -0.107029+0.153159im
   0.147946-0.0811581im   -0.158311+0.0501995im     0.0163464-0.0518527im     0.100633-0.0189791im       0.165692+0.111726im     -0.0363626-0.342749im     -0.0372047+0.164874im     0.0390425+0.0515773im       -0.3078+0.00707645im     -0.235493+0.0917868im      0.164288+0.102094im       0.15286-0.00289066im     0.154967-0.0319365im      0.102037+0.14179im      -0.0778568+0.101872im     0.0593226-0.0118414im    0.0505056-0.0484848im      0.063623+0.252736im     -0.112487-0.0572203im   0.0837635+0.0536245im     -0.021324+0.0917046im      -0.150645+0.0306429im      -0.272128+0.00982935im    0.358557-0.0770518im     0.0417097-0.103922im     -0.0361731+0.0744971im   -0.0403497+0.0115622im    -0.133919-0.0616549im   -0.000631969+0.105628im      0.139081+0.0395278im  -0.0858975+0.126182im   -0.0756735+0.011127im
 -0.0405812+0.0732555im   -0.031034+0.0892489im    -0.0377026+0.0736168im     -0.10554+0.0955357im       -0.25471+0.118354im     -0.0645123-0.0720503im       -0.1049+0.0580423im    -0.155553-0.270087im     -0.0989169+0.0256612im      0.0602421-0.052718im    -0.00780647-0.196546im    -0.0450964+0.028109im       0.212638+0.154647im     0.00634858-0.0245067im     0.0777986-0.0492852im     0.197125+0.0226047im   -0.0430422-0.0250991im      0.256711+0.22705im     -0.0750548-0.129117im    0.0725654+0.0700278im    -0.0892671-0.316492im        0.012315+0.0806153im      0.0121869+0.0959229im    -0.204063-0.11508im       0.0955736+0.104739im      -0.307516-0.0456463im   -0.0910746+0.218562im    -0.0338742-0.164798im       -0.117976-0.100051im      0.055407+0.126706im    0.0203759-0.0270599im   0.0615405-0.0258275im
  0.0656952+0.106849im   -0.0171521+0.036239im       0.136705-0.277714im     -0.309001+0.0666119im        0.14802+0.135395im      0.0459475+0.134442im     0.00706361-0.0782679im     -0.12094+0.0858251im      0.199174+0.129324im      -0.0632299+0.00162007im   -0.0129606+0.106047im     0.0144063-0.0740029im      0.214141-0.00672im        0.197934+0.213371im      0.0502687+0.0300042im    0.0824615-0.101714im     -0.225365+0.031882im     -0.0515676+0.148515im     0.0640991-0.098012im     -0.12696+0.159144im     0.00214111-0.03588im        0.0992662+0.0851489im       0.127608-0.0446128im    -0.018904-0.0212771im     -0.139899-0.00245159im     0.253181-0.085416im      -0.14089-0.0340092im    -0.155476+0.0608846im      0.0554204-0.0675077im  0.000847994+0.200135im    0.0581436+0.246543im     0.147978-0.163983im
  0.0911558+0.0155311im  -0.0674136+0.0679098im      0.130493-0.122809im    -0.0323784+0.121204im        0.155422+0.0194666im     -0.155906-0.172343im       0.130068+0.099674im      0.138172-0.111639im      0.0560963+0.0247816im      0.0309191+0.0467916im     -0.313764+0.0342285im    0.0417246+0.00971781im    -0.102255+0.0285864im    -0.0728386-0.0113147im      0.346825+0.0626741im    0.0760786+0.03905im       0.257438+0.169912im      -0.112777+0.0613848im    -0.229659+0.156226im   -0.0204177-0.0805658im      0.151722-0.0912086im       0.178148+0.113553im      -0.0441146+0.194644im      0.075125+0.276891im      0.0684393+0.19843im       0.0522809-0.0864933im    0.0708666+0.0939922im     0.110384+0.0442883im      -0.127344+0.0839392im   -0.0729812+0.107169im   -0.0914217+0.0433269im    0.103152-0.0622023im
   -0.15158-0.0407914im  0.00479432+0.0137002im   -0.00449535-0.06614im       0.103312-0.0723457im       -0.11247+0.229693im      0.0223281-0.149783im       0.208267-0.0464324im   -0.0355692+0.242793im      0.0705374-0.00178394im     0.0597909+0.272114im     -0.0502979-0.149546im     0.0116681-0.0621913im     -0.113169+0.140621im      -0.135064+0.0276403im     -0.238911-0.17176im       0.179943+0.118985im    -0.0991972+0.147892im      0.0941631-0.00853891im   0.0249472+0.107614im    -0.208636-0.105444im      0.0668701-0.18641im        -0.152176-0.0134984im      0.0504768+0.0644652im     0.103952+0.201758im    -0.00398449-0.0476233im     0.0255232-0.294145im    -0.0520173+0.0480595im    -0.228323+0.0555125im     -0.0497409-0.0514563im     0.079242-0.071421im     0.105934+0.0790141im    -0.22868-0.018252im
  -0.128674+0.226421im    0.0591836+0.061571im      0.0856864+0.120339im    -0.0811919-0.0899823im       0.149496-0.172575im      -0.123535+0.037046im       0.141041+0.174563im     -0.104468-0.00342183im   -0.0290007+0.0344492im     -0.0773888+0.081592im      -0.096073-0.124665im     0.0190922-0.0951647im     -0.185362+0.0232289im      0.261257+0.064037im      -0.179492-0.111529im    -0.0451645+0.160431im      0.150033-0.0130573im    -0.0953365-0.0760398im     0.106474-0.310512im     0.129811+0.0829936im     -0.141002+0.0675915im      -0.131884-0.212655im        0.100222+0.108858im     0.0807897+0.0429496im      0.217195-0.0421689im     0.0377848+0.0123685im    -0.177373+0.247109im       0.14821+0.119242im        -0.12936-0.0117617im   -0.0870293+0.159311im   -0.0136298+0.06012im    -0.0265612-0.0990507im
  0.0841502-0.148055im    0.0403719-0.354039im     -0.0847222+0.0955051im    0.0647431-0.0286344im       0.042847-0.154227im       0.182909+0.127184im     -0.0817213-0.00873804im    0.133974-0.0418197im    0.00497249+0.0425281im      -0.106663+0.103386im      -0.103988-0.361332im      0.209016+0.191009im     -0.0909821+0.196868im       0.127881-0.00684571im    0.0126319+0.00895239im   -0.139669-0.420098im    -0.0306803+0.00343687im     0.098313+0.092851im     -0.017924+0.0534354im   -0.115596+0.0389517im     -0.114129+0.00722528im     0.0187743+0.0784859im      0.0910667+0.150629im      0.107421+0.064161im      0.0490113-0.132037im       0.051091-0.0825995im    0.0017809+0.0706542im    -0.100467-0.132272im      -0.0736011+0.0828474im    -0.139792+0.107026im    0.0102049+0.0458619im   0.0709563+0.000588293im
 -0.0585443-0.140908im     0.301837+0.137142im       0.228516+0.174341im     -0.135885-0.0398463im      0.0838056-0.0383152im    -0.0293728+0.0276098im    -0.0211081-0.19421im        0.13828+0.126789im     -0.0812601-0.131266im       -0.132546-0.172741im     -0.0280809-0.0814978im     0.188756-0.191169im       0.209523-0.148713im      0.0117312-0.0135003im     -0.110313+0.0159502im    -0.208838+0.0721172im    -0.108673-0.0906757im   -0.00200499+0.0766817im     0.130661+0.0586931im  0.00519359+0.00468173im    0.0490747-0.13578im         -0.19052+0.147768im      -0.0247553+0.193058im     0.0140953+0.138086im      0.0704461+0.240624im       0.061831-0.0935313im     0.189169-0.0148685im    0.0793611-0.125306im       -0.066481+0.0695122im     0.180086+0.0734882im    0.111642-0.146854im     0.041084-0.0582232im
 -0.0134504-0.140922im     0.134333+0.134385im       0.142555-0.0341242im   -0.0842613-0.16573im       -0.0240686+0.0616683im     -0.040534+0.159478im      -0.367802+0.0765686im    -0.169123-0.0886893im    -0.0139049-0.0267499im      -0.230598+0.0830972im     -0.226424-0.101734im    -0.0695749-0.00967478im   -0.0152987+0.0349507im     -0.101678+0.0220324im   -0.00157199-0.132572im     0.0215167-0.16881im      0.0521304+0.0543458im     -0.136008+0.114694im     -0.196226+0.123292im     0.253627+0.127131im      0.0703802+0.0141824im       -0.15181-0.115369im        0.163026-0.096343im      0.128707-0.0464214im     -0.179036+0.109332im     -0.0244321-0.0960969im    0.0267531+0.0393444im     0.102072+0.126626im       0.0530439-0.0841964im     0.017009-0.284947im   -0.0340506+0.160691im    -0.107162+0.111177im
  -0.141093-0.102296im   -0.0147609-0.139884im     -0.0886602+0.0593142im    -0.114521+0.156317im       0.0086497-0.0902317im     -0.171983-0.0356648im     -0.286336+0.0441497im    -0.116617+0.123001im      -0.048024+0.0213959im      0.0102385+0.0196345im    -0.0309024+0.138906im     0.0133422-0.197728im      0.0686282-0.0168063im   -0.00958201-0.0410361im     -0.187953+0.0999655im    0.0663974-0.174499im     0.0966968+0.00557635im   -0.0182902-0.102492im    -0.0708744-0.0325375im   -0.463041-0.0697726im      0.274308+0.183977im       0.0282267-0.214739im       -0.030161+0.0794934im   -0.0672213-0.0740998im     0.0944182+0.0450415im    -0.0584936-0.0501238im    0.0546959+0.128444im     0.0313168-0.106385im       -0.165166-0.197341im      0.109282-0.0221662im   -0.183994+0.0770786im    0.105969-0.0478682im
  0.0349436+0.0355201im   -0.166189-0.005502im   -0.000860568-0.0736448im     0.176758-0.0680542im       -0.17393+0.162306im      0.0207951+0.115294im     -0.0418124+0.0194146im   -0.0530278+0.172071im      0.0552793-0.0481076im     -0.0515264+0.0337209im      0.191774-0.0877024im      0.21382-0.332685im      -0.108351-0.059987im     -0.0620314+0.0666126im    -0.0663517-0.150647im     0.0827554+0.0124302im   -0.0695075+0.0286418im    -0.0768635+0.156645im    -0.0751069+0.0912203im   0.0285817+0.154629im      0.0678984+0.200206im        0.223616+0.286068im       0.0961339+0.0723826im    0.0928063-0.0360871im     0.0937861-0.0914248im      -0.13209+0.12096im      0.0857362+0.0885319im     0.300233+0.0916017im      -0.102554-0.111171im     -0.133671+0.031116im     0.135532-0.164241im     0.153465-0.0817031im
 -0.0990295-0.395346im   -0.0606547+0.130919im       0.105091-0.134377im     0.0389616+0.0807626im      0.0369907-0.0486833im      0.121952+0.092148im     -0.0111842+0.0218954im     0.101191+0.00203188im    0.0529455+0.0476551im       0.124985-0.102584im      0.0367932+0.203396im     0.0986727+0.119038im      0.0031107+0.127488im      -0.123645+0.0513083im      -0.21575+0.105434im     0.0821476+0.0131368im   -0.0266714+0.101442im       0.158406-0.160119im    -0.0349707-0.183591im     0.226916+0.0366205im     0.0640375+0.0484379im      0.0147234+0.0167746im       0.139375+0.257875im    -0.0398147+0.180636im     -0.0311673-0.104347im      -0.108996+0.0509374im    -0.310545-0.0655148im      0.20481-0.142878im      -0.0667621+0.0998584im    0.0691063-0.0801121im   0.0747085+0.180667im     0.106375+0.0142174im
   0.015882-0.0844395im  -0.0764273-0.107912im     -0.0325694+0.0593144im   -0.0524211+0.000969119im   -0.0344596-0.0990834im    -0.0519031+0.00110337im    0.0732286+0.166499im      0.106589-0.045448im       0.128186+0.0309449im       0.176224+0.0295508im      0.168392-0.139599im     -0.244106+0.00305806im     0.394041-0.173513im      0.0744619+0.0225261im     0.0360078-0.179289im     0.0771662-0.0304115im    -0.191924+0.178918im      -0.103628-0.00733071im   0.0853007+0.14672im      0.140609-0.0835715im      0.132796+0.105745im       -0.183099-0.0431277im       0.149942-0.0276274im     0.180256+0.224541im       0.125362-0.0870198im    -0.0921918-0.0487978im    0.0113538+0.0611832im    0.0452495+0.043559im        0.109205-0.014732im     0.0385148+0.147415im    -0.249864-0.0450836im    0.166577+0.209703im
 -0.0227285+0.0560875im   -0.158533+0.0151442im     0.0284336+0.235274im      0.280897-0.0153841im     0.00527317+0.0925111im   -0.00706766+0.0366922im    -0.0587868-0.0282922im     0.141065+0.0250861im      0.283952+0.149744im     -0.00871039-0.0865606im    -0.0874146+0.0746704im    -0.106872-0.154974im     -0.0713978+0.0830535im      0.167488+0.156255im      -0.138666+0.0733015im     -0.14611-0.0319241im   -0.0959622+0.0867987im      -0.10833+0.101856im     -0.269681+0.0215828im   0.0191164-0.179094im       -0.22831-0.141239im       0.0450214-0.0405875im     -0.0948606+0.00021852im   -0.046451-0.0812081im      0.271294+0.135003im      0.0508326-0.0575521im   -0.0211326-0.0571131im    0.0951876-0.125765im        0.256203-0.124157im      0.175914-0.0273148im   0.0409751+0.173936im     0.068126+0.128777im
 -0.0659603-0.0184043im  -0.0451481-0.0280488im    -0.0985818-0.0205006im   -0.0765496+0.00363921im     -0.256673-0.00631464im    -0.108321+0.132558im      0.0717247+0.198384im      0.252147+0.0500332im     0.0539581-0.154184im       -0.227678+0.134889im      -0.164275-0.0138224im    -0.103008+0.0496721im      0.173486+0.0492127im    -0.0249201-0.051058im      0.0499157-0.0688355im    0.0977942-0.0702465im     0.074846-0.0549976im     0.0369143+0.0496178im   -0.0502037-0.176631im    -0.192304-0.0664124im    -0.0556943-0.0170121im   -0.000547803-0.0644871im    -1.65174e-6+0.0751476im     0.139713+0.0436387im    -0.0684184+0.121317im       0.168184+0.382213im     -0.168957-0.217443im     0.0725436+0.121403im      -0.0291579-0.0750466im     0.208432+0.0638251im    0.264995-0.172425im   -0.0127399+0.101589im
 -0.0451576-0.0234068im  0.00241205-0.0230128im    -0.0815977+0.183225im     0.0832798-0.0182508im      0.0934729-0.0272054im     0.0857076+0.0739088im     -0.066477+0.0434557im    -0.161281-0.0965344im      0.176775+0.12555im        -0.125874+0.0501616im     0.0668245+0.100577im     -0.113205+0.28842im       0.0500683+0.140835im       -0.11122+0.135915im     -0.0833658+0.0880898im     0.161399+0.141402im     0.0228099+0.255598im      0.0959919-0.105175im    -0.0244933-0.0566389im   0.0468944+0.089229im       0.113612+0.0741411im      -0.123887+0.0634097im      0.0151929+0.198807im      0.169581-0.209678im      0.0454905+0.174708im      0.0928534-0.0312367im     0.344836-0.0938603im   -0.0342473+0.0677231im      0.0790963-0.0330457im   -0.0378033+0.163282im    0.0673524-0.210388im   0.00812901-0.291962im
   0.181963-0.366497im    0.0986859-0.0689351im    -0.0761609-0.00258899im   0.0156706+0.0585812im     0.00104187+0.0453934im      0.110291-0.261803im       0.209843+0.00899157im    0.161562-0.137948im    -0.00469752-0.0164896im       -0.16737+0.103118im      -0.116116-0.0432331im   -0.0101671+0.0328768im     0.0707165-0.0417173im     0.0110374+0.222155im      0.0187671+0.123042im     0.0779104+0.117439im     -0.150831-0.152828im      -0.152374-0.052102im     0.0828494-0.025169im    -0.135762+0.0529459im    -0.0589561-0.0987588im     -0.0210486-0.100334im        0.186785-0.0861855im      -0.2028-0.0818137im     0.0861573-0.0765429im    -0.0847344+0.12189im       0.192516+0.16622im       0.230797+0.163271im        0.067335-0.171553im    -0.0568342-0.125701im    0.0266754+0.127555im   -0.0303762-0.155089im
  0.0455084+0.0383953im    0.164202-0.206126im       0.101472+0.186232im      0.045039-0.0938375im      0.0487878-0.043904im     -0.0106418-0.191742im      -0.169518+0.0250363im   -0.0302891+0.151019im      0.0766369+0.0391395im        0.18683+0.0747348im     0.0520536+0.115735im    -0.0711755+0.0321932im     0.0175874-0.0844349im     -0.070845+0.13744im       0.0817196-0.181571im    -0.0649906+0.062626im     0.0923867+0.157005im     -0.0211833+0.323809im    -0.0644201-0.0617252im   -0.156565-0.113497im     -0.0945682-0.0783379im     -0.0760589-0.0502124im       0.107201+0.109795im     -0.143412-0.0763282im     -0.294933-0.147955im      -0.017986+0.0883196im    -0.145177+0.0852279im     0.149651+0.0520657im      0.0517767+0.342419im     0.0795424-0.104203im    0.0233074-0.110262im     0.108424-0.196189im
  -0.126724-0.0298238im   -0.126308+0.156613im       0.134288-0.154322im      0.152039+0.121214im       0.0234759-0.065064im      0.0895753+0.269466im      -0.177866-0.126805im      0.094705+0.0694034im     -0.194311+0.10818im        0.0194404+0.291513im       0.053771-0.0471414im   -0.0398361+0.189826im     -0.0333383-0.0913984im   -0.00151209+0.249192im      0.0302094+0.054941im    -0.0973047+0.165833im      0.129453-0.0438531im    -0.0980818-0.0151355im    0.0432163+0.153318im   -0.0635849-0.0656124im     -0.172322-0.0257255im     0.00871888-0.0290419im    -0.00865077+0.0432005im   -0.0902524+0.0436792im     -0.233787-0.0384155im    -0.0798582+0.0455515im    0.0779692+0.213985im    0.00570892-0.0233698im      -0.026479-0.194225im      0.195116+0.312065im   -0.0806281-0.0878166im  -0.0504319+0.113071im
  0.0900144+0.0584841im    0.175626-0.285711im      -0.145831+0.162628im    -0.0763136-0.209657im      -0.0681216+0.00991416im    -0.136528+0.141704im       0.194934+0.00245235im  -0.0827607-0.0497176im     -0.103527-0.0786896im      0.0355389+0.111456im      0.0736786-0.0648479im   -0.0229935-0.0635502im   -0.00107468+0.00287305im    -0.247926+0.251229im       0.114175+0.198191im    -0.0469582+0.0905334im    0.0917667+0.102436im      0.0486553-0.0566942im    0.0313942+0.0740626im    0.101988+0.114136im     -0.0361807+0.241277im        0.124651+0.0540936im     -0.0645662-0.139835im    -0.0209408+0.0994147im    -0.0237468+0.125627im     -0.0578094-0.0883955im   -0.0949091+0.00536309im     0.03801-0.132318im      -0.0263884-0.0233282im     0.346548+0.0581046im     0.12629+0.296821im    0.0377777-0.059216im
   0.126506+0.0771321im   0.0111449-0.121387im      0.0797891-0.0664759im     0.152392+0.0300455im      0.0546316-0.110817im      0.0113093-0.278272im       0.145932-0.188638im     -0.244416-0.067717im       0.133496+0.0759362im     -0.0825006+0.121139im      0.0503476-0.0578903im    -0.158263+0.0798365im     0.0821187-0.125381im     -0.0601603-0.0220725im     -0.310816+0.037693im       -0.1401-0.0105588im     0.190139-0.13581im      -0.0708706+0.171501im    0.00190854-0.0778126im   0.0689404+0.161027im       0.140775-0.00567001im      0.202231-0.0575761im       0.189063+0.156435im    -0.0302201+0.10949im      -0.0812866+0.180152im    -0.00189452+0.0961401im    0.0113403-0.0513296im    -0.135645-0.109238im      -0.0432696-0.112543im    -0.0333474-0.0515374im    0.112141-0.0568191im   0.0966404+0.315789im</code></pre><p>and then generate the state <span>$ψ$</span></p><pre><code class="language-julia hljs">psi = P[:, 3]</code></pre><pre><code class="nohighlight hljs">32-element Vector{ComplexF64}:
  -0.07535250267209499 - 0.06756911710751547im
  -0.05353452248041257 - 0.08362524072251473im
 -0.047787917937870225 + 0.02657158033327255im
   -0.1219625860858123 + 0.008204406535330458im
   0.08884008684550379 - 0.16861884331181742im
    0.1720015489751017 - 0.12506841547892716im
   0.10531330211946019 + 0.05857548317424455im
   -0.1904241725940328 - 0.18920687840499853im
   0.11773169451051349 - 0.0020985684226457295im
  -0.00804210555199513 + 0.11236191544153792im
   0.14006449132385693 - 0.22872297109912093im
   0.31470645844613565 + 0.0im
 -0.035180996305046064 - 0.2563430787222636im
   0.04492547633024333 + 0.23769661774667628im
  -0.15395269162525882 - 0.12379871948391766im
  -0.08671387878698766 + 0.0013971206969637915im
 -0.030634267067934616 + 0.1663199423589944im
  -0.12436378127684575 - 0.003209490996217649im
    0.2587897241384397 + 0.08669828241601796im
  -0.05869260991066098 - 0.19116605782104895im
   -0.0635179468283328 - 0.06473448794479066im
   0.09171090672281394 + 0.09950067405528429im
 -0.004022793817400899 + 0.08101149111059582im
   0.15634239004914416 - 0.2061936148368279im
   0.10464392393755317 - 0.10313498883035993im
    0.0732795636681425 - 0.06444532886310148im
   0.07208021322713634 + 0.019570709955981237im
  0.015664860081070316 - 0.13463333058040913im
   0.02638090830287063 - 0.23201744938157043im
  -0.12224310898596054 - 0.16632199238216339im
   0.06734185733111833 - 0.08699557080139879im
 -0.036715410366037704 + 0.0034650810956796388im</code></pre><p>In the phase estimation process, we will feed the state to circuit and measure the first <code>n</code> qubits processed by iQFT.</p><pre><code class="language-julia hljs">r = join(ArrayReg(psi), zero_state(N))
r |&gt; PE(N, M, U)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 8/8
    nlevel: 2</code></pre><p>Since our phase can be represented by 3 qubits precisely, we only need to measure once</p><pre><code class="language-julia hljs">results = measure(r, 1:N; nshots=1)</code></pre><pre><code class="nohighlight hljs">1-element Vector{DitStr{2, 3, Int64}}:
 011 ₍₂₎</code></pre><p>Recall that our QFT&#39;s bit numbering is reversed, let&#39;s reverse it back</p><pre><code class="language-julia hljs">using BitBasis
estimated_phase = bfloat(results[]; nbits=N)</code></pre><pre><code class="nohighlight hljs">0.75</code></pre><p>the phase is exactly <code>0.75</code>!</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../1.prepare-ghz-state/index.html">« Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a><a class="docs-footer-nextpage" href="../3.grover-search/index.html">Grover Search »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.18 on <span class="colophon-date" title="Monday 30 May 2022 22:25">Monday 30 May 2022</span>. Using Julia version 1.7.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
