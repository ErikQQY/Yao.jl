<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quantum Fourier Transformation and Phase Estimation · Documentation | Yao</title><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.044/juliamono.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/indigo.css" rel="stylesheet" type="text/css"/><link href="https://yaoquantum.org/assets/favicon-light.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../index.html"><img src="../../../assets/logo.png" alt="Documentation | Yao logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../index.html">Documentation | Yao</a></span></div><form class="docs-search" action="../../../search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../index.html">Home</a></li><li><a class="tocitem" href="../../../quick-start.html">Quick Start</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../../man/registers.html">Registers</a></li><li><a class="tocitem" href="../../../man/blocks.html">Blocks</a></li><li><a class="tocitem" href="../../../man/symbolic.html">Symbolic Computation</a></li><li><a class="tocitem" href="../../../man/automatic_differentiation.html">Automatic Differentiation</a></li><li><a class="tocitem" href="../../../man/simplification.html">Simplification</a></li><li><a class="tocitem" href="../../../man/bitbasis.html">BitBasis</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../1.prepare-ghz-state/index.html">Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a></li><li class="is-active"><a class="tocitem" href="index.html">Quantum Fourier Transformation and Phase Estimation</a><ul class="internal"><li><a class="tocitem" href="#Quantum-Fourier-Transformation"><span>Quantum Fourier Transformation</span></a></li><li><a class="tocitem" href="#Wrap-QFT-to-an-external-block"><span>Wrap QFT to an external block</span></a></li><li><a class="tocitem" href="#Phase-Estimation"><span>Phase Estimation</span></a></li></ul></li><li><a class="tocitem" href="../3.grover-search/index.html">Grover Search</a></li><li><a class="tocitem" href="../4.shor-algorithm/index.html">Shor&#39;s Algorithm</a></li><li><a class="tocitem" href="../5.shor-9-code/index.html">Shor&#39;s 9 qubit code</a></li><li><a class="tocitem" href="../6.quantum-circuit-born-machine/index.html">Quantum Circuit Born Machine</a></li><li><a class="tocitem" href="../7.variation-quantum-eigen-solver/index.html">Variational Quantum Eigen Solver</a></li></ul></li><li><a class="tocitem" href="../../../performancetips.html">Performance Tips</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/QuantumBFS/Yao.jl/blob/master/docs/src/examples/2.qft-phase-estimation/main.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><p><a href="https://mybinder.org/v2/gh/QuantumBFS/Yao.jl/gh-pages?filepath=dev/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a> <a href="https://nbviewer.jupyter.org/github/QuantumBFS/Yao.jl/blob/gh-pages/dev/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://img.shields.io/badge/show-nbviewer-579ACA.svg" alt/></a> <a href="https://minhaskamal.github.io/DownGit/#/home?url=https://github.com/QuantumBFS/tutorials/tree/gh-pages/dev/generated/examples/2.qft-phase-estimation"><img src="https://img.shields.io/badge/download-project-orange" alt/></a></p><h1 id="example-qft"><a class="docs-heading-anchor" href="#example-qft">Quantum Fourier Transformation and Phase Estimation</a><a id="example-qft-1"></a><a class="docs-heading-anchor-permalink" href="#example-qft" title="Permalink"></a></h1><p>Let&#39;s use Yao first</p><pre><code class="language-julia hljs">using Yao</code></pre><h2 id="Quantum-Fourier-Transformation"><a class="docs-heading-anchor" href="#Quantum-Fourier-Transformation">Quantum Fourier Transformation</a><a id="Quantum-Fourier-Transformation-1"></a><a class="docs-heading-anchor-permalink" href="#Quantum-Fourier-Transformation" title="Permalink"></a></h2><p>The Quantum Fourier Transformation (QFT) circuit is to repeat two kinds of blocks repeatly:</p><p><img src="assets/qft.png" alt="qft-circuit"/></p><p>The basic building block control phase shift gate is defined as</p><p class="math-container">\[R(k)=\begin{bmatrix}
1 &amp; 0\\
0 &amp; \exp\left(\frac{2\pi i}{2^k}\right)
\end{bmatrix}\]</p><p>Let&#39;s define block <code>A</code> and block <code>B</code>, block <code>A</code> is actually a control block.</p><pre><code class="language-julia hljs">A(i, j) = control(i, j=&gt;shift(2π/(1&lt;&lt;(i-j+1))))</code></pre><pre><code class="nohighlight hljs">A (generic function with 1 method)</code></pre><p>Once you construct the blockl you can inspect its matrix using <code>mat</code> function. Let&#39;s construct the circuit in dash box A, and see the matrix of <span>$R_4$</span> gate.</p><pre><code class="language-julia hljs">R4 = A(4, 1)</code></pre><pre><code class="nohighlight hljs">(n -&gt; control(n, 4, 1 =&gt; shift(0.39269908169872414)))</code></pre><p>If you have read about <a href="generated/examples/2.qft-phase-estimation/@ref example-ghz">preparing GHZ state</a>, you probably know that in Yao, we could just leave the number of qubits, and it will be evaluated when possible.</p><pre><code class="language-julia hljs">R4(5)</code></pre><pre><code class="nohighlight hljs">nqubits: 5
control(4)
└─ (1,) shift(0.39269908169872414)</code></pre><p>its matrix will be</p><pre><code class="language-julia hljs">mat(R4(5))</code></pre><pre><code class="nohighlight hljs">32×32 LinearAlgebra.Diagonal{ComplexF64, Vector{ComplexF64}}:
 1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im</code></pre><p>Then we repeat this control block over and over on different qubits, and put a Hadamard gate to <code>i</code>th qubit to construct <code>i</code>-th <code>B</code> block.</p><pre><code class="language-julia hljs">B(n, k) = chain(n, j==k ? put(k=&gt;H) : A(j, k) for j in k:n)</code></pre><pre><code class="nohighlight hljs">B (generic function with 1 method)</code></pre><p>We need to input the total number of qubits <code>n</code> here because we have to iterate through from <code>k</code>-th location to the last.</p><p>Now, let&#39;s construct the circuit by chaining all the <code>B</code> blocks together</p><pre><code class="language-julia hljs">qft(n) = chain(B(n, k) for k in 1:n)
qft(4)</code></pre><pre><code class="nohighlight hljs">nqubits: 4
chain
├─ chain
│  ├─ put on (1)
│  │  └─ H
│  ├─ control(2)
│  │  └─ (1,) shift(1.5707963267948966)
│  ├─ control(3)
│  │  └─ (1,) shift(0.7853981633974483)
│  └─ control(4)
│     └─ (1,) shift(0.39269908169872414)
├─ chain
│  ├─ put on (2)
│  │  └─ H
│  ├─ control(3)
│  │  └─ (2,) shift(1.5707963267948966)
│  └─ control(4)
│     └─ (2,) shift(0.7853981633974483)
├─ chain
│  ├─ put on (3)
│  │  └─ H
│  └─ control(4)
│     └─ (3,) shift(1.5707963267948966)
└─ chain
   └─ put on (4)
      └─ H
</code></pre><h2 id="Wrap-QFT-to-an-external-block"><a class="docs-heading-anchor" href="#Wrap-QFT-to-an-external-block">Wrap QFT to an external block</a><a id="Wrap-QFT-to-an-external-block-1"></a><a class="docs-heading-anchor-permalink" href="#Wrap-QFT-to-an-external-block" title="Permalink"></a></h2><p>In most cases, <code>function</code>s are enough to wrap quantum circuits, like <code>A</code> and <code>B</code> we defined above, but sometimes, we need to dispatch specialized methods on certain kinds of quantum circuit, or we want to define an external block to export, thus, it&#39;s useful to be able to wrap circuit to custom blocks.</p><p>First, we define a new type as subtype of <code>PrimitiveBlock</code> since we are not going to use the subblocks of <code>QFT</code>, if you need to use its subblocks, it&#39;d be better to define it under <code>CompositeBlock</code>.</p><pre><code class="language-julia hljs">struct QFT &lt;: PrimitiveBlock{2}
    n::Int
end

YaoBlocks.nqudits(q::QFT) = q.n</code></pre><p>Now, let&#39;s define its circuit</p><pre><code class="language-julia hljs">circuit(q::QFT) = qft(q.n)</code></pre><pre><code class="nohighlight hljs">circuit (generic function with 1 method)</code></pre><p>And forward <code>mat</code> to its circuit&#39;s matrix</p><pre><code class="language-julia hljs">YaoBlocks.mat(::Type{T}, x::QFT) where T = mat(T, circuit(x))</code></pre><p>You may notice, it is a little ugly to print <code>QFT</code> at the moment, this is because we print the type summary by default, you can define your own printing by overloading <code>print_block</code></p><pre><code class="language-julia hljs">YaoBlocks.print_block(io::IO, x::QFT) = print(io, &quot;QFT($(x.n))&quot;)</code></pre><p>Since it is possible to use FFT to simulate the results of QFT (like cheating), we could define our custom <code>apply!</code> method:</p><pre><code class="language-julia hljs">using FFTW, LinearAlgebra

function YaoBlocks.apply!(r::ArrayReg, x::QFT)
    α = sqrt(length(statevec(r)))
    invorder!(r)
    lmul!(α, ifft!(statevec(r)))
    return r
end</code></pre><p>Now let&#39;s check if our <code>apply!</code> method is correct:</p><pre><code class="language-julia hljs">r = rand_state(5)
r1 = r |&gt; copy |&gt; QFT(5)
r2 = r |&gt; copy |&gt; circuit(QFT(5))
r1 ≈ r2</code></pre><pre><code class="nohighlight hljs">true</code></pre><p>We can get iQFT (inverse QFT) directly by calling <code>adjoint</code></p><pre><code class="language-julia hljs">QFT(5)&#39;</code></pre><pre><code class="nohighlight hljs"> [†]QFT(5)</code></pre><p>QFT and iQFT are different from FFT and IFFT in three ways,</p><ol><li>they are different by a factor of <span>$\sqrt{2^n}$</span> with <span>$n$</span> the number of qubits.</li><li>the <a href="https://quantumbfs.github.io/BitBasis.jl/stable/tutorial/#Conventions-1">bit numbering</a> will exchange after applying QFT or iQFT.</li><li>due to the convention, QFT is more related to IFFT rather than FFT.</li></ol><h2 id="Phase-Estimation"><a class="docs-heading-anchor" href="#Phase-Estimation">Phase Estimation</a><a id="Phase-Estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Phase-Estimation" title="Permalink"></a></h2><p>Since we have QFT and iQFT blocks we can then use them to realize phase estimation circuit, what we want to realize is the following circuit:</p><p><img src="assets/phaseest.png" alt="phase estimation"/></p><p>First we call Hadamard gates repeatly on first <code>n</code> qubits.</p><pre><code class="language-julia hljs">Hadamards(n) = repeat(H, 1:n)</code></pre><pre><code class="nohighlight hljs">Hadamards (generic function with 1 method)</code></pre><p>Then in dashed box <code>B</code>, we have controlled unitaries:</p><pre><code class="language-julia hljs">ControlU(n, m, U) = chain(n+m, control(k, n+1:n+m=&gt;matblock(U^(2^(k-1)))) for k in 1:n)</code></pre><pre><code class="nohighlight hljs">ControlU (generic function with 1 method)</code></pre><p>each of them is a <code>U</code> of power <span>$2^{(k-1)}$</span>.</p><p>Since we will only apply the qft and Hadamard on first <code>n</code> qubits, we could use <code>Subroutine</code>, which creates a context of a sub-scope of the qubits.</p><pre><code class="language-julia hljs">PE(n, m, U) =
    chain(n+m, # total number of the qubits
        subroutine(Hadamards(n), 1:n), # apply H in local scope
        ControlU(n, m, U),
        subroutine(QFT(n)&#39;, 1:n))</code></pre><pre><code class="nohighlight hljs">PE (generic function with 1 method)</code></pre><p>we use the first <code>n</code> qubits as the output space to store phase <span>$ϕ$</span>, and the other <code>m</code> qubits as the input state which corresponds to an eigenvector of oracle matrix <code>U</code>.</p><p>The subroutine here uses <code>focus!</code> and <code>relax!</code> to manage a local scope of quantum circuit, and only activate the first <code>n</code> qubits while applying the block inside the subroutine context, and the scope will be <code>relax!</code>ed back, after the context. This is equivalent to manually <code>focus!</code> then <code>relax!</code></p><p>fullly activated</p><pre><code class="language-julia hljs">r = rand_state(5)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>first 3 qubits activated</p><pre><code class="language-julia hljs">focus!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 3/5
    nlevel: 2</code></pre><p>relax back to the original</p><pre><code class="language-julia hljs">relax!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>In this way, we will be able to apply small operator directly on the subset of the qubits.</p><p>Details about the algorithm can be found here: <a href="https://en.wikipedia.org/wiki/Quantum_phase_estimation_algorithm">Quantum Phase Estimation Algorithm</a></p><p>Now let&#39;s check the results of our phase estimation.</p><p>First we need to set up a unitary with known phase, we set the phase to be 0.75, which is <code>0.75 * 2^3 == 6 == 0b110</code> .</p><pre><code class="language-julia hljs">N, M = 3, 5
P = eigen(rand_unitary(1&lt;&lt;M)).vectors
θ = Int(0b110) / 1&lt;&lt;N
phases = rand(1&lt;&lt;M)
phases[0b010+1] = θ
U = P * Diagonal(exp.(2π * im * phases)) * P&#39;</code></pre><pre><code class="nohighlight hljs">32×32 Matrix{ComplexF64}:
   0.0754656+0.117154im       0.050323-0.0674506im     0.125021+0.112807im    -0.0307382+0.0341043im     -0.161451+0.0512493im      0.0160412-0.107316im       -0.120671-0.01813im      0.0252388+0.0768848im     0.0905783-0.0266425im     0.227678-0.021166im   -0.00384209+0.0735814im    -0.056436+0.0884709im        0.117649+0.096549im      -0.085094+0.0943148im       0.21123-0.0927188im      0.113001-0.051203im     0.242667+0.132378im      -0.186989+0.0538196im     0.0361169+0.0218851im      0.147928-0.087394im      0.205912+0.127923im     0.0679486-0.0871198im    -0.000219418+0.108898im       0.156327-0.0273439im     0.0776359-0.363154im      0.0960475+0.235139im       0.116848-0.0644824im    -0.0971198+0.198459im       0.102044+0.041566im        0.236867+0.0385953im      0.08659-0.306967im     0.0143941-0.0356076im
   -0.124238+0.143506im       0.178705+0.258494im    -0.0469424-0.00512291im    0.085948+0.0299882im       0.16939-0.314668im      0.00967452+0.265779im      -0.0924177-0.0373182im     0.032301+0.0530387im    -0.0330081-0.194498im     -0.127024-0.10266im     -0.0148987-0.0392186im    0.0181237+0.314705im       -0.0610174-0.0106408im     0.0100748-0.102316im       0.169657+0.0327201im      0.222176+0.030428im      0.17779+0.0601402im     -0.195342-0.167596im      -0.189814+0.131794im    -0.00798152-0.0316823im     0.212722-0.030741im    -0.0877563+0.0148794im       0.0896327+0.114136im       -0.03393-0.0389034im     -0.179488+0.0453733im    -0.0378158+0.145615im      -0.116499+0.0676688im     0.0966084-0.0255077im     -0.044917-0.163875im      -0.0594811-0.00266723im   -0.011486+0.0842367im    -0.111215+0.101772im
   0.0867234-0.00870248im    0.0935971+0.0938895im   -0.0381882+0.408457im     0.0752552-0.134002im       0.268635-0.0148524im      0.0022542+0.213305im       -0.247791+0.0854151im   -0.0659991+0.00887663im   -0.0675414+0.0130489im   -0.0587849-0.0943072im     0.124566+0.107541im    -0.0715949+0.0517294im      -0.0128602-0.152111im      -0.192458-0.00521976im    -0.108618-0.0886919im    -0.0351967+0.100567im    -0.319775-0.0100445im     -0.156001+0.018633im       0.253824-0.0740057im      0.190005+0.0323818im    -0.056501-0.0365345im     0.127752-0.124845im         0.160413-0.154079im     -0.0305956-0.0625429im     0.0767383-0.0684885im     0.0631904-0.144656im      -0.114511+0.00581142im     -0.01474+0.0405353im    -0.0352191-0.074807im        0.129843+0.150926im    -0.0840296-0.115992im     0.0238908-0.0750138im
  0.00598163-0.0186054im      0.229831-0.171068im     0.0198367-0.110746im    -0.0960479+0.14298im       -0.103848-0.0747228im     -0.0606087+0.0185081im      -0.161781-0.0451382im    -0.183318-0.0113935im    0.00933951+0.0818303im     0.136665-0.0366868im    0.0683257+0.197808im     -0.189089-0.0628576im      -0.0178754-0.171892im     -0.0255342-0.0728475im    -0.0548844-0.135765im      -0.164216-0.0602525im  -0.0293287-0.0440078im     -0.190507-0.0819317im     -0.055625-0.152248im      0.0753755+0.0709388im     0.225414-0.00363293im   -0.261597-0.185976im       -0.0965595-0.105338im     -0.0183117+0.167703im     -0.0855042+0.09896im       -0.288104-0.0247901im     0.0508876-0.230963im       0.116537-0.206626im     -0.0595394-0.00261515im     -0.166007-0.0436033im    0.0651506-0.172433im      0.105497+0.134664im
  -0.0123149-0.254596im       0.210264-0.0191947im     0.182676+0.0264967im      0.11326-0.139057im       0.024443+0.249367im       -0.106776+0.0602457im      0.0656705-0.024608im    -0.0669754-0.0444814im     -0.152579+0.0257184im   0.00951101+0.103609im      0.143418-0.0330404im    0.0123946+0.230802im         0.222618-0.0690673im      -0.10785-0.0382848im      0.129901-0.208708im      0.0133495-0.0595011im    0.059693-0.0151189im      0.214841+0.0992244im     0.0615186-0.0643143im    -0.0914684+0.218009im     0.0114013+0.221216im    -0.0423535+0.0746373im       -0.171114+0.086346im       0.158261-0.165402im      -0.101259-0.0237037im     -0.191574+0.0925598im     -0.162203+0.200236im       -0.07782+0.0263806im     -0.224764-0.0654709im     -0.0802153+0.114774im     0.0533934+0.0652351im     0.100289+0.0599345im
   0.0407235+0.0350456im      0.198861+0.0741032im     0.156307-0.0558864im   -0.0931115+0.201557im     -0.0979843-0.0453415im      -0.154971+0.204934im        0.279293-0.114901im     0.0727187+0.176979im     -0.0408637+0.166141im     0.0533201-0.0120546im   -0.0137733+0.0269929im    0.0707713+0.00522825im     -0.0349464-0.0316068im      0.253955-0.105901im      0.0542553+0.0424758im     0.0346415+0.093157im    0.0910531+0.0644843im     0.0829508+0.0665588im      0.201928+0.0750471im      0.321737+0.151166im       -0.2037-0.167582im     0.0425155-0.0678357im        0.177545-0.09872im        0.136318-0.0851402im    -0.0781189+0.158267im       -0.15029+0.0396242im    -0.0542318-0.150295im     -0.0716845+0.217402im      0.0829944+0.145944im      -0.0337724+0.0967473im    -0.136867-0.0599708im   -0.0704154-0.0116037im
   0.0676836-0.0156648im    -0.0427574-0.0220331im      0.18807-0.106036im     0.0127261-0.204175im      0.0949691+0.0985248im     -0.0830804+0.276389im      -0.0319588+0.024916im     -0.114099-0.188499im       0.139539+0.0571829im    -0.151258+0.0711828im    -0.107859+0.0958371im     0.134591+0.0121176im      -0.0579415+0.139315im      -0.058213+0.0660558im     0.0857896+0.283382im      0.0381626-0.0950186im    0.109648-0.183341im     -0.0938568-0.0614691im     0.0369108+0.00855801im    -0.119171+0.175755im     0.0175045-0.0447192im     -0.17372+0.118792im        -0.176339-0.11289im       -0.179324-0.109253im      0.0240998-0.124843im     -0.0105392-0.0741222im    -0.0255895-0.145872im     -0.0935354-0.0987206im       0.16249+0.206846im       0.0814595+0.219669im    -0.0864634-0.220159im     -0.174189+0.147997im
   -0.227686+0.351461im        0.12926-0.0671048im     -0.20484-0.0564167im   -0.0738947-0.0932132im    -0.0708167+0.0499481im      -0.102976-0.0895326im     -0.0402562+0.01195im      -0.083148-0.0201794im    -0.0349412+0.021045im     -0.194953+0.108427im    -0.0892427+0.0756138im     0.014916+0.0639399im      -0.0249418+0.0603624im     -0.125013-0.0140428im     0.0147412-0.0946457im     0.0600643+0.0825387im  -0.0148892+0.162991im       0.243372+0.118331im      0.0873578-0.244283im      0.0688463-0.135063im     0.0275606-0.119134im      0.109603+0.130381im         -0.21964+0.0493251im    -0.0606261+0.104659im      -0.184164+0.0735287im     0.0802806-0.141817im      -0.210602-0.0338006im     0.0632569+0.174571im      0.0299204-0.0327516im      -0.125094+0.052181im      0.139774-0.280324im     -0.188319-0.0214871im
  -0.0881478-0.0139464im      0.137339+0.110062im      0.110144+0.0629819im    0.0804871+0.0501785im        -0.185+0.0599828im    -0.00265089+0.19953im        0.0862608+0.166364im      -0.16216-0.0569577im    -0.0400268-0.00406846im  -0.0404424-0.177841im    -0.0574057-0.0472486im     0.150038-0.114718im         0.134093-0.268759im      0.0629851-0.143997im      0.0112066+0.0337859im   -0.00549453+0.0696382im   0.0999437+0.012323im      0.0176956-0.0288263im    -0.0183846+0.0701332im     0.0402189-0.020954im    -0.0896286+0.173403im      0.104045+0.150285im       -0.0614249+0.0698629im   -0.00335085+0.261065im      0.0684117-0.0605641im     0.0601905-0.0003773im     -0.059922+0.203481im       0.189083-0.328438im       0.235465+0.063902im       0.0327084-0.153105im    -0.0376196-0.230348im     0.0590293-0.294963im
   -0.203313+0.0748972im    -0.0597213-0.0937647im    0.0413741-0.0169024im    -0.012429+0.0731855im     0.0553089-0.204417im       -0.229313-0.104494im       0.0083978+0.0572923im    -0.232967+0.153997im      0.0482284+0.19169im      0.0815154+0.155176im      0.240609+0.188508im     -0.103258+0.0879293im      -0.0896157+0.0569284im    -0.0383673-0.179706im      0.0401196-0.0251422im      0.228006-0.119912im   -0.0130007-0.198694im      0.0512884-0.16784im        0.199778+0.154751im     -0.0597141-0.118026im     -0.308077-0.0273375im   -0.0727489-0.075638im       -0.0781998+0.0620218im    -0.0346129-0.0155114im     -0.144175-0.199109im       0.187782+0.0397664im   -0.00872299+0.0451272im    -0.0114579-0.156966im       -0.11721+0.0943879im      0.0828994-0.0807698im   -0.0185468+0.0840888im    0.0569046-0.0866338im
    -0.11877+0.0306968im      0.252018-0.194576im     0.0659874-0.0282934im   -0.0134853-0.0195098im    -0.0992243+0.0586058im      -0.199848+0.0256389im      0.0628541+0.24447im       0.113148-0.0568931im    -0.0617855+0.0797761im    0.0324733-0.228126im     0.0893193+0.209376im     0.0364548-0.0713202im       0.0272992-0.0126192im    -0.0593666+0.23121im        0.129052+0.0440276im    -0.0401655+0.166676im    -0.208901-0.148404im     -0.0562544-0.231882im      -0.134146+0.114461im      -0.212862-0.136927im    -0.0644043-0.0451727im   -0.0155129+0.0544824im       0.0326137-0.0753316im    -0.0118404+0.055068im     -0.0338661+0.0177988im     -0.113811+0.0658141im     0.0979563+0.105949im     -0.0274929+0.304342im       0.226198-0.175011im       0.0426744+0.12602im       0.131837+0.164509im    -0.0380153-0.0380691im
  -0.0674811+0.0530774im      0.184256+0.0858419im    -0.144301+0.124456im     -0.166663-0.137871im    -0.00637843+0.149421im    -0.000683437+0.122826im        0.139338-0.103799im    -0.0646062+0.146723im       0.126849-0.0558534im    -0.187914+0.086095im     0.0528144+0.299561im     0.0281386-0.199696im         0.119122+0.0486427im     0.0018968+0.0797125im     -0.371768+0.118813im      -0.200402-0.0237574im    0.256151+0.0850938im     -0.214994+0.111939im     -0.0334583-0.0619398im   -0.00935748-0.0446931im   -0.0729823+0.0819182im    -0.117064+0.0158925im       0.0675069+0.0781706im     0.0560181-0.0772922im     -0.138499-0.151742im      0.0866313+0.131304im     -0.0686987-0.0207345im     0.0859105+0.0104973im    -0.0263336+0.047177im     -0.00334321+0.0251966im      0.11224+0.276309im     0.0716631-0.0459398im
   0.0587438-0.146525im     -0.0542885-0.0943153im   -0.0627359-0.0659207im   -0.0608738+0.179146im       0.209884-0.0504067im      0.0116632+0.270723im        0.132123+0.152668im      0.153935-0.202265im     -0.0645884-0.243677im      0.166662-0.12625im     -0.0790467+0.191103im    -0.0681744-0.124278im       -0.0906582+0.144543im      -0.178381+0.24615im       -0.036887-0.134848im      0.0265245+0.0352495im   0.0977095+0.0536289im      0.154402+0.00694224im     0.198374+0.115178im       0.104254-0.0457837im   -0.0366626+0.0793536im   0.00361354-0.0773325im      -0.0131128-0.00416201im    0.0353125+0.229839im      -0.053989-0.00247117im    0.0968275+0.120957im      -0.133866+0.0729316im     -0.110302-0.113386im      -0.140026+0.177823im       -0.114872-0.0897819im     0.151185-0.0155429im    -0.166691+0.110813im
   -0.213888+0.00386417im   -0.0636484-0.057922im     -0.101332+0.172812im    -0.0259234+0.27265im      -0.0402736+0.0262594im     -0.0154949+0.149085im      -0.0697787+0.0162298im   -0.0708164+0.0271854im      0.107541+0.101934im    -0.0897354-0.0772448im     0.092766-0.0386912im     0.173922-0.133344im       -0.0334016-0.0298024im     0.0927653+0.215914im       0.202031-0.123299im       0.175571-0.185173im   -0.0203065-0.0737328im     0.0801078+0.279441im      -0.232369-0.0466062im      0.099558+0.0340325im   -0.0336775+0.0279261im   -0.0318676-0.156082im         0.111875+0.089625im       -0.16776-0.152488im       0.191795-0.253081im     -0.0729426-0.163658im     -0.0347093+0.0101143im    -0.0396939-0.0462719im     0.0394179-0.0253455im      -0.324494+0.0798364im    0.0843533+0.079582im    -0.0299345+0.0235491im
   -0.223216+0.0865599im      0.104694-0.0612378im    0.0833136-0.119949im     0.0989168-0.108746im       -0.18089+0.170186im        0.151575-0.0640317im        0.02678+0.142538im      0.033956+0.202611im      0.0458935-0.177551im      0.074492+0.018806im    -0.0512866+0.0939671im    -0.118792+0.164859im         0.242801+0.0282074im     0.0422133+0.130819im     -0.0984676+0.0970627im      0.115949+0.117819im    -0.101988+0.0249522im     0.0763178-0.0582612im     -0.032188+0.195685im       0.118161+0.211661im     0.0050495+0.150477im     -0.109909-0.317631im      0.000480304+0.0258241im     -0.166743+0.0236823im      0.174363+0.149441im       0.294501-0.12135im      -0.0826137-0.0892936im      0.080024-0.0402654im    -0.0548464-0.000409322im   -0.0419921+0.0855007im    -0.174081+0.0307869im   -0.0344164+0.105487im
     0.20481+0.036312im      0.0792401+0.0815976im     0.246926-0.157907im     0.0419639-0.0301057im    -0.0140372-0.0223979im      0.0302152-0.181214im        0.102985-0.0410041im   -0.0871782-0.183322im       0.293622-0.221621im      -0.07524-0.0355834im      0.19373-0.0935728im     0.178204-0.0598056im    -0.000299675-0.0909767im    -0.0948628-0.00114396im   -0.0651965+0.141387im      0.0828142+0.0614098im   -0.132563-0.162703im     -0.0833377-0.196158im       -0.13376-0.0627206im      0.246476-0.0315943im    -0.124869-0.0914646im      0.15817-0.0170741im        0.010737+0.0735373im      0.133325+0.0765974im    -0.0276075-0.15918im       0.0855636-0.00459496im    -0.123418-0.0432391im   -0.00376209+0.123748im      -0.214347-0.00380666im     -0.292143+0.0317991im     0.135754-0.0756926im     0.115386+0.0641574im
   -0.140736-0.0555296im     0.0666137+0.201702im     -0.146822-0.0449709im    -0.214932+0.146565im      0.0478136+0.124489im       0.0969785+0.0286747im       0.205751+0.0884501im     0.143734+0.0142278im    -0.0505146+0.104654im      0.102374-0.0270424im   -0.0538058-0.149621im     -0.133138+0.199019im        -0.113334-0.20286im       -0.138775+0.0648175im    0.00712331+0.126687im      -0.166753-0.226871im     0.158586-0.0241797im    -0.0896928-0.0302751im    -0.0461952-0.0310267im    -0.0112019-0.0764099im     -0.28244+0.0143724im    0.0221646+0.0298338im       -0.109605-0.157742im       -0.12913+0.0293055im   -0.00399299-0.0724238im      0.157394+0.0067624im      0.142536+0.0159434im    -0.0458215+0.034053im      -0.130373-0.276621im      -0.0471422+0.17171im     -0.0493832-0.243213im      0.150087+0.1369im
  -0.0221679-0.228258im       0.048705-0.169084im     -0.135691+0.161036im    -0.0871446+0.145962im     -0.0574096-0.0360641im     -0.0350213-0.224973im        0.213741+0.127769im    -0.0627262+0.137434im        0.17747-0.169191im     -0.195767+0.0596805im    0.0572749-0.0523829im    0.0197268+0.00185307im      -0.111202+0.159915im      -0.152966-0.0222173im     0.0969032-0.108883im    -0.00984151+0.106436im     0.161551+0.0401034im     0.0437603-0.292597im       0.119672-0.0483292im     0.0133221+0.188935im       0.17719+0.0945456im   -0.0522198+0.235393im         0.280579-0.253462im      -0.122027-0.0885431im      0.024942-0.0538774im   -0.00601536-0.0775268im    -0.0677851+0.044115im       0.124285+0.0150529im     0.0534033-0.00525962im    -0.0442419-0.0248419im    -0.116616-0.0962103im    0.0835095-0.000876767im
     0.11124-0.327018im      0.0589528+0.092933im     0.0222236-0.00778063im   -0.050156-0.00571612im    -0.107264+0.0673785im      0.0375936-0.0356215im      -0.105641-0.240991im      0.228652+0.0189097im     0.0620054+0.204335im    -0.0904704+0.131155im      0.286548+0.16698im      0.0483265+0.142255im        -0.131885-0.0732505im      0.148714+0.080063im      -0.025947-0.105429im     -0.0571443-0.0510139im  -0.0541436+0.227885im     -0.0639583-0.125372im      0.0257897+0.226037im       -0.11117-0.0998744im     0.152682-0.0298422im     0.212567-0.00720365im      -0.106624+0.0860206im     -0.260908+0.186832im     -0.0333122-0.0284428im      0.121575-0.0163448im      -0.12775+0.0231916im    -0.0349521+0.0049555im       0.10453+0.121841im       -0.177125+0.0689221im    -0.069956-0.0283835im    -0.084316-0.0515059im
 -0.00242845+0.0400425im    -0.0676988-0.0303359im   -0.0184371-0.0929139im     0.095107-0.203898im      -0.162097-0.281866im       0.0888552+0.0459108im      0.0852506+0.00394314im    0.187494-0.0209951im     -0.133231-0.0381314im     0.104843-0.114704im      0.186665-0.00135331im   -0.194898-0.260834im       -0.0444376-0.049645im     -0.0678234+0.00500205im     0.172299-0.0299481im     -0.208968+0.024722im     0.259247-0.00226864im    0.0140375-0.110566im      0.0368563-0.111079im     -0.0309955+0.189104im    -0.0310328-0.171396im     0.0131283-0.0404352im      -0.0945646+0.207003im     -0.0815115-0.121352im        0.10502-0.137467im     -0.0230572-0.142044im      -0.131974-0.0589202im      0.125526+0.00654823im    -0.173387-0.0534539im       0.013642+0.211697im    -0.0665735+0.0329837im    -0.107715-0.298015im
   0.0952908+0.0392061im     0.0126354+0.0694853im   -0.0748871-0.218483im     0.0715742-0.132411im       0.100798-0.0206378im      -0.116296-0.144616im       -0.223145+0.0755894im     0.127751+0.0978545im     -0.126853+0.183388im    -0.0274385-0.170033im     0.0829012+0.10053im       0.045305-0.164604im       -0.0995508+0.14909im        0.185221+0.0532035im    -0.0507938+0.0279909im      0.268539-0.0362893im    0.141004-0.0328233im   -0.00790405+0.0700583im      -0.14668-0.235998im      0.0248096+0.268708im    -0.0517624+0.276436im     0.0904202+0.0362979im        0.144831-0.226329im     -0.0442666+0.235192im      -0.113648+0.0322066im     0.0891676+0.133054im     -0.0771373+0.0355669im     -0.118449-0.0397516im    -0.0798313-0.0915396im     0.00508913+0.0969724im   -0.0512834-0.0620545im     0.126212-0.0856508im
   0.0046152-0.00265833im     -0.13259+0.0454289im    0.0640877+0.0818457im    0.0418332-0.0179745im    -0.0625134-0.091076im       -0.126617-0.130996im      -0.0802208+0.119327im       0.22297-0.169233im       0.111042+0.0773979im    -0.110251-0.031841im    0.00102549+0.14258im     -0.0497559-0.103475im        0.0413959-0.0372527im      -0.10429+0.0235374im      0.115255+0.0577531im     0.0184983+0.135644im    -0.025406+0.143517im    -0.00724751+0.118209im       0.139617+0.0338507im      0.294694-0.0112139im   -0.0297995+0.114848im    -0.0313294+0.132276im       -0.0629746+0.219643im     -0.0199228-0.162807im       -0.28009+0.123791im      0.0311434+0.0305177im      0.368889+0.0722173im      0.152183-0.20346im       0.0837048-0.0387975im      -0.146755+0.204286im     -0.149228+0.0565515im     0.130292+0.194507im
   0.0429727-0.0539649im      0.136903-0.0535396im    0.0437016+0.238803im    -0.0657559-0.122344im       0.172548+0.280082im        0.225662-0.0516959im    -0.00798137+0.108429im     -0.102671+0.028247im      -0.142153+0.100126im      0.205209-0.181228im     0.0203789-0.155273im     0.0185461-0.0916838im      -0.0291457+0.401216im       0.138704-0.0454765im     0.0547424-0.00445343im    0.0943628-0.0906135im   0.0414213+0.0502014im     -0.127943-0.216772im    -0.00562294+0.0743631im      0.175159-0.115609im    -0.0820739-0.0246425im   -0.0246393+0.0987002im        -0.14136+0.133587im     -0.0933748-0.127916im       -0.15212+0.160072im     -0.0288643-0.0754207im   -0.00239288-0.19807im       0.0263593-0.066191im    -0.00504001-0.0539941im      -0.188879-0.0660433im    0.0670941-0.00146042im  -0.0215181-0.15283im
    0.241048+0.0733768im   -0.00142678-0.18134im      -0.140552+0.0877304im   -0.0716352-0.0352154im    -0.0503868-0.119995im      -0.0885399+0.0471874im      0.0652954+0.0514105im    -0.156221+0.0681778im    -0.0656108+0.119576im     0.0430096-0.0976159im   -0.0877304-0.31932im       0.113553+0.00184191im       0.108848-0.0923142im      0.093482-0.048113im      0.0625854+0.0301092im     -0.121344+0.258737im    0.0562095+0.0457535im     0.0771863-0.076357im      0.0803197-0.0459732im    -0.0631869-0.0338383im     0.121574+0.0315178im     0.145208-0.229217im        -0.176795-0.11883im       -0.091214-0.00694646im    -0.155905-0.183428im       0.230516+0.137805im      -0.121213-0.110266im      -0.128878-0.161964im       0.113606-0.0447562im      -0.076788+0.171027im     0.0395884+0.241815im     0.0703817+0.218333im
   -0.144037+0.0143006im      0.127099-0.145147im      0.040478+0.159421im     -0.086562-0.326853im      0.0568163-0.121849im        -0.11545-0.000167656im    0.0246448-0.00633685im     0.38027+0.00877532im    0.0391206-0.142187im      -0.16137+0.0815942im    -0.119737-0.12194im      -0.133557+0.0213758im       -0.185645-0.0285346im      0.205125+0.091627im     0.00843497-0.110821im     -0.0186906-0.104847im   -0.0571423-0.160025im      0.0262029-0.0634013im     0.0268303-0.0492266im    -0.0437025+0.00667932im   -0.145669+0.0524131im    0.0423987-0.113002im       -0.0159652+0.150542im       0.131625-0.0467074im     0.0847473-0.0180592im    -0.0528508+0.112465im      -0.153313-0.141654im     -0.0297389-0.122422im       0.236994+0.0423833im     -0.0564585-0.189827im     0.0306001-0.153132im      0.278214+0.106406im
   0.0426217-0.0690372im    -0.0684669+0.00138996im  0.00913658+0.0590459im     0.247064-0.18909im        0.144254-0.0817581im     -0.0867065-0.0292655im       0.266099-0.132875im    -0.0843003-0.0697167im      -0.14038+0.284599im     0.0728164+0.244083im     0.0592282-0.119088im     0.0439163+0.000791156im    -0.0349285+0.0647354im     -0.305492+0.092521im      0.0740718+0.0260488im    -0.0861848+0.0202679im   0.0318249-0.0150444im    0.00169057+0.132061im      -0.154277+0.0908976im      0.159654-0.00256098im   0.0172874+0.037247im     -0.270304-0.124671im         0.203567+0.068859im      -0.018461+0.273377im     0.00298315+0.0499006im      0.124715+0.0688133im    -0.0677143-0.0962895im      0.157359+0.0888531im      0.234754-0.139406im      -0.0727955-0.0660882im    0.0307489-0.048028im    0.00199672-0.0316362im
  -0.0347794-0.00749683im   -0.0985593+0.124459im     -0.142292-0.0440887im    0.0583571-0.132893im      0.0347227-0.125213im        0.018084-0.109435im        0.182489+0.17644im      0.0380552-0.0212376im     0.0597002-0.0225481im      0.23832+0.133705im      0.123135+0.111651im      0.219061-0.0521172im      -0.0802604-0.105124im       0.103253-0.135547im      -0.181182-0.25624im       0.0382553+0.28964im      0.113999-0.117011im      -0.191143+0.12036im       -0.110495+0.169803im    -0.00144473-0.123922im    -0.0136847+0.248614im     0.0100721-0.0306758im        -0.14125-0.100116im     -0.0408993-0.271465im      0.0260834+0.074628im      -0.144317-0.145367im     -0.0779167-0.00838869im     -0.12515+0.0122379im     0.0630381-0.0435166im      0.0137273+0.020485im     0.0918822-0.189655im     -0.120046+0.0967345im
 -0.00971215+0.013046im     -0.0166087-0.151667im      0.124562+0.0431463im   -0.0125515+0.172619im     -0.0850092-0.121022im      -0.0808649-0.0385718im      -0.249388-0.0324083im    -0.100031-0.0914594im     -0.200936+0.00284522im  -0.0870112+0.0107224im   -0.0336078-0.142737im    -0.0820719-0.10887im         -0.075465-0.224862im      -0.125309+0.115115im      -0.275593-0.00869043im    0.0569899-0.151862im     0.171064+0.0726488im    -0.0257281-0.101706im     -0.0396843+0.260396im       0.113808+0.122202im      -0.10277+0.241467im     0.0448067+0.263689im       -0.0909246+0.0739292im     0.0666411-0.0331254im   -0.00310807+0.0233601im      0.045857-0.174047im      -0.164605-0.228213im     -0.0900285+0.205203im      0.0901555-0.102242im       0.0884536-0.0552753im   -0.0414838+0.152047im    -0.0763913+0.130121im
   -0.130226-0.0223325im    -0.0122623-0.204447im     0.0713613+0.0662023im     0.093278-0.148633im     -0.0199156-0.00386582im     0.0498586+0.0117658im       0.203322-0.0744385im   -0.0377876-0.0981904im     0.0908244+0.010315im       0.29554-0.216766im    -0.0590047+0.18367im      -0.120358+0.116712im        -0.149671-0.0123582im    -0.0613789-0.227499im    -0.00350752+0.034838im      0.0356146-0.183156im    -0.049097+0.201788im     -0.0068147+0.145298im      -0.282823-0.0156303im    -0.0495225+0.088461im      0.021138-0.0830726im     0.311735+0.113896im         0.174177-0.0906465im     0.0573593-0.0186695im     -0.160132-0.0514707im     0.0718563-0.200594im       -0.10906+0.00938784im     0.082908-0.0790697im     0.0920872+0.141299im       0.0783139+0.0741386im    0.0533759+0.10436im      0.0855976+0.206829im
   0.0385397+0.150575im     -0.0491282+0.297335im      0.200615+0.0936512im    -0.185283+0.110044im      0.0520064+0.0775503im      0.0148574-0.239593im       0.0707045+0.0631155im    -0.105046+0.0215694im   -0.00851522-0.0705612im    0.0561659-0.0535429im    0.0226989+0.0339062im   -0.0065027-0.0376733im       -0.303939-0.0880803im  -0.000765526+0.0756745im     0.0963231-0.170172im     -0.0375524-0.169773im   -0.0756496-0.1021im       -0.0346773+0.0370251im     0.0496465-0.0892449im    -0.0418362+0.135233im      0.108171+0.0263644im   -0.0746979-0.0362685im       -0.173812-0.0703732im      0.156732-0.0466122im      0.108778+0.209394im        0.19154+0.195188im      -0.174583+0.0658298im      0.235111-0.0444737im      0.213477+0.0808389im      0.0196667+0.225382im     0.0658815+0.181241im      -0.14245-0.0227892im
   0.0349727-0.164517im     -0.0246566+0.0183635im   -0.0942991-0.114534im     -0.133929+0.122274im     -0.0148298-0.107226im        0.194441+0.0138676im      0.0403044+0.0667173im     0.163304+0.0957896im    -0.0957871+0.0338763im   -0.0310203+0.0307342im    -0.033031+0.0261518im     0.161196+0.204076im        0.0868996+0.116151im      -0.151734-0.0067336im     -0.240453+0.0492747im      0.189488-0.0375949im    -0.13484-0.171193im       0.155106+0.00615296im    0.0356116+0.0148558im    -0.0255729+0.0346407im    0.0604782+0.054401im      0.118781-0.019184im       0.00184573+0.0907204im      0.208613+0.0416858im    -0.0962629-0.186461im      -0.186992-0.0486402im     0.0361367-0.319066im       0.265638-0.163583im       0.154007-0.096509im       0.0843943+0.286709im      0.139917+0.00968302im  -0.0161153-0.165292im
   -0.106401+0.233095im      0.0585672+0.219251im     0.0956046-0.179004im    -0.0639528+0.159467im      0.0895144+0.138881im        0.126911+0.0828045im     -0.0103438+0.0686443im     0.183816-0.0612827im    -0.0521215+0.299707im     -0.054501+0.0990355im    0.0599373-0.151728im     -0.135162-0.244751im           0.1121+0.104202im       -0.25352+0.0133804im     0.0387716-0.136626im      0.0915454+0.195169im   -0.0402758+0.0771958im    -0.0741801-0.0635052im    -0.0631147+0.107303im       -0.16669-0.0213534im     0.131945-0.0646707im     0.028996-0.000712543im     0.0419555-0.0846331im      0.116602-0.124749im     -0.0205722-0.0855685im     0.0150094-0.121099im      -0.181999-0.0289959im     0.0136124-0.055452im     0.00645098+0.24163im        0.0056272-0.077093im    -0.0778927+0.010091im      0.310343+0.0823373im</code></pre><p>and then generate the state <span>$ψ$</span></p><pre><code class="language-julia hljs">psi = P[:, 3]</code></pre><pre><code class="nohighlight hljs">32-element Vector{ComplexF64}:
  0.021030952787276465 - 0.019260925872622632im
   0.06905096356171402 + 0.11007299443564894im
  -0.11412595122230135 + 0.03157605402694156im
  -0.18086509819226154 + 0.04141295739104413im
  -0.04221036632026508 + 0.24237212316693563im
   0.10540205264503583 + 0.0025237813702154027im
   -0.1164520923456841 - 0.022150696794201973im
  -0.19760825244143707 + 0.14112903762811824im
 -0.022170924757046545 - 0.08363666887727349im
   0.10095868391480285 + 0.10661401726210111im
   0.08811731833698891 + 0.03970013245910951im
  -0.07378346484579475 - 0.30444396119096817im
   -0.1313409476233002 + 0.03268263008094427im
  -0.04201301572295048 - 0.07423328692853301im
   0.08393405365081794 - 0.11031752469610412im
  -0.04093401492598317 - 0.04819668268209165im
  -0.14070805984466941 + 0.027928938264531064im
   0.46967507975133793 + 0.0im
  0.023659094782829244 - 0.06833408030460686im
  -0.15258600374504538 + 0.027116302294178107im
  0.019395300083227082 - 0.057340362509625833im
  0.012438939139456297 - 0.04473881694067412im
   0.08392296752518037 - 0.1355966633281702im
    0.1977952400968136 + 0.07397767582221214im
  -0.14372802177159572 + 0.040189729110510136im
   -0.2566222308507614 - 0.08971859772552697im
  -0.17509822123588017 - 0.07194415808242108im
  -0.06005580656582302 + 0.02429062058476922im
   -0.1195669786010486 + 0.08321104652548084im
   0.10451854722185469 - 0.09530824264916778im
  -0.17727696151861552 + 0.20177689028594697im
 -0.010776002731196478 - 0.08892860833663976im</code></pre><p>In the phase estimation process, we will feed the state to circuit and measure the first <code>n</code> qubits processed by iQFT.</p><pre><code class="language-julia hljs">r = join(ArrayReg(psi), zero_state(N))
r |&gt; PE(N, M, U)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 8/8
    nlevel: 2</code></pre><p>Since our phase can be represented by 3 qubits precisely, we only need to measure once</p><pre><code class="language-julia hljs">results = measure(r, 1:N; nshots=1)</code></pre><pre><code class="nohighlight hljs">1-element Vector{BitBasis.BitStr64{3}}:
 011 ₍₂₎</code></pre><p>Recall that our QFT&#39;s bit numbering is reversed, let&#39;s reverse it back</p><pre><code class="language-julia hljs">using BitBasis
estimated_phase = bfloat(results[]; nbits=N)</code></pre><pre><code class="nohighlight hljs">0.75</code></pre><p>the phase is exactly <code>0.75</code>!</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../1.prepare-ghz-state/index.html">« Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a><a class="docs-footer-nextpage" href="../3.grover-search/index.html">Grover Search »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.16 on <span class="colophon-date" title="Friday 29 April 2022 03:13">Friday 29 April 2022</span>. Using Julia version 1.7.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
