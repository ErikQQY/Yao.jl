<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quantum Fourier Transformation and Phase Estimation · Documentation | Yao</title><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/indigo.css" rel="stylesheet" type="text/css"/><link href="https://yaoquantum.org/assets/favicon-light.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../index.html"><img src="../../../assets/logo.png" alt="Documentation | Yao logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../index.html">Documentation | Yao</a></span></div><form class="docs-search" action="../../../search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../index.html">Home</a></li><li><span class="tocitem">Quick Start</span><ul><li><a class="tocitem" href="../1.prepare-ghz-state/index.html">Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a></li><li class="is-active"><a class="tocitem" href="index.html">Quantum Fourier Transformation and Phase Estimation</a><ul class="internal"><li><a class="tocitem" href="#Quantum-Fourier-Transformation"><span>Quantum Fourier Transformation</span></a></li><li><a class="tocitem" href="#Wrap-QFT-to-an-external-block"><span>Wrap QFT to an external block</span></a></li><li><a class="tocitem" href="#Phase-Estimation"><span>Phase Estimation</span></a></li></ul></li><li><a class="tocitem" href="../3.grover-search/index.html">Grover Search</a></li><li><a class="tocitem" href="../4.shor-algorithm/index.html">Shor&#39;s Algorithm</a></li><li><a class="tocitem" href="../5.shor-9-code/index.html">Shor&#39;s 9 qubit code</a></li><li><a class="tocitem" href="../6.quantum-circuit-born-machine/index.html">Quantum Circuit Born Machine</a></li><li><a class="tocitem" href="../7.variation-quantum-eigen-solver/index.html">Variational Quantum Eigen Solver</a></li></ul></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../../man/array_registers.html">Array Registers</a></li><li><a class="tocitem" href="../../../man/symbolic.html">Symbolic Computation</a></li><li><a class="tocitem" href="../../../man/blocks.html">Blocks</a></li><li><a class="tocitem" href="../../../man/automatic_differentiation.html">Automatic Differentiation</a></li><li><a class="tocitem" href="../../../man/simplification.html">Simplification</a></li><li><a class="tocitem" href="../../../man/base.html">Base</a></li><li><a class="tocitem" href="../../../man/registers.html">Abstract Registers</a></li><li><a class="tocitem" href="../../../man/bitbasis.html">BitBasis</a></li><li><a class="tocitem" href="../../../man/extending_blocks.html">Extending Blocks</a></li></ul></li><li><a class="tocitem" href="../../../benchmarks.html">Benchmark</a></li><li><a class="tocitem" href="../../../dev/index.html">Developer Notes</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Quick Start</a></li><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/QuantumBFS/Yao.jl/blob/master/docs/src/quick-start/2.qft-phase-estimation/main.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><p><a href="https://mybinder.org/v2/gh/QuantumBFS/Yao.jl/gh-pages?filepath=dev/generated/quick-start/2.qft-phase-estimation/main.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a> <a href="https://nbviewer.jupyter.org/github/QuantumBFS/Yao.jl/blob/gh-pages/dev/generated/quick-start/2.qft-phase-estimation/main.ipynb"><img src="https://img.shields.io/badge/show-nbviewer-579ACA.svg" alt/></a> <a href="https://minhaskamal.github.io/DownGit/#/home?url=https://github.com/QuantumBFS/tutorials/tree/gh-pages/dev/generated/quick-start/2.qft-phase-estimation"><img src="https://img.shields.io/badge/download-project-orange" alt/></a></p><h1 id="example-qft"><a class="docs-heading-anchor" href="#example-qft">Quantum Fourier Transformation and Phase Estimation</a><a id="example-qft-1"></a><a class="docs-heading-anchor-permalink" href="#example-qft" title="Permalink"></a></h1><p>Let&#39;s use Yao first</p><pre><code class="language-julia hljs">using Yao</code></pre><h2 id="Quantum-Fourier-Transformation"><a class="docs-heading-anchor" href="#Quantum-Fourier-Transformation">Quantum Fourier Transformation</a><a id="Quantum-Fourier-Transformation-1"></a><a class="docs-heading-anchor-permalink" href="#Quantum-Fourier-Transformation" title="Permalink"></a></h2><p>The Quantum Fourier Transformation (QFT) circuit is to repeat two kinds of blocks repeatly:</p><p><img src="assets/qft.png" alt="qft-circuit"/></p><p>The basic building block control phase shift gate is defined as</p><p class="math-container">\[R(k)=\begin{bmatrix}
1 &amp; 0\\
0 &amp; \exp\left(\frac{2\pi i}{2^k}\right)
\end{bmatrix}\]</p><p>Let&#39;s define block <code>A</code> and block <code>B</code>, block <code>A</code> is actually a control block.</p><pre><code class="language-julia hljs">A(i, j) = control(i, j=&gt;shift(2π/(1&lt;&lt;(i-j+1))))</code></pre><pre><code class="nohighlight hljs">A (generic function with 1 method)</code></pre><p>Once you construct the blockl you can inspect its matrix using <code>mat</code> function. Let&#39;s construct the circuit in dash box A, and see the matrix of <span>$R_4$</span> gate.</p><pre><code class="language-julia hljs">R4 = A(4, 1)</code></pre><pre><code class="nohighlight hljs">(n -&gt; control(n, 4, 1 =&gt; shift(0.39269908169872414)))</code></pre><p>If you have read about <a href="generated/quick-start/2.qft-phase-estimation/@ref example-ghz">preparing GHZ state</a>, you probably know that in Yao, we could just leave the number of qubits, and it will be evaluated when possible.</p><pre><code class="language-julia hljs">R4(5)</code></pre><pre><code class="nohighlight hljs">nqubits: 5
control(4)
└─ (1,) shift(0.39269908169872414)</code></pre><p>its matrix will be</p><pre><code class="language-julia hljs">mat(R4(5))</code></pre><pre><code class="nohighlight hljs">32×32 LinearAlgebra.Diagonal{ComplexF64, Vector{ComplexF64}}:
 1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im</code></pre><p>Then we repeat this control block over and over on different qubits, and put a Hadamard gate to <code>i</code>th qubit to construct <code>i</code>-th <code>B</code> block.</p><pre><code class="language-julia hljs">B(n, k) = chain(n, j==k ? put(k=&gt;H) : A(j, k) for j in k:n)</code></pre><pre><code class="nohighlight hljs">B (generic function with 1 method)</code></pre><p>We need to input the total number of qubits <code>n</code> here because we have to iterate through from <code>k</code>-th location to the last.</p><p>Now, let&#39;s construct the circuit by chaining all the <code>B</code> blocks together</p><pre><code class="language-julia hljs">qft(n) = chain(B(n, k) for k in 1:n)
qft(4)</code></pre><pre><code class="nohighlight hljs">nqubits: 4
chain
├─ chain
│  ├─ put on (1)
│  │  └─ H
│  ├─ control(2)
│  │  └─ (1,) shift(1.5707963267948966)
│  ├─ control(3)
│  │  └─ (1,) shift(0.7853981633974483)
│  └─ control(4)
│     └─ (1,) shift(0.39269908169872414)
├─ chain
│  ├─ put on (2)
│  │  └─ H
│  ├─ control(3)
│  │  └─ (2,) shift(1.5707963267948966)
│  └─ control(4)
│     └─ (2,) shift(0.7853981633974483)
├─ chain
│  ├─ put on (3)
│  │  └─ H
│  └─ control(4)
│     └─ (3,) shift(1.5707963267948966)
└─ chain
   └─ put on (4)
      └─ H
</code></pre><h2 id="Wrap-QFT-to-an-external-block"><a class="docs-heading-anchor" href="#Wrap-QFT-to-an-external-block">Wrap QFT to an external block</a><a id="Wrap-QFT-to-an-external-block-1"></a><a class="docs-heading-anchor-permalink" href="#Wrap-QFT-to-an-external-block" title="Permalink"></a></h2><p>In most cases, <code>function</code>s are enough to wrap quantum circuits, like <code>A</code> and <code>B</code> we defined above, but sometimes, we need to dispatch specialized methods on certain kinds of quantum circuit, or we want to define an external block to export, thus, it&#39;s useful to be able to wrap circuit to custom blocks.</p><p>First, we define a new type as subtype of <code>PrimitiveBlock</code> since we are not going to use the subblocks of <code>QFT</code>, if you need to use its subblocks, it&#39;d be better to define it under <code>CompositeBlock</code>.</p><pre><code class="language-julia hljs">struct QFT &lt;: PrimitiveBlock{2}
    n::Int
end

YaoBlocks.nqudits(q::QFT) = q.n</code></pre><p>Now, let&#39;s define its circuit</p><pre><code class="language-julia hljs">circuit(q::QFT) = qft(q.n)</code></pre><pre><code class="nohighlight hljs">circuit (generic function with 1 method)</code></pre><p>And forward <code>mat</code> to its circuit&#39;s matrix</p><pre><code class="language-julia hljs">YaoBlocks.mat(::Type{T}, x::QFT) where T = mat(T, circuit(x))</code></pre><p>You may notice, it is a little ugly to print <code>QFT</code> at the moment, this is because we print the type summary by default, you can define your own printing by overloading <code>print_block</code></p><pre><code class="language-julia hljs">YaoBlocks.print_block(io::IO, x::QFT) = print(io, &quot;QFT($(x.n))&quot;)</code></pre><p>Since it is possible to use FFT to simulate the results of QFT (like cheating), we could define our custom <code>apply!</code> method:</p><pre><code class="language-julia hljs">using FFTW, LinearAlgebra

function YaoBlocks.apply!(r::ArrayReg, x::QFT)
    α = sqrt(length(statevec(r)))
    invorder!(r)
    lmul!(α, ifft!(statevec(r)))
    return r
end</code></pre><p>Now let&#39;s check if our <code>apply!</code> method is correct:</p><pre><code class="language-julia hljs">r = rand_state(5)
r1 = r |&gt; copy |&gt; QFT(5)
r2 = r |&gt; copy |&gt; circuit(QFT(5))
r1 ≈ r2</code></pre><pre><code class="nohighlight hljs">true</code></pre><p>We can get iQFT (inverse QFT) directly by calling <code>adjoint</code></p><pre><code class="language-julia hljs">QFT(5)&#39;</code></pre><pre><code class="nohighlight hljs"> [†]QFT(5)</code></pre><p>QFT and iQFT are different from FFT and IFFT in three ways,</p><ol><li>they are different by a factor of <span>$\sqrt{2^n}$</span> with <span>$n$</span> the number of qubits.</li><li>the <a href="https://quantumbfs.github.io/BitBasis.jl/stable/tutorial/#Conventions-1">bit numbering</a> will exchange after applying QFT or iQFT.</li><li>due to the convention, QFT is more related to IFFT rather than FFT.</li></ol><h2 id="Phase-Estimation"><a class="docs-heading-anchor" href="#Phase-Estimation">Phase Estimation</a><a id="Phase-Estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Phase-Estimation" title="Permalink"></a></h2><p>Since we have QFT and iQFT blocks we can then use them to realize phase estimation circuit, what we want to realize is the following circuit:</p><p><img src="assets/phaseest.png" alt="phase estimation"/></p><p>First we call Hadamard gates repeatly on first <code>n</code> qubits.</p><pre><code class="language-julia hljs">Hadamards(n) = repeat(H, 1:n)</code></pre><pre><code class="nohighlight hljs">Hadamards (generic function with 1 method)</code></pre><p>Then in dashed box <code>B</code>, we have controlled unitaries:</p><pre><code class="language-julia hljs">ControlU(n, m, U) = chain(n+m, control(k, n+1:n+m=&gt;matblock(U^(2^(k-1)))) for k in 1:n)</code></pre><pre><code class="nohighlight hljs">ControlU (generic function with 1 method)</code></pre><p>each of them is a <code>U</code> of power <span>$2^{(k-1)}$</span>.</p><p>Since we will only apply the qft and Hadamard on first <code>n</code> qubits, we could use <code>Subroutine</code>, which creates a context of a sub-scope of the qubits.</p><pre><code class="language-julia hljs">PE(n, m, U) =
    chain(n+m, # total number of the qubits
        subroutine(Hadamards(n), 1:n), # apply H in local scope
        ControlU(n, m, U),
        subroutine(QFT(n)&#39;, 1:n))</code></pre><pre><code class="nohighlight hljs">PE (generic function with 1 method)</code></pre><p>we use the first <code>n</code> qubits as the output space to store phase <span>$ϕ$</span>, and the other <code>m</code> qubits as the input state which corresponds to an eigenvector of oracle matrix <code>U</code>.</p><p>The subroutine here uses <code>focus!</code> and <code>relax!</code> to manage a local scope of quantum circuit, and only activate the first <code>n</code> qubits while applying the block inside the subroutine context, and the scope will be <code>relax!</code>ed back, after the context. This is equivalent to manually <code>focus!</code> then <code>relax!</code></p><p>fullly activated</p><pre><code class="language-julia hljs">r = rand_state(5)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qudits: 5/5
    nlevel: 2</code></pre><p>first 3 qubits activated</p><pre><code class="language-julia hljs">focus!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qudits: 3/5
    nlevel: 2</code></pre><p>relax back to the original</p><pre><code class="language-julia hljs">relax!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qudits: 5/5
    nlevel: 2</code></pre><p>In this way, we will be able to apply small operator directly on the subset of the qubits.</p><p>Details about the algorithm can be found here: <a href="https://en.wikipedia.org/wiki/Quantum_phase_estimation_algorithm">Quantum Phase Estimation Algorithm</a></p><p>Now let&#39;s check the results of our phase estimation.</p><p>First we need to set up a unitary with known phase, we set the phase to be 0.75, which is <code>0.75 * 2^3 == 6 == 0b110</code> .</p><pre><code class="language-julia hljs">N, M = 3, 5
P = eigen(rand_unitary(1&lt;&lt;M)).vectors
θ = Int(0b110) / 1&lt;&lt;N
phases = rand(1&lt;&lt;M)
phases[0b010+1] = θ
U = P * Diagonal(exp.(2π * im * phases)) * P&#39;</code></pre><pre><code class="nohighlight hljs">32×32 Matrix{ComplexF64}:
   0.133357-0.222585im      0.0428951+0.200477im       0.146183-0.254132im      0.0049323+0.287782im     0.0356765-0.0440474im    0.0479448-0.123035im       0.0858292-0.119979im      -0.103618+0.0904171im     -0.113639+0.0583im        -0.0172101-0.023171im     -0.080637+0.117068im    -0.027607-0.0992691im      0.0910011-0.140824im      -0.170184-0.0571694im   -0.0522898+0.0889134im     -0.100458+0.160308im     0.0669804-0.0439161im     0.045821+0.0898112im    0.000288233+0.207133im     0.101141-0.0400044im      0.135273+0.258512im      0.0550865-0.0437654im    0.0261339-0.00699931im  -0.0971679+0.171259im     0.0317589+0.0448769im     -0.189804-0.147229im       0.086646+0.0866443im    -0.0768796+0.156649im      0.133349-0.176043im     0.0951132+0.234411im     -0.238306+0.0809667im     0.0236374-0.148405im
   0.167765-0.0401263im    -0.0219294-0.214824im      -0.188271+0.0955565im    -0.0680933-0.07123im       0.110086+0.0997765im   -0.0697875+0.0418868im      -0.212143+0.148287im     0.00965429-0.0623302im   -0.00124934-0.0966964im      0.0491664-0.142148im     -0.171884+0.14493im    -0.0921011-0.0752745im      0.0269153-0.0447527im     0.0625414-0.0489088im    0.0692991-0.00884923im     0.128574+0.199675im      -0.26296-0.261489im     -0.123232-0.180211im        0.171046-0.0595476im   0.0916268-0.168133im     -0.0181905+0.0796361im      0.181366-0.115935im      0.128763-0.0159149im    -0.347397-0.0295965im     0.126185+0.0811632im     0.0325173-0.0392634im     0.0480434+0.0486799im     -0.069497-0.0315028im   -0.0672003+0.0191905im     0.165728+0.0266251im   -0.0131798+0.0590161im      0.290024-0.0133271im
   0.032831-0.0935215im     -0.169419-0.158365im       0.163008-0.34271im        0.180322-0.00243565im   0.0421207-0.0266818im    -0.106197-0.0404029im     0.00781609+0.00738311im     0.111648-0.0778104im     -0.176442-0.0389427im       0.176116-0.0217124im    -0.102113-0.177803im   -0.0191437-0.000131825im     0.170209+0.0430994im      0.147254+0.117752im    -0.0949428-0.289874im        0.02214+0.110053im     0.0465634+0.18001im     -0.0456878+0.0539583im       0.232742-0.0351655im   -0.242234+0.0431116im     0.0234252-0.0624022im     -0.198295+0.0113273im    -0.164632-0.0328734im    -0.167301-0.248401im     0.0537687+0.110538im      -0.196508+0.0641494im     0.0230234-0.00870515im   -0.0138924-0.0361214im     0.128026-0.00348317im   0.0128333-0.0350888im     0.126636-0.0444664im     0.0970786-0.157456im
 -0.0582621+0.0299681im      0.116268+0.094269im       0.081846+0.0662886im     0.0592302-0.152455im     0.0365609-0.169487im     0.0459956+0.1436im        -0.0823165+0.128071im     0.00925205+0.149767im      -0.191276+0.121125im        0.107771-0.0511411im   -0.0959937-0.0132921im    0.158422-0.420313im        0.135264+0.0737987im     -0.087058+0.0956375im    0.0843075-0.206417im     -0.0934111-0.152323im      0.112472+0.138526im    -0.0454926-0.0603346im     -0.0769759-0.0759925im   -0.109021-0.147019im       0.119473+0.0215975im      0.108275+0.0364928im     0.161452-0.0394206im   -0.0331416+0.065649im     0.0719797+0.107688im        0.14286-0.0658022im    -0.0915183+0.0869051im      0.103676-0.133835im    -0.0970824-0.326918im      0.179084-0.172381im     -0.117879-0.108647im     -0.0472186+0.0501893im
   0.131906+0.029579im    -0.00245827+0.0632104im     0.0132218+0.00781937im   -0.0195523-0.0234768im    -0.150289-0.307234im     -0.132937+0.0202161im      -0.064723-0.0787918im      0.226674-0.106264im      -0.316918-0.164895im       -0.125114+0.0585063im    0.0827826+0.0853337im  -0.0324461+0.00768696im    -0.0232924-0.0140416im      0.242501+0.111101im     0.0255179+0.12623im     -0.00820942-0.0292437im     0.156856-0.0166187im   -0.0847461-0.0271455im      -0.166456-0.0875366im     0.15618-0.224203im       0.259108+0.0158777im    -0.0245741+0.0380355im   -0.0509245-0.0415485im   -0.0374205-0.0997652im     0.147467-0.141539im      0.0456225+0.0507513im     -0.310189-0.035383im      -0.236023-0.0806096im    0.0385774+0.133268im     0.0333899+0.158952im     0.0084762+0.177062im     -0.0771066-0.00523531im
  0.0971578-0.0859176im      0.032871-0.0337045im    0.00699611+0.18035im      0.00127086-0.146716im     0.0653603+0.0568226im     0.229044-0.176205im       -0.181911+0.00010378im  -0.00767293+0.0319742im      0.100582+0.00937246im     0.0743531-0.0295332im  -0.00549385+0.122118im    -0.191931+0.068166im       0.0630904-0.0271338im   -0.00857595-0.100526im    -0.0301191-0.196312im     -0.0211385-0.155276im      0.328628+0.0043626im    -0.237635-0.0651422im        0.27831-0.124827im   -0.0740649+0.0580403im    -0.0312013+0.117434im       0.238693+0.0777726im     -0.14432+0.00706713im    0.239402+0.0713334im   -0.0849977-0.10796im      0.00460165+0.0060897im      -0.11943-0.0426099im    -0.0111743-0.00316617im    0.304458-0.0751791im     0.104212+0.142987im      0.115702+0.192405im     -0.0177882-0.0502937im
   0.227543-0.112909im      0.0324197+0.117931im      -0.157515+0.000117277im   -0.131452+0.292281im     -0.237181-0.110093im    -0.0695541-0.0630349im      0.0912362-0.197417im     -0.0798887-0.01195im      -0.0945009-0.123399im        0.100604+0.0738489im   0.00930102-0.0720987im   0.0664142+0.130443im        0.307218+0.0769373im     -0.212801+0.0244344im   -0.0238025-0.141219im     -0.0991988-0.0290061im  -0.00499655-0.185648im    -0.0830324-0.229798im       0.0492379-0.154127im    -0.170508+0.032233im      -0.193749-0.0992369im    -0.0038684-0.0960425im     0.140344+0.0910491im    0.0573728+0.102565im      0.102179-0.126189im     -0.0404453+0.166023im     -0.0770747-0.167064im      0.0606426-0.0380218im   -0.0696432+0.0815464im    0.0673043-0.213648im    -0.0951289+0.00570357im    0.0306342+0.0550514im
   0.271818-0.113653im      -0.140986-0.036931im       0.017359+0.114945im      0.0667996+0.155262im    -0.0329152+0.0267332im    0.0116738-0.10197im       -0.0542378+0.0120814im      0.169591+0.125071im    -0.00369515+0.193579im       0.0598843-0.063101im     -0.159812+0.043487im   0.00930798+0.194983im       -0.020494+0.136676im      0.0436419-0.185534im      0.311877+0.152058im    0.000102765+0.0638673im    0.0346654+0.137741im     0.0711479+0.082479im      0.00797581-0.117699im    0.0659818+0.173794im       0.216064-0.0959079im     0.0501419+0.0364285im    -0.149916+0.00534608im    -0.14518+0.0417424im    -0.192583+0.148672im     -0.0507331-0.0278964im     -0.198578-0.0530617im     0.0736547-0.0936188im    -0.112395-0.137415im     -0.201186-0.263217im       -0.1396+0.144674im      0.0346877+0.110119im
  0.0269523-0.0996347im        0.2134-0.278772im     -0.0111922-0.0178414im     -0.115372-0.0771807im    -0.195623+0.227442im      -0.18992-0.0309671im       0.296945+0.0584222im     0.0125005+0.0867558im     0.0547778-0.0494922im    -0.00851489+0.0576872im   -0.0503842+0.0258939im   -0.125121+0.0630757im       0.156933-0.0618622im      -0.11131+0.187432im     0.0161615+0.0953062im      0.115751-0.199863im    -0.0503252+0.19498im       0.162052+0.0360176im     -0.0561759-0.216356im   -0.0743793-0.224901im     0.00658049+0.0511045im      0.145965+0.243245im    -0.0730024+0.219517im      -0.01168-0.121986im     0.0483382+0.0331153im      0.111737-0.00550215im    0.0057177+0.0873055im    -0.0216398+0.162215im      0.067265-0.0752768im   -0.0807451+0.0198473im    -0.180561+0.0844673im     0.0583581-0.115081im
 -0.0889135+0.0803833im      0.109878+0.168385im      -0.142344-0.0737332im    -0.0590363-0.192031im       0.22709-0.00943556im    0.110716-0.0740121im       0.153784+0.00878209im   -0.0932289+0.0962808im    -0.0375092+0.0233432im     -0.0214408-0.145346im     0.0292738-0.0907815im  -0.0174459+0.234817im       -0.178976-0.00959395im    0.0254363+0.00489947im   0.0310823-0.253759im      -0.195686+0.121692im     -0.189855-0.0136908im    -0.236669-0.0667458im     -0.0894202+0.16074im     0.0179646-0.0224855im      0.164721-0.158965im     -0.0167027+0.141168im      0.141552+0.164813im    0.00583581-0.12425im       0.143692-0.00557666im   -0.0469402+0.0322029im     -0.238896+0.000924703im  0.00613036+0.187785im      0.162172-0.0518093im    -0.159657-0.143842im     -0.178497+0.135601im       0.127665-0.0638751im
 -0.0316406+0.069714im      0.0078699-0.0676968im      0.188086+0.0434671im     -0.154437-0.0466333im    0.0869229+0.186121im     -0.115499+0.0715405im      -0.207065-0.0213815im     -0.168286+0.302838im      -0.116693+0.0198558im       0.210545-0.0118667im    0.0570183-0.171287im   -0.0775036-0.0811327im      0.0502131+0.0661692im     0.0810459-0.107262im     -0.029449-0.0242912im     0.0504009-0.052215im     -0.101472-0.149488im      0.044351+0.000654897im    -0.176267-0.168879im    0.0954924-0.0667111im    -0.0433351-0.126358im     -0.0422858+0.0698539im    -0.154607-0.075552im     0.0374411+0.143489im      0.143102-0.202865im       -0.42503+0.111892im     -0.0713987-0.0584964im      0.050633-0.00392223im   -0.129167-0.131611im     -0.153651+0.239883im    -0.0287318+0.0267528im   -0.00579905+0.0175399im
  -0.155863-0.285068im      0.0547593-0.0397466im     0.0848269+0.047986im      -0.262056-0.0445893im    0.0467712-0.0694329im   -0.0847385-0.00492306im      0.133478-0.072469im     -0.0812601+0.136933im         0.1965+0.25383im       -0.0433949+0.157475im     -0.082915-0.0782546im    0.225781-0.141746im      -0.0398358-0.14337im        0.274104-0.211002im    -0.0123782+0.119039im      0.0637047-0.0951674im     0.029231-0.00844953im  -0.0980434+0.0141392im      0.0951955+0.0228472im  -0.0791024-0.0212545im    -0.0820501-0.0472678im     -0.048304-0.118045im     0.0632028-0.0238768im    0.0674129-0.154096im     0.0446571+0.274154im      -0.068319+0.107968im      -0.145074-0.204136im      -0.162825-0.0827474im    0.0141845+0.138524im      0.186275+0.00665613im   -0.141359+0.116465im      0.0374288-0.016911im
 -0.0338324-0.0561365im     -0.130138+0.126461im      0.0994569-0.157769im      -0.279139-0.0291545im     0.102081-0.128498im     -0.315427+0.220105im       -0.100516+0.0375604im     -0.119037+0.054479im     -0.0260575-0.042674im       0.0216336+0.320522im    -0.0735952+0.12057im     -0.215082+0.0977444im       0.152645-0.131448im      0.0345238+0.0985442im    0.0867637+0.0490445im     0.0655465+0.079566im    -0.0794228+0.0711628im    -0.231657-0.0563048im       0.196549+0.148125im    0.0778873+0.102426im     0.00440521+0.0363442im    -0.0283412+0.208163im    0.00382516+0.0893195im     0.166408+0.102024im    -0.0340038+0.0743618im      0.113346-0.106988im      -0.013138+0.147593im      0.0860774-0.0256357im   -0.0749477-0.0800653im    -0.111172-0.0737052im      0.14703+0.0243977im    -0.0323895+0.202971im
 0.00588547-0.0489661im    -0.0519661+0.0176023im    -0.0877338-0.0804301im     -0.023096+0.0529855im    0.0890317-0.0121069im   -0.0037637-0.124732im      -0.0418543-0.0166242im      0.274995-0.227376im      -0.120029+0.200397im      -0.0429236-0.011277im     0.0755562-0.0165463im   -0.052184-0.074219im      -0.0693088+0.11519im         0.15833-0.151679im     -0.110699+0.194175im      -0.135706-0.0437809im   -0.0364267-0.0168902im    0.0494162-0.0923436im     -0.0144733-0.160541im   -0.0841663-0.256081im      -0.178912+0.232351im      -0.163386+0.0891002im     0.146316-0.00204087im    0.288873+0.0856584im     0.128968+0.133269im     -0.0256667-0.0315922im     0.0513032-0.00895229im     0.242276+0.0756112im    0.0713644-0.164663im     -0.199898-0.0339704im    0.0864956+0.0275324im       0.28819+0.0708705im
   0.295098+0.0880424im    -0.0745602-0.137198im     -0.0363385-0.137222im       0.193571-0.199615im      -0.15209-0.207737im     0.0627399-0.0353235im      0.0308754+0.0944417im    -0.0982623+0.0953094im      0.134669-0.110928im       0.0927561+0.0574095im   -0.0949257+0.121515im    0.0138692+0.0864699im       0.152497-0.19756im        0.174562-0.183824im      0.122273-0.120954im       0.111728-0.160363im     -0.111854-0.103683im     0.0862314+0.051917im        -0.14725+0.0654927im   -0.038949+0.0057463im    -0.0150612+0.120011im     -0.0785579-0.147548im      0.270684-0.20348im       0.138377-0.0713594im    0.0179012+0.105608im     -0.0216188+0.107422im     -0.0414798+0.0587465im      0.119321+0.228658im     0.0179816-0.0763738im    -0.147348+0.0690629im   0.00631822+0.0117936im     -0.210416+0.0213174im
   0.057524+0.128691im      -0.077846+0.10676im         0.14552+0.240591im       0.165184+0.0272047im   -0.0710575-0.0233501im    0.0353826+0.000707997im     0.160168-0.190061im        0.14675+0.11536im      -0.0226179-0.03975im        -0.169841+0.12262im     -0.0113811-0.11368im     0.0030188-0.0709487im     0.00884851-0.0625478im      0.158503-0.0366167im   -0.0378778-0.176363im       0.160793-0.169019im     -0.131281-0.340188im    0.00888514+0.175785im       0.0444953+0.0557652im   -0.110088+0.195068im       0.207584+0.122475im     -0.0120319+0.270306im    -0.0239777+0.230334im    -0.0180282+0.100763im     0.0461902+0.0470792im     0.0391761+0.0488403im      0.114175+0.0707436im      0.117703-0.0482635im    -0.111038+0.0233394im      0.12031+0.0378273im    0.0350572+0.0628351im      0.277484-0.0507535im
    0.14656+0.0422293im    -0.0543504-0.194081im      0.0127584-0.105917im     -0.0817144+0.191018im    0.00854407+0.00857254im   -0.120893+0.0636214im      0.0902065-0.0127364im     -0.187063-0.0309476im   -0.00267753+0.0411675im    -0.00764697-0.085398im     -0.173103-0.0667083im    0.016621-0.122814im       -0.255053-0.102874im      0.0351497+0.032537im     0.0412376-0.123345im      0.0927152+0.0287477im     0.118501-0.165802im     0.0871306+0.0133504im       0.049377+0.0839082im   0.0994482-0.103069im       0.157468-0.165683im    -0.00308645-0.216721im     -0.178688+0.017592im      0.262168+0.121589im      0.091079-0.0898202im      0.370423+0.0889193im    -0.0444035-0.0754115im      0.129358-0.18216im        0.20133-0.117997im     -0.167492-0.0108932im   -0.0210514-0.135966im       0.115347-0.164989im
 -0.0418709+0.330398im      -0.100133+0.086749im     -0.0455419-0.144334im      -0.129224-0.0325209im    0.0932028+0.079702im      0.140091-0.0919429im      0.0603586-0.088716im      -0.121883+0.00634823im    0.0148525+0.0989303im       0.132818-0.0340939im   -0.0862464+0.140237im     0.343912+0.0474982im        0.18822-0.0301466im    -0.0520622+0.0699884im   -0.0779625+0.0996641im    -0.0399778+0.0290867im    -0.192288-0.120119im      0.111156-0.0861119im      0.0804656-0.21952im     -0.204379-0.142945im       0.250547-0.00798916im   -0.0526717+0.0394793im    -0.164307-0.145051im      0.105131+0.0895377im   -0.0928218+0.0937646im     0.0732638-0.0657993im     0.0139238+0.194534im      -0.143668-0.13168im      0.0405295+0.139425im    -0.0268021+0.0148112im    0.0926174+0.2516im       -0.0517439+0.0218143im
   0.196258+0.0546681im    -0.0725215+0.164081im    0.000835281+0.0228786im      0.113345+0.0801542im     0.185634+0.227535im     -0.266753+0.259086im        0.236229+0.0641902im    -0.0921051+0.0763949im    -0.0694162+0.0343921im      -0.128785-0.130839im      0.203593-0.0483764im   -0.150344-0.113234im       0.0895062+0.126401im     -0.0507967-0.147035im    -0.0927331-0.052872im    -0.00452036+0.0544753im     0.157813-0.0634684im    0.0724749+0.079926im       0.0781074-0.0924528im    0.102748-0.0206893im     0.0321245-0.0681904im     0.0969969+0.125222im      0.224592-0.313957im     0.0680967-0.168368im    -0.0916696+0.0876205im      0.084959+0.129718im       0.091766-0.0745284im     -0.110719+0.0613784im    0.0709341+0.0392282im    0.0335248-0.102816im     0.0886975+0.218699im     -0.0418782+0.0380547im
 -0.0794795+0.0443596im     -0.205237-0.0391937im     0.0615261+0.161233im      0.0176509+0.128825im     -0.216758-0.0222682im     0.192915-0.195724im      -0.0429634+0.0485381im     -0.192249+0.164556im     -0.0948412+0.000392007im    -0.185508-0.0621387im    -0.128675-0.284468im    -0.110896+0.148233im      -0.0279411-0.27843im       0.0156854+0.0131102im    0.0869607+0.0212001im     -0.158103+0.0870275im    0.0654675+0.114639im      0.107704-0.183054im         0.07675-0.0438529im    0.158668-0.168629im      -0.108433-0.096673im     -0.0601607+0.206526im      0.141742-0.0590112im    0.0148875+0.0215544im     0.121295+0.177965im      0.0309071+0.0232438im      0.059286+0.0749204im     -0.157295-0.0522085im    -0.119315-0.100423im     0.0767111-0.022976im      0.244686-0.0037175im    -0.0408649-0.139428im
 0.00682345-0.0442606im     -0.122566+0.22514im      -0.0150323-0.0802425im     0.0358819-0.0167993im   -0.0274578+0.18403im       0.243832-0.0827256im      0.0481209+0.25135im       0.0505497+0.134978im       0.094665-0.0823302im     0.00484126+0.304972im     0.0221335+0.0824453im  -0.0142278-0.130716im        0.143834+0.0542598im      0.110825+0.184948im     0.0995184+0.293342im      -0.127246-0.0158391im    0.0760485-0.0901248im    -0.202469+0.0606868im     -0.0244066-0.0582716im   0.0884171-0.0128638im    -0.0261841-0.277711im     -0.0791238-0.0792871im    0.0364874-0.0443487im    -0.143118-0.0879802im    0.0449144-0.0835471im     0.0912312+0.191739im       0.114844+0.0432809im      0.288882-0.0733445im     0.114203-0.0240962im   -0.0128823+0.0598957im   -0.0355685+0.0684375im      0.089613-0.198071im
  -0.175418-0.178148im       0.230399+0.100077im      0.0360667-0.0117862im     -0.186575+0.11223im     -0.0222363+0.0258751im     0.132034-0.0704427im     -0.0580206+0.0331287im      -0.14321+0.0580678im     -0.212124+0.00387608im     -0.166231-0.0598456im    -0.195838+0.17154im     -0.117863+0.0155862im    -0.00952323+0.3204im          0.20924+0.0904292im     0.156552-0.139978im     -0.0320279-0.0936925im    -0.105574-0.0218972im     0.184867-0.0339902im      0.0194684-0.0330559im  -0.0974831+0.177659im       0.104155+0.153241im       0.011147-0.105515im     0.0528568-0.00290188im  -0.0618194-0.10544im      0.0457373+0.0186828im      0.115663+0.267436im       0.221334-0.0575957im     -0.122879+0.00678502im   0.0444559-0.0218562im    -0.192277+0.092664im      0.162195+0.0184359im     -0.069732+0.140552im
  0.0720066-0.0405445im     -0.145066-0.0455782im    -0.0141508+0.0130183im     -0.162396-0.105761im     0.0639164-0.0202663im    0.0484659-0.0314498im      -0.252288-0.288709im     -0.0216587+0.0468516im     0.0364964+0.0772866im      0.0369414+0.115097im      0.149542+0.219807im    -0.123435+0.0989034im      -0.093445+0.0616752im    -0.0617908+0.22355im      0.0856007-0.141386im    -0.00945589+0.190624im     0.0688186+0.0013652im     0.161599+0.238943im       -0.156692-0.116308im    -0.108288+0.00546579im   -0.0765995-0.0849495im    -0.0943517+0.145155im      0.109272-0.191485im     0.0632624+0.0450784im   -0.0811185+0.173448im       0.135802+0.197625im     -0.0519926+0.0599537im    -0.0989923+0.0795876im    -0.011373+0.034872im      0.166006+0.0654298im    -0.204608-0.214379im       0.211388-0.0957658im
  -0.155894+0.123393im      0.0271194+0.00704745im     0.128688+0.095434im     -0.0369046+0.0476798im    0.0771508+0.00526856im   0.0386604+0.0241632im    -0.00444855-0.0764366im    -0.0073726-0.159643im      -0.242102-0.0465116im      -0.258559-0.128822im    -0.0981217+0.398115im    0.0855558-0.0121176im       0.193948-0.225909im      0.0304929-0.0875197im     0.165544-0.00347682im    0.0396398-0.0255601im   -0.0179687-0.0601996im     0.154274+0.0245019im      0.0917597+0.0674701im   0.0715154-0.00436355im    -0.212847-0.166683im      0.0523906+0.0842556im    -0.159009-0.0861478im       0.1384-0.290451im    0.00202281-0.126567im      -0.207098-0.014197im     -0.0439491+0.000707903im    0.207537+0.0353305im    0.0296684-0.034144im     0.0782571-0.194461im     -0.130463-0.0610409im     0.0458163-0.0665005im
  -0.021687-0.020144im      -0.100953+0.100902im        -0.1373-0.0564392im    -0.0905313-0.00576126im    0.171923+0.0239475im   -0.0322324-0.246413im       -0.167756+0.181959im      0.0438467+0.119547im     -0.0802839+0.110718im      -0.0659746+0.0907318im   -0.0320114-0.126958im   -0.0398561-0.0415818im      0.0525716-0.196413im      -0.225158+0.0595637im      0.03952+0.00631729im     0.241741-0.159835im      0.115564-0.0357im        0.314557+0.157776im       0.0432622+0.0811538im   -0.169036+0.0190181im     0.0597534-0.0389983im    -0.0468807-0.0409783im     0.286723+0.0262272im   -0.0969834-0.102006im     0.0363605-0.270549im    -0.00859682-0.219165im       -0.18008-0.114175im     -0.0369431-0.0634957im    0.0812982+0.13473im     -0.0955187+0.00769143im     0.10476+0.0108397im      0.148547+0.134462im
  0.0584794-0.151443im    -0.00782797-0.177214im      0.0781637-0.136539im     -0.0656545-0.276098im     -0.107695-0.157934im     0.0268763+0.171909im        0.102595+0.0894907im     0.0228457+0.272143im     -0.0134732+0.0525723im     -0.0422703-0.0900372im     0.121891+0.0458218im    0.247403-0.064938im      -0.0128546+0.0989202im     0.0173851-0.00413246im    0.219446+0.0569703im     -0.186126+0.279761im     0.0597911-0.115497im      0.164615-0.0719797im      0.0816692-0.0961405im   0.0476309+0.173929im     -0.0765726+0.174783im     -0.0519155+0.123857im     0.0406812+0.0934514im    0.0673894+0.0571389im   -0.0327108-0.30334im       0.0247429-0.142462im       0.031155-0.0827659im    0.00152852+0.0699868im    0.0142238+0.122823im     0.0181517-0.0811598im     0.181083+0.0417674im      0.104756-0.206041im
  0.0563468-0.0531334im    -0.0878012-0.138766im       -0.20228+0.10071im      -0.0218714+0.0905749im    0.0432211+0.0158616im     0.127941+0.0686894im     0.00786625+0.213425im     -0.0215717-0.132963im    -0.00785301-0.0992695im       0.076363+0.339697im      -0.14965+0.154051im     0.182362-0.120728im      -0.0439796+0.00494594im   -0.0697468+0.0895363im    -0.180249-0.133706im      -0.150731+0.0339541im   -0.0182936-0.0490374im    0.0671971+0.165408im       -0.131805+0.210357im    0.0355934-0.0912615im   0.000192796+0.0301278im     0.0476833+0.217501im     -0.125629+0.00482749im   0.0440588+0.0116991im   -0.0580297+0.0223581im     -0.123718+0.0776813im   -0.00872809-0.368235im      -0.206448+0.0948922im     -0.12355-0.192714im    -0.0625788-0.111067im      0.171758+0.140345im      0.0316284-0.0242418im
 -0.0124251-0.017975im      -0.221403-0.00118135im   -0.0615486-0.00536637im    0.0555252+0.014694im     -0.126054-0.0676649im    -0.140897-0.0732307im      0.0278869-0.138674im     -0.0808719+0.109601im       0.266267+0.295135im      0.00546781-0.184613im      0.046046+0.119648im   -0.0368683+0.0629034im       0.138091+0.171286im      0.0981392+0.23901im     0.00970491-0.0424782im     -0.141331-0.179634im     -0.152074-0.0319962im   -0.0179374+0.198429im      -0.0597402+0.193073im     0.192984-0.205851im     -0.0575413+0.10712im        0.162931+0.056556im    -0.0427403-0.0192476im    -0.100378-0.00553538im    0.171177-0.0708229im     -0.131315-0.0279622im     0.0032347-0.0482128im     0.0526955-0.201033im      0.242043+0.0427423im    0.0800602-0.133975im      0.166853-0.0916475im     -0.038868+0.120149im
 -0.0261334+0.0320311im    -0.0313838-0.0566319im      0.361316+0.115963im     -0.0505701-0.0360223im    -0.102436-0.0765215im    0.0757849+0.0780719im      0.0155154+0.00248003im     0.200071-0.0455906im     0.0409928+0.087235im        0.198356-0.168435im        0.1164+0.133622im    0.0668696+0.133915im     -0.00914589-0.0598564im     -0.182842+0.0582152im   -0.0354764+0.180865im       0.233968+0.0452249im    0.0119439-0.15119im     -0.0852152-0.171015im        0.038029+0.170059im    -0.123698-0.0160374im     0.0333539-0.129307im      -0.110762+0.161382im      0.203953+0.0010655im   -0.0907119-0.0416104im    0.0544966-0.0203108im     0.0457181+0.131209im       0.198476-0.2308im        -0.166454-0.0833354im     0.212053-0.272583im     -0.139598+0.0268216im   -0.0388953+0.00281133im   -0.0523297+0.0823156im
   0.132596+0.202127im      0.0060817+0.125352im      -0.132066+0.0868845im     -0.146702-0.136769im    -0.0234363+0.237237im    -0.0103107+0.042649im       0.0334577-0.141577im       0.139532+0.0263063im      -0.11027+0.224904im        0.107454+0.0406801im    0.0317093-0.0124421im   0.0402866+0.0755032im       0.105277+0.0637832im    -0.0765558+0.0699972im    0.0993871+0.027186im       0.126903-0.148324im     0.0865891+0.0833182im   -0.0498174-0.0389476im      0.0740982+0.199206im      0.20543+0.106952im     -0.0357503+0.196753im      -0.189661-0.318665im    -0.0673349+0.0440858im    0.0863357-0.124344im      0.137585-0.00446258im  -0.00755513+0.0650259im    -0.0139802+0.0875744im     -0.226694+0.109617im     -0.172333-0.197802im     0.0389839-0.089987im      0.139378-0.0187544im     0.0768458-0.280484im
   0.203599-0.00207595im     0.248105-0.133426im    -0.00104875-0.0794374im     -0.033964+0.129341im     0.0627393+0.288899im      0.140739+0.139302im       0.0296623+0.163977im      0.0671416+0.0196697im    0.00631096-0.0401467im       -0.18492+0.034558im      0.117495+0.118398im    0.0419111+0.104407im       -0.032903+0.0402898im     0.0229662+0.0456765im   -0.0620115+0.0584703im       0.02873+0.05751im    -0.00474306-0.0557185im    0.0579376-0.00088931im     0.0237201+0.0825708im   -0.124501+0.140871im     0.00505903+0.0415243im    -0.0876665+0.125638im     0.0997757+0.0103964im    0.0179556+0.140296im      0.280337+0.208733im       -0.15497-0.0077987im     -0.361953+0.113894im      0.0565333-0.285256im     0.0882698+0.00578399im    0.114169-0.00125682im    0.130964-0.185477im      -0.220418-0.0345754im
  -0.077826-0.0910973im      0.116323-0.121103im      -0.113363-0.183313im      0.0259895+0.00299897im   0.0631571-0.0278731im    -0.049339-0.143449im       -0.112433-0.114817im     -0.0772677+0.222773im     -0.0972654-0.220567im      -0.0137128-0.101816im      0.115797+0.0907825im   0.0404242+0.00895281im     0.0317676+0.0957111im    0.00468576-0.173955im    -0.0454353+0.161215im      0.0627768-0.293821im      0.185571-0.124818im     -0.181237-0.0789709im     -0.0610627+0.247962im   -0.0706401-0.132941im      0.0620856-0.0293949im     0.0506535+0.158497im   -0.00272474-0.0929222im   -0.0682265+0.0591611im    -0.234538+0.10447im      -0.0110974+0.0269972im     0.0632313+0.0779929im    -0.0908007-0.0831063im    -0.113996+0.0975573im    -0.190535-0.220375im      0.104733-0.186092im       0.131811-0.248517im</code></pre><p>and then generate the state <span>$ψ$</span></p><pre><code class="language-julia hljs">psi = P[:, 3]</code></pre><pre><code class="nohighlight hljs">32-element Vector{ComplexF64}:
    0.1934087414964175 - 0.04887966309015377im
  -0.08060993550723959 - 0.044187902105993895im
   0.06660063730162454 - 0.1307191446902646im
    0.1547237866822187 - 0.11445684918634154im
   -0.1317777095651212 - 0.036504176798183845im
   0.16079498751453516 - 0.04287544551834638im
   0.14405281253603008 + 0.09488116686607453im
  -0.17192087058444047 + 0.20137871095857865im
   0.11058143939687931 - 0.08353414277304864im
   0.09303671722294508 - 0.10972078586018194im
    0.1992750731022234 + 0.046293789793119274im
 -0.023362020807442947 - 0.08770700104975025im
   -0.0763522170099289 - 0.23912926938677015im
  0.007417463817273477 + 0.24881573171165808im
  -0.02166315376736581 + 0.06159458115382347im
  -0.09237077428951009 + 0.1293711018074984im
  0.020061936229810576 + 0.009925458242558546im
     0.214219379794326 + 0.0707581819881307im
  -0.04782612298327499 + 0.2261924811931375im
   0.22980483237757404 + 0.13978007916907123im
  0.022440960991516413 + 0.018579122248910087im
    -0.190369831930727 - 0.07821455180254559im
   0.11670998031068956 + 0.1471855899836672im
  -0.14561271070332388 - 0.2360227026474294im
  -0.17279353028618358 - 0.15643243745916582im
   0.04234400764757734 - 0.02968784003174261im
  -0.05947226883076178 + 0.038642400707976185im
  0.055919135763574566 + 0.006735183508031243im
 -0.030976380159112898 - 0.0563667819335984im
  -0.06737519301171807 - 0.05871214009682732im
   0.09629425899488125 - 0.042166315583976204im
    0.2854043464931499 + 0.0im</code></pre><p>In the phase estimation process, we will feed the state to circuit and measure the first <code>n</code> qubits processed by iQFT.</p><pre><code class="language-julia hljs">r = join(ArrayReg(psi), zero_state(N))
r |&gt; PE(N, M, U)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qudits: 8/8
    nlevel: 2</code></pre><p>Since our phase can be represented by 3 qubits precisely, we only need to measure once</p><pre><code class="language-julia hljs">results = measure(r, 1:N; nshots=1)</code></pre><pre><code class="nohighlight hljs">1-element Vector{BitBasis.BitStr64{3}}:
 011 ₍₂₎</code></pre><p>Recall that our QFT&#39;s bit numbering is reversed, let&#39;s reverse it back</p><pre><code class="language-julia hljs">using BitBasis
estimated_phase = bfloat(results[]; nbits=N)</code></pre><pre><code class="nohighlight hljs">0.75</code></pre><p>the phase is exactly <code>0.75</code>!</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../1.prepare-ghz-state/index.html">« Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a><a class="docs-footer-nextpage" href="../3.grover-search/index.html">Grover Search »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.15 on <span class="colophon-date" title="Wednesday 13 April 2022 19:11">Wednesday 13 April 2022</span>. Using Julia version 1.7.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
