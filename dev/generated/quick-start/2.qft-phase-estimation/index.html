<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quantum Fourier Transformation and Phase Estimation · Documentation | Yao</title><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/indigo.css" rel="stylesheet" type="text/css"/><link href="https://yaoquantum.org/assets/favicon-light.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../index.html"><img src="../../../assets/logo.png" alt="Documentation | Yao logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../index.html">Documentation | Yao</a></span></div><form class="docs-search" action="../../../search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../index.html">Home</a></li><li><span class="tocitem">Quick Start</span><ul><li><a class="tocitem" href="../1.prepare-ghz-state/index.html">Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a></li><li class="is-active"><a class="tocitem" href="index.html">Quantum Fourier Transformation and Phase Estimation</a><ul class="internal"><li><a class="tocitem" href="#Quantum-Fourier-Transformation"><span>Quantum Fourier Transformation</span></a></li><li><a class="tocitem" href="#Wrap-QFT-to-an-external-block"><span>Wrap QFT to an external block</span></a></li><li><a class="tocitem" href="#Phase-Estimation"><span>Phase Estimation</span></a></li><li class="toplevel"><a class="tocitem" href="#using-LinearAlgebra"><span>using LinearAlgebra</span></a></li></ul></li><li><a class="tocitem" href="../3.grover-search/index.html">Grover Search</a></li><li><a class="tocitem" href="../4.shor-algorithm/index.html">Shor&#39;s Algorithm</a></li><li><a class="tocitem" href="../5.shor-9-code/index.html">Shor&#39;s 9 qubit code</a></li><li><a class="tocitem" href="../6.quantum-circuit-born-machine/index.html">Quantum Circuit Born Machine</a></li><li><a class="tocitem" href="../7.variation-quantum-eigen-solver/index.html">Variational Quantum Eigen Solver</a></li></ul></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../../man/array_registers.html">Array Registers</a></li><li><a class="tocitem" href="../../../man/symbolic.html">Symbolic Computation</a></li><li><a class="tocitem" href="../../../man/blocks.html">Blocks</a></li><li><a class="tocitem" href="../../../man/automatic_differentiation.html">Automatic Differentiation</a></li><li><a class="tocitem" href="../../../man/simplification.html">Simplification</a></li><li><a class="tocitem" href="../../../man/base.html">Base</a></li><li><a class="tocitem" href="../../../man/registers.html">Abstract Registers</a></li><li><a class="tocitem" href="../../../man/bitbasis.html">BitBasis</a></li><li><a class="tocitem" href="../../../man/extending_blocks.html">Extending Blocks</a></li></ul></li><li><a class="tocitem" href="../../../benchmarks.html">Benchmark</a></li><li><a class="tocitem" href="../../../dev/index.html">Developer Notes</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Quick Start</a></li><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/QuantumBFS/Yao.jl/blob/master/docs/src/quick-start/2.qft-phase-estimation/main.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><p><a href="https://mybinder.org/v2/gh/QuantumBFS/Yao.jl/gh-pages?filepath=dev/generated/quick-start/2.qft-phase-estimation/main.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a> <a href="https://nbviewer.jupyter.org/github/QuantumBFS/Yao.jl/blob/gh-pages/dev/generated/quick-start/2.qft-phase-estimation/main.ipynb"><img src="https://img.shields.io/badge/show-nbviewer-579ACA.svg" alt/></a> <a href="https://minhaskamal.github.io/DownGit/#/home?url=https://github.com/QuantumBFS/tutorials/tree/gh-pages/dev/generated/quick-start/2.qft-phase-estimation"><img src="https://img.shields.io/badge/download-project-orange" alt/></a></p><h1 id="example-qft"><a class="docs-heading-anchor" href="#example-qft">Quantum Fourier Transformation and Phase Estimation</a><a id="example-qft-1"></a><a class="docs-heading-anchor-permalink" href="#example-qft" title="Permalink"></a></h1><p>Let&#39;s use Yao first</p><pre><code class="language-julia hljs">using Yao</code></pre><h2 id="Quantum-Fourier-Transformation"><a class="docs-heading-anchor" href="#Quantum-Fourier-Transformation">Quantum Fourier Transformation</a><a id="Quantum-Fourier-Transformation-1"></a><a class="docs-heading-anchor-permalink" href="#Quantum-Fourier-Transformation" title="Permalink"></a></h2><p>The Quantum Fourier Transformation (QFT) circuit is to repeat two kinds of blocks repeatly:</p><p><img src="assets/qft.png" alt="qft-circuit"/></p><p>The basic building block control phase shift gate is defined as</p><p class="math-container">\[R(k)=\begin{bmatrix}
1 &amp; 0\\
0 &amp; \exp\left(\frac{2\pi i}{2^k}\right)
\end{bmatrix}\]</p><p>Let&#39;s define block <code>A</code> and block <code>B</code>, block <code>A</code> is actually a control block.</p><pre><code class="language-julia hljs">A(i, j) = control(i, j=&gt;shift(2π/(1&lt;&lt;(i-j+1))))</code></pre><pre><code class="nohighlight hljs">A (generic function with 1 method)</code></pre><p>Once you construct the blockl you can inspect its matrix using <code>mat</code> function. Let&#39;s construct the circuit in dash box A, and see the matrix of <span>$R_4$</span> gate.</p><pre><code class="language-julia hljs">R4 = A(4, 1)</code></pre><pre><code class="nohighlight hljs">(n -&gt; control(n, 4, 1 =&gt; shift(0.39269908169872414)))</code></pre><p>If you have read about <a href="generated/quick-start/2.qft-phase-estimation/@ref example-ghz">preparing GHZ state</a>, you probably know that in Yao, we could just leave the number of qubits, and it will be evaluated when possible.</p><pre><code class="language-julia hljs">R4(5)</code></pre><pre><code class="nohighlight hljs">nqubits: 5
control(4)
└─ (1,) shift(0.39269908169872414)</code></pre><p>its matrix will be</p><pre><code class="language-julia hljs">mat(R4(5))</code></pre><pre><code class="nohighlight hljs">32×32 LinearAlgebra.Diagonal{ComplexF64, Vector{ComplexF64}}:
 1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im</code></pre><p>Then we repeat this control block over and over on different qubits, and put a Hadamard gate to <code>i</code>th qubit to construct <code>i</code>-th <code>B</code> block.</p><pre><code class="language-julia hljs">B(n, k) = chain(n, j==k ? put(k=&gt;H) : A(j, k) for j in k:n)</code></pre><pre><code class="nohighlight hljs">B (generic function with 1 method)</code></pre><p>We need to input the total number of qubits <code>n</code> here because we have to iterate through from <code>k</code>-th location to the last.</p><p>Now, let&#39;s construct the circuit by chaining all the <code>B</code> blocks together</p><pre><code class="language-julia hljs">qft(n) = chain(B(n, k) for k in 1:n)
qft(4)</code></pre><pre><code class="nohighlight hljs">nqubits: 4
chain
├─ chain
│  ├─ put on (1)
│  │  └─ H
│  ├─ control(2)
│  │  └─ (1,) shift(1.5707963267948966)
│  ├─ control(3)
│  │  └─ (1,) shift(0.7853981633974483)
│  └─ control(4)
│     └─ (1,) shift(0.39269908169872414)
├─ chain
│  ├─ put on (2)
│  │  └─ H
│  ├─ control(3)
│  │  └─ (2,) shift(1.5707963267948966)
│  └─ control(4)
│     └─ (2,) shift(0.7853981633974483)
├─ chain
│  ├─ put on (3)
│  │  └─ H
│  └─ control(4)
│     └─ (3,) shift(1.5707963267948966)
└─ chain
   └─ put on (4)
      └─ H
</code></pre><h2 id="Wrap-QFT-to-an-external-block"><a class="docs-heading-anchor" href="#Wrap-QFT-to-an-external-block">Wrap QFT to an external block</a><a id="Wrap-QFT-to-an-external-block-1"></a><a class="docs-heading-anchor-permalink" href="#Wrap-QFT-to-an-external-block" title="Permalink"></a></h2><p>In most cases, <code>function</code>s are enough to wrap quantum circuits, like <code>A</code> and <code>B</code> we defined above, but sometimes, we need to dispatch specialized methods on certain kinds of quantum circuit, or we want to define an external block to export, thus, it&#39;s useful to be able to wrap circuit to custom blocks.</p><p>First, we define a new type as subtype of <code>PrimitiveBlock</code> since we are not going to use the subblocks of <code>QFT</code>, if you need to use its subblocks, it&#39;d be better to define it under <code>CompositeBlock</code>.</p><pre><code class="language-julia hljs">struct QFT{N} &lt;: PrimitiveBlock{N} end
QFT(n::Int) = QFT{n}()</code></pre><pre><code class="nohighlight hljs">Main.##276.QFT</code></pre><p>Now, let&#39;s define its circuit</p><pre><code class="language-julia hljs">circuit(::QFT{N}) where N = qft(N)</code></pre><pre><code class="nohighlight hljs">circuit (generic function with 1 method)</code></pre><p>And forward <code>mat</code> to its circuit&#39;s matrix</p><pre><code class="language-julia hljs">YaoBlocks.mat(::Type{T}, x::QFT) where T = mat(T, circuit(x))</code></pre><p>You may notice, it is a little ugly to print <code>QFT</code> at the moment, this is because we print the type summary by default, you can define your own printing by overloading <code>print_block</code></p><pre><code class="language-julia hljs">YaoBlocks.print_block(io::IO, x::QFT{N}) where N = print(io, &quot;QFT($N)&quot;)</code></pre><p>Since it is possible to use FFT to simulate the results of QFT (like cheating), we could define our custom <code>apply!</code> method:</p><pre><code class="language-julia hljs">using FFTW, LinearAlgebra

function YaoBlocks.apply!(r::ArrayReg, x::QFT)
    α = sqrt(length(statevec(r)))
    invorder!(r)
    lmul!(α, ifft!(statevec(r)))
    return r
end</code></pre><p>Now let&#39;s check if our <code>apply!</code> method is correct:</p><pre><code class="language-julia hljs">r = rand_state(5)
r1 = r |&gt; copy |&gt; QFT(5)
r2 = r |&gt; copy |&gt; circuit(QFT(5))
r1 ≈ r2</code></pre><pre><code class="nohighlight hljs">true</code></pre><p>We can get iQFT (inverse QFT) directly by calling <code>adjoint</code></p><pre><code class="language-julia hljs">QFT(5)&#39;</code></pre><pre><code class="nohighlight hljs"> [†]QFT(5)</code></pre><p>QFT and iQFT are different from FFT and IFFT in three ways,</p><ol><li>they are different by a factor of <span>$\sqrt{2^n}$</span> with <span>$n$</span> the number of qubits.</li><li>the <a href="https://quantumbfs.github.io/BitBasis.jl/stable/tutorial/#Conventions-1">bit numbering</a> will exchange after applying QFT or iQFT.</li><li>due to the convention, QFT is more related to IFFT rather than FFT.</li></ol><h2 id="Phase-Estimation"><a class="docs-heading-anchor" href="#Phase-Estimation">Phase Estimation</a><a id="Phase-Estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Phase-Estimation" title="Permalink"></a></h2><p>Since we have QFT and iQFT blocks we can then use them to realize phase estimation circuit, what we want to realize is the following circuit:</p><p><img src="assets/phaseest.png" alt="phase estimation"/></p><pre><code class="language-julia hljs">using Yao</code></pre><p>First we call Hadamard gates repeatly on first <code>n</code> qubits.</p><pre><code class="language-julia hljs">Hadamards(n) = repeat(H, 1:n)</code></pre><pre><code class="nohighlight hljs">Hadamards (generic function with 1 method)</code></pre><p>Then in dashed box <code>B</code>, we have controlled unitaries:</p><pre><code class="language-julia hljs">ControlU(n, m, U) = chain(n+m, control(k, n+1:n+m=&gt;matblock(U^(2^(k-1)))) for k in 1:n)</code></pre><pre><code class="nohighlight hljs">ControlU (generic function with 1 method)</code></pre><p>each of them is a <code>U</code> of power <span>$2^(k-1)$</span>.</p><p>Since we will only apply the qft and Hadamard on first <code>n</code> qubits, we could use <code>Subroutine</code>, which creates a context of a sub-scope of the qubits.</p><pre><code class="language-julia hljs">PE(n, m, U) =
    chain(n+m, # total number of the qubits
        subroutine(Hadamards(n), 1:n), # apply H in local scope
        ControlU(n, m, U),
        subroutine(QFT(n)&#39;, 1:n))</code></pre><pre><code class="nohighlight hljs">PE (generic function with 1 method)</code></pre><p>we use the first <code>n</code> qubits as the output space to store phase <span>$ϕ$</span>, and the other <code>m</code> qubits as the input state which corresponds to an eigenvector of oracle matrix <code>U</code>.</p><p>The concentrator here uses <code>focus!</code> and <code>relax!</code> to manage a local scope of quantum circuit, and only active the first <code>n</code> qubits while applying the block inside the concentrator context, and the scope will be <code>relax!</code>ed back, after the context. This is equivalent to manually <code>focus!</code> then <code>relax!</code></p><p>fullly activated</p><pre><code class="language-julia hljs">r = rand_state(5)</code></pre><pre><code class="nohighlight hljs">ArrayReg{1, ComplexF64, Array...}
    active qubits: 5/5</code></pre><p>first 3 qubits activated</p><pre><code class="language-julia hljs">focus!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{1, ComplexF64, Array...}
    active qubits: 3/5</code></pre><p>relax back to the original</p><pre><code class="language-julia hljs">relax!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{1, ComplexF64, Array...}
    active qubits: 5/5</code></pre><p>In this way, we will be able to apply small operator directly on the subset of the qubits.</p><p>Details about the algorithm can be found here: <a href="ttps://en.wikipedia.org/wiki/Quantum_phase_estimation_algorithm">Quantum Phase Estimation Algorithm</a></p><p>Now let&#39;s check the results of our phase estimation.</p><p>First we need to set up a unitary with known phase, we set the phase to be 0.75, which is <code>0.75 * 2^3 == 6 == 0b110</code> .</p><h1 id="using-LinearAlgebra"><a class="docs-heading-anchor" href="#using-LinearAlgebra">using LinearAlgebra</a><a id="using-LinearAlgebra-1"></a><a class="docs-heading-anchor-permalink" href="#using-LinearAlgebra" title="Permalink"></a></h1><pre><code class="language-julia hljs">N, M = 3, 5
P = eigen(rand_unitary(1&lt;&lt;M)).vectors
θ = Int(0b110) / 1&lt;&lt;N
phases = rand(1&lt;&lt;M)
phases[0b010+1] = θ
U = P * Diagonal(exp.(2π * im * phases)) * P&#39;</code></pre><pre><code class="nohighlight hljs">32×32 Matrix{ComplexF64}:
  0.0071608+0.177047im      -0.0505693+0.0746727im    -0.0506848-0.125741im      0.0478447+0.00398931im    0.145817+0.0505263im   -0.0910818+0.0465179im     0.0332305-0.119193im      0.086381-0.102103im      0.302648+0.153211im    -0.0701008-0.081133im   -0.0541712+0.0156643im     0.0321067-0.0639554im      -0.2165-0.213834im     -0.0190838+0.016302im       0.0713839+0.155444im     -0.237392-0.0126335im      0.123994+0.241718im     0.0509291-0.0326331im     0.0280309-0.102167im     0.00841311+0.078675im      0.161068-0.0138993im     0.139703+0.228604im       0.123196-0.0647255im      0.0107407-0.185387im      0.0514303+0.249768im       0.0587681+0.0741734im       0.07582+0.0426596im      -0.140498-0.144708im     -0.277131-0.00301337im     0.267927-0.163441im    -0.00822066-0.0877543im    0.0768796-0.0227019im
 -0.0216954-0.0523032im      0.0499517-0.155539im      -0.162274-0.0109324im    -0.0923438+0.0438138im   -0.0899774-0.235807im      -0.33492+0.0510827im      0.201286+0.0839404im     0.128879-0.145538im     -0.100888+0.0371724im    0.0907137+0.0584518im    0.088623+0.142723im    -0.00116353+0.108718im     0.0103192+0.255655im    -0.00915811+0.117822im        -0.02162+0.095801im    -0.0217941+0.138293im      -0.132495+0.00181624im   0.0330292-0.179291im       0.295121+0.180071im     -0.0898079+0.161154im       0.07354-0.0686672im    0.0521873-0.0324892im     -0.030319-0.0347026im      -0.160954-0.00187847im    0.0156589+0.0912062im      0.0489017-0.112668im      0.0612551+0.0807769im     -0.0619408-0.0150717im    0.0115136-0.311504im     0.00884724-0.107872im     -0.0394925-0.279094im     -0.120585+0.101435im
   0.144454-0.0425251im      0.0850148-0.11628im        0.060742+0.101175im       0.252052+0.0743731im   -0.0280134+0.0956283im   -0.0547091+0.0613164im     -0.091387-0.03765im       0.142234-0.0520331im     -0.18135+0.07047im      -0.427542-0.260903im     0.112437+0.186168im     -0.0536155-0.0769952im   -0.0309361-0.038946im      0.0466616+0.193833im       0.0158679+0.0751181im    0.0845919+0.0313817im    -0.0889673+0.157608im    -0.0461859-0.00460335im    -0.200959+0.0726226im    -0.0801065-0.273868im      0.037854-0.0459586im   -0.0752467-0.0515601im     -0.164933+0.232198im       -0.196227+0.0509315im    -0.0406497+0.0572666im        0.08397+0.068793im      0.0752327-0.0790352im      0.0299383-0.188389im     0.0920622+0.0429693im     0.0599827-0.0999298im     -0.171585-0.024304im    -0.0664539+0.0607251im
  -0.013752-0.216701im      0.00310403+0.162076im      -0.160685+0.179316im       0.196092-0.0253917im     0.094882-0.0775965im    0.0577832+0.0635823im     0.0377337+0.0985486im   -0.0985766-0.0889056im     0.030843-0.0284325im     0.335827-0.0320038im    0.105156+0.0333418im   -0.00319064-0.0625503im     0.127559-0.217688im       0.143834+0.143652im      -0.0504088+0.0501923im    -0.107821-0.00230765im    -0.111541+0.136494im      0.228326+0.101402im      -0.154944+0.0839298im    -0.0683687-0.0225409im   -0.0510964+0.0534659im    -0.111744-0.00911762im   -0.0912879+0.0415193im      0.0870806-0.0453532im      0.266956-0.0814031im     -0.0864699+0.229079im      0.0462404-0.179571im      -0.0860483-0.038183im    -0.0381563-0.177963im      -0.166256-0.23708im        0.169434-0.050601im     -0.106513-0.129887im
  -0.103992-0.073117im       -0.263719-0.146184im    -0.00366717+0.131808im      0.0778668+0.00532991im  -0.0792036+0.167493im     -0.050444-0.148038im      0.0326028+0.291055im     0.0663167-0.305429im     -0.192708-0.0807306im    0.0764632-0.0703621im  -0.0858153-0.0734726im    -0.0391982+0.040721im     -0.221363+0.106082im      0.0074982-0.256859im       0.0025864-0.135705im    -0.0657799+0.0987764im    -0.0975091+0.112526im    -0.0275919+0.0850134im     0.0623667-0.183192im     -0.0533448+0.0479812im    0.0479826-0.14058im      -0.109298-0.170947im     -0.0405481+0.0314997im      0.0349731-0.100214im    -0.00771113+0.00516321im    -0.0163731+0.0024125im     -0.231385-0.253507im       -0.049509+0.0202445im   -0.0862899+0.155356im       0.282432-0.0746361im     0.0754722+0.0188315im   -0.0624216-0.0144283im
   0.257983+0.0977593im    -0.00558096+0.116436im      -0.115453+0.0262574im     -0.189827-0.162219im    -0.0110304+0.0208304im   -0.0112541-0.0331095im     -0.173176-0.0255988im     0.104264-0.149498im     0.0357609+0.151983im     -0.191667-0.0276358im  -0.0930262-0.366907im       0.108335-0.0056486im    0.0346847-0.0949143im    0.00245581+0.12538im     -0.000193538+0.0361806im    -0.117807-0.122467im      -0.166787-0.0513322im     0.121293-0.13287im         0.13127+0.131376im       0.122123+0.225908im     -0.191827+0.0442032im   -0.0547465-0.137667im      -0.354509+0.0627454im       0.106748+0.00629133im    0.0310784-0.124884im      -0.0204237-0.0157376im     -0.217781+0.0525013im     -0.0925723-0.0419098im    0.0759441+0.0948201im     0.0404591-0.078692im      -0.121586-0.0948759im    0.0177743-0.0762084im
  0.0589676-0.0327707im      -0.235933-0.075354im      -0.111635+0.0368498im    -0.0106414-0.0392769im   -0.0880502+0.0931025im  -0.00683143-0.13696im        -0.10864-0.276714im    -0.0411848-0.0413301im  -0.00015081+0.171181im      0.101676-0.0639785im  -0.0663017+0.0642934im    -0.0285749+0.159243im     -0.179819-0.109849im       0.100808-0.166662im        0.110438-0.173697im      0.175285+0.0216044im    -0.0235189+0.0336949im    0.0828338-0.179494im      -0.213455+0.137115im      0.0755856-0.0894185im      0.04939-0.0118595im       0.1623-0.0217676im      0.129153+0.0776032im        0.13486+0.1648im         0.286547-0.0723534im     -0.0677439-0.0600633im     0.0383674+0.225965im        0.169125+0.163432im      0.133191-0.187811im       0.193956-0.0357479im    -0.0855713-0.091981im     -0.168554-0.0389224im
 -0.0553429-0.16136im       -0.0574015-0.0343842im    -0.0653804+0.104681im      0.0644245-0.134559im      0.186677+0.111966im     0.0202664-0.0963725im    -0.0500859-0.173204im      0.293556-0.0630886im   -0.0677921+0.105681im     0.0676299-0.0796423im  -0.0783446-0.0292441im     -0.064168-0.21463im       0.164746+0.233427im       0.125027-0.0591907im       0.109577+0.0817766im   -0.0636328-0.015861im       0.191756+0.00962894im   0.0156877-0.314504im      -0.110765-0.166741im     -0.0895818-0.106385im    -0.0778666+0.134677im     -0.119098-0.116294im    -0.00864074-0.281282im       -0.103003-0.00847055im    -0.212604-0.0995025im      0.0255934+0.0224585im     0.0569278+0.0912847im      -0.182079+0.145462im      0.018744-0.180021im      0.0182901-0.02952im        0.045362+0.0498002im     0.185607-0.09617im
 -0.0706544-0.0557943im      -0.159768-0.0561831im    -0.0186083-0.00583673im    -0.192137+0.0721757im    0.0631865-0.0458709im    -0.199108+0.253312im      -0.107901+0.0791686im    0.0432561+0.0476694im   0.00102347-0.145314im     -0.118088-0.213743im   -0.0535288+0.0209443im    -0.0577159-0.258307im     0.0342414+0.0511514im     0.0992676-0.0637292im       0.240858+0.0386871im   -0.0403139-0.190557im      -0.180278+0.0300307im    0.0229132+0.0129047im     -0.126196+0.0187472im      0.123849+0.0445947im    -0.213903-0.229179im      0.154221+0.0772348im      0.297269-0.0532541im       0.212771+0.124678im      -0.173895+0.133107im      -0.0605968+0.0478111im     -0.112097-0.0801822im     -0.0298788-0.0377095im     0.119868+0.00300571im    -0.185294-0.00466326im    0.0810287-0.143254im     -0.126207-0.0690628im
 -0.0946275+0.116013im        0.030985-0.164725im       0.128151-0.099004im      -0.132457+0.263696im      0.038137-0.148399im      0.172654+0.109818im       -0.17581-0.0278518im   -0.0398753-0.23826im        0.18346+0.0700893im     0.140816+0.0046347im   -0.019244+0.211285im       0.198974+0.168654im    -0.0829685-0.0618388im    -0.0165825+0.0727238im      0.0820525+0.090708im      0.192104+0.0895681im     0.0908019+0.0766625im     0.117095-0.0330191im    -0.0349462+0.120555im     -0.0607807-0.00571747im   -0.159487-0.0625345im   -0.0584187-0.259382im      0.0445874-0.0457486im      -0.158501+0.0161376im     -0.157358-0.0585372im    -0.00877728+0.201373im      -0.296821-0.00327524im     0.0307176-0.137164im    0.00100886-0.0890448im     0.0406158+0.0705437im    0.00891431+0.0771417im     0.128487-0.203673im
  -0.205042+0.262598im       -0.047763-0.0161124im     -0.203361-0.00850598im     0.132371+0.123338im     -0.087253-0.054277im      0.231448-0.136001im      0.0685234+0.0673385im    0.0113313-0.180906im    0.00998133+0.0592622im    -0.125349+0.213695im   -0.0543372-0.0373667im     0.0134554-0.147499im      0.094269+0.121256im      0.0476874-0.206847im      -0.0785232+0.273405im     0.0943593-0.0756282im     -0.151882+0.156763im    -0.0855569+0.0916832im     -0.121711+0.141242im        0.11764+0.0779681im    0.0109623-0.0721235im     0.108214+0.116531im      0.0245199+0.00785543im    -0.0641103-0.103523im     -0.0745281-0.328705im       0.0792222+0.00183233im     0.256819-0.00867924im      0.042927+0.038539im     0.0836225+0.0744418im    -0.0331638-0.0264181im    -0.0536626-0.158969im     0.0065121-0.190279im
  -0.208601-0.0884012im     -0.0388583+0.205253im     -0.0130717-0.0511313im      0.268055+0.00506596im  -0.0360033+0.0481095im   -0.0934722+0.0797094im      0.132198+0.262253im     0.0249965+0.0340704im     0.184983-0.0881449im    -0.188249-0.112129im     -0.22687+0.00519666im     0.126418+0.172291im     0.0299511-0.0164178im    -0.0549572-0.00154422im      0.307818+0.0556748im     0.125632+0.0272837im     0.0775533-0.138032im      0.265099-0.137487im      0.0631986+0.00275039im    -0.112962-0.0101805im    -0.121711+0.139871im     0.0387485-0.0338654im    -0.0365109+0.139119im      -0.0202457+0.0143827im     0.0512344-0.0266604im      -0.238762-0.225933im       0.171088-0.108895im       0.0614132+0.00621015im   0.0332306+0.0248966im     0.0726777+0.131934im     0.00121839-0.104636im      0.155627-0.111998im
   0.215847+0.152062im       0.0189919+0.0923911im    -0.0399642-0.271642im      0.0478262+0.0816073im    0.0618754+0.0178263im    0.0354632+0.0108718im     0.0412793+0.0907611im    -0.082033+0.0344499im     0.168025+0.161407im      0.182151-0.0604774im    0.171006-0.174674im     -0.0426111-0.0321499im    -0.110729+0.208409im       0.133625-0.10756im         0.184334-0.0436851im    -0.164237+0.2056im        -0.192624+0.00875058im   -0.270587-0.203365im      -0.187466-0.00282458im    -0.038519-0.0775525im   -0.0700495+0.0688541im    -0.101262+0.159743im       -0.02945+0.0378375im      -0.124529-0.0209733im     0.0305128-0.065729im       -0.140922-0.0496644im     -0.112678-0.236592im        0.151279-0.131649im      0.110742-0.104917im     -0.0477533+0.100528im      0.0406685-0.0438476im    0.0864421+0.168694im
   0.169882+0.13557im        -0.120544-0.00855028im     0.160276+0.20411im       0.0902824-0.276427im     -0.187029-0.213071im     -0.156799+0.154286im      0.0528184+0.0499372im   -0.0230384+0.13371im     -0.0732419+0.00159811im   0.0235874+0.060228im    -0.170462+0.0349968im      0.249357-0.0882947im   -0.0864297-0.0945764im      0.175281+0.11196im       -0.0294204+0.102284im    -0.0507924+0.178401im      -0.101669+0.115553im     -0.245752+0.0898553im    -0.0398456+0.15917im       -0.109079-0.134613im     -0.123873+0.0515882im    -0.104951-0.0534987im      0.121262-0.210411im       0.0795682-0.062191im       0.033954+0.00802203im     0.0900469-0.174133im     -0.0151109+0.0626169im       0.142849+0.111761im    -0.0332095+0.0526585im     0.0971623-0.00266662im    0.0791792-0.00562986im     0.19509-0.184477im
 -0.0824528+0.00726765im    -0.0463329-0.0202594im     0.0978884-0.118775im       0.248265-0.0833543im     0.213149-0.172374im     -0.103303+0.000114618im  -0.0647869-0.153463im     -0.097223+0.030069im      -0.15275+0.0630614im     0.159024-0.0575733im  0.00992571+0.221453im      -0.145078+0.0414339im    -0.127294+0.227598im       0.165352+0.0532501im       0.162681+0.0144363im      0.10644-0.139232im     -0.0101659+0.00555244im   -0.108536+0.130142im      0.0900477+0.116632im       0.263344+0.108602im     0.0939516+0.0813564im     0.062885-0.0548678im     -0.243212+0.158323im        0.318607-0.228786im     -0.0295968-0.000660153im   -0.0551814-0.0234288im    -0.0377854+0.0071468im      -0.150567-0.0533769im    0.0324856+0.0429543im   -0.00652285+0.0644648im    -0.0767049+0.0415623im     0.227046-0.033039im
 -0.0430012-0.0136248im     -0.0460635-0.0114568im     0.0711302-0.0507035im     0.0178014+0.0869169im    -0.177814-0.0495253im   -0.0653801-0.134284im      -0.220361-0.137515im     0.0829829+0.12679im     -0.0165866+0.0777639im    0.0792611+0.164226im    -0.287731+0.0164843im      0.204512-0.251487im      0.208186+0.109097im      -0.170617-0.0214996im       0.140148-0.226447im      0.107043+0.0591074im     0.0237293+0.138623im     0.0993533-0.150226im     -0.0287698+0.15026im      -0.0661096+0.0803428im    0.0518201-0.158579im     -0.200562+0.0984891im    -0.0270887+0.0772366im   -0.000821198-0.162379im       0.246615+0.182595im        0.150073+0.123419im      0.0460414-0.205408im      -0.0789751-0.0266603im   -0.0183269+0.105507im      -0.107438+0.101001im      -0.010694-0.0511596im    0.0414348+0.129997im
  -0.124132+0.145932im        0.102254-0.156339im      -0.198387+0.121045im     -0.0897962+0.0100203im    0.0488502+0.169723im      0.132178+0.113607im      0.0310455+0.0839078im    -0.169717+0.0903029im     0.169763+0.133803im     -0.120837-0.0590422im   0.0543104+0.0534338im     0.0666511-0.168686im      0.118582-0.00805402im    0.0776948+0.0761376im       0.111502-0.122679im      0.116235+0.175674im      0.0156018+0.041352im      0.102989-0.00288392im     0.166587+0.0520145im    0.00786117-0.0861064im      0.19695-0.0185933im     0.125217-0.0452686im      -0.19842-0.0608363im       0.235914-0.034494im      -0.108447+0.0113624im       0.176656-0.082571im     -0.0675978-0.0921514im       0.110368+0.152886im      0.198626-0.0658759im       0.11487-0.189027im       0.327033+0.0619861im     0.102064+0.196527im
  0.0221589-0.175868im        -0.15877+0.0842864im     -0.210288-0.00638595im   -0.0364035-0.122746im    -0.0712547-0.106734im     0.0605652-0.0405162im      0.111698+0.0214331im     -0.11085-0.311321im    -0.0939281+0.0194372im     0.102198-0.0304688im  -0.0148071-0.0113622im      0.111921-0.107481im     0.0312552-0.0879321im      0.109799+0.175314im        0.101312-0.108495im    -0.0274777-0.148205im      0.0725327-0.0262049im   -0.0411377-0.0718537im    -0.0633889-0.0453564im     -0.294568-0.00420329im   0.0756757-0.117726im      0.284575-0.00141641im    -0.040863+0.0343344im     -0.0637835-0.242368im      -0.147694+0.040723im     0.000301419+0.0478628im     0.0116174+0.243957im        0.253303-0.181387im     0.0631776+0.211395im      -0.122997+0.176948im     -0.0127922+0.0796162im    0.0565599+0.176756im
   0.187634-0.0872256im      -0.257644+0.0819411im      0.241924+0.00999658im     0.123671+0.079843im     0.0881612-0.288723im      0.096533+0.131989im      0.0663272+0.105937im     0.0560906+0.132755im    -0.0317567+0.0888297im   -0.0494963+0.0129274im   -0.109416+0.0754845im     0.0773447-0.0117764im     0.226347+0.0156197im     0.0687133-0.165985im       -0.121862+0.0246992im    -0.156082+0.0057858im     0.0821228+0.00565507im   0.0855498-0.208245im    -0.00797671-0.0597036im      0.167042+0.149133im      0.311694-0.00188997im    0.227993-0.0796244im    -0.0669141-0.00178195im    -0.0531456+0.230806im      0.0142869-0.147104im        0.134325-0.0295746im    -0.0731989-0.0861761im      0.0733046-0.224474im     0.0274967-3.4007e-5im      0.100806+0.00882551im     0.103054+0.131651im     -0.122036-0.0134644im
  -0.111107+0.134543im       0.0438565+0.0413651im     0.0590136-0.0278232im    -0.0706908-0.0141877im    0.0565094-0.155036im     -0.212668+0.0622199im       0.01694-0.232803im     0.0215771-0.272027im     0.0636651-0.233246im     0.0147019+0.0980781im  -0.0455533-0.0530875im     0.0987526-0.119003im   -0.00147571+0.00873667im     0.197227-0.171573im       -0.146377-0.157136im     0.0774649-0.141304im       -0.01165+0.0591414im     0.163016+0.0891971im    -0.0142344+0.0396948im     0.0974048-0.357453im      -0.13381+0.13826im     0.00273874+0.0756809im     -0.162962+0.0298007im      -0.137224+0.12081im       0.0202372-0.0760915im     -0.0321592-0.205228im      0.0052167-0.00693089im     -0.110484-0.148815im    -0.0968153+0.0242084im      0.106587+0.0633008im      0.231498-0.00659151im   -0.046694+0.260455im
  -0.072802+0.0585842im      -0.149038-0.129357im       0.162134-0.121665im       0.173352-0.0364699im    -0.171391+0.129366im   -0.00944057-0.0787828im    0.00633201-0.197494im   -0.00791657-0.219428im     0.0529136-0.00999854im   -0.101105-0.0669587im   -0.033367-0.07702im       -0.166918-0.151478im    -0.0321995+0.136705im      -0.142081+0.207882im       -0.089168-0.186072im     -0.280377+0.253336im     -0.0950376-0.0949329im     0.145753+0.0371099im      0.185034+0.0983396im      0.114502-0.0523273im    0.0407072+0.0863217im    0.0782823-0.0447925im      0.121794+0.0573969im      0.0332644+0.106844im     -0.0102951-0.0603953im     -0.0646233+0.0800815im     0.0590564+0.0673221im        0.18182-0.108854im    -0.0918537-0.0488993im     -0.273879-0.0196906im      0.188662+0.0473972im     0.118871-0.206053im
  -0.117644+0.17149im        -0.148343+0.0343338im      0.197581+0.105485im      -0.102796-0.0768256im     0.177381+0.116359im      0.188659+0.0744539im     0.0325142-0.0141747im     0.196057-0.0973376im    0.0740714-0.35549im       0.234872-0.15783im     0.0939841-0.081828im        0.10059+0.123941im       0.13881+0.0279311im    -0.0582555+0.00403218im     0.0493779+0.0516056im    -0.139265+0.132869im    -0.00373253+0.0932833im    -0.103378-0.0384673im       0.13919+0.127223im     -0.0868255-0.0906174im    0.0694147-0.0914353im   -0.0643492+0.089896im     -0.0182323+0.13318im         0.108686+0.0649217im     0.0975699+0.0616776im       0.100298-0.00678943im      0.16692+0.143154im       -0.113429-0.102504im      0.389255+0.0635358im     0.0450737+0.017346im      -0.165458+0.0259492im   0.00788419-0.0148825im
   -0.00831-0.0419189im       0.023109+0.0286369im     0.0754539+0.0653068im     0.0713761-0.136342im     0.0322749-0.190933im     0.0337462+0.056657im      -0.152757+0.0175282im    0.0594985-0.0824136im    0.0272562-0.112147im     0.0257236+0.0233292im    0.134083-0.240272im      -0.217337-0.196715im     0.0367724+0.0349033im     -0.119953+0.0917748im      0.0325818+0.228038im       0.26175+0.0755335im     0.0880993+0.0756814im   -0.0304089-0.0599882im     0.0516852+0.0240375im      0.181205+0.179597im    -0.0477355+0.182196im    -0.0531377-0.15511im        0.220145+0.0992671im     -0.0790725-0.0767982im     0.0692144+0.111563im       -0.136522+0.182978im      0.0569881+0.0373818im        0.27161+0.0527609im    0.0710733+0.0770575im      0.291451-0.00137101im      0.17882-0.0161344im   -0.0736903+0.234929im
  0.0809429-0.00505959im     0.0268927+0.11386im      -0.0026782+0.120244im       0.235086+0.12021im      -0.110949+0.0431291im     0.120585+0.126167im      -0.107386-0.26051im        0.11678-0.0794253im    0.0664481+0.00526679im   0.0768357-0.0205037im   -0.141658+0.0451789im     -0.036837+0.180334im     0.0978353+0.0193507im      0.189538-0.0987796im     -0.0616451-0.0117492im    0.0441511+0.0795184im     -0.155105-0.402486im     0.0469189+0.0523368im     0.0570864+0.0134417im     -0.112085+0.133029im     -0.129665+0.145471im    0.00722669+0.137501im       0.233896+0.0496143im      0.0263994-0.229611im      -0.213515+0.0720187im       0.212425-0.0743351im    -0.0918573-0.083602im     -0.00198734-0.056597im     0.0596385+0.0652238im      0.032805-0.25493im      -0.0279112+0.00978166im   -0.112849+0.131266im
   0.114622+0.103434im       0.0690759+0.20987im       -0.135523+0.0308279im   -0.00920238-0.195187im     0.0547977-0.0630784im     0.187763+0.112576im      -0.021608+0.0369167im      0.11044+0.026927im    -0.0870034-0.0472039im    0.0596295+0.0269563im   -0.120611+0.202106im      -0.188924+0.0579658im    -0.173603+0.110548im     -0.0850035-0.085423im        0.118481-0.0358554im    0.0310294-0.00923614im    -0.239001+0.099607im      0.175442-0.0161798im     0.0785999-0.113295im     -0.0392142+0.080628im     -0.203463-0.239775im    -0.0948849+0.109289im      -0.100651+0.145896im      -0.0132654+0.258423im     -0.0554078+0.00056187im      0.243972+0.105201im       0.144488+0.120831im        0.181583+0.028377im     -0.220783-0.0859337im     0.0381497+0.0421427im      0.107608+0.169639im      0.168219+0.0642436im
    0.10188-0.0774181im     -0.0951171+0.091565im      -0.255629-0.0493213im     0.0347123+0.0569922im   -0.0588032-0.0365095im    0.0320542+0.0862228im     0.0528346-0.099514im     0.0736058-0.08768im     -0.0469544-0.127178im    -0.0679769-0.0809132im  0.00583927-0.00468463im    0.0272074+0.161638im     -0.164723-0.0812681im      0.109898-0.0201453im      -0.288095-0.0706253im    0.0157175-0.0314753im      0.226605+0.166237im     0.0817024-0.123035im      0.0159719+0.214654im       0.237198+0.114927im      0.144494-0.0942825im    -0.305176+0.131037im      0.0116034-0.126423im     -0.00780399+0.0346712im     -0.223475+0.198813im       -0.149987-0.0567181im     0.0709222-0.213296im        0.130133+0.136666im      0.183335+0.038395im      -0.131825+0.038588im      0.0181832+0.0831293im     0.161908-0.0147656im
  -0.188127+0.163559im      -0.0181289-0.0885609im     -0.319935+0.0897879im     0.0296897-0.0497296im      0.15581-0.0931077im     0.152915+0.2123im        -0.121754+0.0436883im     0.101834+0.098179im     -0.201612+0.236482im      0.137746-0.0618978im   -0.189404-0.127193im    -0.00744802-0.0758155im    -0.178587-0.0676269im      -0.21394+0.0462175im       0.014014-0.0568507im    0.0620943+0.0551933im      0.116403-0.0202877im    -0.114687+0.0340804im     0.0275217-0.0115675im     0.0159715-0.0374455im    0.0522532+0.111735im     -0.100148-0.060561im      0.0855707+0.0834588im     -0.0813958+0.052993im      0.0201661+0.0377896im     -0.0696621-0.340343im    0.000150642+0.0356854im     -0.0740905-0.296369im    -0.0312905+0.0220855im     -0.194978-0.0377811im     0.0472378+0.0792077im    -0.227535-0.0637901im
   0.104553-0.0958026im        0.19441-0.114588im       0.127019-0.0261767im      0.187447+0.0927952im    0.0418631+0.117503im     0.0725972+0.189831im      0.0332233-0.213045im     -0.128777-0.0449706im    0.0210124-0.0253186im   -0.0392572-0.0364007im   -0.165301-0.0968586im    -0.0921497+0.211166im     0.0515634+0.033598im     -0.0774826+0.0724975im       0.123152-0.00733892im  -0.0950928-0.287328im     -0.0550261+0.176123im     -0.203104-0.100157im       0.112659+0.0839192im     -0.112866+0.0694328im      0.01239-0.263309im    -0.0717488-0.00253013im   -0.0290836-0.0929074im      -0.100397-0.124012im      0.0807226-0.141593im       -0.077232-0.109189im      0.0302337+0.0829295im     -0.0400475+0.104705im      0.028392+0.0527305im     0.0618482+0.077345im       0.408023+0.00465749im   -0.217697-0.0808052im
   0.172922-0.0207435im       0.132792-0.391713im     -0.0826836-0.176904im     -0.0207641-0.20761im       0.154531+0.0325803im    0.0865061+0.0372899im      0.226512+0.0563128im    -0.127458-0.142773im      0.120094+0.00580095im  -0.0192951-0.19369im     -0.195153+0.136525im     -0.0264088-0.122573im      0.156932+0.0116534im     0.0112955-0.237963im       -0.152031+0.158518im    -0.0677463-0.0352007im     0.0687624-0.197065im     0.0811348-0.00114006im   -0.0311211+0.112501im      0.0403335-0.0180632im     -0.12135-0.0682394im    -0.193395-0.166409im      0.0742415-0.0104103im       0.149103-0.0946978im      0.216456+0.0689465im        0.04915-0.0388119im     0.0945239-0.0432587im       0.118746-0.0909274im    -0.083989+0.00960325im    0.0033878+0.0908968im     -0.165632+0.0606068im    -0.036188+0.0898267im
 -0.0275315-0.00180316im     0.0363905-0.122073im     -0.0135949+0.0653067im      0.105871-0.141809im     -0.255002-0.124614im     -0.122044+0.179582im      -0.120468-0.0653228im   -0.0492373-0.100923im      0.221319-0.127579im    -0.0640776+0.0389044im   0.0348234-0.0394738im    -0.0161397+0.0102758im    -0.130053+0.0785976im     -0.230427+0.0165113im      -0.060005-0.0038308im   -0.0389746-0.0488006im     0.0833525+0.0565355im    0.0667721+0.0841012im      -0.25827-0.372745im     -0.0763863+0.171845im     0.0716011+0.0509605im    -0.103051+0.0721405im     -0.131043-0.0474407im       0.197108-0.0937178im    -0.0184136-0.131758im         0.17689-0.0732859im    -0.0200399-0.0261076im      0.0266587-0.114998im      0.263798-0.315969im    -0.00860376+0.170319im     -0.0728196+0.00748088im   -0.058394-0.0148685im
 -0.0893096-0.000985972im  -0.00989385-0.253361im       0.157225-0.0746924im     0.0865111-0.12689im      -0.121848-0.155627im    0.00352448+0.0162304im     0.0550669+0.125759im    -0.0642634+0.125334im     0.0648739+0.0894539im    0.0859191-0.0160949im  -0.0863083-0.167016im      -0.131087+0.0428841im   -0.0517292-0.0837412im    -0.0135276-0.0281054im      -0.194647-0.123548im       0.18545+0.0663352im    -0.0765296+0.042634im     0.0195724-0.2643im        0.0203702-0.0267111im   -0.00878888-0.0728051im    -0.291712-0.109433im      0.207286+0.209993im      -0.211213-0.114121im       0.0028942-0.0745472im     -0.148752+0.102702im       -0.175116+0.1616im         0.191073-0.00114481im     -0.143032-0.0706948im    0.0952954+0.0337133im     0.0407816-0.228244im     -0.0808618+0.239292im    -0.0717251-0.0538618im
   0.058065+0.290324im        0.101998-0.0900557im    -0.0978284+0.0656954im     0.0371548+0.026902im     -0.159163+0.111259im     -0.259038-0.0868734im     -0.101768+0.0938002im     0.140115+0.0368024im    -0.136391-0.0996409im   -0.0900999+0.0467725im   0.0414407+0.145934im     -0.0163116+0.171381im      0.173639-0.118183im       0.174891-0.217053im        0.147261+0.082924im    -0.0733237+0.166907im       0.227017+0.0324613im   -0.0290433-0.0275348im    -0.0560815-0.0239535im    0.00865994+0.193682im    -0.0513232-0.00828696im  -0.0497746+0.0382898im    -0.0285463+0.00598779im     0.0912219-0.054762im      0.0851444-0.106021im       -0.231567+0.13853im      -0.0176337+0.25513im     -0.000547726-0.211153im     0.0029408+0.0307013im     -0.168985-0.0714548im      0.220204+0.199091im    0.00948481+0.108608im</code></pre><p>and then generate the state <span>$ψ$</span></p><pre><code class="language-julia hljs">psi = P[:, 3]</code></pre><pre><code class="nohighlight hljs">32-element Vector{ComplexF64}:
   -0.01636360506113138 - 0.05568459477542906im
    0.13707108087464007 + 0.2422585412532984im
  -0.009623798025463603 - 0.20973697284342238im
    -0.1451715728865935 - 0.009891032012703638im
    0.09291987732692462 + 0.1854243444442412im
   -0.01031015989658441 - 0.17097524257920335im
   -0.05139647839937393 - 0.29285186033529254im
  -0.005103083973604219 - 0.2648814563454137im
   -0.03592240335325686 - 0.006670894037567492im
    0.07302495851030857 + 0.05819995379096163im
     0.1036116990118485 - 0.1838466352004047im
   -0.04546063773776551 - 0.15883971574275596im
    -0.1259865180445483 - 0.10955662380196579im
   -0.04352993588942491 + 0.07490317932598985im
   -0.20335788238077224 + 0.08393443667778103im
   -0.07587805903836702 - 0.15463581937990364im
 -0.0052164632037748435 + 0.12566403577274995im
  -0.028776169252493305 - 0.2892824432991404im
     0.3039508178286205 + 0.0im
   -0.10010552288307126 - 0.23542879598381264im
    0.06909983865906542 - 0.13024540511388416im
    0.01208455600267248 - 0.055258537285065204im
     0.1466332682395373 - 0.007749750776674507im
   0.011753471800745551 + 0.16141722728195448im
    -0.0328383371860785 - 0.03220482637845992im
  -0.005610145929956811 - 0.05698865253075442im
   -0.17494660284203528 + 0.14879391206360174im
   -0.12058402220691243 - 0.10600714642166942im
   -0.06056150672514937 + 0.02367514160995863im
    0.04559669360304857 + 0.01900700146644863im
   0.022910168822515474 + 0.008156428476497501im
   -0.06712224697854823 + 0.0327619046114696im</code></pre><p>In the phase estimation process, we will feed the state to circuit and measure the first <code>n</code> qubits processed by iQFT.</p><pre><code class="language-julia hljs">r = join(ArrayReg(psi), zero_state(N))
r |&gt; PE(N, M, U)</code></pre><pre><code class="nohighlight hljs">ArrayReg{1, ComplexF64, Array...}
    active qubits: 8/8</code></pre><p>Since our phase can be represented by 3 qubits precisely, we only need to measure once</p><pre><code class="language-julia hljs">results = measure(r, 1:N; nshots=1)</code></pre><pre><code class="nohighlight hljs">1-element Vector{BitBasis.BitStr64{3}}:
 011 ₍₂₎</code></pre><p>Recall that our QFT&#39;s bit numbering is reversed, let&#39;s reverse it back</p><pre><code class="language-julia hljs">using BitBasis
estimated_phase = bfloat(results[]; nbits=N)</code></pre><pre><code class="nohighlight hljs">0.75</code></pre><p>the phase is exactly <code>0.75</code>!</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../1.prepare-ghz-state/index.html">« Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a><a class="docs-footer-nextpage" href="../3.grover-search/index.html">Grover Search »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.10 on <span class="colophon-date" title="Monday 20 December 2021 01:12">Monday 20 December 2021</span>. Using Julia version 1.7.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
