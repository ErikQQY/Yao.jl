<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quantum Fourier Transformation and Phase Estimation · Documentation | Yao</title><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/indigo.css" rel="stylesheet" type="text/css"/><link href="https://yaoquantum.org/assets/favicon-light.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../index.html"><img src="../../../assets/logo.png" alt="Documentation | Yao logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../index.html">Documentation | Yao</a></span></div><form class="docs-search" action="../../../search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../index.html">Home</a></li><li><span class="tocitem">Quick Start</span><ul><li><a class="tocitem" href="../1.prepare-ghz-state/index.html">Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a></li><li class="is-active"><a class="tocitem" href="index.html">Quantum Fourier Transformation and Phase Estimation</a><ul class="internal"><li><a class="tocitem" href="#Quantum-Fourier-Transformation"><span>Quantum Fourier Transformation</span></a></li><li><a class="tocitem" href="#Wrap-QFT-to-an-external-block"><span>Wrap QFT to an external block</span></a></li><li><a class="tocitem" href="#Phase-Estimation"><span>Phase Estimation</span></a></li></ul></li><li><a class="tocitem" href="../3.grover-search/index.html">Grover Search</a></li><li><a class="tocitem" href="../4.shor-algorithm/index.html">Shor&#39;s Algorithm</a></li><li><a class="tocitem" href="../5.shor-9-code/index.html">Shor&#39;s 9 qubit code</a></li><li><a class="tocitem" href="../6.quantum-circuit-born-machine/index.html">Quantum Circuit Born Machine</a></li><li><a class="tocitem" href="../7.variation-quantum-eigen-solver/index.html">Variational Quantum Eigen Solver</a></li></ul></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../../man/array_registers.html">Array Registers</a></li><li><a class="tocitem" href="../../../man/symbolic.html">Symbolic Computation</a></li><li><a class="tocitem" href="../../../man/blocks.html">Blocks</a></li><li><a class="tocitem" href="../../../man/automatic_differentiation.html">Automatic Differentiation</a></li><li><a class="tocitem" href="../../../man/simplification.html">Simplification</a></li><li><a class="tocitem" href="../../../man/base.html">Base</a></li><li><a class="tocitem" href="../../../man/registers.html">Abstract Registers</a></li><li><a class="tocitem" href="../../../man/bitbasis.html">BitBasis</a></li><li><a class="tocitem" href="../../../man/extending_blocks.html">Extending Blocks</a></li></ul></li><li><a class="tocitem" href="../../../benchmarks.html">Benchmark</a></li><li><a class="tocitem" href="../../../dev/index.html">Developer Notes</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Quick Start</a></li><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/QuantumBFS/Yao.jl/blob/master/docs/src/quick-start/2.qft-phase-estimation/main.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><p><a href="https://mybinder.org/v2/gh/QuantumBFS/Yao.jl/gh-pages?filepath=dev/generated/quick-start/2.qft-phase-estimation/main.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a> <a href="https://nbviewer.jupyter.org/github/QuantumBFS/Yao.jl/blob/gh-pages/dev/generated/quick-start/2.qft-phase-estimation/main.ipynb"><img src="https://img.shields.io/badge/show-nbviewer-579ACA.svg" alt/></a> <a href="https://minhaskamal.github.io/DownGit/#/home?url=https://github.com/QuantumBFS/tutorials/tree/gh-pages/dev/generated/quick-start/2.qft-phase-estimation"><img src="https://img.shields.io/badge/download-project-orange" alt/></a></p><h1 id="example-qft"><a class="docs-heading-anchor" href="#example-qft">Quantum Fourier Transformation and Phase Estimation</a><a id="example-qft-1"></a><a class="docs-heading-anchor-permalink" href="#example-qft" title="Permalink"></a></h1><p>Let&#39;s use Yao first</p><pre><code class="language-julia hljs">using Yao</code></pre><h2 id="Quantum-Fourier-Transformation"><a class="docs-heading-anchor" href="#Quantum-Fourier-Transformation">Quantum Fourier Transformation</a><a id="Quantum-Fourier-Transformation-1"></a><a class="docs-heading-anchor-permalink" href="#Quantum-Fourier-Transformation" title="Permalink"></a></h2><p>The Quantum Fourier Transformation (QFT) circuit is to repeat two kinds of blocks repeatly:</p><p><img src="assets/qft.png" alt="qft-circuit"/></p><p>The basic building block control phase shift gate is defined as</p><p class="math-container">\[R(k)=\begin{bmatrix}
1 &amp; 0\\
0 &amp; \exp\left(\frac{2\pi i}{2^k}\right)
\end{bmatrix}\]</p><p>Let&#39;s define block <code>A</code> and block <code>B</code>, block <code>A</code> is actually a control block.</p><pre><code class="language-julia hljs">A(i, j) = control(i, j=&gt;shift(2π/(1&lt;&lt;(i-j+1))))</code></pre><pre><code class="nohighlight hljs">A (generic function with 1 method)</code></pre><p>Once you construct the blockl you can inspect its matrix using <code>mat</code> function. Let&#39;s construct the circuit in dash box A, and see the matrix of <span>$R_4$</span> gate.</p><pre><code class="language-julia hljs">R4 = A(4, 1)</code></pre><pre><code class="nohighlight hljs">(n -&gt; control(n, 4, 1 =&gt; shift(0.39269908169872414)))</code></pre><p>If you have read about <a href="generated/quick-start/2.qft-phase-estimation/@ref example-ghz">preparing GHZ state</a>, you probably know that in Yao, we could just leave the number of qubits, and it will be evaluated when possible.</p><pre><code class="language-julia hljs">R4(5)</code></pre><pre><code class="nohighlight hljs">nqubits: 5
control(4)
└─ (1,) shift(0.39269908169872414)</code></pre><p>its matrix will be</p><pre><code class="language-julia hljs">mat(R4(5))</code></pre><pre><code class="nohighlight hljs">32×32 LinearAlgebra.Diagonal{ComplexF64, Vector{ComplexF64}}:
 1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im</code></pre><p>Then we repeat this control block over and over on different qubits, and put a Hadamard gate to <code>i</code>th qubit to construct <code>i</code>-th <code>B</code> block.</p><pre><code class="language-julia hljs">B(n, k) = chain(n, j==k ? put(k=&gt;H) : A(j, k) for j in k:n)</code></pre><pre><code class="nohighlight hljs">B (generic function with 1 method)</code></pre><p>We need to input the total number of qubits <code>n</code> here because we have to iterate through from <code>k</code>-th location to the last.</p><p>Now, let&#39;s construct the circuit by chaining all the <code>B</code> blocks together</p><pre><code class="language-julia hljs">qft(n) = chain(B(n, k) for k in 1:n)
qft(4)</code></pre><pre><code class="nohighlight hljs">nqubits: 4
chain
├─ chain
│  ├─ put on (1)
│  │  └─ H
│  ├─ control(2)
│  │  └─ (1,) shift(1.5707963267948966)
│  ├─ control(3)
│  │  └─ (1,) shift(0.7853981633974483)
│  └─ control(4)
│     └─ (1,) shift(0.39269908169872414)
├─ chain
│  ├─ put on (2)
│  │  └─ H
│  ├─ control(3)
│  │  └─ (2,) shift(1.5707963267948966)
│  └─ control(4)
│     └─ (2,) shift(0.7853981633974483)
├─ chain
│  ├─ put on (3)
│  │  └─ H
│  └─ control(4)
│     └─ (3,) shift(1.5707963267948966)
└─ chain
   └─ put on (4)
      └─ H
</code></pre><h2 id="Wrap-QFT-to-an-external-block"><a class="docs-heading-anchor" href="#Wrap-QFT-to-an-external-block">Wrap QFT to an external block</a><a id="Wrap-QFT-to-an-external-block-1"></a><a class="docs-heading-anchor-permalink" href="#Wrap-QFT-to-an-external-block" title="Permalink"></a></h2><p>In most cases, <code>function</code>s are enough to wrap quantum circuits, like <code>A</code> and <code>B</code> we defined above, but sometimes, we need to dispatch specialized methods on certain kinds of quantum circuit, or we want to define an external block to export, thus, it&#39;s useful to be able to wrap circuit to custom blocks.</p><p>First, we define a new type as subtype of <code>PrimitiveBlock</code> since we are not going to use the subblocks of <code>QFT</code>, if you need to use its subblocks, it&#39;d be better to define it under <code>CompositeBlock</code>.</p><pre><code class="language-julia hljs">struct QFT &lt;: PrimitiveBlock{2}
    n::Int
end

YaoBlocks.nqudits(q::QFT) = q.n</code></pre><p>Now, let&#39;s define its circuit</p><pre><code class="language-julia hljs">circuit(q::QFT) = qft(q.n)</code></pre><pre><code class="nohighlight hljs">circuit (generic function with 1 method)</code></pre><p>And forward <code>mat</code> to its circuit&#39;s matrix</p><pre><code class="language-julia hljs">YaoBlocks.mat(::Type{T}, x::QFT) where T = mat(T, circuit(x))</code></pre><p>You may notice, it is a little ugly to print <code>QFT</code> at the moment, this is because we print the type summary by default, you can define your own printing by overloading <code>print_block</code></p><pre><code class="language-julia hljs">YaoBlocks.print_block(io::IO, x::QFT) = print(io, &quot;QFT($(x.n))&quot;)</code></pre><p>Since it is possible to use FFT to simulate the results of QFT (like cheating), we could define our custom <code>apply!</code> method:</p><pre><code class="language-julia hljs">using FFTW, LinearAlgebra

function YaoBlocks.apply!(r::ArrayReg, x::QFT)
    α = sqrt(length(statevec(r)))
    invorder!(r)
    lmul!(α, ifft!(statevec(r)))
    return r
end</code></pre><p>Now let&#39;s check if our <code>apply!</code> method is correct:</p><pre><code class="language-julia hljs">r = rand_state(5)
r1 = r |&gt; copy |&gt; QFT(5)
r2 = r |&gt; copy |&gt; circuit(QFT(5))
r1 ≈ r2</code></pre><pre><code class="nohighlight hljs">true</code></pre><p>We can get iQFT (inverse QFT) directly by calling <code>adjoint</code></p><pre><code class="language-julia hljs">QFT(5)&#39;</code></pre><pre><code class="nohighlight hljs"> [†]QFT(5)</code></pre><p>QFT and iQFT are different from FFT and IFFT in three ways,</p><ol><li>they are different by a factor of <span>$\sqrt{2^n}$</span> with <span>$n$</span> the number of qubits.</li><li>the <a href="https://quantumbfs.github.io/BitBasis.jl/stable/tutorial/#Conventions-1">bit numbering</a> will exchange after applying QFT or iQFT.</li><li>due to the convention, QFT is more related to IFFT rather than FFT.</li></ol><h2 id="Phase-Estimation"><a class="docs-heading-anchor" href="#Phase-Estimation">Phase Estimation</a><a id="Phase-Estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Phase-Estimation" title="Permalink"></a></h2><p>Since we have QFT and iQFT blocks we can then use them to realize phase estimation circuit, what we want to realize is the following circuit:</p><p><img src="assets/phaseest.png" alt="phase estimation"/></p><p>First we call Hadamard gates repeatly on first <code>n</code> qubits.</p><pre><code class="language-julia hljs">Hadamards(n) = repeat(H, 1:n)</code></pre><pre><code class="nohighlight hljs">Hadamards (generic function with 1 method)</code></pre><p>Then in dashed box <code>B</code>, we have controlled unitaries:</p><pre><code class="language-julia hljs">ControlU(n, m, U) = chain(n+m, control(k, n+1:n+m=&gt;matblock(U^(2^(k-1)))) for k in 1:n)</code></pre><pre><code class="nohighlight hljs">ControlU (generic function with 1 method)</code></pre><p>each of them is a <code>U</code> of power <span>$2^{(k-1)}$</span>.</p><p>Since we will only apply the qft and Hadamard on first <code>n</code> qubits, we could use <code>Subroutine</code>, which creates a context of a sub-scope of the qubits.</p><pre><code class="language-julia hljs">PE(n, m, U) =
    chain(n+m, # total number of the qubits
        subroutine(Hadamards(n), 1:n), # apply H in local scope
        ControlU(n, m, U),
        subroutine(QFT(n)&#39;, 1:n))</code></pre><pre><code class="nohighlight hljs">PE (generic function with 1 method)</code></pre><p>we use the first <code>n</code> qubits as the output space to store phase <span>$ϕ$</span>, and the other <code>m</code> qubits as the input state which corresponds to an eigenvector of oracle matrix <code>U</code>.</p><p>The subroutine here uses <code>focus!</code> and <code>relax!</code> to manage a local scope of quantum circuit, and only activate the first <code>n</code> qubits while applying the block inside the subroutine context, and the scope will be <code>relax!</code>ed back, after the context. This is equivalent to manually <code>focus!</code> then <code>relax!</code></p><p>fullly activated</p><pre><code class="language-julia hljs">r = rand_state(5)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qudits: 5/5
    nlevel: 2</code></pre><p>first 3 qubits activated</p><pre><code class="language-julia hljs">focus!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qudits: 3/5
    nlevel: 2</code></pre><p>relax back to the original</p><pre><code class="language-julia hljs">relax!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qudits: 5/5
    nlevel: 2</code></pre><p>In this way, we will be able to apply small operator directly on the subset of the qubits.</p><p>Details about the algorithm can be found here: <a href="https://en.wikipedia.org/wiki/Quantum_phase_estimation_algorithm">Quantum Phase Estimation Algorithm</a></p><p>Now let&#39;s check the results of our phase estimation.</p><p>First we need to set up a unitary with known phase, we set the phase to be 0.75, which is <code>0.75 * 2^3 == 6 == 0b110</code> .</p><pre><code class="language-julia hljs">N, M = 3, 5
P = eigen(rand_unitary(1&lt;&lt;M)).vectors
θ = Int(0b110) / 1&lt;&lt;N
phases = rand(1&lt;&lt;M)
phases[0b010+1] = θ
U = P * Diagonal(exp.(2π * im * phases)) * P&#39;</code></pre><pre><code class="nohighlight hljs">32×32 Matrix{ComplexF64}:
    -0.058746-0.0197908im   -0.00916167-0.154106im     -0.212415+0.00594241im     0.144671-0.0161176im    0.0690147+0.0872477im    -0.0790659-0.125282im      -0.121923+0.249733im      -0.108256-0.121956im      0.0166663+0.007851im       -0.26756+0.197813im     -0.0480134-0.0601833im     0.109211-0.102363im      -0.156275-0.120755im        0.208586-0.0641873im    -0.0810153-0.0377081im     -0.226573+0.0776118im      0.111961+0.088785im     -0.0984961-0.115847im    0.0268389+0.104126im      0.0736722+0.141659im      0.0945463+0.0340798im     -0.063307+0.0290014im     -0.222851-0.118266im       0.139133+0.0906084im    -0.0870261+0.162619im     -0.080807-0.0826706im  -0.0262582-0.226447im     0.00207119-0.151409im      -0.142065-0.135414im        0.126308+0.13837im         0.197248+0.0165808im    -0.226972+0.0557377im
     0.131478-0.118811im      -0.115531+0.168253im      0.089839-0.0772289im     -0.278649-0.0282589im   -0.0519103+0.0773452im     -0.103027-0.0955286im     0.0189394+0.250932im       0.171773+0.0660407im     0.0846956-0.253539im      -0.164595+0.085238im      0.0367911-0.173212im    -0.0754632+0.049965im       0.324004-0.0276219im      0.0714603-0.155379im       0.142831+0.0968058im     -0.065484+0.308063im     -0.0575446-0.0825906im      0.104093-0.0272684im   -0.108211-0.0577404im    -0.0268468+0.054043im      -0.175813+0.0842497im     -0.179757-0.137652im     -0.0782714-0.062927im    -0.00596039-0.015561im      -0.203371+0.0766621im    -0.089293+0.0950289im  -0.0871522+0.0183321im     -0.145294+0.0747741im      0.135984-0.0139122im     -0.0839961+0.124504im       -0.111586-0.0810502im  -0.00363979+0.0189689im
   -0.0879853-0.022271im      -0.108084+0.233608im     -0.165367+0.136049im       0.132954-0.0582163im      0.17719+0.0904953im      0.282487+0.130333im      -0.143391-0.0739776im     0.0523913-0.0234428im     0.0921451+0.0380863im    -0.0321151-0.0239295im      0.143145-0.247187im     0.0923391-0.185336im      0.0917877+0.0439123im     -0.0549706-0.0986357im    0.00121903+0.0575437im     0.0587222-0.0209354im     0.0198503+0.00856303im    -0.264806+0.132807im   -0.0729591+0.0844522im     -0.107204+0.258085im       0.186947+0.0901693im    -0.0961508-0.134892im      -0.261928+0.124945im      -0.188677-0.0590856im   -0.00757873+0.0977222im   0.00471179-0.0295852im    0.173003+0.175537im     -0.0633969-0.0273403im     0.0153026+0.0449387im      0.0122699-0.0458759im      0.0149568-0.0551823im     0.209181-0.162512im
   -0.0962331-0.081274im         0.1732+0.113285im      0.212737+0.135394im      0.0599117+0.160633im      0.124469+0.164912im       0.225373-0.057445im       0.108615+0.0632533im     0.0466033-0.0538142im   -0.00744182+0.0860177im     0.0097614-0.205039im     0.00196395+0.277123im     0.0810688-0.0406621im     0.0108767+0.0623473im     -0.0776747+0.129368im      -0.112418+0.280461im      -0.037285+0.0231053im     -0.251405+0.0329999im     0.0248679-0.130987im    -0.140312-0.0112078im      0.110339+0.0870133im     -0.154129+0.0245101im    -0.0390172+0.034984im   -0.000870125+0.077024im       0.154147-0.0931761im    -0.0366933+0.0492785im    -0.170904-0.0158343im  0.00625716+0.0973202im    -0.0595064-0.0910177im     0.0758416+0.188262im         0.21158+0.239346im        0.180483-0.190372im     -0.149152+0.00859873im
     0.159592+0.0723848im    -0.0641841+0.155112im    -0.0622823-0.158422im      0.0175094+0.00744791im     0.10855-0.0814517im      -0.03375+0.0214823im     0.0867192-0.0850953im    -0.0438978+0.0347956im     0.0152281-0.140884im       0.196429-0.126959im       0.166149+0.130103im     -0.298436-0.0730697im     0.0309928-0.032338im      -0.0231379-0.120654im      -0.197873-0.276997im     -0.0859295+0.0192241im     0.0482159+0.216298im      0.0503895+0.102714im    -0.155175+0.108414im      -0.114164+0.0627076im    -0.0431206-0.173261im      0.0349272-0.013687im     -0.0311807+0.0346245im    0.00552396+0.175325im     -0.0681712+0.0846997im  -0.00243762-0.134077im    0.0362504+0.209779im      -0.112497-0.27764im       0.0270606-0.0972238im       0.214623+0.0890961im      -0.191362+0.0433866im      -0.2559+0.0717019im
    0.0556427-0.229716im     0.00146671-0.107409im    -0.0840369-0.353214im      0.0097429+0.00976704im    0.022337-0.189742im      0.0700963+0.228495im     -0.0866032-0.0366303im     -0.126918+0.0664262im   -0.00756624-0.0472459im    -0.0674396+0.135566im      -0.156881-0.00149847im    0.090236+0.240643im       0.086389+0.0437959im      -0.079889-0.166304im     0.00985355+0.0445221im       -0.1389-0.144485im      -0.213524-0.0214749im    -0.0244723-0.0792888im     0.08588-0.0310383im    -0.0268684+0.0173023im     0.0962224+0.0435332im     -0.212018-0.0615672im     0.0830673+0.095241im      -0.106492+0.160228im       0.170384-0.119326im     -0.257248-0.0287819im  -0.0413856-0.084355im     -0.0111253-0.197286im     -0.0141799+0.218094im        0.197326-0.0551948im      -0.109621-0.182308im   -0.00189864-0.087812im
    0.0228932+0.138828im      0.0145277+0.233999im     0.0308538+0.0635463im    0.00924348+0.233925im     0.0368913-0.126958im       0.021171+0.0450563im    -0.0636967+0.0985326im    -0.0521491+0.018948im    -0.00440216-0.0468777im     -0.334036+0.0294572im      0.138355+0.142736im     0.0951337-0.0931499im     -0.115237+0.050628im        0.107381-0.146377im      -0.156512+0.0357215im      0.260398+0.0819429im     -0.112101+0.160856im      0.0362633-0.0320508im   -0.140344-0.185266im       0.155634-0.208597im      0.0407755+0.0263493im    -0.0328599-0.0599874im    -0.0763591-0.013623im      0.0894673+0.0924519im     0.0663787-0.276629im    -0.0573668-0.103125im    0.0735104-0.00870515im   -0.0430634+0.0605651im     -0.316305-0.0646222im      -0.131751-0.10006im        -0.257162-0.0082878im   -0.0107632-0.108282im
    0.0124195-0.0275312im    -0.0939196+0.0569829im     0.127129+0.204087im      0.0804552-0.0120423im     0.108307+0.0211424im    -0.0990874-0.0296054im    0.00953871-0.114041im      0.0660972+0.280711im      0.0244086-0.203324im       0.119735+0.0515242im     0.0140054+0.0456229im    0.0830865+0.213287im       0.167282-0.0522662im       0.130664+0.133008im      0.0501088-0.0404723im     0.0296673-0.116292im     -0.0344808+0.129983im      -0.145995+0.119639im      0.10346-0.0887237im      0.108362+0.18876im       0.0543977+0.123392im       0.148761-0.0910021im     0.0464317+0.0817894im    -0.0373008-0.00463556im    -0.211331-0.195661im      -0.20203+0.0659985im    -0.13693-0.111595im      0.0404768+0.115203im      -0.224732-0.162611im        0.327787+0.0766664im      0.0432094+0.234035im    0.00095667-0.0785298im
   -0.0644731-0.224459im      0.0776989+0.049102im      0.189872+0.0849138im     0.0948269+0.0683118im    -0.175477+0.0109045im      0.175349-0.0993392im    -0.0533915+0.0176916im     -0.144727-0.119493im      0.0998014+0.14922im        0.142244-0.177578im      0.0559488+0.130211im      0.133577+0.0416419im      0.190254+0.0145389im       0.164036-0.0928936im     0.0402609-0.179092im      0.0931284-0.0013496im      0.268848-0.220524im     -0.0269721-0.0142418im    0.143795+0.138383im     -0.0942609-0.220765im       0.123078+0.0773805im    -0.0505755+0.0160459im     -0.125982-0.0258713im    -0.0876985+0.249804im     -0.0292877+0.0487416im   0.00285867-0.0623597im   -0.192422-0.060836im      -0.257644+0.183146im     -0.0721002+0.0190885im      0.0758413+0.0856438im       -0.14983-0.0793385im   -0.0838089+0.0116105im
     0.259688+0.292199im     -0.0424776-0.134803im    -0.0713449-0.0111488im     0.0233673-0.326238im    -0.0470302+0.134458im       0.189167+0.0133855im      0.187759-0.156282im     -0.0641724-0.214321im      -0.161362+0.00599033im    -0.118686-0.0103561im     -0.130039-0.0398293im    0.0898362+0.0195431im      0.299437-0.0620354im     -0.0791509+0.0580814im    -0.0123154-0.0511782im      0.158801-0.118817im      -0.125295+0.15369im        0.190991+0.111759im     0.101376-0.0225463im      -0.01541-0.0117134im     -0.103117+0.106489im      0.0109006+0.0807561im     -0.268958-0.0553536im      0.179166+0.125526im     -0.0918876-0.0404303im   -0.0303198+0.0260175im  -0.0729209+0.0352418im    -0.0826852+0.0206173im     -0.127037-0.00503599im     0.0096343-0.0700906im      0.0621917-0.183715im     0.0232938+0.0203228im
   -0.0144625+0.161507im      -0.141026-0.0437272im    0.0268477-0.262501im      -0.201848+0.243004im     -0.111264+0.00976784im    0.0146467-0.0750889im      0.153751+0.153757im      0.0473177-0.011058im       0.194164-0.122818im     -0.0593286-0.0900488im     0.0782431+0.081166im    -0.0321193+0.194079im      0.0446268+0.0159229im      -0.126012+0.356822im      -0.213914-0.00579751im    0.0596741-0.0853507im      0.247891-0.0639098im    -0.0799479+0.145489im   -0.0235926-0.0478823im     0.0455151+0.00346672im     0.334791-0.00940291im    -0.125911+0.172593im      -0.200546+0.0369361im     -0.032641-0.129458im     -0.0428985+0.0294799im   -0.0546778+0.135141im     0.066549-0.0854652im     -0.010651-0.1387im       -0.0746402+0.0879989im     -0.0269748+0.0112943im      0.0580049-0.0541684im    0.0761201-0.00707915im
    0.0160558+0.0935292im    0.00397874-0.130612im      0.123754+0.0642847im    -0.0863315-0.117273im      0.235165+0.0772435im    -0.0885079+0.0278262im     0.0927661+0.0758684im      0.275228+0.00609189im   -0.0607763-0.0224144im      0.111988-0.00714565im    0.0528376+0.217749im      0.018429+0.0293517im       -0.1387-0.0217055im       0.157599-0.126453im      -0.210236+0.277517im     -0.0692442-0.262234im     -0.0244973+0.103696im     -0.0895598-0.0539478im     0.18643+0.107972im     -0.0468935+0.169682im     -0.0669459+0.0395958im     -0.200594+0.169353im     -0.0622136-0.13389im       -0.204815+0.203491im      0.0148396+0.0921208im    0.0320102+0.018721im   -0.0504841-0.0601837im    -0.0951944+0.0468529im    0.00459443+0.0321707im       -0.22616+0.00357084im     -0.268603+0.0633673im      0.11641+0.0218569im
    -0.119696+0.0657375im     0.0922099-0.0976249im    -0.112652+0.0751383im    -0.0438153+0.0361055im     0.136992+0.00915753im     0.132352+0.111148im       0.156198+0.138971im     -0.0615348+0.163705im      0.0015257+0.106758im       -0.19199+0.198996im       0.260314+0.181886im     -0.143218+0.14601im       0.0386384+0.0311411im     -0.0105634+0.0582458im   -0.00558816-0.0306197im    0.00852646+0.0160603im     0.0930144+0.0160545im      0.303527+0.112081im   -0.0675932-0.0604536im     -0.152764+0.131786im      0.0554791+0.280107im      0.0563826-0.135822im       0.143147+0.0724648im    -0.0590645+0.119357im        0.12728+0.171972im      0.140615-0.0601675im    -0.25959+0.011434im      -0.068148+0.0722156im       0.09223+0.0243692im     -0.0287349-0.128973im        0.171786+0.0487832im    -0.116183-0.230817im
    -0.102401+0.0764223im     -0.298681-0.128491im     0.0637975+0.00354523im    0.0924974+0.0900477im    0.0434711-0.0250496im      0.258895-0.151563im      -0.172915+0.0908543im    -0.0493941-0.0823335im     -0.248399-0.0739771im     0.0612395+0.00674396im     0.210915-0.0998951im    -0.114784+0.0128723im     0.0267228-0.0685691im     -0.0995356-0.0162805im    -0.0964561-0.149841im    -0.00228237-0.0666714im     -0.125131+0.0264984im      0.175931-0.114766im    0.0442614+0.0547828im      0.259103-0.0738976im     -0.108619-0.118256im      -0.135031-0.116102im     -0.0788036-0.0375024im    -0.0716705-0.246467im       0.062738+0.0380589im    0.0865216-0.108479im    -0.254331-0.176726im     0.00438961+0.00848998im    0.0743337+0.122232im        0.128488+0.0775119im      -0.107232+0.190363im      0.214385-0.0197236im
    0.0363628+0.160376im      0.0545502+0.281524im    -0.0431881+0.0150685im    -0.0103306-0.0614312im   -0.0474935+0.0966421im     -0.194701-0.0523501im      0.141908-0.0552677im    -0.0168249-0.0900733im      0.224366+0.197617im      0.0522106+0.080471im      0.0636144+0.184919im      0.176587+0.237608im      -0.135072+0.126552im       0.0877375-0.133436im        0.14915-0.220221im     -0.0915807-0.0614574im     -0.123756-0.0188933im      0.135834+0.0618217im   0.0788593+0.153948im       0.109159+0.0426032im     0.0307779-0.00662215im    -0.259087-0.141098im     -0.0784632+0.0340798im      0.243803-0.103747im     -0.0930441-0.0255043im    0.0394722-0.0672429im    0.169465-0.12185im      -0.0437281-0.0233659im      0.217047+0.109678im       0.0802604-0.104502im    -0.000637381+0.157232im        0.1431-0.0593215im
     0.163073-0.159498im     -0.0948365+0.152761im     0.0804614+0.00583918im     0.229088-0.0396277im     0.142318+0.10846im       0.0438976-0.0215588im     -0.157183+0.00256148im      0.12118-0.0496006im     0.0155203+0.165725im      -0.016383+0.128536im       0.139248+0.125076im       -0.1576+0.0917742im      0.248023-0.00639804im    -0.0204534+0.056173im      -0.117935-0.0318898im    -0.0499907+0.114375im      -0.235418-0.135501im     -0.0825203+0.0788728im    0.113459+0.105769im      0.0358265-0.164429im       0.077625+0.121699im     -0.0217821+0.0679449im   -0.00193295+0.0935554im      0.100471+0.0484569im      0.188184-0.0146346im     0.109613+0.338911im   0.00470056-0.0659212im      0.194376-0.228174im     -0.0470033-0.134798im       -0.222009-0.0482674im      0.0357232+0.125239im     -0.117643+0.156684im
   -0.0288761-0.0282968im     0.0761352+0.0843231im   0.00832369-0.0242198im     -0.100753+0.155897im    -0.0243324-0.0395364im     0.0134832-0.00349142im     0.123101+0.118065im     -0.0230689+0.175231im     -0.0478862-0.0171375im    -0.0254069+0.0205512im      0.148578+0.0127604im     0.113162-0.0592341im      0.208157-0.219697im    -0.000903865-0.0352918im       0.17706-0.157008im     -0.0505919-0.255805im       0.102278-0.0791655im     -0.273471+0.0378238im   0.0903383+0.0141096im      0.151152+0.126109im      -0.425851+0.0302303im     0.0356639+0.0657592im      -0.13241+0.0496542im    -0.0228099-0.0587215im       0.12725-0.159992im      0.149217-0.230817im    0.0306101-0.0208917im     0.0271972-0.157035im     -0.0336169+0.120046im       -0.156656-0.183044im        0.118457-0.0631118im    -0.152433+0.133399im
 -0.000531725+0.0288416im     0.0860823+0.00695783im   0.0900027-0.0665565im     -0.196277+0.146043im    -0.0690866-0.015904im    -0.00942075-0.100311im       -0.11035-0.153183im       0.416332+0.0119843im    -0.0391887+0.0761811im    -0.0940041+0.11563im      -0.0973029-0.029575im      0.137436-0.225681im      0.0159129+0.0601446im      0.0423911+0.151218im    0.000931954+0.0328983im      0.109173+0.0736488im     0.0791821+0.120875im     -0.0141532+0.109088im     0.132488+0.181141im        -0.2691-0.014449im     -0.0200813-0.105246im    -0.00717767-0.139274im     -0.0387719+0.159702im       0.219255+0.0237375im      0.248196-0.0167302im    -0.109936-0.173545im    -0.301748-0.0607573im   0.000111481-0.188675im      0.0755708-0.0872248im       0.109453-0.0188099im     -0.0274259+0.0618043im     0.105669-0.00125845im
   -0.0210248+0.0155961im      0.146931-0.232157im    -0.0568451+0.0837325im    -0.0382465-0.0667328im    -0.208849+0.0057723im     -0.356827-0.134384im      -0.287034-0.183836im      0.0781488+0.0870467im    -0.0137148+0.154839im      0.0263223+0.0284817im      0.127269+0.00418919im  0.00296712+0.104912im      0.0564528-0.00172605im   0.000419825+0.00281311im   0.00870333-0.0730033im        0.1138+0.0856848im     -0.192146+0.0378751im    -0.0257503+0.138037im    -0.194904-0.0949098im      0.128904+0.0627053im    -0.0209266-0.0174189im   -0.00369551+0.124889im      -0.264823-0.0342111im     -0.162845-0.0317901im       0.23095+0.0943044im   -0.0386857+0.0543906im  0.00192448+0.135133im      -0.198413-0.0182445im    -0.0696197+0.257009im      -0.0125541+0.146305im      0.00768826+0.0785708im    -0.148847-0.143779im
    0.0730916+0.0644479im    -0.0869117-0.0645902im     0.194699-0.026515im      0.0660448-0.205357im     -0.298914+0.0427156im      0.152187+0.0339895im    -0.0690693+0.0137912im    -0.0173932-0.0149274im     0.0359407-0.0547504im     -0.164352-0.0824498im    -0.0197656+0.117447im     0.0829135+0.145207im      -0.140729-0.0506105im      0.0378578-0.169882im        0.13676-0.00851701im     0.103132-0.026859im    -0.00457733-0.0460666im    -0.0843428-0.0856798im    -0.32975+0.0719802im     0.0861535+0.185537im      0.0394108+0.0260774im    -0.0110908+0.217687im       0.191224+0.365505im     -0.0341976-0.042049im     -0.0473567+0.0966501im   -0.0191862-0.104345im    -0.183278+0.0571343im    -0.0857581-0.21283im      -0.0175472-0.224876im       -0.130145-0.0252296im      0.0173966+0.111276im      0.110455+0.093472im
   0.00346117-0.119252im      0.0540235-0.172148im     0.0267833-0.297154im       0.100824-0.139428im    0.00682066-0.0622337im     0.0515782-0.146798im    -0.00442224+0.162975im      0.0229658+0.0227681im     -0.217572-0.0402211im      0.222289+0.130389im     -0.0658935+0.126123im      0.198728+0.0338339im      0.135478+0.263543im        0.181931+0.0320331im     -0.270814-0.00546213im   -0.0117837+0.249176im      0.0827265-0.0213432im    -0.0188244+0.11715im    -0.0965783+0.026924im      0.0654966+0.105389im      -0.076245+0.133254im      0.0631173+0.0149612im    -0.0676421+0.185893im      0.0832534-0.0867875im    -0.0321499-0.0725578im     0.167247-0.218462im     0.217725+0.0845189im      0.157533+0.156404im      0.0321183-0.0401222im      -0.011898-0.0171159im      -0.080327-0.0107771im    0.0579922-0.134234im
     0.165062+0.0339093im     0.0918819-0.381931im    -0.0692539+0.198386im     0.00994938+0.109467im      0.235012-0.0142987im    0.00181608-0.0714022im     0.0526374+0.0830904im     0.0948074+0.154862im     -0.0632702-0.0243706im      -0.20112-0.11554im       -0.144417+0.0773188im    0.0763114+0.0911537im     0.0870016-0.0202367im     -0.0924108-0.17451im       0.0577533-0.0140946im     0.0494775+0.0385165im     0.0881613-0.135041im     -0.0893737-0.0527178im    0.170901+0.00209654im    0.0662108-0.252024im       0.122458-0.0969901im    -0.0472394-0.144589im   -0.000623683+0.0867676im     0.0203153-0.0308187im     -0.172696-0.0822482im     0.181622+0.0101093im     0.11377+0.30972im       -0.139108-0.244im          0.113832-0.026601im       0.0542109+0.0774065im      0.0180185+0.149425im     0.0475174-0.0938801im
     0.049602-0.163729im     -0.0710132+0.010884im      -0.14583+0.154132im      0.0557385-0.139255im     -0.147569+0.0264545im   -0.00123792-0.079569im       0.222687+0.0500169im      0.193726-0.124207im     -0.0173095-0.203146im      -0.152171-0.181429im       0.029879-0.0521623im   -0.0742783-0.09929im     -0.00121092+0.227522im        0.197998+0.0914614im   -0.00110258-0.300867im      0.0781118-0.00384647im    0.0172373+0.198676im      -0.106273-0.216891im     0.165262-0.216193im    -0.00137824+0.0400737im     0.0552919+0.125213im     -0.0840005-0.0106706im      0.206372+0.153682im     0.00245654+0.0664087im      0.183757+0.0713829im     0.047382+0.0204386im   0.0813795-0.0131708im     0.0743804-0.0159095im    -0.0154937+0.334643im      0.00131973+0.0907555im    -0.00820693+0.0557113im   -0.0155297+0.0575445im
   -0.0721243+0.309725im      0.0638156+0.0777413im   -0.0953696-0.123475im      0.0369799-0.092713im     0.0357561+0.031882im        0.21351+0.095504im      -0.038594-0.0447281im      0.226747+0.0348654im      0.176175+0.278236im     -0.0733303+0.16448im      -0.0223215+0.0591652im    0.0771329+0.147648im       0.112703-0.151977im       0.0150376-0.13138im      -0.0757357-0.0906364im    -0.0387288+0.107045im       0.267833+0.00577328im   -0.0157754-0.102466im    0.0754297-0.23625im        0.023013-0.0574294im     -0.240684-0.178005im      0.0479516+0.0299039im      0.134124+0.0976222im     -0.144033-0.0749286im     0.0677457+0.097384im    -0.0633458+0.115211im     0.117764-0.037797im      0.0979924+0.0960747im    -0.0910044+0.000193888im     0.116228+0.305245im        -0.10076-0.0275425im    0.0198675+0.0469285im
    0.0934956-0.233006im      0.0366978-0.0894606im    0.0658825-0.130312im       0.129236-0.007232im     0.0217316+0.0787159im   -0.00262135+0.0750434im       0.20575+0.0170029im     -0.206899+0.0987807im      0.197672+0.170104im       0.021245+0.0476492im    -0.0846247-0.0732653im     0.128354-0.194582im      0.0474526+0.0236179im       0.027239+0.213465im     -0.0367686+0.0595182im      0.139143-0.0699887im     0.0672874+0.0967252im     0.0538351+0.132248im    -0.110629-0.222079im       0.299541+0.0478095im    -0.0967227-0.146628im      -0.170873-0.267037im     -0.0145316-0.0967492im    -0.0519137+0.189741im       0.102395+0.159976im    -0.0514268+0.0372728im  -0.0411537+0.0734835im    -0.0422576-0.0627999im      0.077461-0.1251im        -0.0857158+0.0454098im     -0.0403322+0.250086im      0.143841+0.172788im
    -0.120257+0.0290504im    -0.0388277+0.12461im       0.100528-0.0430292im   -0.00327435+0.0504744im    -0.265016+0.121082im      -0.030805-0.118096im      -0.146014-0.160156im     -0.0645594+0.172122im       -0.10116-0.0963815im   -0.00853674+0.217622im       0.105514+0.0352807im    0.0226951-0.156181im     -0.0942253+0.155071im       -0.118882-0.0896052im   -0.00539261+0.15414im         0.12978-0.0393282im     0.0924354-0.0201733im      0.277156-0.0869497im    0.309479-0.13784im       0.0734604+0.0819988im   -0.00837076+0.163934im     -0.0445253+0.0691131im    -0.0569962+0.0511461im     -0.165019+0.208256im      -0.135055-0.0378299im     0.226357+0.0737016im    0.172857+0.0451267im     0.0345041-0.242443im      0.0703558-0.0743388im       0.168285+0.0862374im      0.0749268-0.0809197im    0.0103953+0.118155im
    -0.141965-0.247143im      0.0592527-0.0906729im   -0.0688815+0.130068im      -0.108853+0.131092im    -0.0935737-0.0830653im      0.110955-0.0987436im     0.0743298+0.0208515im       0.17106-0.145355im       0.294999+0.0698198im    -0.0441985+0.186057im    -0.00286832-0.0593302im    -0.158624+0.129123im      0.0879547+0.100502im       0.0948941-0.1001im         -0.10588-0.0339648im    0.00244952-0.114628im      -0.183736+0.0939052im      0.079823-0.0452097im   0.0209968+0.0164529im      0.131557-0.0867781im    -0.0707453-0.132139im        0.32428+0.162979im      -0.135367+0.00674377im   -0.0774295+0.110169im      -0.232744+0.165094im    -0.0908486-0.101666im    0.0103955+0.137091im       0.168184-0.0659548im    -0.0100941-0.0384395im      0.0553972-0.258517im     -0.00320453-0.0229893im      0.18779+0.000823434im
   -0.0990345-0.00281204im    0.0528761+0.0894449im   -0.0918364-0.0184526im     0.0641375-0.152422im      0.204839+0.00308558im    -0.145318-0.0540174im    -0.0938119-0.114215im      0.0266753-0.193164im    -0.00280313-0.187322im     -0.0962459+0.0823361im   -0.00949444+0.350038im    0.00993718-0.00752889im     0.109367-0.0321146im      -0.229538+0.183917im       0.116652-0.0167106im    -0.0451753+0.178064im       0.118254-0.0394895im     0.0761468-0.173957im   -0.0675863+0.0572191im     0.0379639-0.0072286im     0.0877137-0.125438im     0.00736241-0.0803721im     -0.112267+0.069102im      -0.277164+0.159572im     -0.0661836-0.16796im      -0.147859-0.236496im   -0.0693755+0.0647102im     0.0783305+0.102134im     0.00488923+0.14938im        -0.142553-0.0455046im       0.135885+0.0903275im     0.108562+0.258279im
   -0.0633227+0.212766im      -0.128742+0.0993514im    0.0502218+0.0168946im     0.0965534+0.0762623im    0.0535381-0.252552im       -0.12839+0.182852im      -0.159448-0.0750465im     -0.096668+0.0439429im      0.211971-0.0108672im    -0.0978879+0.0654916im     -0.243808-0.0479182im    0.0591159-0.119055im       0.240399+0.00756865im     0.0366391+0.170087im      -0.123275+0.0400846im     0.0378054+0.0480921im    -0.0258665-0.0657808im   -0.00888577-0.055464im    0.0747086+0.184684im       0.115312+0.0544386im    -0.0305394+0.228466im      0.0380535+0.196417im       0.224086-0.125963im         0.1432-0.00454654im    -0.140486+0.214186im      0.157642-0.151382im   -0.0763517+0.126815im     -0.0711344-0.0479965im   -0.00219255+0.280827im     -0.00678224+0.0394106im      -0.125542+0.131512im    0.00542286+0.019002im
     -0.12679+0.0179038im     0.0607012+0.0787431im    0.0447998-0.143645im     -0.0789295-0.179286im    -0.0157735-0.293245im     -0.0402334+0.0448803im      0.152409+0.000812143im    0.105314-0.0541875im    -0.0125258+0.0581886im    -0.0630242+0.00945648im   -0.0779622+0.0163783im    0.0270189-0.188712im     0.00953622+0.0615522im     -0.0357763+0.0155174im     -0.193631-0.12696im      0.00377084-0.17207im      -0.0908578-0.206012im    -0.00254729-0.348169im   -0.0608819+0.0542115im     0.0810077+0.124376im      0.0346626+0.0376384im      0.297706-0.222937im      -0.197786+0.0782225im    -0.0554542-0.0507887im     -0.016206-0.120503im      0.060999+0.310618im   -0.0433438-0.104998im      -0.275918-0.021704im      0.0915705-0.106984im      -0.0266602+0.0437663im      0.0218796+0.0998318im   -0.0835679-0.0991242im
    -0.127224+0.0701278im    -0.0440204-0.060072im       0.10014-0.18098im       -0.253026-0.0179064im     0.213087+0.196373im       0.295118+0.0383678im   -0.00198535-0.186837im     -0.0854517-0.0405579im   -0.00716085-0.027729im      0.0833009+0.0914372im    -0.0548409-0.148457im     -0.048579+0.0655081im     -0.190104+0.059668im        0.258188+0.0786647im      0.073029-0.0136303im      0.179174+0.200566im      -0.108813-0.0890001im    -0.0840946-0.0324926im   0.0962438-0.0811675im    -0.0440531-0.093047im     -0.0497163+0.00840238im   0.00533406+0.0337809im    -0.0455291+0.0541412im    -0.0718671+0.00590249im    -0.134003-0.0168932im    -0.108783-0.0540115im    0.103433-0.0366979im     -0.165662-0.0752291im    0.00719116+0.153668im      -0.0808261-0.156716im       0.0464913+0.320556im      -0.31953+0.0586935im
   -0.0358462-0.183119im     -0.0839569+0.0741319im     -0.14893-0.143146im          0.155-0.173196im     0.0927046+0.0373935im    -0.0492449-0.00405267im    -0.127385-0.111151im       0.155975-0.0250183im      0.122182-0.111856im     -0.0622586-0.0225226im     0.0228899+0.0302699im   -0.0756853+0.181919im      -0.234074+0.0149149im      -0.159243+0.0199299im    -0.0248958+0.0612714im      0.350074-0.125849im       0.144991-0.0278534im     -0.159516+0.0754953im    0.116998-0.0458379im      0.221246-0.0519407im     -0.122979-0.0159356im     0.0269833-0.0857557im    -0.0360209-0.0263233im      0.195377-0.0231661im     -0.141676+0.0615981im    0.0463985-0.0855297im   -0.227703-0.00939155im    0.0562986+0.0569018im      0.220707-0.021635im       -0.109027+0.0618502im     -0.0760935-0.224663im     -0.247596-0.188892im</code></pre><p>and then generate the state <span>$ψ$</span></p><pre><code class="language-julia hljs">psi = P[:, 3]</code></pre><pre><code class="nohighlight hljs">32-element Vector{ComplexF64}:
  -0.15893796641945462 + 0.10854523842407944im
   0.09859587834493048 + 0.09314936940326671im
  -0.04206984006361766 + 0.016088204678969913im
   0.07054147374325481 + 0.0942976224957177im
  -0.01166277068933068 - 0.21377543778365832im
   0.04839481641955097 + 0.0489288584335896im
  -0.14280660197590886 - 0.2046168724376449im
  -0.06277917853698363 + 0.1104536924883903im
  -0.03252684517738722 + 0.10756410189196507im
   0.04823169488208904 + 0.01745933728795655im
  -0.14584444871189461 + 0.024577189419727474im
  -0.01077812234962023 - 0.11056014447394812im
    0.3316628710185111 + 0.0im
  -0.02121869603911272 + 0.14730725148616225im
 -0.019731758082936837 - 0.27844473223800464im
   0.01630825951185471 + 0.015970502786967895im
   0.26376408066478085 + 0.11314995324347624im
  -0.07240258571996205 - 8.722798274486979e-5im
 -0.061924948691677376 + 0.047188781869353595im
   0.08423179693288196 + 0.04701456529710361im
  -0.16586118677622552 + 0.14156202284384428im
    0.3248983829036283 + 0.0246200533319503im
  -0.16395847293296723 - 0.14337301314591083im
  -0.08832184248267932 + 0.15541506557504678im
  0.026189142132991117 - 0.046458794968428904im
  -0.07801245590232546 - 0.09641454946347977im
   -0.2672753264700734 + 0.17596619977481312im
   0.14280843274587698 + 0.08715431595392091im
  -0.03197958864249892 - 0.11626855394908302im
   0.10189823401522513 + 0.05434949369410854im
   0.06504686492441733 - 0.03770234710642146im
 -0.009136758792098708 + 0.14594496721456496im</code></pre><p>In the phase estimation process, we will feed the state to circuit and measure the first <code>n</code> qubits processed by iQFT.</p><pre><code class="language-julia hljs">r = join(ArrayReg(psi), zero_state(N))
r |&gt; PE(N, M, U)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qudits: 8/8
    nlevel: 2</code></pre><p>Since our phase can be represented by 3 qubits precisely, we only need to measure once</p><pre><code class="language-julia hljs">results = measure(r, 1:N; nshots=1)</code></pre><pre><code class="nohighlight hljs">1-element Vector{BitBasis.BitStr64{3}}:
 011 ₍₂₎</code></pre><p>Recall that our QFT&#39;s bit numbering is reversed, let&#39;s reverse it back</p><pre><code class="language-julia hljs">using BitBasis
estimated_phase = bfloat(results[]; nbits=N)</code></pre><pre><code class="nohighlight hljs">0.75</code></pre><p>the phase is exactly <code>0.75</code>!</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../1.prepare-ghz-state/index.html">« Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a><a class="docs-footer-nextpage" href="../3.grover-search/index.html">Grover Search »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.15 on <span class="colophon-date" title="Thursday 7 April 2022 18:33">Thursday 7 April 2022</span>. Using Julia version 1.7.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
