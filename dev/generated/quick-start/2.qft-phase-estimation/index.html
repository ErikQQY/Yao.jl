<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quantum Fourier Transformation and Phase Estimation · Documentation | Yao</title><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.044/juliamono.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/indigo.css" rel="stylesheet" type="text/css"/><link href="https://yaoquantum.org/assets/favicon-light.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../index.html"><img src="../../../assets/logo.png" alt="Documentation | Yao logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../index.html">Documentation | Yao</a></span></div><form class="docs-search" action="../../../search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../index.html">Home</a></li><li><span class="tocitem">Quick Start</span><ul><li><a class="tocitem" href="../1.prepare-ghz-state/index.html">Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a></li><li class="is-active"><a class="tocitem" href="index.html">Quantum Fourier Transformation and Phase Estimation</a><ul class="internal"><li><a class="tocitem" href="#Quantum-Fourier-Transformation"><span>Quantum Fourier Transformation</span></a></li><li><a class="tocitem" href="#Wrap-QFT-to-an-external-block"><span>Wrap QFT to an external block</span></a></li><li><a class="tocitem" href="#Phase-Estimation"><span>Phase Estimation</span></a></li></ul></li><li><a class="tocitem" href="../3.grover-search/index.html">Grover Search</a></li><li><a class="tocitem" href="../4.shor-algorithm/index.html">Shor&#39;s Algorithm</a></li><li><a class="tocitem" href="../5.shor-9-code/index.html">Shor&#39;s 9 qubit code</a></li><li><a class="tocitem" href="../6.quantum-circuit-born-machine/index.html">Quantum Circuit Born Machine</a></li><li><a class="tocitem" href="../7.variation-quantum-eigen-solver/index.html">Variational Quantum Eigen Solver</a></li></ul></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../../man/array_registers.html">Array Registers</a></li><li><a class="tocitem" href="../../../man/symbolic.html">Symbolic Computation</a></li><li><a class="tocitem" href="../../../man/blocks.html">Blocks</a></li><li><a class="tocitem" href="../../../man/automatic_differentiation.html">Automatic Differentiation</a></li><li><a class="tocitem" href="../../../man/simplification.html">Simplification</a></li><li><a class="tocitem" href="../../../man/registers.html">Abstract Registers</a></li><li><a class="tocitem" href="../../../man/bitbasis.html">BitBasis</a></li><li><a class="tocitem" href="../../../man/extending_blocks.html">Extending Blocks</a></li></ul></li><li><a class="tocitem" href="../../../benchmarks.html">Benchmark</a></li><li><a class="tocitem" href="../../../dev/index.html">Developer Notes</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Quick Start</a></li><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/QuantumBFS/Yao.jl/blob/master/docs/src/quick-start/2.qft-phase-estimation/main.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><p><a href="https://mybinder.org/v2/gh/QuantumBFS/Yao.jl/gh-pages?filepath=dev/generated/quick-start/2.qft-phase-estimation/main.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a> <a href="https://nbviewer.jupyter.org/github/QuantumBFS/Yao.jl/blob/gh-pages/dev/generated/quick-start/2.qft-phase-estimation/main.ipynb"><img src="https://img.shields.io/badge/show-nbviewer-579ACA.svg" alt/></a> <a href="https://minhaskamal.github.io/DownGit/#/home?url=https://github.com/QuantumBFS/tutorials/tree/gh-pages/dev/generated/quick-start/2.qft-phase-estimation"><img src="https://img.shields.io/badge/download-project-orange" alt/></a></p><h1 id="example-qft"><a class="docs-heading-anchor" href="#example-qft">Quantum Fourier Transformation and Phase Estimation</a><a id="example-qft-1"></a><a class="docs-heading-anchor-permalink" href="#example-qft" title="Permalink"></a></h1><p>Let&#39;s use Yao first</p><pre><code class="language-julia hljs">using Yao</code></pre><h2 id="Quantum-Fourier-Transformation"><a class="docs-heading-anchor" href="#Quantum-Fourier-Transformation">Quantum Fourier Transformation</a><a id="Quantum-Fourier-Transformation-1"></a><a class="docs-heading-anchor-permalink" href="#Quantum-Fourier-Transformation" title="Permalink"></a></h2><p>The Quantum Fourier Transformation (QFT) circuit is to repeat two kinds of blocks repeatly:</p><p><img src="assets/qft.png" alt="qft-circuit"/></p><p>The basic building block control phase shift gate is defined as</p><p class="math-container">\[R(k)=\begin{bmatrix}
1 &amp; 0\\
0 &amp; \exp\left(\frac{2\pi i}{2^k}\right)
\end{bmatrix}\]</p><p>Let&#39;s define block <code>A</code> and block <code>B</code>, block <code>A</code> is actually a control block.</p><pre><code class="language-julia hljs">A(i, j) = control(i, j=&gt;shift(2π/(1&lt;&lt;(i-j+1))))</code></pre><pre><code class="nohighlight hljs">A (generic function with 1 method)</code></pre><p>Once you construct the blockl you can inspect its matrix using <code>mat</code> function. Let&#39;s construct the circuit in dash box A, and see the matrix of <span>$R_4$</span> gate.</p><pre><code class="language-julia hljs">R4 = A(4, 1)</code></pre><pre><code class="nohighlight hljs">(n -&gt; control(n, 4, 1 =&gt; shift(0.39269908169872414)))</code></pre><p>If you have read about <a href="generated/quick-start/2.qft-phase-estimation/@ref example-ghz">preparing GHZ state</a>, you probably know that in Yao, we could just leave the number of qubits, and it will be evaluated when possible.</p><pre><code class="language-julia hljs">R4(5)</code></pre><pre><code class="nohighlight hljs">nqubits: 5
control(4)
└─ (1,) shift(0.39269908169872414)</code></pre><p>its matrix will be</p><pre><code class="language-julia hljs">mat(R4(5))</code></pre><pre><code class="nohighlight hljs">32×32 LinearAlgebra.Diagonal{ComplexF64, Vector{ComplexF64}}:
 1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im</code></pre><p>Then we repeat this control block over and over on different qubits, and put a Hadamard gate to <code>i</code>th qubit to construct <code>i</code>-th <code>B</code> block.</p><pre><code class="language-julia hljs">B(n, k) = chain(n, j==k ? put(k=&gt;H) : A(j, k) for j in k:n)</code></pre><pre><code class="nohighlight hljs">B (generic function with 1 method)</code></pre><p>We need to input the total number of qubits <code>n</code> here because we have to iterate through from <code>k</code>-th location to the last.</p><p>Now, let&#39;s construct the circuit by chaining all the <code>B</code> blocks together</p><pre><code class="language-julia hljs">qft(n) = chain(B(n, k) for k in 1:n)
qft(4)</code></pre><pre><code class="nohighlight hljs">nqubits: 4
chain
├─ chain
│  ├─ put on (1)
│  │  └─ H
│  ├─ control(2)
│  │  └─ (1,) shift(1.5707963267948966)
│  ├─ control(3)
│  │  └─ (1,) shift(0.7853981633974483)
│  └─ control(4)
│     └─ (1,) shift(0.39269908169872414)
├─ chain
│  ├─ put on (2)
│  │  └─ H
│  ├─ control(3)
│  │  └─ (2,) shift(1.5707963267948966)
│  └─ control(4)
│     └─ (2,) shift(0.7853981633974483)
├─ chain
│  ├─ put on (3)
│  │  └─ H
│  └─ control(4)
│     └─ (3,) shift(1.5707963267948966)
└─ chain
   └─ put on (4)
      └─ H
</code></pre><h2 id="Wrap-QFT-to-an-external-block"><a class="docs-heading-anchor" href="#Wrap-QFT-to-an-external-block">Wrap QFT to an external block</a><a id="Wrap-QFT-to-an-external-block-1"></a><a class="docs-heading-anchor-permalink" href="#Wrap-QFT-to-an-external-block" title="Permalink"></a></h2><p>In most cases, <code>function</code>s are enough to wrap quantum circuits, like <code>A</code> and <code>B</code> we defined above, but sometimes, we need to dispatch specialized methods on certain kinds of quantum circuit, or we want to define an external block to export, thus, it&#39;s useful to be able to wrap circuit to custom blocks.</p><p>First, we define a new type as subtype of <code>PrimitiveBlock</code> since we are not going to use the subblocks of <code>QFT</code>, if you need to use its subblocks, it&#39;d be better to define it under <code>CompositeBlock</code>.</p><pre><code class="language-julia hljs">struct QFT &lt;: PrimitiveBlock{2}
    n::Int
end

YaoBlocks.nqudits(q::QFT) = q.n</code></pre><p>Now, let&#39;s define its circuit</p><pre><code class="language-julia hljs">circuit(q::QFT) = qft(q.n)</code></pre><pre><code class="nohighlight hljs">circuit (generic function with 1 method)</code></pre><p>And forward <code>mat</code> to its circuit&#39;s matrix</p><pre><code class="language-julia hljs">YaoBlocks.mat(::Type{T}, x::QFT) where T = mat(T, circuit(x))</code></pre><p>You may notice, it is a little ugly to print <code>QFT</code> at the moment, this is because we print the type summary by default, you can define your own printing by overloading <code>print_block</code></p><pre><code class="language-julia hljs">YaoBlocks.print_block(io::IO, x::QFT) = print(io, &quot;QFT($(x.n))&quot;)</code></pre><p>Since it is possible to use FFT to simulate the results of QFT (like cheating), we could define our custom <code>apply!</code> method:</p><pre><code class="language-julia hljs">using FFTW, LinearAlgebra

function YaoBlocks.apply!(r::ArrayReg, x::QFT)
    α = sqrt(length(statevec(r)))
    invorder!(r)
    lmul!(α, ifft!(statevec(r)))
    return r
end</code></pre><p>Now let&#39;s check if our <code>apply!</code> method is correct:</p><pre><code class="language-julia hljs">r = rand_state(5)
r1 = r |&gt; copy |&gt; QFT(5)
r2 = r |&gt; copy |&gt; circuit(QFT(5))
r1 ≈ r2</code></pre><pre><code class="nohighlight hljs">true</code></pre><p>We can get iQFT (inverse QFT) directly by calling <code>adjoint</code></p><pre><code class="language-julia hljs">QFT(5)&#39;</code></pre><pre><code class="nohighlight hljs"> [†]QFT(5)</code></pre><p>QFT and iQFT are different from FFT and IFFT in three ways,</p><ol><li>they are different by a factor of <span>$\sqrt{2^n}$</span> with <span>$n$</span> the number of qubits.</li><li>the <a href="https://quantumbfs.github.io/BitBasis.jl/stable/tutorial/#Conventions-1">bit numbering</a> will exchange after applying QFT or iQFT.</li><li>due to the convention, QFT is more related to IFFT rather than FFT.</li></ol><h2 id="Phase-Estimation"><a class="docs-heading-anchor" href="#Phase-Estimation">Phase Estimation</a><a id="Phase-Estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Phase-Estimation" title="Permalink"></a></h2><p>Since we have QFT and iQFT blocks we can then use them to realize phase estimation circuit, what we want to realize is the following circuit:</p><p><img src="assets/phaseest.png" alt="phase estimation"/></p><p>First we call Hadamard gates repeatly on first <code>n</code> qubits.</p><pre><code class="language-julia hljs">Hadamards(n) = repeat(H, 1:n)</code></pre><pre><code class="nohighlight hljs">Hadamards (generic function with 1 method)</code></pre><p>Then in dashed box <code>B</code>, we have controlled unitaries:</p><pre><code class="language-julia hljs">ControlU(n, m, U) = chain(n+m, control(k, n+1:n+m=&gt;matblock(U^(2^(k-1)))) for k in 1:n)</code></pre><pre><code class="nohighlight hljs">ControlU (generic function with 1 method)</code></pre><p>each of them is a <code>U</code> of power <span>$2^{(k-1)}$</span>.</p><p>Since we will only apply the qft and Hadamard on first <code>n</code> qubits, we could use <code>Subroutine</code>, which creates a context of a sub-scope of the qubits.</p><pre><code class="language-julia hljs">PE(n, m, U) =
    chain(n+m, # total number of the qubits
        subroutine(Hadamards(n), 1:n), # apply H in local scope
        ControlU(n, m, U),
        subroutine(QFT(n)&#39;, 1:n))</code></pre><pre><code class="nohighlight hljs">PE (generic function with 1 method)</code></pre><p>we use the first <code>n</code> qubits as the output space to store phase <span>$ϕ$</span>, and the other <code>m</code> qubits as the input state which corresponds to an eigenvector of oracle matrix <code>U</code>.</p><p>The subroutine here uses <code>focus!</code> and <code>relax!</code> to manage a local scope of quantum circuit, and only activate the first <code>n</code> qubits while applying the block inside the subroutine context, and the scope will be <code>relax!</code>ed back, after the context. This is equivalent to manually <code>focus!</code> then <code>relax!</code></p><p>fullly activated</p><pre><code class="language-julia hljs">r = rand_state(5)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>first 3 qubits activated</p><pre><code class="language-julia hljs">focus!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 3/5
    nlevel: 2</code></pre><p>relax back to the original</p><pre><code class="language-julia hljs">relax!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>In this way, we will be able to apply small operator directly on the subset of the qubits.</p><p>Details about the algorithm can be found here: <a href="https://en.wikipedia.org/wiki/Quantum_phase_estimation_algorithm">Quantum Phase Estimation Algorithm</a></p><p>Now let&#39;s check the results of our phase estimation.</p><p>First we need to set up a unitary with known phase, we set the phase to be 0.75, which is <code>0.75 * 2^3 == 6 == 0b110</code> .</p><pre><code class="language-julia hljs">N, M = 3, 5
P = eigen(rand_unitary(1&lt;&lt;M)).vectors
θ = Int(0b110) / 1&lt;&lt;N
phases = rand(1&lt;&lt;M)
phases[0b010+1] = θ
U = P * Diagonal(exp.(2π * im * phases)) * P&#39;</code></pre><pre><code class="nohighlight hljs">32×32 Matrix{ComplexF64}:
   -0.23862-0.0227427im    -0.0198977+0.0472406im     0.0548884-0.103467im    -0.276668+0.00737245im   -0.0268229+0.0776204im      0.231846+0.136986im     -0.0699697-0.017555im       0.101676-0.059129im   -0.00455547+0.0566371im        0.01013-0.00281333im  -0.0676198+0.140517im       0.236363-0.0941062im      0.197856+0.0587895im     -0.0300351+0.0821706im    -0.0332766+0.128837im      -0.219014-0.141228im      -0.162911+0.144583im      0.021644+0.311952im      0.050258-0.0391767im    -0.0112946-0.101099im    -0.0897757-0.103844im    -0.0361481-0.0906012im    0.00766618+0.154771im    0.0544515+0.012013im      0.252502+0.141002im    0.00374449+0.120144im    -0.243271+0.0016938im       -0.1095+0.152602im        0.161968+0.0857217im      0.0714015-0.178654im       0.12302-0.119866im      -0.0905268+0.0841535im
 0.00260202-0.11318im      -0.0896463-0.109128im      0.0215065+0.0476877im  -0.0812059+0.0316331im     0.0637433-0.0223878im      0.245407+0.10524im       0.0110089-0.0744837im     -0.181776-0.0264081im   -0.0242752+0.0163174im      -0.159513-0.00883213im   0.0439894+0.014411im      -0.103281-0.153554im    -0.00967837+0.133196im       -0.331458+0.0576962im    -0.0730766+0.147577im      0.0343266-0.0792624im     -0.132972+0.0642239im     0.157402-0.148617im     -0.150031+0.00419964im     -0.17139-0.0121831im   -0.0481452-0.0646832im    0.0421447-0.175797im     -0.0426799+0.012036im   -0.0325702-0.320219im     -0.069284+0.0745186im   -0.0793524+0.0472696im  -0.0125268-0.0688624im      0.118691+0.124603im       -0.099169-0.00533071im    -0.0240597+0.312142im     -0.210208+0.274095im       0.0462192+0.255083im
   0.286606-0.0685581im     0.0847153+0.104063im     0.00766035-0.114627im    -0.120409+0.161759im      0.0164553-0.203084im     -0.0118007+0.0681733im     -0.098529-0.102431im      -0.080323+0.0227865im    0.0884423+0.18048im        0.0234568+0.242583im     -0.020678+0.16918im       -0.139745-0.0728954im    -0.0294442-0.0329255im      0.0339582+0.06902im        0.113175+0.258524im      -0.108714-0.169009im      0.0230914-0.303373im     -0.130851-0.0120846im    -0.075075+0.107059im       -0.16959-0.016402im    -0.0254442+0.0260612im     0.221435+0.104863im      -0.193224+0.168442im    -0.108162+0.0863411im   -0.0153392+0.046815im    -0.0291261-0.13971im     0.0318483-0.0150394im      0.132009-0.0789072im     -0.0621051-0.0103559im     -0.0999731-0.264068im       -0.1082-0.14313im       -0.0753994+0.121651im
  -0.270807-0.153465im       0.105981-0.055863im     -0.0509333-0.151947im    -0.192657+0.0419111im      0.232956+0.0472766im   0.000975431+0.0181162im     -0.154764-0.0963765im       0.10065-0.107463im     0.0684767+0.0867666im      -0.235577-0.035064im     0.0147005-0.102172im      -0.251028+0.0741333im    -0.0340704-0.174323im       0.0486009+0.181079im       -0.02071-0.0625299im     -0.150708+0.0789376im     0.0152129+0.0422946im   -0.0956133-0.131297im     0.0967487-0.0799096im     0.0475381-0.217901im      -0.13241+0.117919im     0.0752388+0.0365762im      0.233244-0.064797im     0.113199-0.018794im     -0.200979+0.0747949im    -0.137358-0.311405im    -0.101366-0.0104371im    -0.0992604-0.0414848im       -0.22369+0.0714848im     -0.0101804+0.0621696im    0.0556446-0.0653434im     -0.0885051-0.0465519im
   0.026948+0.0371455im     0.0546835-0.217266im    -0.00212905-0.167802im    0.0756658+0.116802im       0.176576-0.125075im      0.0376262-0.0106778im    -0.0170487-0.414828im       0.206703-0.0310761im   -0.0553392+0.280821im      -0.0966402-0.0842912im    -0.014875+0.0387097im    -0.0168098+0.0160143im     -0.022383-0.0951353im       0.017883+0.0216444im     -0.127242-0.00656511im     0.141457+0.265571im      -0.141802-0.0887309im   -0.0945262-0.0393095im    -0.130399-0.00811498im   -0.0730609+0.119021im     -0.065882-0.326153im     0.0320441-0.0877949im    -0.0384428-0.0524789im   0.0952897+0.0725663im     0.128965-0.0354195im    0.0491991+0.180199im    0.0867504-0.00808272im   -0.0337141-0.167032im        0.239658+0.0212974im      -0.127649+0.0547611im     0.167576+0.0499922im      0.0724924-0.0502459im
  -0.219451-0.141382im      -0.058482-0.0798714im     -0.101207-0.0392521im   -0.271887+0.126573im     -0.0920069+0.168339im      -0.276646-0.108043im     -0.0169422-0.0147042im      -0.15607+0.150632im     0.0206615-0.101491im       -0.112231-0.144144im      -0.10205-0.109242im     -0.0697624+0.0560405im     -0.111732+0.300797im       0.0560779-0.0099525im     0.0350212+0.0626433im     0.0713296+0.119797im     0.00928751-0.0636731im  -0.00582179-0.0730013im     0.143531-0.113204im      -0.202181+0.0775582im    -0.032545-0.157986im    -0.0916424-0.28153im       -0.130697+0.0848864im   -0.126628-0.0431061im    0.0885664-0.0115859im     0.221812-0.0560523im    0.112933+0.0910461im      0.117084-0.036845im     -0.00322483-0.0494855im      -0.035538-0.0846861im   -0.0474998-0.154773im       -0.234351-0.0915878im
  0.0672565-0.0396853im    -0.0504104+0.246773im      0.0181054+0.0253397im   0.0816993-0.0387865im       0.16847+0.213798im      -0.135602+0.0884414im     -0.171208-0.0252268im     0.0794352-0.304046im     0.0436391-0.106981im         0.26339-0.184376im     -0.181762+0.0410516im    -0.0500699+0.0317601im     0.0112482-0.127257im        -0.01659+0.401921im      0.0756495-0.0547152im     0.0779753-0.0755285im      0.108461+0.0697362im   0.00793455+0.00123084im    0.179343+0.0952325im     -0.178914+0.0459319im   -0.0888776-0.0667094im    0.0318436-0.0170601im     -0.052888-0.104145im    0.0513518-0.0325202im     0.105593+0.0226584im      -0.0231+0.0887441im    0.327934-0.0842083im     0.0297163+0.0595457im      0.0775561+0.188094im      -0.0259289+0.0209798im    -0.113263+0.0453996im     -0.0716752+0.118378im
  0.0376464-0.00595128im     0.103821-0.0241196im     -0.137896-0.0128864im   0.0333097-0.0324594im      -0.10765-0.0331287im     -0.104641+0.0643849im    -0.0635821-0.0163324im      -0.25001-0.211318im    -0.0652905+0.174967im          0.1242+0.0582971im    -0.225078-0.130299im     -0.0749047+0.147002im       0.136225-0.0367762im      -0.275449-0.21364im      -0.0615715-0.190462im      -0.290178+0.0398738im       0.12134-0.150518im     0.0183936+0.162615im    -0.0468594-0.0446196im      0.116231-0.0359487im    -0.193621-0.127459im    -0.0320954-0.0362132im       0.19046-0.0994325im   -0.296141-0.166133im      0.151926-0.0628052im    0.0622709+0.0205038im   0.0241685-0.105857im      0.0672382-0.1266im        -0.0690091+0.0670536im      0.0317721+0.0529797im    0.0648173-0.128274im       0.0827019+0.076348im
 -0.0585407-0.191492im      0.0731961-0.0402432im      0.161526+0.0326235im  -0.0060813+0.151945im      0.0880571-0.0863579im    0.00708859+0.0590771im      0.228468+0.141014im      -0.241462-0.23004im     -0.0432367+0.0625744im      0.0951875-0.0250623im   -0.0308307+0.00973553im    -0.117503-0.0188292im      -0.17076-0.147719im       -0.231141-0.060088im     -0.0669875+0.141891im       0.122882-0.0367561im     -0.010121+0.176981im     -0.156885-0.00709898im  0.00180068+0.0916544im     0.0861382+0.344462im     0.0589175+0.0763986im    -0.163079+0.0459988im      0.165929-0.0908347im     0.10329+0.182945im     0.0376253+0.245186im      0.161628-0.0237752im  -0.0839281+0.204186im     -0.0268391-0.121235im       0.0639826-0.0258605im      0.0130766-0.0747506im    0.0102218-0.0206516im      -0.201827+0.0903126im
  -0.127635-0.00131729im    -0.134868+0.107692im     -0.0184553-0.0532577im  -0.0124245+0.206935im      -0.187391+0.0203193im    -0.0899802+0.0541886im     0.0292825+0.0832398im     0.0206001-0.0098497im    0.0487708+0.119095im       -0.162876-0.252074im    0.00324356+0.19934im        0.184113+0.140225im       -0.18676-0.378327im        0.112345-0.0802554im     0.0313848-0.0073509im     0.0382609-0.104713im      -0.128854+0.135932im     0.0624169+0.0492544im    -0.251455+0.167764im      0.0694621-0.108232im      0.149946-0.232988im      0.015847-0.0212568im      0.114012+0.0272556im   -0.170615-0.0624227im   -0.0444257+0.126616im     0.0164314-0.0796712im    0.180978-0.100507im       0.211162+0.0519071im      -0.169756-0.0191648im      0.0512548-0.0899318im   -0.0360364+0.0454629im      0.0761573-0.0711239im
 -0.0202529-0.0650816im      0.143857+0.0871134im      0.160072-0.0191011im   0.0163785+0.257572im       0.159441-0.172292im     -0.0225641-0.0133625im    0.00334472-0.0608122im   -0.00392778+0.0601879im     0.106992-0.0716346im    -0.00437921+0.0280142im    -0.105338-0.163542im       0.129569+0.118787im       0.101813+0.122372im       0.0371403-0.00622754im    -0.231548-0.132978im       -0.16397-0.206146im     -0.0833857+0.0828191im     0.132719-0.00176751im   -0.126239+0.284376im     -0.0825342+0.173242im     0.0674555+0.0346949im    0.0490482+0.00119697im   -0.0766148-0.0920389im    0.109809-0.181211im    -0.0363536-0.242304im         0.248-0.0959609im  -0.0383818+0.06682im        -0.13766+0.0913649im     -0.0903037+0.274806im      -0.0851203-0.045154im    -0.0824126-0.00218509im     0.0488655-0.243281im
 0.00168438+0.212765im      -0.150475-0.0308235im     -0.223779+0.124953im   -0.0856012-0.0323948im    -0.0270474+0.0771542im      0.268022+0.102515im       -0.14075-0.0118593im     -0.107729+0.220671im     0.0126485+0.0745118im     0.00780045-0.162613im     0.0308888+0.0694239im     -0.169041-0.116808im       0.171396-0.1516im        -0.0497656-0.0872396im     0.0917987-0.270677im     -0.0171278-0.109244im      0.0253521+0.0015023im    -0.328655+0.0918675im    0.0799824+0.154271im      -0.058193+0.0336055im     0.142703+0.0719594im    0.0360877-0.0382838im     -0.104437-0.229035im    0.0902264-0.12116im     -0.0273612+0.0238874im     0.154535-0.0303238im  -0.0900837-0.0048111im      0.153866-0.0991263im      0.0705268+0.0270058im      -0.173728-0.0170961im    0.0362978+0.0896865im      -0.229312-0.137924im
  -0.162331-0.145598im      -0.209775-0.00497929im     0.123925+0.0677134im  -0.0386844+0.256545im      0.0250477-0.067517im      0.0211256+0.179571im     -0.0597907+0.0464951im      0.105792+0.138275im     -0.111717+0.0590389im        0.13413+0.122813im    -0.0126107-0.0849331im     -0.116257-0.25678im       -0.333646-0.0225513im      -0.037934-0.0532468im     0.0439366-0.0776632im     0.0372601-0.013441im     0.00213225-0.215551im     0.0567992+0.120995im     0.0645453-0.0435372im     0.0324049-0.030392im     0.0168484+0.126034im     0.0647621+0.139451im        0.11431+0.0275177im  -0.0862363+0.090517im     0.0567934-0.176418im     0.0829733+0.0192752im    0.116574-0.116115im       0.110686+0.309608im        0.129607+0.144686im       0.0304375+0.24483im       0.247169-0.027227im      -0.0483412-0.067474im
   0.197086+0.0654066im      0.050113-0.126518im      0.0472004-0.122575im   -0.0644664-0.155308im     -0.0381401+0.0695308im     -0.203514+0.00690638im   -0.0148426-0.0906322im     0.0133525+0.115352im     0.0807347-0.0819949im      -0.168357+0.0616501im    0.0381033+0.147478im    -0.00523318+0.0521674im    -0.0509506-0.0898474im      0.0327296-0.0616002im     0.0173194-0.0404017im    -0.0583012-0.108217im      -0.119829-0.158389im     0.0327214+0.0351843im     0.053146+0.170257im    -0.00518872+0.0649316im  -0.00395534+0.0905448im    -0.135193-0.296773im       0.238833-0.167549im     0.200891+0.036164im     -0.078238-0.233626im    0.00863282+0.0232104im   0.0218663+0.148763im       0.148885+0.137663im       0.0271324+0.144671im        0.260198-0.0717654im      0.15638+0.0362655im     -0.0786502+0.385453im
 -0.0893252+0.010288im      -0.292456-0.0820768im      0.161066-0.262332im    0.0894211-0.109835im       0.112136+0.194935im      0.0976649+0.0812327im     0.0799527-0.105555im       -0.16457-0.0654687im     0.066792+0.0249309im       0.103201+0.0558767im      0.12167+0.0489266im     0.0291697+0.165758im      0.0392327-0.000310886im     0.210663-0.0737406im     -0.261502-0.101922im     -0.0407519-0.103044im     -0.0732319-0.0897im      -0.0349712-0.136489im       0.14689+0.198119im      -0.212665-0.0696473im     0.130077+0.0778864im   -0.0914996+0.173317im       0.131055+0.146981im    -0.271237-0.0418731im    0.0339969-0.0511157im   -0.0285146+0.0978903im    0.028942+0.116596im     -0.0952647-0.0482468im    -0.00847967-0.187843im       -0.150232+0.124491im     0.0151544-0.110806im      -0.0847215+0.0982477im
 -0.0756076-0.0639092im    -0.0167856-0.0506368im     -0.125563+0.339567im    0.0300426-0.114592im     -0.0407925+0.131264im      0.0126006+0.0801244im     0.0628445-0.0159398im      0.114261-0.044104im    -0.0809282+0.158954im      0.00269959-0.0760287im    0.0713877-0.0210616im     0.0342738+0.149643im      -0.152072+0.0447176im     -0.0479243-0.0217311im     0.0674861+0.216831im        -0.3736+0.0235855im      0.114737+0.153189im     -0.212419-0.119445im     -0.265258+0.0381818im     -0.244477+0.0942459im    0.0976127+0.0765367im    0.0773346+0.0192886im      0.027144+0.053578im    0.0312949-0.0775673im  -0.00708524-0.288116im    -0.0342124-0.0964892im    0.160048-0.0376096im     -0.205754+0.0367852im       0.173009-0.120608im       0.0991701-0.0706706im     0.109435-0.0208808im     -0.0515352+0.0615852im
  -0.106278-0.0388819im     0.0376852+0.135032im      0.0320303+0.0156216im   -0.194426-0.116808im      -0.152512-0.155914im      0.0403062+0.0429001im      0.105365-0.0673854im   -0.00316633-0.142588im      0.101288-0.418186im     -0.00639578-0.130705im      0.110425-0.0586996im    0.00609656-0.0236377im     0.0973761+0.013571im      -0.0353988+0.0365689im    -0.0968035+0.0375898im     0.0465738+0.0106038im     -0.140543-0.0956938im    -0.098889+0.101319im     -0.226794+0.0302664im    -0.0530919+0.111213im     -0.196748-0.00650758im  -0.0184821+0.175664im     -0.0325302-0.130318im   -0.0564194+0.0349226im     0.113737-0.16177im      -0.337543-0.151676im    0.0901305+0.149134im       0.261513-0.0642144im      0.0165019-0.0686476im      -0.144863+0.0561512im     0.240682+0.0171231im     -0.0340841-0.0875597im
  -0.073991+0.170809im      0.0616583+0.0353083im    -0.0502847+0.14124im     0.0397146-0.0402173im      0.135667-0.180006im      -0.316064+0.35812im       0.0627847+0.0752078im     0.0575016+0.181353im    -0.0629645+0.0350816im      0.0248548-0.0240405im      0.31813-0.0337529im     0.0441914+0.12527im       0.0186066-0.0890608im      -0.139992+0.206127im     -0.0342586-0.0550668im    -0.0256934-0.00981176im   -0.0106969+0.0254795im   -0.0156711-0.0953447im     0.133651+0.0943182im     0.0528956+0.0678469im    -0.159072-0.0520173im     0.255845-0.0809984im   0.000399566+0.12547im    -0.0186533-0.128775im     0.0475546+0.098974im     0.0224477+0.145123im    -0.147184+0.231526im       0.148349+0.0783069im      0.0114027-0.152997im       0.0400056+0.0944018im    -0.021647-0.23171im        0.0597986-0.0489847im
  0.0657892-0.0497551im     -0.352596+0.140692im      -0.104056-0.123735im    -0.119537-0.115317im      0.0957597-0.253571im     -0.0980945-0.0721276im       0.27016+0.0523371im     -0.105453-0.0396214im    0.0424351+0.0213237im      -0.203956+0.157523im    -0.0848739+0.0547999im     0.0798711-0.141904im      0.0818334-0.0340933im      -0.137631+0.130712im      0.0187988-0.215924im      -0.102689+0.0502041im     0.0270186+0.0795462im     0.043515-0.0107734im   -0.0213264+0.0198495im     0.0183173+0.020613im      0.170349+0.144033im     0.0243563-0.245754im      0.0925718+0.175706im     0.146634+0.0593129im     0.090562-0.0226752im    -0.132296-0.0778007im    0.187862-0.163186im      -0.029278-0.175041im        0.204915+0.018002im    -0.000574925+0.0796466im    -0.063608-0.142836im      0.00787256-0.156771im
  -0.145973-0.261843im       0.205856+0.261496im       0.123096+0.122193im    0.0970534-0.0941387im     0.0525405-0.03022im       0.0376974-0.0357502im    -0.0633307-0.184867im    -0.00724324+0.133801im     0.0308704+0.0881045im      -0.140227+0.182915im     -0.272244+0.029183im       0.206308+0.149962im      0.0306173-0.0961695im    -0.00788348-0.193903im       0.207952-0.0718079im    -0.0330506-0.00482427im  -0.00667461+0.0449873im    0.0184772+0.0204935im    0.0589734+0.00400856im    -0.170066-0.176049im    -0.0789826+0.145131im    -0.0663228+0.0341239im    -0.0637135-0.0844766im    0.107331+0.050046im    -0.0120159+0.121898im     0.0672962+0.0674371im   0.0844104+0.195704im        0.21833-0.000812897im     0.151603-0.270788im      -0.0258154+0.216544im     -0.051628+0.0307364im   -0.000272023-0.0172799im
  -0.119559+0.0216104im     -0.233877-0.100704im      -0.085276+0.123864im    -0.118613-0.0455413im    -0.0726836-0.151684im       0.160538-0.206809im       0.110974+0.0611898im     0.0391755-0.0964261im    -0.346697+0.028229im        0.145921+0.152852im     -0.183382+0.0203501im      0.157295+0.161903im       -0.16608-0.0817864im      0.0418015+0.0784572im    -0.0263468-0.181567im     -0.0444975-0.0454539im    -0.0505444-0.0852752im    -0.020225-0.192616im      0.168872+0.107613im     -0.0101496+0.0426177im    -0.261549-0.21985im      0.0300505+0.0319544im    -0.0780818+0.0284669im    0.205706+0.111559im    -0.0149115-0.169865im   -0.00953822-0.0791569im   -0.145271+0.00630802im      0.11939+0.0544593im       -0.17128-0.0647563im     -0.0642169-0.110327im     -0.111247+0.0977986im     -0.0168143+0.108867im
  -0.115421-0.169307im    -0.00962404+0.00717023im   -0.0539829+0.0330747im    0.196008-0.155452im       0.190649+0.150575im      -0.121503-0.0814796im     0.0381602+0.131489im      0.0811556+0.0807457im    0.0091567-0.0364372im    -0.00613473+0.102789im       -0.2103-0.034242im     -0.0817511-0.383788im      -0.055082-0.0335275im       0.233686+0.0343209im     -0.166265+0.0244225im     -0.112702+0.082853im      -0.210285+0.043215im     -0.273186+0.00625094im   -0.224101+0.10913im        0.250906-0.0176371im     0.011747+0.00635211im   0.0731822-0.09303im       -0.142429-0.127639im   -0.0816931-0.0660415im     0.207294-0.0451268im   0.00798221+0.0797883im  -0.0673006+0.0301457im     0.0893598+0.00240988im     -0.140706-0.0617867im     -0.0360995+0.00660646im   -0.141468-0.125335im       0.0415517+0.156938im
 -0.0224356-0.0713835im     -0.219824-0.106302im     0.00465647+0.153342im     0.017136+0.0353854im   -0.00264123-0.126947im      -0.208555-0.0358925im     -0.086406-0.330459im       0.120194-0.181702im     0.0177106+0.000981552im  -0.00134528-0.233613im      0.128226-0.0994006im      0.134509-0.026401im      0.0380451-0.0426389im      0.0525519-0.0750169im      0.131319+0.0867864im     -0.140887+0.0524716im     0.0313957-0.0941048im     0.165574-0.0233788im     0.054818+0.0555012im     0.0263644+0.0423407im      0.19717+0.197962im     -0.120699+0.14719im       -0.150163-0.0508473im  0.00438892+0.0299766im     0.234653+0.0434261im   0.00313337-0.0429799im   -0.338665-0.114606im       0.159939-0.158493im      -0.0702521+0.102141im        0.152249+0.118516im     -0.176937-0.016414im      -0.0949887+0.0914875im
 -0.0600267-0.25734im      -0.0926373-0.0329692im    -0.0741327+0.0341221im     0.04487-0.0050629im    -0.0569866-0.0195778im    0.00951032-0.053364im       0.057083+0.0237714im      0.227951-0.0859444im    -0.157497-0.0688151im      -0.187801+0.0670902im   0.00183325+0.333527im      0.0935485-0.0170218im     0.0780858+0.127863im       0.0163571+0.107318im      0.0375716+0.066894im       0.174854-0.101891im        0.18294-0.0728408im    0.0168974+0.178147im      0.088267-0.0726135im    -0.0598012+0.0928924im    0.0628796+0.00448638im      0.3186+0.0285818im      0.290098-0.276477im    -0.231325-0.131739im    -0.0775961-0.123499im      0.127233+0.0510218im   -0.125311+0.152228im     -0.0471841-0.206129im        0.016201+0.0319282im     -0.0628711-0.00754148im  -0.0836241-0.0035722im      0.0365775-0.0167714im
  0.0828873+0.0296491im     0.0772358-0.00301065im    0.0213761+0.0191414im   -0.168751+0.175091im      0.0370705-0.190697im     -0.0934648-0.114508im      0.0942149+0.0530952im     0.0912222-0.120837im      0.130322-0.0570385im     -0.0470938-0.0143301im    0.0992299+0.0560956im     0.0593146+0.0821765im     0.0638752+0.155195im       -0.111636+0.00131074im     0.117137-0.166399im     -0.0647731+0.0890992im     -0.257347+0.150527im     -0.143329-0.205383im     0.0845938+0.0114317im      0.200191-0.268927im    -0.0177112+0.107842im      0.140427+0.1174im       -0.0303965-0.132264im    -0.242732+0.043168im     0.0509295-0.0731415im     0.175115+0.199478im     0.126018-0.12813im      -0.0884516+0.0748802im      0.0690741-0.108015im      -0.0425659-0.0750138im    0.0311702+0.207698im       -0.267332+0.180246im
   0.243761-0.147309im      -0.171362+0.0247917im     0.0250489-0.0110125im  -0.0892667+0.17405im         0.19055+0.0524536im     0.0589449+0.175885im      -0.153484-0.00515396im   -0.0695119+0.0984127im   -0.0983473-0.0448633im       0.236376+0.00264854im  -0.0285527+0.14722im       0.0330524+0.0628365im      0.063796+0.167672im        0.188802-0.172375im     -0.0467696-0.0270244im   -0.00585298+0.194008im       0.160303+0.184416im      0.202675-0.0560258im   -0.0851862+0.112809im       0.132337-0.0198172im   -0.0838489-0.0158477im     0.229315-0.167673im      0.0131068-0.127296im    0.0661377+0.0195096im     0.160631+0.0787874im     -0.14122-0.189021im    0.0150285+0.089137im    -0.00557036-0.0979751im     -0.0871729-0.203545im        0.178103+0.00199242im    0.198442+0.12632im        -0.108567-0.0283722im
  0.0480969+0.0811624im      0.115376+0.0688636im      0.120303-0.28171im     -0.231738+0.0915819im      0.029265+0.210312im     -0.0385379-0.0588251im     -0.091193+0.179095im      0.0867491-0.0442373im   -0.0743071+0.0454861im       0.149878+0.0822573im    0.0889681-0.080618im       0.200209+0.162625im     -0.0810115-0.0411828im      -0.137854+0.000941453im   0.0661448+0.167163im        0.13463-0.0705357im      0.113014-0.054764im     -0.254844-0.0771312im   -0.0685741+0.0586225im      0.134614-0.114682im      0.126216+0.0101103im   -0.0413215-0.185192im     -0.0244612-0.0795497im  0.00264091-0.0377756im     0.134977-0.221254im    -0.0335615-0.167857im    -0.210177-0.0647815im     0.0802637-0.0652954im       0.215285-0.0428165im      -0.103328+0.277823im     -0.156094+0.0305718im       0.105752-0.0470716im
  0.0278605+0.0553im         -0.14128+0.0243176im      0.188399-0.0834135im   0.0255929+0.0784168im     -0.174825+0.00526064im   -0.0735588+0.125643im       0.179202+0.357187im      0.0390506-0.0128852im    0.0412045-0.00804198im     -0.122428+0.0387847im   -0.0209432+0.0133779im    -0.0805193+0.00612248im     0.205427-0.0608735im       0.104479-0.00964589im    0.0782999+0.277067im      -0.197963+0.202637im     -0.0624497-0.213856im    -0.0209049-0.0167724im     0.109805+0.0706264im     -0.175174-0.0535428im    -0.114985-0.117034im    -0.0104385+0.124358im     -0.0371649-0.211788im     0.307833-0.118085im      0.080072+0.069591im      0.197766+0.0557543im   0.0531093-0.128736im      -0.108616-0.108339im       -0.120164-0.0540656im      0.0400915+0.205786im     0.0799504+0.0427409im      0.0187589-0.0552265im
   0.091378-0.146247im      0.0280569-0.155537im       0.131016-0.0552379im  -0.0275772+0.0203291im     -0.131503+0.0616117im      -0.11525+0.0133737im   0.000288991+0.0962094im    0.00386468+0.0244297im     0.038072+0.360885im        -0.15751+0.0490193im     0.060941-0.00900322im    -0.159787+0.031555im       0.156224+0.00230246im     0.0170419-0.0548395im     -0.103943-0.0748332im     0.0233739-0.094416im     -0.0249158+0.274046im    -0.0300141+0.0767377im     0.245185-0.10477im      -0.0887439+0.194396im   -0.00906367-0.0286942im    0.0224567+0.117997im     -0.0992769-0.177765im   -0.0317778+0.116681im      0.192211-0.196349im      -0.36091+0.0351336im   0.0270834-0.0586074im      0.123819+0.219916im      -0.0295708-0.0721353im      0.0860526-0.0590818im    -0.201953+0.0520899im     0.00902827-0.1749im
  -0.064803+0.0861285im    -0.0123649+0.0684358im     0.0229744-0.106441im    0.0490645-0.216335im      0.0736308-0.153001im      -0.178313+0.0111415im    -0.0471151+0.110397im     0.00300756+0.163394im      -0.12449+0.208847im       0.0904319+0.0168465im   -0.0863242-0.324878im      0.0619244-0.0281464im    -0.0503906-0.0713424im     0.00731169+0.103272im      0.0754872+0.170245im       0.120717-0.00663203im     -0.15461+0.0990504im     0.275695+0.139668im     0.0136424+0.00559026im    -0.167557+0.0116495im    0.0630521+0.121677im    0.00768587-0.0630077im     0.0981557-0.12656im     -0.105166-0.115571im     0.0033163-0.0427102im   -0.0560223-0.0620365im   -0.102083-0.145462im     -0.0201776-0.129605im      -0.0389501-0.123796im       -0.289989-0.224522im      0.205502+0.226263im       -0.159785+0.0965487im
 -0.0674179-0.101751im       0.148406-0.114644im     -0.0627118+0.261409im    -0.119962-0.0748742im     0.0649259+0.00858125im    0.0736932-0.0700931im     0.0863204+0.106191im      -0.170984+0.0476278im       0.1905+0.202494im        0.125883+0.13744im       0.142675-0.128509im         0.1615-0.0651352im      0.215294-0.00458849im      0.226646+0.0235724im     0.0252697+0.0489155im      0.247356+0.00813884im   -0.0378123+0.08457im      0.0731592-0.0471759im    0.0423613+0.0579435im     0.0349296-0.104683im     0.0614528-0.258793im     0.0908246+0.174824im      0.0994754+0.0589348im   0.0653514-0.0748256im   -0.0398882-0.0900334im    0.0207154-0.121898im     0.122985-0.0471673im       0.15878-0.184756im        0.119577+0.271877im        0.123114+0.1235im       0.0469488-0.145375im       -0.104416+0.173668im
   0.072931-0.11767im      -0.0961264+0.0365916im        0.2275-0.262277im    0.0277247-0.15995im      -0.0552592-0.185664im     -0.0237292-0.0074321im     -0.106771+0.0741954im     -0.023656+0.188006im     -0.168635+0.017527im       0.0877799-0.0691779im      0.20867+0.0424191im     0.0245478-0.0210688im    -0.0844252+0.0357772im      0.0542257+0.0494538im      0.169203-0.192139im      -0.121078+0.103084im       0.112328+0.212498im    -0.0745468+0.0789652im    -0.317225-0.113943im      -0.111064-0.0219077im     -0.19936-0.154277im      -0.15387+0.102023im     -0.0584947-0.0856772im  -0.0500571+0.0145299im    -0.193149-0.0191339im    0.0317762+0.079411im   -0.0477677+0.0504806im    -0.0506084-0.0493309im      0.0127096+0.201577im       0.0226595+0.105059im      -0.18813-0.146309im       -0.250811+0.0786271im</code></pre><p>and then generate the state <span>$ψ$</span></p><pre><code class="language-julia hljs">psi = P[:, 3]</code></pre><pre><code class="nohighlight hljs">32-element Vector{ComplexF64}:
    0.17860695796547077 + 0.013936116091587236im
  -0.028738389302212355 - 0.2868597206710803im
   -0.07052078216363453 + 0.1661835015430075im
   0.003983923781049257 - 0.05837251491571858im
   -0.28392114353545467 + 0.001957808198007574im
    -0.0735663543497486 + 0.07430009857600806im
   -0.02369315245809553 + 0.04157829190270842im
    0.10387528885477852 - 0.0538051218096342im
   0.037485066992763695 - 0.017804105018464893im
    0.10039505572396602 + 0.06360267593635029im
  -0.006826991231942168 + 0.06715050599780945im
  -0.010679020309864517 + 0.006033259152351943im
 -0.0040352701692515855 - 0.017485565805722057im
     0.3430558526679298 + 0.0im
   -0.06695050051086325 - 0.11877734284204929im
    0.15085540807840953 + 0.03982522241100352im
  -0.033157379435041504 + 0.09786844421893001im
    -0.2307713959885332 - 0.16476150275425175im
   -0.22159705045223943 + 0.013403239109313639im
    0.11247939971168025 - 0.18342495141843598im
   -0.22725279842559393 - 0.15312681957697172im
    0.14630383962563026 + 0.09582723460490569im
    0.08326573037275926 - 0.05271591822513687im
  -0.019223451572592008 + 0.06818766790289478im
    0.11587616929950721 - 0.015556549586461695im
    0.07416918788038594 + 0.15258197493258704im
   0.057799399832004335 + 0.08946695602301319im
   -0.24180876574307364 + 0.06633947367014298im
   0.056500414666821215 - 0.05382983047589561im
    0.16599427235657135 + 0.03864520698900156im
    -0.0693309679118442 - 0.061439868894874405im
    -0.2752623937209359 + 0.12856881805552509im</code></pre><p>In the phase estimation process, we will feed the state to circuit and measure the first <code>n</code> qubits processed by iQFT.</p><pre><code class="language-julia hljs">r = join(ArrayReg(psi), zero_state(N))
r |&gt; PE(N, M, U)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 8/8
    nlevel: 2</code></pre><p>Since our phase can be represented by 3 qubits precisely, we only need to measure once</p><pre><code class="language-julia hljs">results = measure(r, 1:N; nshots=1)</code></pre><pre><code class="nohighlight hljs">1-element Vector{BitBasis.BitStr64{3}}:
 011 ₍₂₎</code></pre><p>Recall that our QFT&#39;s bit numbering is reversed, let&#39;s reverse it back</p><pre><code class="language-julia hljs">using BitBasis
estimated_phase = bfloat(results[]; nbits=N)</code></pre><pre><code class="nohighlight hljs">0.75</code></pre><p>the phase is exactly <code>0.75</code>!</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../1.prepare-ghz-state/index.html">« Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a><a class="docs-footer-nextpage" href="../3.grover-search/index.html">Grover Search »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.16 on <span class="colophon-date" title="Thursday 28 April 2022 03:36">Thursday 28 April 2022</span>. Using Julia version 1.7.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
