<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quantum Fourier Transformation and Phase Estimation · Documentation | Yao</title><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.044/juliamono.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/indigo.css" rel="stylesheet" type="text/css"/><link href="https://yaoquantum.org/assets/favicon-light.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../index.html"><img src="../../../assets/logo.png" alt="Documentation | Yao logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../index.html">Documentation | Yao</a></span></div><form class="docs-search" action="../../../search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../index.html">Home</a></li><li><span class="tocitem">Quick Start</span><ul><li><a class="tocitem" href="../1.prepare-ghz-state/index.html">Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a></li><li class="is-active"><a class="tocitem" href="index.html">Quantum Fourier Transformation and Phase Estimation</a><ul class="internal"><li><a class="tocitem" href="#Quantum-Fourier-Transformation"><span>Quantum Fourier Transformation</span></a></li><li><a class="tocitem" href="#Wrap-QFT-to-an-external-block"><span>Wrap QFT to an external block</span></a></li><li><a class="tocitem" href="#Phase-Estimation"><span>Phase Estimation</span></a></li></ul></li><li><a class="tocitem" href="../3.grover-search/index.html">Grover Search</a></li><li><a class="tocitem" href="../4.shor-algorithm/index.html">Shor&#39;s Algorithm</a></li><li><a class="tocitem" href="../5.shor-9-code/index.html">Shor&#39;s 9 qubit code</a></li><li><a class="tocitem" href="../6.quantum-circuit-born-machine/index.html">Quantum Circuit Born Machine</a></li><li><a class="tocitem" href="../7.variation-quantum-eigen-solver/index.html">Variational Quantum Eigen Solver</a></li></ul></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../../man/array_registers.html">Array Registers</a></li><li><a class="tocitem" href="../../../man/symbolic.html">Symbolic Computation</a></li><li><a class="tocitem" href="../../../man/blocks.html">Blocks</a></li><li><a class="tocitem" href="../../../man/automatic_differentiation.html">Automatic Differentiation</a></li><li><a class="tocitem" href="../../../man/simplification.html">Simplification</a></li><li><a class="tocitem" href="../../../man/registers.html">Abstract Registers</a></li><li><a class="tocitem" href="../../../man/bitbasis.html">BitBasis</a></li><li><a class="tocitem" href="../../../man/extending_blocks.html">Extending Blocks</a></li></ul></li><li><a class="tocitem" href="../../../benchmarks.html">Benchmark</a></li><li><a class="tocitem" href="../../../performancetips.html">Performance Tips</a></li><li><a class="tocitem" href="../../../dev/index.html">Developer Notes</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Quick Start</a></li><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/QuantumBFS/Yao.jl/blob/master/docs/src/quick-start/2.qft-phase-estimation/main.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><p><a href="https://mybinder.org/v2/gh/QuantumBFS/Yao.jl/gh-pages?filepath=dev/generated/quick-start/2.qft-phase-estimation/main.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a> <a href="https://nbviewer.jupyter.org/github/QuantumBFS/Yao.jl/blob/gh-pages/dev/generated/quick-start/2.qft-phase-estimation/main.ipynb"><img src="https://img.shields.io/badge/show-nbviewer-579ACA.svg" alt/></a> <a href="https://minhaskamal.github.io/DownGit/#/home?url=https://github.com/QuantumBFS/tutorials/tree/gh-pages/dev/generated/quick-start/2.qft-phase-estimation"><img src="https://img.shields.io/badge/download-project-orange" alt/></a></p><h1 id="example-qft"><a class="docs-heading-anchor" href="#example-qft">Quantum Fourier Transformation and Phase Estimation</a><a id="example-qft-1"></a><a class="docs-heading-anchor-permalink" href="#example-qft" title="Permalink"></a></h1><p>Let&#39;s use Yao first</p><pre><code class="language-julia hljs">using Yao</code></pre><h2 id="Quantum-Fourier-Transformation"><a class="docs-heading-anchor" href="#Quantum-Fourier-Transformation">Quantum Fourier Transformation</a><a id="Quantum-Fourier-Transformation-1"></a><a class="docs-heading-anchor-permalink" href="#Quantum-Fourier-Transformation" title="Permalink"></a></h2><p>The Quantum Fourier Transformation (QFT) circuit is to repeat two kinds of blocks repeatly:</p><p><img src="assets/qft.png" alt="qft-circuit"/></p><p>The basic building block control phase shift gate is defined as</p><p class="math-container">\[R(k)=\begin{bmatrix}
1 &amp; 0\\
0 &amp; \exp\left(\frac{2\pi i}{2^k}\right)
\end{bmatrix}\]</p><p>Let&#39;s define block <code>A</code> and block <code>B</code>, block <code>A</code> is actually a control block.</p><pre><code class="language-julia hljs">A(i, j) = control(i, j=&gt;shift(2π/(1&lt;&lt;(i-j+1))))</code></pre><pre><code class="nohighlight hljs">A (generic function with 1 method)</code></pre><p>Once you construct the blockl you can inspect its matrix using <code>mat</code> function. Let&#39;s construct the circuit in dash box A, and see the matrix of <span>$R_4$</span> gate.</p><pre><code class="language-julia hljs">R4 = A(4, 1)</code></pre><pre><code class="nohighlight hljs">(n -&gt; control(n, 4, 1 =&gt; shift(0.39269908169872414)))</code></pre><p>If you have read about <a href="generated/quick-start/2.qft-phase-estimation/@ref example-ghz">preparing GHZ state</a>, you probably know that in Yao, we could just leave the number of qubits, and it will be evaluated when possible.</p><pre><code class="language-julia hljs">R4(5)</code></pre><pre><code class="nohighlight hljs">nqubits: 5
control(4)
└─ (1,) shift(0.39269908169872414)</code></pre><p>its matrix will be</p><pre><code class="language-julia hljs">mat(R4(5))</code></pre><pre><code class="nohighlight hljs">32×32 LinearAlgebra.Diagonal{ComplexF64, Vector{ComplexF64}}:
 1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im</code></pre><p>Then we repeat this control block over and over on different qubits, and put a Hadamard gate to <code>i</code>th qubit to construct <code>i</code>-th <code>B</code> block.</p><pre><code class="language-julia hljs">B(n, k) = chain(n, j==k ? put(k=&gt;H) : A(j, k) for j in k:n)</code></pre><pre><code class="nohighlight hljs">B (generic function with 1 method)</code></pre><p>We need to input the total number of qubits <code>n</code> here because we have to iterate through from <code>k</code>-th location to the last.</p><p>Now, let&#39;s construct the circuit by chaining all the <code>B</code> blocks together</p><pre><code class="language-julia hljs">qft(n) = chain(B(n, k) for k in 1:n)
qft(4)</code></pre><pre><code class="nohighlight hljs">nqubits: 4
chain
├─ chain
│  ├─ put on (1)
│  │  └─ H
│  ├─ control(2)
│  │  └─ (1,) shift(1.5707963267948966)
│  ├─ control(3)
│  │  └─ (1,) shift(0.7853981633974483)
│  └─ control(4)
│     └─ (1,) shift(0.39269908169872414)
├─ chain
│  ├─ put on (2)
│  │  └─ H
│  ├─ control(3)
│  │  └─ (2,) shift(1.5707963267948966)
│  └─ control(4)
│     └─ (2,) shift(0.7853981633974483)
├─ chain
│  ├─ put on (3)
│  │  └─ H
│  └─ control(4)
│     └─ (3,) shift(1.5707963267948966)
└─ chain
   └─ put on (4)
      └─ H
</code></pre><h2 id="Wrap-QFT-to-an-external-block"><a class="docs-heading-anchor" href="#Wrap-QFT-to-an-external-block">Wrap QFT to an external block</a><a id="Wrap-QFT-to-an-external-block-1"></a><a class="docs-heading-anchor-permalink" href="#Wrap-QFT-to-an-external-block" title="Permalink"></a></h2><p>In most cases, <code>function</code>s are enough to wrap quantum circuits, like <code>A</code> and <code>B</code> we defined above, but sometimes, we need to dispatch specialized methods on certain kinds of quantum circuit, or we want to define an external block to export, thus, it&#39;s useful to be able to wrap circuit to custom blocks.</p><p>First, we define a new type as subtype of <code>PrimitiveBlock</code> since we are not going to use the subblocks of <code>QFT</code>, if you need to use its subblocks, it&#39;d be better to define it under <code>CompositeBlock</code>.</p><pre><code class="language-julia hljs">struct QFT &lt;: PrimitiveBlock{2}
    n::Int
end

YaoBlocks.nqudits(q::QFT) = q.n</code></pre><p>Now, let&#39;s define its circuit</p><pre><code class="language-julia hljs">circuit(q::QFT) = qft(q.n)</code></pre><pre><code class="nohighlight hljs">circuit (generic function with 1 method)</code></pre><p>And forward <code>mat</code> to its circuit&#39;s matrix</p><pre><code class="language-julia hljs">YaoBlocks.mat(::Type{T}, x::QFT) where T = mat(T, circuit(x))</code></pre><p>You may notice, it is a little ugly to print <code>QFT</code> at the moment, this is because we print the type summary by default, you can define your own printing by overloading <code>print_block</code></p><pre><code class="language-julia hljs">YaoBlocks.print_block(io::IO, x::QFT) = print(io, &quot;QFT($(x.n))&quot;)</code></pre><p>Since it is possible to use FFT to simulate the results of QFT (like cheating), we could define our custom <code>apply!</code> method:</p><pre><code class="language-julia hljs">using FFTW, LinearAlgebra

function YaoBlocks.apply!(r::ArrayReg, x::QFT)
    α = sqrt(length(statevec(r)))
    invorder!(r)
    lmul!(α, ifft!(statevec(r)))
    return r
end</code></pre><p>Now let&#39;s check if our <code>apply!</code> method is correct:</p><pre><code class="language-julia hljs">r = rand_state(5)
r1 = r |&gt; copy |&gt; QFT(5)
r2 = r |&gt; copy |&gt; circuit(QFT(5))
r1 ≈ r2</code></pre><pre><code class="nohighlight hljs">true</code></pre><p>We can get iQFT (inverse QFT) directly by calling <code>adjoint</code></p><pre><code class="language-julia hljs">QFT(5)&#39;</code></pre><pre><code class="nohighlight hljs"> [†]QFT(5)</code></pre><p>QFT and iQFT are different from FFT and IFFT in three ways,</p><ol><li>they are different by a factor of <span>$\sqrt{2^n}$</span> with <span>$n$</span> the number of qubits.</li><li>the <a href="https://quantumbfs.github.io/BitBasis.jl/stable/tutorial/#Conventions-1">bit numbering</a> will exchange after applying QFT or iQFT.</li><li>due to the convention, QFT is more related to IFFT rather than FFT.</li></ol><h2 id="Phase-Estimation"><a class="docs-heading-anchor" href="#Phase-Estimation">Phase Estimation</a><a id="Phase-Estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Phase-Estimation" title="Permalink"></a></h2><p>Since we have QFT and iQFT blocks we can then use them to realize phase estimation circuit, what we want to realize is the following circuit:</p><p><img src="assets/phaseest.png" alt="phase estimation"/></p><p>First we call Hadamard gates repeatly on first <code>n</code> qubits.</p><pre><code class="language-julia hljs">Hadamards(n) = repeat(H, 1:n)</code></pre><pre><code class="nohighlight hljs">Hadamards (generic function with 1 method)</code></pre><p>Then in dashed box <code>B</code>, we have controlled unitaries:</p><pre><code class="language-julia hljs">ControlU(n, m, U) = chain(n+m, control(k, n+1:n+m=&gt;matblock(U^(2^(k-1)))) for k in 1:n)</code></pre><pre><code class="nohighlight hljs">ControlU (generic function with 1 method)</code></pre><p>each of them is a <code>U</code> of power <span>$2^{(k-1)}$</span>.</p><p>Since we will only apply the qft and Hadamard on first <code>n</code> qubits, we could use <code>Subroutine</code>, which creates a context of a sub-scope of the qubits.</p><pre><code class="language-julia hljs">PE(n, m, U) =
    chain(n+m, # total number of the qubits
        subroutine(Hadamards(n), 1:n), # apply H in local scope
        ControlU(n, m, U),
        subroutine(QFT(n)&#39;, 1:n))</code></pre><pre><code class="nohighlight hljs">PE (generic function with 1 method)</code></pre><p>we use the first <code>n</code> qubits as the output space to store phase <span>$ϕ$</span>, and the other <code>m</code> qubits as the input state which corresponds to an eigenvector of oracle matrix <code>U</code>.</p><p>The subroutine here uses <code>focus!</code> and <code>relax!</code> to manage a local scope of quantum circuit, and only activate the first <code>n</code> qubits while applying the block inside the subroutine context, and the scope will be <code>relax!</code>ed back, after the context. This is equivalent to manually <code>focus!</code> then <code>relax!</code></p><p>fullly activated</p><pre><code class="language-julia hljs">r = rand_state(5)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>first 3 qubits activated</p><pre><code class="language-julia hljs">focus!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 3/5
    nlevel: 2</code></pre><p>relax back to the original</p><pre><code class="language-julia hljs">relax!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>In this way, we will be able to apply small operator directly on the subset of the qubits.</p><p>Details about the algorithm can be found here: <a href="https://en.wikipedia.org/wiki/Quantum_phase_estimation_algorithm">Quantum Phase Estimation Algorithm</a></p><p>Now let&#39;s check the results of our phase estimation.</p><p>First we need to set up a unitary with known phase, we set the phase to be 0.75, which is <code>0.75 * 2^3 == 6 == 0b110</code> .</p><pre><code class="language-julia hljs">N, M = 3, 5
P = eigen(rand_unitary(1&lt;&lt;M)).vectors
θ = Int(0b110) / 1&lt;&lt;N
phases = rand(1&lt;&lt;M)
phases[0b010+1] = θ
U = P * Diagonal(exp.(2π * im * phases)) * P&#39;</code></pre><pre><code class="nohighlight hljs">32×32 Matrix{ComplexF64}:
  -0.218439+0.0758865im     -0.149266-0.00982415im     0.119227+0.20175im       0.0103741-0.210161im       0.122859-0.110419im   -0.0748209+0.265161im     -0.153682+0.152978im    -0.0205984+0.197883im      0.107881+0.122139im    -0.0183126+0.0827116im   -0.0214387+0.10547im        0.0398867-0.12836im         -0.436954+0.00979987im    0.0283253-0.121057im      0.049462+0.131114im       0.290404-0.0637732im     0.152257-0.113076im     -0.0544334-0.0882783im      -0.236057+0.0150428im   -0.0643812-0.0849315im    -0.0371431+0.0871244im    0.186946+0.140113im      0.0356111+0.0958806im   -0.0351813-0.00697044im    0.0826486+0.00221577im  -0.00612486-0.0430022im   0.0343942+0.0476781im      0.0925692-0.0207975im    0.0111029-0.111996im      -0.108376-0.0933055im   -0.0657797-0.0898573im   -0.0150853-0.0315797im
  -0.117467-0.102815im     -0.0384382-0.0455406im    0.00664523-0.219919im       0.208759-0.0747921im      0.139462-0.0797194im   0.0682151+0.158901im    0.00182979+0.0132868im     0.310113+0.0320552im    -0.234181+0.0394017im     0.252824+0.148241im    -0.0331982-0.18142im         0.243886+0.105485im        0.0487396+8.82574e-5im    0.0468656+0.0581436im     0.103645-0.185687im      0.0901026+0.0739235im   0.00354651-0.0875149im   -0.00872502-0.0897634im     -0.0295117+0.171432im     -0.118436-0.169539im       0.200644-0.159522im   -0.0636437+0.000812309im  -0.0553724-0.0118624im   -0.0136326+0.0382752im     -0.084145-0.102116im      0.0522751-0.109889im    -0.141141+0.203045im        0.207741+0.0705952im     0.027197+0.256992im      0.0788234-0.0458042im    -0.107314+0.113708im    -0.0153367+0.053954im
    0.10186-0.098378im      0.0175206+0.159049im      -0.264568-0.0541354im    -0.0561408+0.116423im     -0.0637073-0.184634im     0.189372-0.10728im     -0.0573059+0.0916545im   -0.0345208+0.0985231im     0.109929+0.161964im    -0.0985782+0.179356im     -0.225477+0.0664874im        0.14067+0.176032im       -0.0643385-0.0270123im       0.22065-0.12578im      0.0921713-0.292705im     -0.0983349-0.0891062im   -0.0084004+0.0820531im     0.0223413-0.0349393im      -0.041232+0.134965im      0.185218-0.096277im      -0.144514+0.353238im    -0.010677+0.0281329im     -0.040453+0.137356im     0.0152425+0.0819381im     0.0287792-0.0438104im      0.145684+0.0119409im   0.0308859+0.114718im      -0.0368543-0.0940775im    -0.211756-0.0387061im     0.0365748-0.171085im     0.0778393+0.090025im     0.0251389+0.0547981im
   0.126171+0.17195im        0.153878-0.0328575im      0.256234-0.0583035im      -0.15335-0.114378im        0.03216-0.118691im    0.0278435-0.0495465im    0.0519586-0.075678im    -0.0492886-0.0642503im     0.211451+0.021534im     0.0731278+0.176576im     -0.095708-0.391167im        0.076788+0.109633im         0.119583+0.0206392im    -0.0804748-0.101787im       -0.1311+0.00909454im    0.0728992+0.209259im     0.0838935+0.0760975im     0.0690506-0.108473im      -0.0733185-0.132636im      -0.13105-0.185189im     -0.0986222+0.195983im     0.129137+0.041388im      -0.121454+0.0435701im    -0.140784-0.151473im      -0.115482+0.181221im     -0.0993904+0.213258im    0.0304735-0.00200826im      0.032248+0.0649953im    0.0307833+0.0646097im      -0.16267+0.0599223im    0.0487837+0.143271im      0.186676+0.0253248im
  -0.066437-0.019917im      -0.171079-0.0556364im   -0.00363153+0.0137754im     0.0872502-0.125803im      -0.359204+0.0318917im   0.0591971+0.146282im    -0.0252351-0.230529im     -0.153508+0.0836916im     0.164494-0.0153604im    -0.111787-0.206299im     0.0927168+0.0419043im       0.243199+0.217205im          0.14905+0.170724im       0.187275-0.111168im     0.0470897-0.0488553im      0.138072-0.0157238im    0.0190193+0.0179999im    -0.0998559-0.28933im         0.168099+0.117289im      0.108705-0.0149455im    -0.0162578-0.127499im    0.0407643-0.0704836im    -0.0603593+0.046058im     -0.086591-0.0831544im      0.206299+0.0650616im     -0.056464+0.0157698im   0.0805371-0.0284031im     -0.0821248+0.318363im     0.0374556+0.030305im     -0.0150934+0.0745255im    -0.057347+0.0200183im   -0.0813826+0.0486399im
  0.0291685-0.0503286im    -0.0245124-0.245215im     -0.0875455-0.0407096im     0.0279718+0.230103im     -0.0855713+0.0834408im    -0.24864+0.0535083im   -0.0371762-0.140803im     -0.152824+0.0416624im   -0.0580225+0.172092im     0.0987616-0.0142482im     0.110534+0.0216866im      -0.110914-0.0459309im     -0.00807783+0.260106im      0.0996838-0.0334112im     0.122204-2.58321e-5im     0.029039+0.029988im     0.0760739-0.167468im      -0.150298+0.0210124im     -0.0177066-0.0125552im    -0.172426-0.0533565im       -0.1831+0.0980224im   -0.151746-0.22147im       -0.120764-0.024296im    -0.0485702-0.0322351im     -0.120047-0.303305im      -0.152556+0.161167im     0.162534-0.0591681im       0.199883-0.121359im    -0.0658449+0.123998im      -0.123171-0.234102im      0.107833+0.0608499im    0.0946438-0.0644627im
  0.0279553+0.0436298im        0.1969-0.227658im      -0.136895+0.201967im     -0.0602839+0.00337874im    0.0163681-0.149615im   -0.0231067+0.0172383im    -0.304008-0.131003im     0.0411996-0.029725im     0.0311941-0.113336im    -0.0913321+0.0759635im     0.101565-0.112372im      0.00494424-0.0870492im       0.0549367-0.048683im       0.223301+0.067667im    -0.0977626-0.00195433im  0.000967947-0.0029888im    0.0898615-0.0708338im     -0.163938-0.0122959im      0.0138617+0.0728524im   -0.0932474+0.25969im       0.0670683+0.0492149im   0.0885036-0.00584357im    0.0200608+0.109306im      -0.14708+0.101081im      0.0250357+0.0344283im     -0.192837-0.145969im    -0.262236-0.105924im       -0.179882-0.228147im     -0.132951+0.121098im      0.0606057+0.0276532im    -0.254994+0.21774im     0.00344248+0.159223im
   0.220005+0.200436im      0.0552709+0.0460213im      0.101757-0.0684494im     0.0483654-0.210131im     -0.0419806+0.0265292im   -0.160287-0.12673im       -0.08265-0.0809218im    -0.205064-0.0233189im    -0.063851-0.126718im    -0.0673418+0.108916im     0.0899701-0.109705im        0.028096+0.0832217im      -0.0317614-0.00107494im     0.243136-0.206739im      0.141752+0.0789043im     0.0604271-0.122386im      0.122794+0.171943im      0.0752056+0.0118114im      0.0547685+0.10726im      -0.277381-0.0447973im     0.0924089-0.190335im    -0.159797-0.0039047im     0.0973654-0.00487841im    0.265166+0.238217im      -0.122933-0.0114619im      0.245454-0.140623im     0.015269+0.0481714im     -0.0558173-0.0670482im   -0.0402191-0.154978im      -0.166199-0.0726472im    0.0504753+0.0691538im    -0.016872-0.0998988im
   0.040324-0.250394im      -0.210868+0.0130231im     0.0330759+0.0737955im    -0.0625227-0.115489im      0.0227307+0.302251im    0.0862103+0.224685im      0.114474-0.156913im     -0.269973-0.153785im     -0.113362+0.0189003im   0.00989021+0.0631231im    -0.182396-0.136083im      -0.0705085-0.0346549im       -0.124484+0.25337im       0.0553405-0.0162013im    -0.193373-0.0414219im      -0.15272-0.00293798im  0.00764234+0.00649165im   -0.0462512+0.148451im      -0.0474737-0.0852595im   -0.0655581-0.227629im      0.0216609+0.0567713im    0.175115-0.0349457im    -0.0596057-0.0421507im   -0.0151743+0.192458im      0.0188588+0.111671im        0.15003-0.130311im     0.113055-0.0154563im      -0.112933-0.152802im    -0.0118031+0.130287im       0.196491+0.0739794im    -0.146656+0.0667818im    -0.050216+0.0573001im
  0.0216043-0.228155im       0.050678+0.111541im       0.080962+0.0369864im      0.135226-0.165582im      0.0201784-0.218944im    0.0700165-0.0393831im    0.0980154+0.0698361im    -0.195058-0.0957428im     0.192572-0.333435im     -0.130275-0.231297im     -0.135544-0.0893338im      -0.162529+0.121631im       -0.0194196-0.23502im       0.0447546-0.032005im      0.179273-0.00481253im    -0.100162-0.09056im       0.118963-0.194707im     -0.0849656+0.0966635im      -0.154104+0.015822im     0.0271892-0.0273971im     0.0264278-0.0478056im  -0.0296887-0.0100353im     0.0174544+0.0926869im     0.065775-0.110535im     -0.0770642-0.155487im      -0.118776-0.150494im     0.158478-0.120173im        0.170338+0.0119041im    0.0475737+0.288262im   -0.000564603-0.0261528im   -0.0160323-0.0225372im     0.128989+0.0668389im
  -0.112212-0.0338035im      0.103046-0.0733702im     0.0989814-0.376952im      0.0792421+0.14804im       -0.142479+0.0438111im   0.0641352+0.0805252im    -0.100617+0.00665796im   -0.167701+0.0823474im    0.0254205-0.0553447im   -0.0902867-0.0829132im    -0.106806-0.0441375im      -0.115256-0.261372im       -0.0608978-0.0377873im    -0.0470346-0.091551im    -0.0793691+0.156881im    -0.00839191-0.0596859im   -0.0342459+0.206799im       0.107006-0.0227312im       0.138031+0.0768596im     0.105494+0.00681036im     0.258626+0.149749im    0.0102858+0.232013im      -0.209076+0.0557048im    0.0527479-0.067475im      -0.184213-0.139074im      -0.137951+0.0250199im   0.0907249+0.141717im       0.0583268-0.0112269im   0.00793127-0.0723461im    -0.0594656-0.0586896im    -0.232195+0.141609im      -0.23342+0.115666im
   0.248036+0.181888im     -0.0683621-0.138994im       -0.13618-0.00655462im    0.0178416+0.0361658im     -0.014489+0.0388297im    0.144901+0.0629312im    0.0881015+0.0657871im    0.0751269+0.0698787im     0.220946-0.0848254im   -0.0307557+0.121899im     -0.138656-0.0302436im      -0.227824-0.0437701im       -0.211302+0.0321344im    -0.0630231-0.0721541im   -0.0796749-0.172344im      0.0835394+0.184904im    -0.0934779-0.0169108im      0.122509+0.0549961im       0.075385+0.0473585im    -0.120487-0.02499im     -0.00634314-0.178011im    -0.336043+0.144879im       -0.15824+0.0381567im    -0.165497+0.174989im       0.140514+0.0126523im     -0.167993-0.155915im    0.0229059-0.196738im      0.00601426+0.227044im    -0.0169485-0.0109158im      0.124036-0.170184im    -0.0848344-0.0738964im    0.0250792-0.111694im
   0.176924+0.0521591im    -0.0876288+0.100001im      0.0379574-0.0116497im      0.116164-0.0606189im       0.20016-0.0463442im  -0.0475704-0.1201im       -0.128656+0.00755793im     0.23408-0.144051im    -0.0981728+0.0687487im     -0.16443-0.0209025im    -0.115132+0.0989046im       0.202842+0.0826805im       -0.169027+0.0547167im     0.0414097+0.0564251im   0.00303962+0.150148im      -0.117614+0.205492im      0.195258-0.141311im     -0.0919756+0.0174619im       0.145001+0.125376im     0.0435919+0.0576905im      0.021246+0.173894im    0.0327251-0.0148061im     -0.198169-0.0874306im   0.00279478+0.15549im       -0.140052-0.176431im      -0.113771+0.0411889im    0.281832-0.168187im       -0.124745+0.137142im      0.110902-0.0571356im    -0.0112211+0.27677im     -0.0234777+0.0969296im    -0.116601-0.123907im
   0.181776-0.0211179im     0.0981044+0.125614im      -0.122293+0.169457im      0.0656296-0.0106887im     0.0184236-0.176173im   -0.0735157+0.216298im      0.031307-0.0145436im    0.0197133+0.109261im    -0.0691147-0.126937im     -0.116707+0.0249994im    -0.114199-0.0965809im       0.150278+0.0115198im       0.0964302-0.0255097im     -0.233809+0.00846813im  -0.0888756+0.0373043im      0.180579+0.0364192im    -0.209791+0.1312im        -0.150418+0.0874168im      -0.113426-0.0605725im     0.165414-0.0564022im     0.0908972-0.235902im     0.141229-0.206619im      -0.156167-0.142403im    -0.0568373-0.0860138im    -0.0185606-0.0949872im   -0.00177779-0.0369547im    0.132854-0.0450844im      -0.127701-0.141417im    -0.0777934-0.0767066im     -0.122743-0.282056im     0.0993352+0.175777im     -0.220752-0.156857im
  0.0708443-0.141987im     -0.0584468-0.0622053im      0.129122-0.0023493im    -0.0985222+0.148895im       0.132773-0.143775im   -0.0588236+0.113775im     -0.230776+0.0407128im    0.0686813-0.0102438im    0.0149225-0.0200725im    -0.283069-0.255941im    -0.0367763-0.0275441im     -0.0343319+0.0335691im      -0.0468625+0.0487284im    -0.0497889+0.050983im     -0.314603-0.207376im     -0.0578772+0.0320463im    0.0383996-0.0318075im      0.176328-0.0428701im       0.160917+0.0444047im     -0.19031-0.10067im      -0.0342273-0.178296im     0.113765-0.199062im       0.222659+0.217442im    -0.0319839-0.0469387im     -0.234181-0.0903176im      0.112938+0.0992636im  0.00338142+0.145885im      -0.0044979+0.146763im     -0.166531-0.12689im         0.05166-0.0662294im   -0.0327243-0.135972im     0.0605014-0.00641889im
  0.0792238-0.313031im      0.0354114+0.209714im     0.00308902+0.101343im      0.0768311-0.064379im     -0.0958042-0.0377316im   -0.124741-0.0344793im   -0.0797631+0.0992359im   -0.0717496+0.0746551im    0.0688894+0.306991im     0.0866786+0.0814381im    0.0552145-0.120078im       0.0306518-0.0342753im       0.0704882-0.0079628im    -0.0301444-0.0233888im   -0.0400474+0.065424im      -0.286263-0.135365im     0.0146281+0.0972942im      0.134182-0.0850183im      -0.165574+0.163301im    -0.0215635+0.0363034im       0.18587-0.241866im   -0.0755941+0.0392172im     0.0891898-0.0428472im    -0.256702+0.159091im       0.101824+0.0147586im     -0.230097+0.196809im    0.0950916-0.083882im        0.161121-0.0429131im   -0.0120204-0.197025im      0.0215206+0.0892767im    -0.121629+0.0671931im     0.136409-0.0836821im
 -0.0523495-0.00781989im    -0.217897+0.063308im      0.0341682-0.015538im       0.025254+0.11554im      -0.0294837-0.0335784im   0.0955894-0.248144im     -0.069059-0.0426511im    -0.162609+0.0322699im   -0.0716684+0.126129im     -0.247259-0.0527279im    0.0664926-0.186097im      -0.0827133-0.212944im       -0.0657342-0.0148581im    -0.0715231+0.183783im    -0.0473545-0.131345im      0.0751222+0.124635im     -0.151086-0.153258im     -0.0400697-0.181984im       -0.045328+0.128566im     0.0421237-0.117785im       0.102776-0.0678988im   0.0864669+0.0526678im     -0.158355-0.0546555im     0.181916+0.0964173im      0.116758+0.0671378im    -0.0628544-0.160014im    -0.166225-0.0387556im       0.105652-0.0571871im    -0.219075+0.0870792im     -0.280756+0.209391im      0.243121+0.0464793im    0.0817049-0.120958im
  0.0689883+0.116154im    0.000647819+0.21552im       0.0632665-0.161974im      0.0491193+0.135367im      -0.186394+0.198458im    -0.090534+0.0483616im     0.224885+0.104194im     0.0320566-0.0636759im     -0.11026+0.155424im     -0.160488+0.00412365im  -0.0832062-0.0535753im      0.0809664-0.0762988im        0.127008-0.0453402im     0.0147788+0.0990289im    -0.112584-0.096893im       0.105204-0.0188719im     0.272748-0.127102im       -0.19984-0.0364163im      -0.266545+0.116001im    -0.0302117+0.0994453im     0.0298169-0.0732103im   0.0950095+0.1687im         0.032361+0.0784855im     0.131078+0.0315357im    -0.0927981-0.0160432im    -0.0603164+0.104889im   -0.0858999-0.149163im       -0.286118+0.0756438im    0.0451287+0.0194157im     0.0175041-0.292089im    -0.0950663-0.143485im      0.143225+0.109832im
 -0.0559418+0.0021904im   0.000669288+0.274855im       -0.18737-0.220672im      0.0232077-0.161447im     -0.0905921+0.0733245im   -0.239551+0.00713213im   -0.274246-0.0654071im     0.103343-0.0668793im     0.169407-0.276928im     0.0710265-0.0302677im    0.0463258+0.047235im      -0.0428351-0.151721im       -0.0831212+0.137031im     -0.0183724+0.0740781im   0.00435674-0.134326im      -0.150674+0.0611391im   -0.0113802-0.0772325im      0.156735-0.0628692im       -0.29724-0.163641im     0.0752563+0.0127836im     -0.126651+0.0273556im  -0.0239275-0.186951im      -0.084769-0.0358286im   0.00289191+0.205902im     -0.0566664+0.153423im      -0.122214+0.0284858im  -0.0730285+0.217587im      -0.0932928+0.133531im     0.0676161+0.0807243im     -0.146914-0.0662738im   0.00774881-0.00839688im  -0.0980147+0.0372982im
  0.0962438-0.0624278im      0.216138+0.146912im       0.163409+0.0770579im      0.197441+0.19884im       0.0410266+0.167804im   -0.0647416-0.0858684im   0.00172235+0.0754265im    0.0193718+0.0334039im   -0.0911791+0.035533im     0.0973438-0.158116im      0.050783-0.0462735im     -0.0547598+0.0245851im       -0.195204-0.14259im      -0.0592533-0.133052im       0.09373+0.00591989im    0.0645567-0.157792im      -0.36983-0.164985im      -0.012428-0.377723im       0.0392801-0.0238799im    -0.179589-0.0605886im     -0.191517+0.0623658im   0.0405427-0.0209922im    -0.0118985+0.0926883im    -0.142913+0.0782557im    -0.0691286+0.0935244im     0.0715401-0.0893908im   0.0495312-0.104291im       -0.171677+0.0427432im    0.0937329+0.0231685im     0.0949243-0.0199935im     0.021056+0.214062im    -0.0806405+0.152707im
 -0.0134293+0.277637im     -0.0750702-0.0811758im     0.0199714-0.0699941im      0.372574+0.0296853im     0.0200434-0.107566im    0.0478622+0.0197027im   0.00686295-0.0868161im    -0.020973+0.00106379im   -0.159497-0.0592404im     0.174928-0.0629985im   -0.0960453+0.00650315im  -0.000437822-0.135703im        0.0330596-0.0699483im      0.123733-0.290419im     -0.207774-0.101508im      -0.108611+0.0119667im    0.0022914+0.074415im        0.11848+0.0326436im      -0.229677+0.0790478im    0.0598686-0.0160322im     -0.159008+0.0178164im    0.136336-0.143353im       0.197627-0.0199573im     0.140252-0.0408827im     0.0437963+0.0456444im     -0.114471+0.125008im   -0.0210426-0.317981im        0.151162+0.00985456im     -0.1929-0.0170848im      0.136412+0.113819im     0.0506126-0.0122815im    -0.206232+0.00528112im
 -0.0331182+0.0787863im     -0.096893-0.24314im       0.0814616+0.0612371im     0.0909255-0.158819im      0.0541308-0.0401717im  -0.0920533-0.039357im    -0.0185275-0.134621im    -0.0883407-0.0584843im     0.132118-0.0573408im   -0.0557036+0.240442im     -0.135211+0.190107im      -0.0520464-0.0228145im        0.276363-0.00360305im    -0.206281+0.180812im    -0.0732664-0.0606041im    -0.0721824-0.219768im    -0.0564191-0.242685im     -0.0716251-0.219297im       -0.144871+0.091918im     0.0125121-0.199196im     -0.0511338+0.0353657im   -0.195156+0.170072im      0.0854194-0.0910943im    0.0554227-0.0544195im     -0.131253-0.0950899im    -0.0714217-0.0464443im   0.0636622+0.157263im       -0.137335+0.00283999im  -0.0480931-0.221455im       0.207087+0.0361631im    0.0790346+0.135673im    -0.0616072+0.0175843im
 0.00938584-0.0360687im     0.0695027-0.130208im      0.0349854-0.206584im       0.118632-0.164961im      -0.034361-0.087742im    -0.116995+0.0600968im    0.0190094+0.215316im     0.0945477-0.00547396im  -0.0871665-0.0116212im    -0.128605-0.0609005im    0.0712631+0.258823im       0.0289499-0.0347969im        0.204914+0.0319613im      0.102731-0.141314im     -0.149978+0.022151im     -0.0549512-0.102759im     -0.137382-0.0602137im      0.188953+0.0959146im     -0.0725847-0.167411im     -0.131431-0.0528246im     -0.114973-0.0467524im    0.139554+0.14633im       -0.361005+0.0216187im   -0.0647785-0.00319258im     0.260506-0.187494im       0.170247-0.0343522im  -0.0224692-0.0418755im      -0.124229-0.0522089im   -0.0843661+0.050012im     -0.0604428+0.112455im    -0.0347185+0.0789509im     0.306633-0.0673965im
   -0.19206+0.0261476im     0.0641372+0.0509335im    -0.0612555-0.0746155im     0.0110125-0.0475343im     -0.113784+0.0474029im    0.119696-0.113881im     -0.196203+0.0867882im   -0.0509291-0.0884263im    -0.036111-0.0324023im     0.272739-0.0250995im    0.0395875-0.223445im      -0.0282439+0.25786im         -0.227222+0.13486im       0.0112075+0.0576139im    -0.340188+0.106144im     -0.0641392-0.172292im     0.0982398-0.129899im      -0.131578-0.000318549im   -0.0604242-0.0671647im     0.149948+0.0433796im      0.041503-0.058326im    -0.159445-0.0086806im     -0.174883+0.0887596im   -0.0534503-0.233685im     -0.0804915-0.124963im        0.17352-0.115894im    -0.140855-0.173097im      -0.0455895+0.0763118im   -0.0785941-0.214389im      0.0397728-0.0378424im     0.106796+0.0262468im    0.0339297-0.142214im
   0.243982-0.00908174im    0.0848279-0.011447im       0.088956-0.11729im         -0.1034-0.0490209im      0.222848+0.0471244im    0.169656+0.129691im    -0.0724625+0.0517471im   -0.0824745+0.070177im     0.0233164-0.0292692im     0.092125-0.00194846im  -0.0231229+0.17341im        0.0218473-0.217im        -0.000705036+0.121334im       0.314869+0.0696853im    -0.031771-0.0164433im    -0.0259353+0.0234534im   -0.0301685+0.140033im      -0.027616-0.378909im     -0.00661911-0.108064im      0.308846-0.0807588im     0.0505751-0.108541im   -0.0394454+0.0465448im      0.183669-0.0851408im   -0.0996182-0.0572731im     -0.172535-0.145712im    -0.00832943-0.0488026im    -0.07707-0.155329im      -0.0750153-0.11303im       0.168567+0.160242im     -0.0543358+0.00920868im    0.104388-0.101532im      0.142814-0.143134im
  -0.114538-0.114679im      -0.030366-0.124455im     -0.0217128-0.234587im      -0.157783-0.129767im       0.168746+0.284462im   0.00944727-0.0485438im   -0.0150545+0.166994im     0.0384295-0.277179im     0.0867516+0.0536994im  -0.00747406-0.00542638im  -0.0138308+0.0297464im      0.0418997+0.26657im        0.00644352-0.224625im      0.0616073-0.116763im    -0.0197436-0.0324947im      0.223934-0.0681369im    -0.104292-0.0555049im     0.0600077-0.0494151im        0.02881-0.0373224im  -0.00802697-0.128805im       0.148638+0.0291206im  -0.0252716-0.191834im      0.0940424-0.0896294im   0.00258888+0.0408908im        0.1029-0.0275347im     -0.344744+0.0509483im   0.0277912-0.109254im       -0.131498-0.171843im     -0.233447-0.061415im      -0.160939-0.0468438im   -0.0393262-0.130342im     -0.133881+0.0177088im
   0.116315+0.0791717im     -0.100704-0.112745im      0.0696881+0.0558172im     -0.149762+0.073668im     -0.0510275-0.0638533im  -0.0967962+0.113068im      0.147819-0.0776305im     0.252955+0.171058im     0.0689753+0.0670255im   -0.0279914-0.0510858im   -0.0664362+0.00884386im     0.0680539+0.080128im       -0.0430477-0.142739im       0.113573+0.0212023im    -0.128579+0.168299im      -0.302806-0.154109im    -0.0516698-0.11907im      -0.0412632-0.160665im       0.0221568-0.168187im     0.0947708-0.152862im       0.105341-0.0125959im    -0.12884-0.198837im      -0.214877+0.176677im      0.377225+0.0653774im     0.0332372+0.19925im      -0.0533368-0.0107049im  -0.0745604-0.0606668im       0.162748-0.137036im      0.136895-0.0548178im    -0.0566234-0.0763643im     -0.14157-0.0132843im    0.0128629+0.0349987im
   0.174686-0.00254168im     0.197913-0.227703im     -0.0577106-0.000795808im    0.080196-0.132561im        -0.1723+0.0674566im    0.327138-0.158802im     -0.206526+0.0676537im   -0.0774438+0.19727im       0.066755+0.157501im     0.0463757-0.0905198im      0.12333-0.019974im        0.175838+0.0416696im       -0.100776-0.00126111im   -0.0987226+0.209661im     0.0540519-0.00146972im    0.0503634+0.0644854im    -0.166461-0.054707im      -0.022525+0.114549im       -0.207881-0.188469im    -0.0828843-0.0375576im    -0.0209908-0.038344im    0.0618126+0.00982871im    0.0978752-0.0243459im     0.316962+0.0423793im    -0.0700271-0.0362872im    0.00350216+0.167673im     0.165026+0.0546877im     -0.0756494+0.0362908im    -0.030877+0.109787im       0.111756+0.0391958im    -0.250499-0.0705252im   -0.0080627-0.122949im
 -0.0271994-0.119759im      0.0523331+0.117462im     -0.0350645+0.0226802im    -0.0929807-0.179732im    -0.00671646-0.0031369im   0.0366004-0.0263786im       0.3025-0.291347im      0.227981+0.271412im    -0.0970846-0.0273197im   -0.0369834-0.162248im    -0.0111608-0.0773991im     -0.0674467-0.107153im       -0.0860282+0.000107306im     0.24867-0.0875404im    -0.127814+0.0939552im      0.216669+0.0205373im   -0.0650323-0.112621im      0.0274349+0.0190909im      -0.101794-0.145948im      0.014227+0.133299im       0.129634+0.075572im    -0.206301+0.0531094im       0.06573-0.053586im    -0.0354431+0.0444085im     -0.135929-0.0594352im    -0.0655931+0.104607im     0.113135+0.155598im      -0.0789798+0.063392im     -0.320864-0.0801177im      0.109435+0.127511im      0.140638+0.0643455im     0.121698+0.072726im
 -0.0221562-0.0108315im    -0.0848617-0.118291im       0.108291-0.0281452im    -0.0826155-0.0956799im     0.0260594-0.0872156im  -0.0632075-0.253994im     0.0107331-0.0711264im   -0.0526483+0.021774im    -0.0433469+0.0766179im     0.110074+0.169125im     -0.114545-0.0068453im      -0.099206-0.000834613im      0.052892-0.00189001im   -0.0341504-0.163343im    -0.0317227-0.0385172im    -0.0627185+0.267815im     -0.221717-0.0780913im     -0.166916-0.0784126im      -0.116764-0.0144891im     0.175891+0.220002im    -0.00647736-0.178586im    0.0234955-0.0774871im    -0.0207401+0.146148im    -0.0957253+0.0989603im   -0.00849918-0.19916im        0.254195-0.0342126im    0.150133+0.00952443im  -0.000995016+0.0109186im    0.0128793-0.0731975im     -0.227776+0.0144238im    -0.214884-0.245504im    -0.0644847+0.355008im
   -0.14633-0.0174558im    -0.0970928+0.0551318im     -0.140193+0.155597im        0.06615-0.138089im     -0.0712874-0.0889361im  -0.0143259-0.0421369im   -0.0568764-0.00476797im   0.0613309-0.0487606im    -0.217004-0.0833745im     0.108802-0.00731241im   -0.311934-0.197489im        -0.10535-0.215982im         0.112878+0.0278549im    0.00370396+0.0532626im     0.285374+0.0320694im    -0.0403203-0.0544628im    -0.094041+0.0616677im     0.0224862-0.170553im        0.232666-0.110337im    -0.0827377-0.107507im      0.0036998+0.178049im    0.0274139-0.0799795im     0.0240065-0.0171942im    0.0750336-0.0827928im    0.00329338-0.0595148im    -0.0228415+0.0661485im  -0.0448192-0.138548im       -0.179114+0.138454im     -0.116744-0.126462im     -0.0798776-0.105672im     -0.299333-0.15833im        0.21852-0.202632im
 -0.0229994+0.00348449im    0.0192622+0.0205867im     -0.059212-0.215277im      -0.128306-0.0971031im     0.0241191-0.230867im    -0.164058-0.00620803im  0.00217512-0.058055im     0.0338401+0.0878339im   -0.0834891+0.148018im    -0.0011108-0.0511465im    0.0994763-0.178247im       -0.123865-0.0400913im       0.0278817-0.0113805im    -0.0192749+0.129129im    -0.0928812+0.0123457im    -0.0310948-0.0541742im     0.033513-0.127669im    -0.00378758+0.106089im        0.119925-0.0943809im     0.080517-0.213561im     -0.0163595+0.0787712im   -0.107262+0.189208im       0.380891+0.153272im    -0.0375015+0.0621974im      0.324552-0.0631649im      0.105988+0.0419996im    0.129691-0.169203im       -0.136373+0.0817995im     0.122868+0.186715im      -0.128576-0.0848829im    0.0140624+0.165099im      -0.28309-0.0553055im</code></pre><p>and then generate the state <span>$ψ$</span></p><pre><code class="language-julia hljs">psi = P[:, 3]</code></pre><pre><code class="nohighlight hljs">32-element Vector{ComplexF64}:
   0.14091737315913708 + 0.11599893218555399im
 -0.035163261850538925 - 0.2043940425465525im
  -0.17182830527565474 - 0.047541339015956266im
    0.0845068135935529 + 0.11802581858462077im
   -0.0937133987628494 - 0.08536808763283484im
  -0.28523434407759274 + 0.002630760658161424im
  0.022417629651079005 - 0.13896259307975253im
   0.03141797848697169 + 0.0174085446794362im
    0.3077821880070724 + 0.0im
    0.0669468676176817 - 0.010146418264632733im
   0.11305193407034232 + 0.09096904559009768im
  -0.01839289205078044 + 0.0895655024710277im
  -0.18677052450392012 + 0.07229928710234734im
 -0.018221903822483603 + 0.10534834151690518im
  0.004338557550947114 - 0.19403812336475884im
   0.09883727628361538 - 0.0028314803724684215im
  -0.26516089311111884 - 0.08741862008866187im
  -0.12115274371835236 - 0.1880071972265258im
   0.13988335414763678 + 0.21715778501350416im
  -0.03309434506819075 + 0.2006835696103022im
  -0.07740839333675206 - 0.23589355028506043im
  -0.09810274288258732 - 0.12370511236036855im
  -0.09006003362228805 - 0.0074366789225904055im
  -0.15932189309102765 + 0.055504839395883444im
   -0.1994578140078995 - 0.03606742975877321im
  -0.03415407538364664 + 0.04239844127775918im
   -0.0978136026044949 - 0.013221133935384495im
  -0.06075871913874299 - 0.04053975238641726im
    0.1637464489617049 + 0.02574492368807954im
   -0.1697921474988324 - 0.11104973172419022im
  0.038623646421724715 + 0.051647007592950225im
  -0.15360342907966446 + 0.09887910249787094im</code></pre><p>In the phase estimation process, we will feed the state to circuit and measure the first <code>n</code> qubits processed by iQFT.</p><pre><code class="language-julia hljs">r = join(ArrayReg(psi), zero_state(N))
r |&gt; PE(N, M, U)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 8/8
    nlevel: 2</code></pre><p>Since our phase can be represented by 3 qubits precisely, we only need to measure once</p><pre><code class="language-julia hljs">results = measure(r, 1:N; nshots=1)</code></pre><pre><code class="nohighlight hljs">1-element Vector{BitBasis.BitStr64{3}}:
 011 ₍₂₎</code></pre><p>Recall that our QFT&#39;s bit numbering is reversed, let&#39;s reverse it back</p><pre><code class="language-julia hljs">using BitBasis
estimated_phase = bfloat(results[]; nbits=N)</code></pre><pre><code class="nohighlight hljs">0.75</code></pre><p>the phase is exactly <code>0.75</code>!</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../1.prepare-ghz-state/index.html">« Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a><a class="docs-footer-nextpage" href="../3.grover-search/index.html">Grover Search »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.16 on <span class="colophon-date" title="Friday 29 April 2022 02:27">Friday 29 April 2022</span>. Using Julia version 1.7.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
