<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quantum Fourier Transformation and Phase Estimation · Documentation | Yao</title><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.044/juliamono.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/indigo.css" rel="stylesheet" type="text/css"/><link href="https://yaoquantum.org/assets/favicon-light.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../index.html"><img src="../../../assets/logo.png" alt="Documentation | Yao logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../index.html">Documentation | Yao</a></span></div><form class="docs-search" action="../../../search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../index.html">Home</a></li><li><span class="tocitem">Quick Start</span><ul><li><a class="tocitem" href="../1.prepare-ghz-state/index.html">Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a></li><li class="is-active"><a class="tocitem" href="index.html">Quantum Fourier Transformation and Phase Estimation</a><ul class="internal"><li><a class="tocitem" href="#Quantum-Fourier-Transformation"><span>Quantum Fourier Transformation</span></a></li><li><a class="tocitem" href="#Wrap-QFT-to-an-external-block"><span>Wrap QFT to an external block</span></a></li><li><a class="tocitem" href="#Phase-Estimation"><span>Phase Estimation</span></a></li></ul></li><li><a class="tocitem" href="../3.grover-search/index.html">Grover Search</a></li><li><a class="tocitem" href="../4.shor-algorithm/index.html">Shor&#39;s Algorithm</a></li><li><a class="tocitem" href="../5.shor-9-code/index.html">Shor&#39;s 9 qubit code</a></li><li><a class="tocitem" href="../6.quantum-circuit-born-machine/index.html">Quantum Circuit Born Machine</a></li><li><a class="tocitem" href="../7.variation-quantum-eigen-solver/index.html">Variational Quantum Eigen Solver</a></li></ul></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../../man/array_registers.html">Array Registers</a></li><li><a class="tocitem" href="../../../man/symbolic.html">Symbolic Computation</a></li><li><a class="tocitem" href="../../../man/blocks.html">Blocks</a></li><li><a class="tocitem" href="../../../man/automatic_differentiation.html">Automatic Differentiation</a></li><li><a class="tocitem" href="../../../man/simplification.html">Simplification</a></li><li><a class="tocitem" href="../../../man/registers.html">Abstract Registers</a></li><li><a class="tocitem" href="../../../man/bitbasis.html">BitBasis</a></li><li><a class="tocitem" href="../../../man/extending_blocks.html">Extending Blocks</a></li></ul></li><li><a class="tocitem" href="../../../benchmarks.html">Benchmark</a></li><li><a class="tocitem" href="../../../dev/index.html">Developer Notes</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Quick Start</a></li><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/QuantumBFS/Yao.jl/blob/master/docs/src/quick-start/2.qft-phase-estimation/main.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><p><a href="https://mybinder.org/v2/gh/QuantumBFS/Yao.jl/gh-pages?filepath=dev/generated/quick-start/2.qft-phase-estimation/main.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a> <a href="https://nbviewer.jupyter.org/github/QuantumBFS/Yao.jl/blob/gh-pages/dev/generated/quick-start/2.qft-phase-estimation/main.ipynb"><img src="https://img.shields.io/badge/show-nbviewer-579ACA.svg" alt/></a> <a href="https://minhaskamal.github.io/DownGit/#/home?url=https://github.com/QuantumBFS/tutorials/tree/gh-pages/dev/generated/quick-start/2.qft-phase-estimation"><img src="https://img.shields.io/badge/download-project-orange" alt/></a></p><h1 id="example-qft"><a class="docs-heading-anchor" href="#example-qft">Quantum Fourier Transformation and Phase Estimation</a><a id="example-qft-1"></a><a class="docs-heading-anchor-permalink" href="#example-qft" title="Permalink"></a></h1><p>Let&#39;s use Yao first</p><pre><code class="language-julia hljs">using Yao</code></pre><h2 id="Quantum-Fourier-Transformation"><a class="docs-heading-anchor" href="#Quantum-Fourier-Transformation">Quantum Fourier Transformation</a><a id="Quantum-Fourier-Transformation-1"></a><a class="docs-heading-anchor-permalink" href="#Quantum-Fourier-Transformation" title="Permalink"></a></h2><p>The Quantum Fourier Transformation (QFT) circuit is to repeat two kinds of blocks repeatly:</p><p><img src="assets/qft.png" alt="qft-circuit"/></p><p>The basic building block control phase shift gate is defined as</p><p class="math-container">\[R(k)=\begin{bmatrix}
1 &amp; 0\\
0 &amp; \exp\left(\frac{2\pi i}{2^k}\right)
\end{bmatrix}\]</p><p>Let&#39;s define block <code>A</code> and block <code>B</code>, block <code>A</code> is actually a control block.</p><pre><code class="language-julia hljs">A(i, j) = control(i, j=&gt;shift(2π/(1&lt;&lt;(i-j+1))))</code></pre><pre><code class="nohighlight hljs">A (generic function with 1 method)</code></pre><p>Once you construct the blockl you can inspect its matrix using <code>mat</code> function. Let&#39;s construct the circuit in dash box A, and see the matrix of <span>$R_4$</span> gate.</p><pre><code class="language-julia hljs">R4 = A(4, 1)</code></pre><pre><code class="nohighlight hljs">(n -&gt; control(n, 4, 1 =&gt; shift(0.39269908169872414)))</code></pre><p>If you have read about <a href="generated/quick-start/2.qft-phase-estimation/@ref example-ghz">preparing GHZ state</a>, you probably know that in Yao, we could just leave the number of qubits, and it will be evaluated when possible.</p><pre><code class="language-julia hljs">R4(5)</code></pre><pre><code class="nohighlight hljs">nqubits: 5
control(4)
└─ (1,) shift(0.39269908169872414)</code></pre><p>its matrix will be</p><pre><code class="language-julia hljs">mat(R4(5))</code></pre><pre><code class="nohighlight hljs">32×32 LinearAlgebra.Diagonal{ComplexF64, Vector{ComplexF64}}:
 1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im</code></pre><p>Then we repeat this control block over and over on different qubits, and put a Hadamard gate to <code>i</code>th qubit to construct <code>i</code>-th <code>B</code> block.</p><pre><code class="language-julia hljs">B(n, k) = chain(n, j==k ? put(k=&gt;H) : A(j, k) for j in k:n)</code></pre><pre><code class="nohighlight hljs">B (generic function with 1 method)</code></pre><p>We need to input the total number of qubits <code>n</code> here because we have to iterate through from <code>k</code>-th location to the last.</p><p>Now, let&#39;s construct the circuit by chaining all the <code>B</code> blocks together</p><pre><code class="language-julia hljs">qft(n) = chain(B(n, k) for k in 1:n)
qft(4)</code></pre><pre><code class="nohighlight hljs">nqubits: 4
chain
├─ chain
│  ├─ put on (1)
│  │  └─ H
│  ├─ control(2)
│  │  └─ (1,) shift(1.5707963267948966)
│  ├─ control(3)
│  │  └─ (1,) shift(0.7853981633974483)
│  └─ control(4)
│     └─ (1,) shift(0.39269908169872414)
├─ chain
│  ├─ put on (2)
│  │  └─ H
│  ├─ control(3)
│  │  └─ (2,) shift(1.5707963267948966)
│  └─ control(4)
│     └─ (2,) shift(0.7853981633974483)
├─ chain
│  ├─ put on (3)
│  │  └─ H
│  └─ control(4)
│     └─ (3,) shift(1.5707963267948966)
└─ chain
   └─ put on (4)
      └─ H
</code></pre><h2 id="Wrap-QFT-to-an-external-block"><a class="docs-heading-anchor" href="#Wrap-QFT-to-an-external-block">Wrap QFT to an external block</a><a id="Wrap-QFT-to-an-external-block-1"></a><a class="docs-heading-anchor-permalink" href="#Wrap-QFT-to-an-external-block" title="Permalink"></a></h2><p>In most cases, <code>function</code>s are enough to wrap quantum circuits, like <code>A</code> and <code>B</code> we defined above, but sometimes, we need to dispatch specialized methods on certain kinds of quantum circuit, or we want to define an external block to export, thus, it&#39;s useful to be able to wrap circuit to custom blocks.</p><p>First, we define a new type as subtype of <code>PrimitiveBlock</code> since we are not going to use the subblocks of <code>QFT</code>, if you need to use its subblocks, it&#39;d be better to define it under <code>CompositeBlock</code>.</p><pre><code class="language-julia hljs">struct QFT &lt;: PrimitiveBlock{2}
    n::Int
end

YaoBlocks.nqudits(q::QFT) = q.n</code></pre><p>Now, let&#39;s define its circuit</p><pre><code class="language-julia hljs">circuit(q::QFT) = qft(q.n)</code></pre><pre><code class="nohighlight hljs">circuit (generic function with 1 method)</code></pre><p>And forward <code>mat</code> to its circuit&#39;s matrix</p><pre><code class="language-julia hljs">YaoBlocks.mat(::Type{T}, x::QFT) where T = mat(T, circuit(x))</code></pre><p>You may notice, it is a little ugly to print <code>QFT</code> at the moment, this is because we print the type summary by default, you can define your own printing by overloading <code>print_block</code></p><pre><code class="language-julia hljs">YaoBlocks.print_block(io::IO, x::QFT) = print(io, &quot;QFT($(x.n))&quot;)</code></pre><p>Since it is possible to use FFT to simulate the results of QFT (like cheating), we could define our custom <code>apply!</code> method:</p><pre><code class="language-julia hljs">using FFTW, LinearAlgebra

function YaoBlocks.apply!(r::ArrayReg, x::QFT)
    α = sqrt(length(statevec(r)))
    invorder!(r)
    lmul!(α, ifft!(statevec(r)))
    return r
end</code></pre><p>Now let&#39;s check if our <code>apply!</code> method is correct:</p><pre><code class="language-julia hljs">r = rand_state(5)
r1 = r |&gt; copy |&gt; QFT(5)
r2 = r |&gt; copy |&gt; circuit(QFT(5))
r1 ≈ r2</code></pre><pre><code class="nohighlight hljs">true</code></pre><p>We can get iQFT (inverse QFT) directly by calling <code>adjoint</code></p><pre><code class="language-julia hljs">QFT(5)&#39;</code></pre><pre><code class="nohighlight hljs"> [†]QFT(5)</code></pre><p>QFT and iQFT are different from FFT and IFFT in three ways,</p><ol><li>they are different by a factor of <span>$\sqrt{2^n}$</span> with <span>$n$</span> the number of qubits.</li><li>the <a href="https://quantumbfs.github.io/BitBasis.jl/stable/tutorial/#Conventions-1">bit numbering</a> will exchange after applying QFT or iQFT.</li><li>due to the convention, QFT is more related to IFFT rather than FFT.</li></ol><h2 id="Phase-Estimation"><a class="docs-heading-anchor" href="#Phase-Estimation">Phase Estimation</a><a id="Phase-Estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Phase-Estimation" title="Permalink"></a></h2><p>Since we have QFT and iQFT blocks we can then use them to realize phase estimation circuit, what we want to realize is the following circuit:</p><p><img src="assets/phaseest.png" alt="phase estimation"/></p><p>First we call Hadamard gates repeatly on first <code>n</code> qubits.</p><pre><code class="language-julia hljs">Hadamards(n) = repeat(H, 1:n)</code></pre><pre><code class="nohighlight hljs">Hadamards (generic function with 1 method)</code></pre><p>Then in dashed box <code>B</code>, we have controlled unitaries:</p><pre><code class="language-julia hljs">ControlU(n, m, U) = chain(n+m, control(k, n+1:n+m=&gt;matblock(U^(2^(k-1)))) for k in 1:n)</code></pre><pre><code class="nohighlight hljs">ControlU (generic function with 1 method)</code></pre><p>each of them is a <code>U</code> of power <span>$2^{(k-1)}$</span>.</p><p>Since we will only apply the qft and Hadamard on first <code>n</code> qubits, we could use <code>Subroutine</code>, which creates a context of a sub-scope of the qubits.</p><pre><code class="language-julia hljs">PE(n, m, U) =
    chain(n+m, # total number of the qubits
        subroutine(Hadamards(n), 1:n), # apply H in local scope
        ControlU(n, m, U),
        subroutine(QFT(n)&#39;, 1:n))</code></pre><pre><code class="nohighlight hljs">PE (generic function with 1 method)</code></pre><p>we use the first <code>n</code> qubits as the output space to store phase <span>$ϕ$</span>, and the other <code>m</code> qubits as the input state which corresponds to an eigenvector of oracle matrix <code>U</code>.</p><p>The subroutine here uses <code>focus!</code> and <code>relax!</code> to manage a local scope of quantum circuit, and only activate the first <code>n</code> qubits while applying the block inside the subroutine context, and the scope will be <code>relax!</code>ed back, after the context. This is equivalent to manually <code>focus!</code> then <code>relax!</code></p><p>fullly activated</p><pre><code class="language-julia hljs">r = rand_state(5)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>first 3 qubits activated</p><pre><code class="language-julia hljs">focus!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 3/5
    nlevel: 2</code></pre><p>relax back to the original</p><pre><code class="language-julia hljs">relax!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>In this way, we will be able to apply small operator directly on the subset of the qubits.</p><p>Details about the algorithm can be found here: <a href="https://en.wikipedia.org/wiki/Quantum_phase_estimation_algorithm">Quantum Phase Estimation Algorithm</a></p><p>Now let&#39;s check the results of our phase estimation.</p><p>First we need to set up a unitary with known phase, we set the phase to be 0.75, which is <code>0.75 * 2^3 == 6 == 0b110</code> .</p><pre><code class="language-julia hljs">N, M = 3, 5
P = eigen(rand_unitary(1&lt;&lt;M)).vectors
θ = Int(0b110) / 1&lt;&lt;N
phases = rand(1&lt;&lt;M)
phases[0b010+1] = θ
U = P * Diagonal(exp.(2π * im * phases)) * P&#39;</code></pre><pre><code class="nohighlight hljs">32×32 Matrix{ComplexF64}:
  -0.0123604-0.104443im     -0.0496458-0.0288659im      0.0968161+0.182762im     -0.120398-0.124836im     0.0324595-0.10314im        -0.086003-0.196928im     -0.116708+0.064926im     -0.0472712-0.102144im      0.129305-0.152125im    0.0199862+0.0728608im     0.215015-0.165249im      0.249327-0.322617im     0.0173612+0.0572776im    0.0888403-0.0149111im     0.0388797+0.13746im        0.103141+0.106633im    -0.0772462-0.0955019im    -0.0146037+0.167573im       0.0844515-0.192535im       -0.272279+0.114727im     0.307795-0.0714505im     0.0151472+0.0351934im     0.101803+0.125412im     0.0882308-0.0632617im        -0.27059-0.0159346im    0.0238745+0.0745416im    -0.0871745+0.11156im       -0.13969-0.0456713im      0.0238253+0.116429im    -0.0824655+0.059759im      0.0522794-0.0713438im   -0.000594706-0.131577im
 0.000852984+0.228131im      0.0752658-0.194349im        0.187271+0.245286im     0.0140679+0.0869576im      0.14294-0.155188im        0.160835+0.167186im    -0.0512581-0.0243989im     0.0108543-0.151968im    -0.0941216-0.238582im   -0.0857454+0.130657im     0.0452911-0.0716043im   -0.0155418+0.0491557im  -0.00485979-0.048941im     -0.217665+0.013145im      -0.249331-0.0088247im      0.256044-0.202213im     -0.124611+0.221394im     -0.0174399-0.0193463im       0.111011+0.219755im     -0.00410915-0.0700125im   0.0560292+0.019551im      0.0280774+0.153032im    0.00670911+0.0522411im   -0.0319216+0.00312776im       0.093267+0.11956im      0.0734268+0.0235742im     -0.156599-0.0123105im      0.07457-0.0890395im        0.16794+0.156708im     -0.143565+0.126716im     0.00408512+0.137075im       -0.103228+0.0988407im
   -0.260823+0.00216164im    0.0828835+0.0300717im      0.0107659-0.157947im    -0.0323969+0.0114267im     -0.19799-0.173333im        0.139434-0.0674035im    -0.133776+0.00351804im   -0.0905591+0.228512im    -0.0258923+0.171325im   -0.0892905-0.068049im     0.0493588-0.0309441im      0.15312-0.0173933im     0.109474+0.183504im    -0.0121271-0.214849im      -0.141072-0.0300137im      0.187425-0.0327527im   0.00934656+0.023812im      0.0754326-0.0185643im       0.331953+0.236321im       -0.076256+0.0205501im   0.0215886-0.11422im       -0.235013+0.0590638im   -0.0903067-0.22598im      0.0425303-0.0337497im        0.107971+0.0676508im   -0.0250332-0.00308749im   -0.0380477-0.0618286im    -0.236117+0.174007im       0.0171927-0.133018im     0.0103991-0.154418im      0.0839987+0.0173419im     0.00140096-0.191876im
  -0.0809828-0.00796332im    -0.224092+0.15729im       -0.0203995+0.126974im    -0.0546225-0.207339im     -0.247457+0.0309028im       0.291919-0.0965969im   -0.0368981-0.0189193im    -0.0969441-0.0460756im   -0.0659319+0.0573978im   -0.108065+0.0459042im   -0.0690998+0.0816381im    -0.107363-0.169383im    0.00809864-0.0711096im      0.19877-0.10312im       0.0417601+0.0595513im    -0.0518698-0.21076im      -0.102315-0.0955657im    -0.0215483+0.0946359im     -0.0954268-0.0688102im       0.010984+0.0430906im   0.0726021+0.206422im      -0.049976+0.121141im      0.245169+0.0896691im    -0.117758-0.0103964im         0.20638+0.0677611im    -0.123657-0.0366607im    -0.0637986-0.375425im     0.0769703+0.0295814im    -0.00259596+0.210165im     0.0724726-0.118039im     -0.0253292+0.155525im      -0.0922755+0.0287334im
   -0.112688-0.0323945im    -0.0215264-0.103129im        0.120545-0.207578im      0.291521+0.0217089im   -0.0862528+0.0219033im       0.114544+0.0546207im    -0.116715-0.0792232im      0.240138-0.0579644im     0.201529-0.0228127im  -0.0289581-0.0619075im    -0.203129-0.16244im       -0.15566-0.133762im      0.180833-0.0145661im    -0.186083-0.0873092im    -0.0594628+0.0173984im     -0.142591+0.146232im     -0.169851-0.00323085im    0.0363826+0.123046im     -0.00639745+0.000545074im    -0.225816+0.0836051im  -0.0595169+0.0540183im      0.068563-0.178592im      0.014236-0.152683im       0.26688+0.079363im        0.0981674-0.0425572im    0.0996174+0.0838652im    0.00980898-0.130073im     0.0162535-0.265359im      -0.0453628+0.196374im      0.103152+0.0574884im       0.15784-0.0275082im      0.0795061+0.0271778im
   -0.188303-0.188244im      -0.125412+0.142663im       0.0907175+0.030714im     0.0127994-0.197336im    -0.0901955+0.153121im       -0.158221-0.227646im     -0.175604+0.0847375im   -0.00515099-0.0396364im   -0.0501398-0.12721im     0.0466969+0.0151235im   -0.0702734-0.144038im    -0.0245919+0.0659487im    0.0272652-0.0271118im    0.0511585+0.165785im     -0.0734051-0.229364im      -0.113411-0.0947769im     0.104877-0.112452im      -0.190853-0.0731525im      0.0188425+0.280308im      -0.0315724-0.0039145im  -0.0472646-0.00735613im    -0.167832-0.0219619im    -0.135468+0.155911im      0.126168+0.20211im         0.0804392+0.214939im      0.163218-0.0415428im     -0.136093+0.178101im     0.0140108-0.0404225im      -0.206248-0.0170507im   -0.0924334+0.0707229im   -0.00252612-0.00228111im     -0.209115+0.156787im
   -0.237547-0.195212im      0.0984244-0.192802im       0.0753834-0.13559im       0.252399-0.0307629im     -0.06439+0.0977164im      0.0711888+0.0162126im    -0.138957-0.11636im       0.0475481+0.203949im     -0.102434-0.0223412im  -0.0350449+0.137324im    0.00174426-0.0906283im     0.192043+0.0418785im    -0.105106-0.084332im       0.15765+0.129461im      0.0333837-0.0146855im       0.12005-0.0179435im    -0.214127-0.0685109im       0.16309+0.064856im      -0.0552536+0.0333384im       0.167204+0.0368406im  0.00442776+0.182887im       0.216442+0.0508645im     0.153656-0.00920699im  -0.0599455-0.25231im        -0.0676176-0.104636im      0.101534+0.0693228im     -0.089564+0.189509im     0.0943848+0.134032im     -0.00366311-0.0689329im   -0.0749717-0.200933im     -0.0244803-0.0940724im     -0.0025993+0.264672im
  -0.0634016+0.0976438im      -0.23275-0.136532im        0.149451+0.0847757im    0.0995608+0.0887253im   -0.0915314+0.0596173im     0.00923819+0.0700628im     0.147667+0.0609494im      -0.20812-0.333981im      0.173001+0.176395im   -0.0894652+0.220592im     0.0655828+0.0239553im    -0.234262+0.083752im   -0.00607236+0.114281im     0.0875521-0.026639im     -0.0395006-0.255111im      -0.102117+0.0365437im    -0.043971-0.259244im      0.0773404-0.161459im        0.141071+0.019556im      -0.0212737-0.029253im    0.0776889+0.00224287im   -0.0829004+0.0261072im    -0.049137+0.01634im     -0.0713517-0.204132im       -0.0411786-0.0549095im    0.0634687+0.324368im       0.164675+0.133605im     -0.020848+0.102944im       0.0153894-0.0151417im    0.0250417-0.00654396im     0.157072+0.0138417im       0.047559+0.0251337im
   0.0660169-0.173793im       -0.11062-0.154872im       0.0300287-0.00267817im   0.0401433-0.042696im      0.201146+0.101967im      0.00502495-0.109539im      0.184327-0.250985im       0.156762-0.220802im     0.0180031-0.21227im     -0.221499-0.116563im    -0.0933994+0.124721im      0.122942+0.0252894im    0.0781196-0.019856im      0.126272-0.0914103im       0.07517-0.140155im      -0.128902+0.0373634im    -0.174065+0.0959049im     -0.174928+0.0769362im       0.244948-0.0968684im     -0.0799121+0.0676926im  -0.0876142-0.174745im     -0.0445659-0.00271373im    0.108082-0.209637im      -0.18762+0.0685887im         0.12206+0.153016im     -0.177548-0.0943492im     -0.103903+0.0906291im   -0.0140088+0.232202im       0.0771221-0.103273im     0.0014383-0.00457487im    0.0238916-0.0460701im       0.013107+0.0778249im
   0.0831664+0.0078im         0.153151+0.155151im       0.0439764-0.201415im    -0.0892403-0.0893919im     0.082128+0.0270468im     -0.0385745+0.0916001im   0.00439394+0.01261im       -0.059669-0.0922741im   -0.0861133+0.0343992im   -0.419853-0.10405im       0.055834+0.0642246im   -0.0318146-0.264378im    -0.0344011-0.122123im    -0.0510779+0.139238im     -0.0243299+0.0412184im     0.0386177-0.0754753im    -0.162107+0.0691552im     -0.248364-0.306521im      -0.0746175+0.0132946im     -0.0464255-0.0178323im    0.180006-0.00409114im     0.112659+0.0703011im    0.0461205-0.0460522im    0.0896716-0.080622im       -0.0517531+0.0336577im     0.112614+0.0383314im     0.0878184-0.036199im     0.0129649-0.121435im       -0.206002-0.301755im     0.0384039-0.142822im       0.253934+0.0991333im    -0.00805172+0.0245959im
   -0.233624+0.0816755im     -0.158011+0.121369im       -0.170825+0.125919im    -0.0926988+0.105536im     0.0981555-0.177448im     -6.20963e-5-0.0319405im     0.128161+0.153063im       0.205143+0.0030571im    0.0639743-0.129796im    -0.202978+0.14018im     -0.0237824-0.292309im     0.0520682+0.135326im      0.179886+0.172293im      0.059108+0.0343831im     -0.127604+0.173386im     -0.0373064+0.115122im      0.232586-0.0676457im    -0.0420001+0.0036813im      -0.164996+0.0303728im     -0.0472774+0.115304im   -0.0700055+0.0977009im   -0.00979669+0.0319348im     0.113108-0.119597im      -0.23103-0.039492im       -0.0171243-0.0681618im    0.0598726-0.0903195im    -0.0298311+0.0197122im    0.0665644-0.137755im        0.106356-0.226303im      0.173658-0.107288im       0.153386+0.0168461im      -0.034033+0.146325im
      0.1101-0.0282027im      0.115911+0.154136im       -0.224674-0.00694012im    0.168626+0.088178im     -0.104657+0.0774698im      0.0903563+0.00774327im    0.121066+0.185331im      -0.110287+0.00477499im  -0.0657362+0.0257818im   0.0615522+0.0404084im    0.0745884-0.0631122im     0.167352-0.312369im      0.125577-0.00616471im  -0.0600147+0.0829914im     -0.243524-0.266835im      -0.198384+0.0520445im   -0.0107758+0.114748im      -0.188157+0.0681004im    -0.00119416+0.119858im       0.0418314+0.190695im    0.0287251+0.161262im      0.0731211-0.0471638im      -0.1091-0.0954656im    -0.044639-0.0608474im       -0.153499+0.086554im     -0.143734+0.162518im     0.00560022-0.110018im    -0.0959495+0.062003im        0.231222-0.0293553im   -0.0206055+0.137448im      -0.197754-0.00479024im      0.076138+0.208761im
    0.141901-0.0335068im    0.00656726+0.0965102im      -0.206576-0.00893812im  -0.0217271+0.0656955im    -0.145634+0.0916838im       0.172049-0.113359im      0.052543+0.0259542im      0.173534-0.0128574im   -0.0838468-0.071425im   -0.0728082+0.0862101im    0.0465311-0.00573285im  -0.0782497+0.160088im     -0.251296-0.114054im      0.115282-0.250437im      0.0121167+0.0668452im     0.0649416-0.0981384im   -0.0315236-0.00842636im   -0.0946437+0.13635im         0.133723+0.0608189im     -0.0714237+0.083891im   -0.0578667+0.0595506im     0.0569573+0.102815im    -0.0372835-0.0809168im     0.258028+0.112701im        -0.227857+0.209174im      0.163686+0.103545im       0.272131+0.262923im      0.178645-0.0697965im       0.201638+0.0304767im     0.122022-0.151584im     -0.0333341+0.0723521im     -0.0388747-0.126054im
   -0.123643+0.0999797im    -0.0280909-0.194235im        0.124751+0.0778405im    0.0542263+0.050731im     -0.217127+0.163475im      -0.0391066+0.0202831im    -0.178153+0.13426im      -0.0769174-0.0335838im     -0.15011-0.114201im   -0.0198986-0.147524im      0.121481+0.312397im    -0.0109979+0.0244315im    0.0910305-0.113551im    -0.0832941-0.247752im      -0.160057+0.0283787im     0.0204512+0.0754845im     0.230898-0.091525im      -0.149459+0.157072im      -0.0722234-0.0590476im     -0.0348685-0.192088im   -0.0532355-0.20461im       0.0932619-0.1558im       0.0123191+0.0338444im   -0.0348227-0.0698301im       -0.307884+0.0777956im  -0.00775238-0.137833im     -0.0259724-0.135796im     0.0451806+0.0161476im      0.0221333-0.0533987im    0.0731679-0.12957im        0.144909-0.05218im        0.0126151+0.228799im
    0.159345+0.0265338im   -0.00582014-0.00716201im     0.0407966+0.0147119im    -0.282691+0.029579im     0.0263848+0.143958im        0.103946-0.00182731im   0.0208544-0.0022483im     0.0773486+0.0888661im    -0.052532-0.231684im    0.0597906+0.00127017im  -0.0150168-0.0614252im    -0.117623-0.0191106im     0.151764-0.0443819im     0.210092+0.0667358im    -0.0510625-0.418651im       0.140575-0.059458im      0.178113+0.0847235im      0.290955+0.0580832im      0.0876015-0.0186911im      -0.308145+0.0110253im   -0.116529+0.124621im       0.202439+0.0116141im    0.0172247+0.107962im     0.0808688-0.000757804im     0.0343311-0.0840521im    0.0513584+0.00188612im    0.0442141-0.16434im     -0.0690424+0.0173395im      -0.101193-0.169386im     -0.112816-0.139793im      0.0702032-0.0097334im       0.227286-0.00877905im
   0.0738141+0.0804906im    -0.0934423-0.107046im       0.0161794-0.0222741im   -0.0546432+0.104044im      0.254921+0.00624031im     -0.217777-0.152843im    -0.0802729+0.0376782im     -0.151307+0.0951288im     0.254152-0.218791im   -0.0638205+0.0779527im    -0.128345-0.133806im      0.196165-0.133797im     -0.176593-0.206679im     0.0894689-0.129054im    -0.00877656+0.0788824im       -0.1072-0.299284im     0.0181762-0.0227659im     0.0492386-0.0109609im      0.0335003+0.157099im        0.188198-0.163973im    -0.166186+0.0487612im    -0.0420608-0.135806im     -0.075783-0.0489209im    0.0899491-0.0536292im      -0.0305875-0.0168254im   -0.0317095+0.195026im      0.0208295-0.218085im     -0.116792+0.0483145im    -0.00909029+0.0419682im     0.284132-0.0875467im     0.0355083-0.0213473im      0.0315084+0.0203027im
    0.146826-0.101251im      -0.003002-0.0360716im      -0.296065-0.156097im     -0.159851+0.0769316im    -0.176852-0.0975425im     -0.0761488-0.0504448im   -0.0575653-0.136876im     -0.0773754-0.0768484im    0.0958042-0.0143965im   -0.196304+0.0124174im    -0.141829+0.0966573im   -0.0176845-0.0544698im   -0.0892934+0.085611im     0.0271855+0.0981366im      -0.29606+0.0490382im   -0.00692925-0.0361349im    -0.177365-0.308339im       0.327249+0.0747026im     -0.0631056-0.0614655im     -0.0431941-0.196916im   -0.0313643-0.165245im      0.0718378+0.0717278im    -0.120638-0.0554978im    -0.106833+0.124997im       -0.0365387+0.0615034im     0.104517-0.111205im     -0.0589257+0.0120393im    -0.144103-0.151708im       0.0868579-0.00537547im   -0.143616+0.10091im      -0.0903953+0.0923567im     -0.0322441+0.199038im
   0.0895744-0.215583im     -0.0126342-0.091777im      -0.0395735+0.0689827im    -0.153922-0.0887327im    0.0909318+0.132459im       0.0673535+0.244555im    -0.0452089+0.0155034im      -0.26453-0.114107im      0.132626+0.0726246im     0.11898-0.143962im     -0.191336+0.00606121im  -0.0531466-0.128944im      0.156996+0.153338im     0.0735597-0.0337173im    -0.0844779+0.233208im     -0.0330811-0.12082im      0.0328339+0.0246941im     0.0507967+0.000154441im    0.0852841+0.241314im      -0.0409992+0.101814im   -0.0747006-0.00282614im   -0.0293071+0.0178412im   -0.0263681-0.0364676im    0.0724355-0.0492322im      -0.0798982-0.0867538im     -0.16881+0.00430051im   -0.0476801+0.083145im      0.364456-0.148644im       0.0934073-0.102182im     -0.141931-0.203104im     -0.0164834-0.274134im       -0.130237-0.00792276im
    0.058754+0.067527im      0.0945408+0.11902im       -0.0930989+0.215084im     0.0140599+0.0953141im   -0.0752363+0.190757im         0.29372-0.0173167im    0.0302734-0.104103im      0.0065902-0.0219497im    -0.234938-0.131566im   0.00754953-0.201141im     0.0245431-0.158815im     0.0950186-0.0865267im    -0.103905+0.11825im     0.00363625-0.0581976im    -0.0271615-0.0379571im     -0.075395-0.116848im      -0.10149+0.078667im      0.0780971+0.0340794im      -0.101963-0.116271im       0.0314635-0.0805827im  -0.0724525-0.232199im      -0.396827-0.0193455im   -0.0479836-0.00317359im  -0.0614569-0.167215im        0.0349758-0.249916im      0.110199+0.118438im     -0.0164579+0.161279im    -0.0317425-0.159413im       -0.235693+0.0389902im     0.132882+0.0396496im     0.0478078-0.12774im        0.0644051+0.104404im
    0.169367-0.18669im        -0.14125+0.162581im       0.0456482+0.0926605im    0.0792661-0.0559864im     0.210052+0.0075946im       0.105377+0.0366705im   -0.0108612+0.191223im       0.175145+0.0124203im    0.0796985+0.0982471im    0.113293+0.0652029im    0.0525112+0.102748im     -0.131704-0.0911616im   -0.0742156-0.00952966im   -0.130321-0.0779503im     -0.153556+0.0455323im      0.261884+0.029462im     0.0171001+0.0198327im     0.0718631-0.01553im        0.0929581+0.0033462im     -0.0412154-0.0427342im   0.0889271-0.0586263im     0.0622287-0.0951334im    0.0985765-0.109543im    -0.0287508+0.154736im        0.0799517-0.176419im    -0.0298807+0.0277149im      0.171896+0.0635505im    -0.258715+0.128575im       -0.162657+0.0155125im     0.132155-0.158826im       -0.12878-0.0665791im      -0.317853+0.336652im
   0.0169949+0.0383203im     0.0451883-0.199545im      0.00847798-0.135942im      0.113568-0.0863226im    -0.101893-0.11452im       -0.0740729-0.1571im        0.313003+0.0482596im    0.00534033+0.0354233im   -0.0252702-0.0388302im   -0.106986+0.193095im     0.0678832+0.0528587im    0.0996474-0.0277262im     0.103965-0.0245228im    0.0408866-0.176638im      -0.086771-0.0340439im    -0.0591714+0.0248688im   -0.0212983+0.0980326im     0.0373815-0.137439im       -0.127293+0.102654im      -0.0616484+0.0821642im    0.012117-0.315375im      -0.061285-0.120839im      0.106177+0.368839im      0.125469+0.0507417im        0.166188-0.166865im    -0.0546134+0.0372071im     0.0194459+0.0196197im    0.0629132-0.191815im       0.0369865-0.0493678im   -0.0322652-0.267553im       -0.31877+0.0719554im      -0.018626+0.00278041im
   0.0582134-0.0366232im     0.0683246-0.000159349im    0.0881802-0.0845068im    0.0691415-0.11429im       -0.02894+0.0537591im       0.104568+0.139499im     0.0641046+0.270501im      -0.113821-0.204398im     0.0612135-0.124488im      -0.1934-0.0249399im     0.121383-0.147888im    -0.0515209+0.0191094im    0.0787911+0.190389im     0.0198335-0.245044im      0.0332138+0.00555479im   -0.0816147-0.080615im    -0.0735026-0.00191952im   0.00628976+0.193241im       0.0104294-0.0409322im       0.303113-0.110557im    -0.133235+0.203354im      0.0826069-0.077782im     0.0700826+0.0179956im    0.0970062+0.162887im       -0.0752852-0.216025im      0.175179-0.229671im      -0.139299+0.0689595im     -0.15382+0.12187im       -0.0966162-0.163482im    -0.0926922+0.104597im      -0.129893+0.0969946im      -0.021869-0.18708im
   0.0810824+0.109029im     -0.0104573-0.0776188im      0.0499189+0.123266im     -0.178023-0.248251im   -0.00451988-0.155602im        -0.14432+0.0337977im    0.0944292-0.149413im       0.144535+0.019709im     -0.178294+0.186746im    0.0928582-0.00637246im    0.284076+0.0271598im   -0.0440929+0.0741595im     0.338547-0.0282082im     0.205179-0.0223577im    -0.0625711+0.051455im      -0.144632-0.0999933im    -0.179655+0.00407097im   0.00281383-0.0561209im     -0.0349586-0.0686947im    -0.00807654-0.11512im     -0.113536+0.121575im      0.0699307-0.0814672im    -0.141978-0.234301im       0.15608-0.159359im       -0.0111875+0.110503im      0.193184+0.0827513im     -0.128171-0.0092652im    -0.104192-0.0593449im      0.0143366+0.0346739im      0.14629-0.0224544im     -0.145475-0.161264im       -0.160168+0.0610747im
   -0.145722+0.222267im      0.0840375-0.0179988im      0.0623663-0.0207013im     0.100685-0.181186im     0.0213625+0.159592im        0.126772+0.223375im     0.0810621-0.297321im     -0.0823931+0.0753248im     0.101021-0.175805im   -0.0403991-0.0327609im      0.10813-0.118032im    -0.0294728-0.0897778im    -0.238092+0.102133im      0.113661-0.0711406im    -0.0909445+0.0625744im     -0.161466+0.00526984im    0.335443-0.0566542im     0.0444607-0.239206im      -0.0937652-0.149483im      -0.0246493+0.0860139im   0.0676083+0.0379388im      0.114203+0.0620303im    -0.115499-0.0695819im     0.109181+0.137726im        0.0378908+0.126378im     -0.162308-0.0808615im     0.0106856+0.115692im     -0.258397+0.000270469im    0.0874796+0.109333im    -0.0770212-0.120044im     -0.0234683-0.0526605im     -0.0982083+0.0639762im
  -0.0548067+0.174135im     -0.0269781+0.0257905im       -0.16392-0.00862511im   0.0448723+0.175847im      0.320583+0.0560095im      0.0937527+0.127144im     -0.121386-0.158384im     -0.0956094+0.0400728im    0.0474804+0.248204im    0.0384146+0.100844im    -0.0739458+0.150007im     0.0682967-0.0849427im     0.230887+0.0488153im   -0.0289068+0.0646476im       0.12623-0.133288im     -0.0168066-0.238859im     0.0345414-0.0561943im   -0.00908452+0.119705im      -0.0124333-0.151011im     -0.00152365+0.165661im    0.0813081-0.0521922im     -0.144439-0.158379im     0.0919742+0.14668im       0.131538+0.171663im        -0.118021+0.0777189im     0.270713-0.0873288im     -0.173043+0.137134im    -0.0422946+0.0549414im      0.0978328-0.0087873im    0.0776901-0.18951im       0.0233927+0.20298im        0.0111937+0.0881309im
   0.0520495+0.0890953im     0.0268361+0.128027im        0.319911+0.0392434im   -0.0257723-0.055007im     0.0125578-0.00156487im      0.078126+0.025895im    -0.0238259-0.0667773im      0.158849+0.11204im      0.0662799+0.151386im    -0.105871+0.279447im     -0.096053+0.0137657im   -0.0306349-0.0660403im    -0.256297+0.0623863im     0.160711+0.00321564im    -0.015426-0.0843067im     0.0519419+0.131665im     -0.089983+0.00717331im    0.0376307-0.0502022im       0.137332-0.0776825im     0.00656021+0.114235im     -0.16068-0.059562im      -0.211125-0.0900054im    -0.142788+0.0351493im     0.120263-0.0715886im       -0.309079-0.0549965im    -0.122099-0.241205im      -0.129553-0.211378im      0.169195-0.0804807im       0.052987-0.20476im      0.0574299+0.201906im     -0.0790712+0.025398im       -0.100003+0.116473im
    0.122432+0.0516581im      0.152974+0.0436217im     -0.0152769+0.0115826im    -0.185754-0.0572899im    -0.167426-0.0368984im      0.0125442-0.00734697im   -0.135096-0.152702im      0.0196934-0.0640995im    0.0806905-0.110524im     -0.13486+0.0453954im     0.216919+0.0915716im    0.0591669-0.0632373im    0.0239516+0.10314im      -0.213133+0.0602519im     0.0684382-0.00162493im    -0.157956+0.116594im      0.126834-0.0193195im      0.250058-0.140933im        0.275887+0.194135im        0.181841+0.20321im     0.0100115+0.0416454im     0.0491438-0.165093im      0.257761+0.0718292im    -0.116814+0.0637849im    -0.000714864+0.113151im      0.150861-0.061475im      0.0639846+0.0101563im     0.187654+0.0730042im      -0.126233+0.143858im      0.258808+0.0447382im    -0.0632941-0.156183im        0.070599+0.0830081im
   0.0487622-0.104038im      -0.297222+0.201035im       0.0770565+0.149156im    0.00203536+0.0349424im   -0.0886931+0.000710766im   -0.0361412-0.0722145im     0.187926-0.131312im       0.013127+0.175119im       0.13079+0.0346187im   -0.156169-0.0348749im   -0.0681761+0.0886069im    0.0178088-0.147261im     0.0366738+0.165049im     -0.141584-0.0358481im    -0.0573584-0.126647im       0.260906-0.0846079im    0.0654751-0.0291527im     -0.158985-0.0324221im     -0.0237367+0.0358805im       0.187237-0.0630815im  -0.0369114-0.0144129im      0.270967-0.0811529im    -0.134058+0.00366946im    0.128235-0.256852im        0.0901592-0.0180427im  -0.00579525-0.203459im      -0.132653+0.23694im      0.0393435-0.0792105im      0.0293431+0.213597im     0.0520257-0.0323449im   -0.00678008-0.0392557im       0.255843-0.0700066im
  -0.0144974+0.263496im     -0.0468165-0.022218im      -0.0686588+0.164721im    0.00719254+0.0739743im    -0.145573-0.161781im       -0.140459-0.18004im     -0.0819129-0.098214im      -0.137686+0.0309581im    0.0437959+0.101582im   -0.0969739-0.271316im     -0.127733-0.187531im     -0.190065+0.159994im     -0.151474+0.127662im    -0.0660992+0.129257im      -0.133381-0.0624569im     0.0205887+0.0166213im    -0.207617+0.199948im     -0.0993001+0.0516309im      0.0965794-0.138915im      -0.0202278-0.0191429im   -0.026007+0.181176im      0.0468121-0.217861im      0.229406+0.129642im      0.068515+0.104276im          -0.1345+0.0422749im    -0.218366+0.0663785im   -0.00920677+0.0736607im   -0.0679041+0.0220202im     -0.0677144-0.109189im    -0.0450391-0.197275im     -0.0949304-0.131771im      -0.0370041+0.0491218im
   -0.166434-0.021612im     -0.0638736-0.0173882im       0.188025+0.0821935im    -0.339477+0.0109155im   -0.0415161+0.0256328im       0.290211+0.0921908im    0.0594141+0.159219im       0.127632-0.0491479im    0.0397006+0.0316102im   0.0963968+0.064659im     -0.165506+0.130582im      0.255233+0.0146652im    -0.112693+0.00381024im   -0.114141+0.264546im      -0.190817+0.021016im      -0.235549+0.133018im     -0.129585+0.0464207im   -0.00624534+0.0217393im      -0.102211-0.0526253im       0.127314+0.0135324im   -0.182479-0.160946im       0.172277-0.0722493im    -0.013288-0.0038408im    0.0298017+0.060248im        -0.048113+0.114391im     0.0177978+0.16609im      -0.0194787+0.0404341im   -0.0952974+0.080648im       -0.089843+0.0367464im   -0.0104094-0.210437im     0.00161268+0.100913im      -0.0434567-0.247004im
   -0.206891+0.00551629im   -0.0216187-0.0266781im    -0.00903543+0.00410711im  -0.0833495+0.155046im    -0.0404068+0.0711133im      0.0858428-0.0325869im     0.019906-0.125366im      0.0652303-0.132051im      0.136853+0.0242314im   0.0621334+0.113732im    -0.0334755+0.0826993im   -0.0243666-0.0785833im   -0.0950786-0.0567012im    -0.145326+0.0376987im    -0.0420658+0.00708109im  -0.00218442-0.0864041im    0.0939509-0.0273359im     -0.116743-0.00916674im     -0.153863+0.032071im       -0.135177-0.231748im     0.121806+0.0293436im    -0.0743033+0.201561im      0.268517-0.0759202im     0.236124-0.0310056im       0.0785168+0.0091136im     0.132656-0.0480181im    -0.0251201-0.0653631im  -0.00777355+0.125838im       0.0479828-0.298971im     0.0843698+0.165161im      -0.365718-0.367144im        0.121735-0.065254im
  -0.0167577+0.00572085im    -0.250963+0.302769im      -0.0980877-0.107436im      0.164925+0.129812im     0.0928308+0.047897im       0.0158297+0.0939981im    -0.106833-0.0849687im      0.143865-0.16472im      -0.111118+0.0609137im  -0.0725576-0.0189982im    0.0899812-0.210727im    -0.0178144+0.085822im      0.145951-0.0080745im     0.139727+0.0428837im     0.0189191+0.0896431im     -0.101217+0.0952542im    0.0469494+0.161586im       0.183077+0.00965932im      0.146102+0.0854451im       0.215845-0.214209im      0.11591-0.321956im       0.167086+0.175919im     0.0256352+0.187325im       0.17883-0.0511093im       -0.146252+0.105871im     -0.130146+0.0777039im    -0.0943396-0.176207im   -0.00710014+0.0463287im     -0.0310533+0.0463019im   -0.0537321-0.047006im     -0.0300313-0.0670286im      0.0119731-0.0156399im</code></pre><p>and then generate the state <span>$ψ$</span></p><pre><code class="language-julia hljs">psi = P[:, 3]</code></pre><pre><code class="nohighlight hljs">32-element Vector{ComplexF64}:
    0.3483972729891905 + 0.0im
  -0.07425544729450907 - 0.11445414236279736im
  -0.05682537971374901 + 0.0030305565231832066im
  -0.14738879359698928 + 0.058459877037154384im
   0.12501566174948067 - 0.09976081264137938im
  0.028891066721126377 - 0.13163952446770844im
   -0.0895719190128098 - 0.20201620957155092im
  -0.06670384530039389 - 0.09603470633058152im
   0.10106771677289275 - 0.15919584834768644im
   0.16486530676682004 + 0.006290583996881453im
   0.18230302998912165 - 0.14239999614619245im
    0.2777471855150743 + 0.0678861135571313im
  -0.03203977661064603 - 0.1922514629097348im
  -0.17696928134334927 - 0.009491451199175716im
  -0.06437738631279138 + 0.01578461370906082im
  -0.18551291130040526 + 0.19175115543433577im
 -0.010387521777830425 + 0.06976612432829929im
   0.15851413208352402 + 0.19275039923892348im
   0.09447710117672922 + 0.11060533034233982im
 -0.043410435701720616 + 0.2256368953569485im
   0.02059758895175068 - 0.08917646028610114im
  -0.11946733139638692 + 0.10311880183258433im
   0.06696613012091267 + 0.1561713850186135im
   0.09102399991479412 - 0.051028819021783835im
  -0.04529660934646378 + 0.1617148314086653im
  -0.05173219472358058 + 0.10917198554877575im
   -0.1985540932237075 + 0.18909087435061925im
    0.1020256861075841 + 0.02025442234205408im
  -0.08698531761761397 - 0.10246961013179753im
   0.10740178460806038 + 0.07867843077455637im
 -0.050410801044664576 + 0.010561924914567618im
 -0.011173223435087977 - 0.027169333873757463im</code></pre><p>In the phase estimation process, we will feed the state to circuit and measure the first <code>n</code> qubits processed by iQFT.</p><pre><code class="language-julia hljs">r = join(ArrayReg(psi), zero_state(N))
r |&gt; PE(N, M, U)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 8/8
    nlevel: 2</code></pre><p>Since our phase can be represented by 3 qubits precisely, we only need to measure once</p><pre><code class="language-julia hljs">results = measure(r, 1:N; nshots=1)</code></pre><pre><code class="nohighlight hljs">1-element Vector{BitBasis.BitStr64{3}}:
 011 ₍₂₎</code></pre><p>Recall that our QFT&#39;s bit numbering is reversed, let&#39;s reverse it back</p><pre><code class="language-julia hljs">using BitBasis
estimated_phase = bfloat(results[]; nbits=N)</code></pre><pre><code class="nohighlight hljs">0.75</code></pre><p>the phase is exactly <code>0.75</code>!</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../1.prepare-ghz-state/index.html">« Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a><a class="docs-footer-nextpage" href="../3.grover-search/index.html">Grover Search »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.16 on <span class="colophon-date" title="Thursday 28 April 2022 04:41">Thursday 28 April 2022</span>. Using Julia version 1.7.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
