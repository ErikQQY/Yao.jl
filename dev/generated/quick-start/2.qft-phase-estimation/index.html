<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quantum Fourier Transformation and Phase Estimation · Documentation | Yao</title><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/indigo.css" rel="stylesheet" type="text/css"/><link href="https://yaoquantum.org/assets/favicon-light.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../index.html"><img src="../../../assets/logo.png" alt="Documentation | Yao logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../index.html">Documentation | Yao</a></span></div><form class="docs-search" action="../../../search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../index.html">Home</a></li><li><span class="tocitem">Quick Start</span><ul><li><a class="tocitem" href="../1.prepare-ghz-state/index.html">Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a></li><li class="is-active"><a class="tocitem" href="index.html">Quantum Fourier Transformation and Phase Estimation</a><ul class="internal"><li><a class="tocitem" href="#Quantum-Fourier-Transformation"><span>Quantum Fourier Transformation</span></a></li><li><a class="tocitem" href="#Wrap-QFT-to-an-external-block"><span>Wrap QFT to an external block</span></a></li><li><a class="tocitem" href="#Phase-Estimation"><span>Phase Estimation</span></a></li></ul></li><li><a class="tocitem" href="../3.grover-search/index.html">Grover Search</a></li><li><a class="tocitem" href="../4.shor-algorithm/index.html">Shor&#39;s Algorithm</a></li><li><a class="tocitem" href="../5.shor-9-code/index.html">Shor&#39;s 9 qubit code</a></li><li><a class="tocitem" href="../6.quantum-circuit-born-machine/index.html">Quantum Circuit Born Machine</a></li><li><a class="tocitem" href="../7.variation-quantum-eigen-solver/index.html">Variational Quantum Eigen Solver</a></li></ul></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../../man/array_registers.html">Array Registers</a></li><li><a class="tocitem" href="../../../man/symbolic.html">Symbolic Computation</a></li><li><a class="tocitem" href="../../../man/blocks.html">Blocks</a></li><li><a class="tocitem" href="../../../man/automatic_differentiation.html">Automatic Differentiation</a></li><li><a class="tocitem" href="../../../man/simplification.html">Simplification</a></li><li><a class="tocitem" href="../../../man/base.html">Base</a></li><li><a class="tocitem" href="../../../man/registers.html">Abstract Registers</a></li><li><a class="tocitem" href="../../../man/bitbasis.html">BitBasis</a></li><li><a class="tocitem" href="../../../man/extending_blocks.html">Extending Blocks</a></li></ul></li><li><a class="tocitem" href="../../../benchmarks.html">Benchmark</a></li><li><a class="tocitem" href="../../../dev/index.html">Developer Notes</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Quick Start</a></li><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/QuantumBFS/Yao.jl/blob/master/docs/src/quick-start/2.qft-phase-estimation/main.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><p><a href="https://mybinder.org/v2/gh/QuantumBFS/Yao.jl/gh-pages?filepath=dev/generated/quick-start/2.qft-phase-estimation/main.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a> <a href="https://nbviewer.jupyter.org/github/QuantumBFS/Yao.jl/blob/gh-pages/dev/generated/quick-start/2.qft-phase-estimation/main.ipynb"><img src="https://img.shields.io/badge/show-nbviewer-579ACA.svg" alt/></a> <a href="https://minhaskamal.github.io/DownGit/#/home?url=https://github.com/QuantumBFS/tutorials/tree/gh-pages/dev/generated/quick-start/2.qft-phase-estimation"><img src="https://img.shields.io/badge/download-project-orange" alt/></a></p><h1 id="example-qft"><a class="docs-heading-anchor" href="#example-qft">Quantum Fourier Transformation and Phase Estimation</a><a id="example-qft-1"></a><a class="docs-heading-anchor-permalink" href="#example-qft" title="Permalink"></a></h1><p>Let&#39;s use Yao first</p><pre><code class="language-julia hljs">using Yao</code></pre><h2 id="Quantum-Fourier-Transformation"><a class="docs-heading-anchor" href="#Quantum-Fourier-Transformation">Quantum Fourier Transformation</a><a id="Quantum-Fourier-Transformation-1"></a><a class="docs-heading-anchor-permalink" href="#Quantum-Fourier-Transformation" title="Permalink"></a></h2><p>The Quantum Fourier Transformation (QFT) circuit is to repeat two kinds of blocks repeatly:</p><p><img src="assets/qft.png" alt="qft-circuit"/></p><p>The basic building block control phase shift gate is defined as</p><p class="math-container">\[R(k)=\begin{bmatrix}
1 &amp; 0\\
0 &amp; \exp\left(\frac{2\pi i}{2^k}\right)
\end{bmatrix}\]</p><p>Let&#39;s define block <code>A</code> and block <code>B</code>, block <code>A</code> is actually a control block.</p><pre><code class="language-julia hljs">A(i, j) = control(i, j=&gt;shift(2π/(1&lt;&lt;(i-j+1))))</code></pre><pre><code class="nohighlight hljs">A (generic function with 1 method)</code></pre><p>Once you construct the blockl you can inspect its matrix using <code>mat</code> function. Let&#39;s construct the circuit in dash box A, and see the matrix of <span>$R_4$</span> gate.</p><pre><code class="language-julia hljs">R4 = A(4, 1)</code></pre><pre><code class="nohighlight hljs">(n -&gt; control(n, 4, 1 =&gt; shift(0.39269908169872414)))</code></pre><p>If you have read about <a href="generated/quick-start/2.qft-phase-estimation/@ref example-ghz">preparing GHZ state</a>, you probably know that in Yao, we could just leave the number of qubits, and it will be evaluated when possible.</p><pre><code class="language-julia hljs">R4(5)</code></pre><pre><code class="nohighlight hljs">nqubits: 5
control(4)
└─ (1,) shift(0.39269908169872414)</code></pre><p>its matrix will be</p><pre><code class="language-julia hljs">mat(R4(5))</code></pre><pre><code class="nohighlight hljs">32×32 LinearAlgebra.Diagonal{ComplexF64, Vector{ComplexF64}}:
 1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im</code></pre><p>Then we repeat this control block over and over on different qubits, and put a Hadamard gate to <code>i</code>th qubit to construct <code>i</code>-th <code>B</code> block.</p><pre><code class="language-julia hljs">B(n, k) = chain(n, j==k ? put(k=&gt;H) : A(j, k) for j in k:n)</code></pre><pre><code class="nohighlight hljs">B (generic function with 1 method)</code></pre><p>We need to input the total number of qubits <code>n</code> here because we have to iterate through from <code>k</code>-th location to the last.</p><p>Now, let&#39;s construct the circuit by chaining all the <code>B</code> blocks together</p><pre><code class="language-julia hljs">qft(n) = chain(B(n, k) for k in 1:n)
qft(4)</code></pre><pre><code class="nohighlight hljs">nqubits: 4
chain
├─ chain
│  ├─ put on (1)
│  │  └─ H
│  ├─ control(2)
│  │  └─ (1,) shift(1.5707963267948966)
│  ├─ control(3)
│  │  └─ (1,) shift(0.7853981633974483)
│  └─ control(4)
│     └─ (1,) shift(0.39269908169872414)
├─ chain
│  ├─ put on (2)
│  │  └─ H
│  ├─ control(3)
│  │  └─ (2,) shift(1.5707963267948966)
│  └─ control(4)
│     └─ (2,) shift(0.7853981633974483)
├─ chain
│  ├─ put on (3)
│  │  └─ H
│  └─ control(4)
│     └─ (3,) shift(1.5707963267948966)
└─ chain
   └─ put on (4)
      └─ H
</code></pre><h2 id="Wrap-QFT-to-an-external-block"><a class="docs-heading-anchor" href="#Wrap-QFT-to-an-external-block">Wrap QFT to an external block</a><a id="Wrap-QFT-to-an-external-block-1"></a><a class="docs-heading-anchor-permalink" href="#Wrap-QFT-to-an-external-block" title="Permalink"></a></h2><p>In most cases, <code>function</code>s are enough to wrap quantum circuits, like <code>A</code> and <code>B</code> we defined above, but sometimes, we need to dispatch specialized methods on certain kinds of quantum circuit, or we want to define an external block to export, thus, it&#39;s useful to be able to wrap circuit to custom blocks.</p><p>First, we define a new type as subtype of <code>PrimitiveBlock</code> since we are not going to use the subblocks of <code>QFT</code>, if you need to use its subblocks, it&#39;d be better to define it under <code>CompositeBlock</code>.</p><pre><code class="language-julia hljs">struct QFT &lt;: PrimitiveBlock{2}
    n::Int
end

YaoBlocks.nqudits(q::QFT) = q.n</code></pre><p>Now, let&#39;s define its circuit</p><pre><code class="language-julia hljs">circuit(q::QFT) = qft(q.n)</code></pre><pre><code class="nohighlight hljs">circuit (generic function with 1 method)</code></pre><p>And forward <code>mat</code> to its circuit&#39;s matrix</p><pre><code class="language-julia hljs">YaoBlocks.mat(::Type{T}, x::QFT) where T = mat(T, circuit(x))</code></pre><p>You may notice, it is a little ugly to print <code>QFT</code> at the moment, this is because we print the type summary by default, you can define your own printing by overloading <code>print_block</code></p><pre><code class="language-julia hljs">YaoBlocks.print_block(io::IO, x::QFT) = print(io, &quot;QFT($(x.n))&quot;)</code></pre><p>Since it is possible to use FFT to simulate the results of QFT (like cheating), we could define our custom <code>apply!</code> method:</p><pre><code class="language-julia hljs">using FFTW, LinearAlgebra

function YaoBlocks.apply!(r::ArrayReg, x::QFT)
    α = sqrt(length(statevec(r)))
    invorder!(r)
    lmul!(α, ifft!(statevec(r)))
    return r
end</code></pre><p>Now let&#39;s check if our <code>apply!</code> method is correct:</p><pre><code class="language-julia hljs">r = rand_state(5)
r1 = r |&gt; copy |&gt; QFT(5)
r2 = r |&gt; copy |&gt; circuit(QFT(5))
r1 ≈ r2</code></pre><pre><code class="nohighlight hljs">true</code></pre><p>We can get iQFT (inverse QFT) directly by calling <code>adjoint</code></p><pre><code class="language-julia hljs">QFT(5)&#39;</code></pre><pre><code class="nohighlight hljs"> [†]QFT(5)</code></pre><p>QFT and iQFT are different from FFT and IFFT in three ways,</p><ol><li>they are different by a factor of <span>$\sqrt{2^n}$</span> with <span>$n$</span> the number of qubits.</li><li>the <a href="https://quantumbfs.github.io/BitBasis.jl/stable/tutorial/#Conventions-1">bit numbering</a> will exchange after applying QFT or iQFT.</li><li>due to the convention, QFT is more related to IFFT rather than FFT.</li></ol><h2 id="Phase-Estimation"><a class="docs-heading-anchor" href="#Phase-Estimation">Phase Estimation</a><a id="Phase-Estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Phase-Estimation" title="Permalink"></a></h2><p>Since we have QFT and iQFT blocks we can then use them to realize phase estimation circuit, what we want to realize is the following circuit:</p><p><img src="assets/phaseest.png" alt="phase estimation"/></p><p>First we call Hadamard gates repeatly on first <code>n</code> qubits.</p><pre><code class="language-julia hljs">Hadamards(n) = repeat(H, 1:n)</code></pre><pre><code class="nohighlight hljs">Hadamards (generic function with 1 method)</code></pre><p>Then in dashed box <code>B</code>, we have controlled unitaries:</p><pre><code class="language-julia hljs">ControlU(n, m, U) = chain(n+m, control(k, n+1:n+m=&gt;matblock(U^(2^(k-1)))) for k in 1:n)</code></pre><pre><code class="nohighlight hljs">ControlU (generic function with 1 method)</code></pre><p>each of them is a <code>U</code> of power <span>$2^{(k-1)}$</span>.</p><p>Since we will only apply the qft and Hadamard on first <code>n</code> qubits, we could use <code>Subroutine</code>, which creates a context of a sub-scope of the qubits.</p><pre><code class="language-julia hljs">PE(n, m, U) =
    chain(n+m, # total number of the qubits
        subroutine(Hadamards(n), 1:n), # apply H in local scope
        ControlU(n, m, U),
        subroutine(QFT(n)&#39;, 1:n))</code></pre><pre><code class="nohighlight hljs">PE (generic function with 1 method)</code></pre><p>we use the first <code>n</code> qubits as the output space to store phase <span>$ϕ$</span>, and the other <code>m</code> qubits as the input state which corresponds to an eigenvector of oracle matrix <code>U</code>.</p><p>The subroutine here uses <code>focus!</code> and <code>relax!</code> to manage a local scope of quantum circuit, and only activate the first <code>n</code> qubits while applying the block inside the subroutine context, and the scope will be <code>relax!</code>ed back, after the context. This is equivalent to manually <code>focus!</code> then <code>relax!</code></p><p>fullly activated</p><pre><code class="language-julia hljs">r = rand_state(5)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qudits: 5/5
    nlevel: 2</code></pre><p>first 3 qubits activated</p><pre><code class="language-julia hljs">focus!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qudits: 3/5
    nlevel: 2</code></pre><p>relax back to the original</p><pre><code class="language-julia hljs">relax!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qudits: 5/5
    nlevel: 2</code></pre><p>In this way, we will be able to apply small operator directly on the subset of the qubits.</p><p>Details about the algorithm can be found here: <a href="https://en.wikipedia.org/wiki/Quantum_phase_estimation_algorithm">Quantum Phase Estimation Algorithm</a></p><p>Now let&#39;s check the results of our phase estimation.</p><p>First we need to set up a unitary with known phase, we set the phase to be 0.75, which is <code>0.75 * 2^3 == 6 == 0b110</code> .</p><pre><code class="language-julia hljs">N, M = 3, 5
P = eigen(rand_unitary(1&lt;&lt;M)).vectors
θ = Int(0b110) / 1&lt;&lt;N
phases = rand(1&lt;&lt;M)
phases[0b010+1] = θ
U = P * Diagonal(exp.(2π * im * phases)) * P&#39;</code></pre><pre><code class="nohighlight hljs">32×32 Matrix{ComplexF64}:
  -0.111504-0.166488im     -0.324897+0.0653573im    -0.0311954+0.0101961im    0.000786727+0.164475im   -0.0767742+0.143712im      -0.221056+0.262541im    0.00305902+0.0128361im     0.133759+0.0530121im     0.0932802-0.0641054im     0.0525209+0.111954im     -0.0572396+0.0278113im    0.0466804+0.0588895im    -0.0641506+0.0104781im    -0.0425126-0.0657542im   -0.0855011+0.0814467im    0.0731825+0.0685829im   -0.0810164-0.156259im     -0.0465512+0.0600413im   -0.0679323-0.122639im     0.0135246+0.0756999im    0.0765496+0.13108im         -0.393717-0.188201im      0.0994293-0.211063im      -0.0807628-0.104955im     -0.0431063+0.158179im      -0.144922-0.155347im      0.0451072-0.16833im    -0.0863079-0.205191im     0.0947647-0.00959424im   -0.147493-0.133851im       0.0692548+0.0466518im   -0.00803992-0.17038im
  0.0461403+0.0800261im     0.107769-0.0201792im     -0.072523-0.207311im       -0.150964-0.196053im   0.00473623+0.0850268im     -0.171428-0.0290701im      0.11271-0.099811im     -0.379197-0.22549im       -0.203111+0.0366448im    -0.0536555-0.0457255im      0.107361+0.1153im       -0.138378+0.0525219im     0.0367072-0.0328229im    -0.0625169-0.150406im     -0.158858+0.142709im    -0.0499559+0.103023im     -0.225894-0.185767im      0.0094458+0.0739056im   0.00157821-0.0518222im     0.111213-0.0760892im    0.0194884+0.152143im       -0.0318165+0.0995471im      0.069037+0.0888809im      0.0219689+0.0140364im      0.148577+0.100157im      -0.040898-0.108936im       0.168473+0.0193227im   -0.264396+0.139201im      0.138173+0.0506092im   -0.0894079-0.0268253im      -0.124316+0.244251im        0.01941+0.0629608im
  -0.100281+0.249106im    -0.0470057-0.308891im     -0.0924385+0.126593im       0.0292189-0.02794im      0.282474+0.110169im     -0.0746534+0.047218im     0.0414586+0.127261im    -0.0205675+0.105546im        0.11311-0.0801885im    -0.0717706-0.169853im      0.0213561+0.146384im    -0.0140735+0.0238136im     0.0864192-0.330495im      0.0618784+0.261094im      0.175513-0.118278im    -0.0210075-0.257497im     -0.126912-0.265925im     -0.0343556-0.0669161im   -0.0762935+0.00596681im   0.0236026+0.0165197im    -0.119833+0.146515im       -0.0554138+0.0170587im     0.0686631+0.0730981im      -0.157349+0.0408002im     -0.139715-0.105741im      0.0709779+0.0693297im     0.0901303-0.0953349im  -0.0608554-0.0600671im    0.0505169+0.0512629im     -0.12202+0.187091im      -0.0193733-0.027661im     -0.0510434+0.00447141im
  -0.161531-0.219913im     -0.187999-0.148963im     -0.0359108+0.165643im       -0.026075-0.147569im    0.0599231-0.242656im       0.145073-0.141966im    -0.0619001+0.00342752im  -0.0524936-0.18465im       0.0335091-0.132622im      -0.125711+0.0548487im    -0.0937828-0.00109287im   -0.124525-0.00207827im   -0.0582719-0.0916772im    -0.0244649+0.0679542im   -0.0505503+0.120681im    -0.0319952+0.287218im     0.0730577+0.0378157im   -0.00917523-0.105704im     -0.163271-0.0823244im     0.114114+0.0126528im    0.0225538-0.171308im        0.0472125+0.0664936im      0.110508+0.0664826im       -0.28668-0.264268im     -0.0899265+0.103282im     -0.0713743+0.197023im     -0.0185141-0.0235506im   0.0584464-0.0424125im   -0.0077236-0.0751678im    -0.165889+0.00346845im     0.0831764+0.177702im     -0.0713823+0.278503im
  -0.109186+0.207719im    -0.0348522+0.095873im       -0.05212-0.0189101im       0.203236-0.0628944im   -0.162233-0.208007im       0.127479+0.118025im     -0.240463+0.0712194im    -0.186897+0.0815861im     0.0811291+0.00392475im    -0.175894-0.148137im      0.0254884+0.0818306im     0.105318-0.0674571im     -0.138752+0.0262896im     -0.063433+0.0461144im    -0.203035+0.0869231im     0.152147-0.0757335im     0.091119-0.066167im     -0.0747721-0.0180437im    0.0534861-0.00740639im  -0.0252669+0.105873im      0.135271-0.12043im         -0.142883-0.0810003im     0.0171269+0.313278im       0.0992195+0.0692679im    -0.0420958-0.0534641im     0.0601655-0.227642im     -0.0250023+0.0200766im   0.0757478-0.096073im     -0.139668-0.0729553im    0.0138842+0.18833im      -0.00562456+0.362314im     -0.0462948-0.139622im
   0.125234-0.213075im      0.050246+0.15008im      -0.0472195+0.0658531im      -0.100521-0.0792113im  -0.0520752-0.105995im       0.096597-0.00570316im    0.105384-0.111052im     0.0943288+0.0411364im     -0.151456+0.0995312im      -0.19863-0.22635im      -0.0761694+0.111212im    -0.0750042+0.0445434im     0.0544304-0.0429394im    -0.0764344-0.099916im    0.00176657-0.0730387im   -0.0339737-0.0575899im   0.00737624+0.0451685im     0.0546815+0.202455im      0.166633-0.0854491im   -0.0137518+0.0959314im   -0.0287438-0.0189228im       0.0157797+0.051412im      0.0214855+0.14514im        -0.358838+0.041777im       0.086717-0.254458im      -0.214216-0.122106im     -0.0981846-0.175028im    0.0325184-0.27027im        0.14711+0.149265im     -0.051947+0.167379im      -0.0186969-0.110978im       0.252164-0.0940711im
  -0.147515-0.152776im     0.0281027+0.151584im      -0.171492-0.18694im       -0.0508528+0.168253im   -0.0351302-0.178075im      -0.183052+0.0142633im     0.100012+0.176616im     -0.105451+0.142217im      0.0357956-0.146801im      0.0764363+0.159813im        0.17468+0.132019im    -0.0449669+0.0247859im     0.0376823+0.00799214im     0.134033+0.130943im     -0.175605-0.0836333im     -0.28295-0.090396im     -0.090813+0.219042im       0.193605+0.102421im     0.0495553-0.100895im      0.134022-0.12201im       -0.16592-0.191741im        -0.146815-0.0501636im    -0.0463871+0.126329im      -0.0932887-0.0898108im      0.049384-0.212317im       0.178617-0.019701im      0.0806646+0.0467465im  -0.0625707+0.0143645im    -0.166221-0.049511im    -0.0965721+0.0139613im     -0.0222703-0.098105im      -0.117583+0.0114957im
  -0.115327-0.078587im      0.168951-0.0420495im   -0.00425396+0.0336722im      0.0638444-0.10978im    -0.0202393+0.0762767im    -0.0322729+0.059583im     0.0710986+0.0510945im    -0.124339+0.0494104im    -0.0425567-0.0165539im     0.0492463+0.000989577im   -0.006212-0.14159im     -0.0963901+0.120024im      -0.203447+0.207142im     -0.0110552+0.0828483im    0.0197533-0.00803318im   -0.116019-0.0290225im    -0.235278+0.172835im       -0.40835-0.198672im      -0.20231-0.0690754im    -0.262823+0.225126im    0.00473567+0.0473536im       0.0313102-0.11161im        0.142911+0.00705195im     -0.124949-0.126325im       0.231764-0.0807324im     0.0208998+0.0907843im    -0.0788077+0.16639im    -0.0506131-0.143484im     0.0161508+0.0510529im    0.0911827+0.0914007im      -0.208034-0.0474842im    -0.0920882-0.13436im
  0.0190763-0.0374472im     0.143736+0.063995im     -0.0823405-0.0849704im        -0.1648-0.178049im    -0.095708-0.117359im     -0.0964862+0.260164im      0.151791-0.00590046im     0.19774-0.0836218im    -0.0517386-0.00223764im    -0.140623-0.0050967im     -0.142584-0.0855747im     0.104952+0.04405im       0.0397504-0.0488183im    -0.0148159+0.0334917im   -0.0871287-0.203648im      0.160536+0.0823577im    -0.168431-0.131917im      0.0116243-0.0160485im    0.0164486-0.159301im     -0.248069+0.238587im    -0.0797563+0.0196719im        0.121775+0.156246im     -0.0196267-0.000687921im   -0.0230571+0.0811481im     -0.114415-0.0565052im      0.244205+0.121684im    -0.00575008+0.0044411im  -0.0519232+0.100517im     -0.260824-0.0545672im    -0.134358-0.199418im        0.297403+0.103467im     -0.0516796-0.0592469im
   0.147453-0.0975734im    0.0546996-0.0427166im     -0.352892-0.106275im        0.137077+0.0589383im    0.100096+0.12064im        0.064755-0.0171139im    0.0191022+0.0337784im   -0.0684823+0.0417119im     -0.316466-0.158306im      -0.131841-0.0669214im     0.0110464+0.0931112im     0.038752-0.0540611im     -0.143958-0.0202968im      0.165416+0.0149622im     0.161498+0.151926im     0.0606151-0.149762im      0.180265+0.129266im      0.0169544+0.0746737im     0.159255-0.145584im    -0.0368646-0.0408796im    0.0820887+0.0804492im        0.112379-0.216009im      0.0441958-0.21746im       -0.0878977+0.225158im    -0.00997089+0.173925im      0.0130049+0.113639im      -0.127316+0.107523im   -0.0273543-0.141409im      -0.15383-0.0696022im    -0.174325-0.119626im      -0.0541452+0.143412im     -0.0849809+0.0621558im
 -0.0471259+0.0232631im     -0.01493-0.150926im       0.054792+0.000472546im    0.0846377-0.123111im     -0.10083-0.0194991im     -0.184727+0.129128im    -0.0957847+0.252458im     0.0563401-0.0713612im     -0.132132-0.0626604im       0.17552-0.113219im      -0.271591+0.0891105im    -0.108798-0.0106923im     -0.266405+0.0350072im        0.2823-0.21094im      0.0223927+0.0559908im    0.0818477-0.0683998im   -0.0723904+0.0270375im      0.138462-0.0546673im   -0.0656894-0.130483im      0.115298+0.0361252im    0.0895678-0.208926im        0.0686891-0.0715179im    -0.0158873+0.0810216im      0.0355593+0.201239im      0.0107339-0.236704im      -0.193565+0.117099im       0.144878-0.0595427im    0.119993+0.204077im      0.234074+0.0186774im    0.0178488-0.0747247im       0.063606-0.0645931im    -0.0531366-0.0467408im
  -0.137072-0.0798046im    0.0863632+0.0545378im   0.000555645-0.141022im       -0.115887-0.0651249im     0.20481+0.046444im      0.0344325+0.00143386im    0.027794-0.186525im      0.111261+0.264854im     -0.0127376+0.0440872im    -0.0113551+0.192345im      -0.037352+0.0789574im    -0.213995+0.232823im      -0.195177+0.151968im       0.181536+0.156226im     -0.155946-0.129632im      0.230922-0.0877723im    0.0852109-0.215624im    -0.00961338-0.0907184im    0.0299987+0.0218114im     0.142296+0.039248im    -0.0405389+0.09637im        -0.0704208+0.159277im      0.0277605+0.0761167im       0.124964+0.0567293im     0.0727695-0.0396558im     -0.164021-0.0681666im     -0.162812-0.0508852im    0.231713-0.014392im    -0.0557265-0.00756824im  -0.0130614-0.101133im       -0.169369+0.0486802im    -0.0411881+0.276191im
  -0.107458+0.0268589im    -0.124843-0.0203252im    -0.0967008+0.00778875im    -0.0484257-0.0855409im  -0.0727118+0.107086im      -0.117048+0.0490432im     -0.14936+0.155282im    0.00950142+0.0815869im    -0.0285358+0.124987im    -0.00958648-0.256227im     -0.0421604+0.055242im     0.0749323-0.0796411im     -0.151723+0.254055im      -0.142759+0.19134im     -0.0527821-0.254665im     -0.226595+0.106228im     0.0112033-0.0228967im    -0.0288329-0.00192991im  -0.0042037+0.0364846im     0.160995-0.0726429im    0.0190271+0.114309im         0.239323+0.0233528im     -0.058022-0.0296806im     -0.0915637-0.0340526im     -0.123745+0.1288im        -0.349512-0.125706im      0.0011441+0.123771im    -0.108739+0.172155im     -0.312261-0.0483615im   -0.0885919-0.0147635im     -0.0240905-0.119371im       0.155746-0.0111626im
   0.124223+0.0564173im    -0.122964-0.0477309im     -0.103191+0.0184403im       -0.21738-0.104795im   -0.0910364-0.0416327im     -0.297178-0.0775634im    -0.184152-0.00328607im    0.219048-0.0530077im    -0.0472245-0.0715247im     -0.146241+0.0208073im     0.0180252-0.0159584im    0.0875673-0.141488im       0.118644+0.0615213im     0.0133925+0.0518157im     0.105087+0.175385im     0.0534782+0.166423im     -0.149369+0.0283567im     0.0490553-0.037823im     -0.148186+0.0854464im   -0.0554711-0.0226869im    -0.205782+0.0500891im       0.0659924-0.00929108im    -0.278413-0.0189727im      0.0970974+0.100792im       0.160116-0.119813im      -0.081875-0.186656im      -0.135765+0.0361644im    0.111019-0.201208im     0.0277835-0.114206im    -0.0893928+0.181015im       -0.156265+0.00258244im     -0.32916+0.0847819im
   0.044343+0.0754382im    0.0770823+0.0600689im     0.0703782-0.0919977im     -0.0866832+0.127286im     0.151222+0.18858im        0.220725-0.102854im     -0.143314+0.13047im       0.139746+0.192257im     -0.0482935-0.211569im      -0.111075+0.000906001im    -0.19153+0.186527im     0.0333091+0.177658im      -0.141227-0.0283099im    -0.0418223-0.13014im      -0.104685-0.130317im    -0.0253568+0.182109im      0.109252+0.0719729im     0.0885429+0.0192469im       -0.287+0.0163078im    -0.206995-0.190877im   -0.00747602+0.130946im          0.10593-0.0838221im    -0.0517905+0.222596im       0.0663865-0.104222im       0.112339-0.024484im      0.0765805-0.0872105im     0.0573502+0.0641684im    -0.24659-0.0658473im     0.159763+0.00421887im  -0.0940947-0.018306im        0.208684+0.0270265im    -0.0210551-0.0152326im
 -0.0302411-0.0930533im   -0.0674878-0.00749652im    -0.190503-0.0524095im       0.238238+0.147413im    -0.147697+0.088903im     -0.0851902+0.0345603im     0.281052-0.169423im     0.0517933-0.0423023im     0.0251251+0.0482438im      0.021538-0.0937077im     -0.157318+0.17832im     -0.0511621+0.108346im       0.198611+0.0400715im      0.160411+0.166238im     0.0977799-0.0824876im   -0.0400792+0.19785im      -0.019208-0.151172im      -0.150603+0.00965153im    0.015665-0.0656105im    0.0976333-0.113787im      0.244619-0.130826im         0.197482+0.0692083im     0.0977138+0.109301im         0.11606+0.00815311im    0.0942512+0.0713829im     0.0823845-0.129733im     -0.0353865+0.119449im    0.0268954-0.0789824im     0.136756-0.223491im      0.158871+0.204865im        0.207883-0.0632877im     -0.105351+0.0158959im
 0.00722725+0.0307536im      0.10266-0.028711im       0.136638+0.205285im       -0.153984+0.0124766im  -0.0735429-0.175361im      0.0737962-0.101126im      0.178253-0.0769206im   -0.0141411-0.019676im       0.151203+0.0195851im      0.166323-0.218033im     -0.0442707+0.0782607im   -0.0101537-0.000644849im   0.0979036+0.0661781im      0.135834+0.216776im      0.111575+0.0914534im   -0.0971399-0.047968im    -0.0576049+0.100773im       0.159161-0.168211im    -0.0822458+0.0844641im    -0.088617+0.0340456im    0.0994172+0.000521785im    -0.0569597-0.18418im       0.0943922+0.168147im       0.0963866+0.20521im        0.192148+0.0992603im     -0.109404-0.108704im     -0.0225022-0.244274im    -0.208165-0.112008im     -0.139024-0.142403im     -0.105978-0.353376im        0.004163+0.0512594im     0.0367043+0.0478787im
   0.137201+0.0345878im    0.0522168-0.00430374im    0.0584814-0.0387172im        -0.2082+0.0425647im    0.132747-0.0780212im    -0.0128757+0.111445im     0.0525496+0.00712837im   -0.046006-0.106128im       0.155857+0.203047im    -0.00585978-0.016608im      -0.246675+0.0725424im      0.16126-0.287648im      -0.135731+0.040184im       0.126271+0.134427im     -0.164294+0.0577854im    0.0634778-0.0894517im     0.259552+0.0402677im     -0.186489-0.121934im     0.0321273-0.282944im     -0.128608-0.250222im      -0.12201-0.109153im       -0.0629519+0.140189im      0.0982139-0.259982im     -0.00959305-0.0565628im     0.0797503-0.10243im      0.00802791-0.0949544im      0.100183-0.0232669im   -0.189713-0.00725047im    0.076246-0.10805im      0.0158929+0.144698im      -0.0639485-0.0178802im     0.0478676+0.0990681im
  0.0781236+0.0858123im   -0.0911907+0.0596068im    -0.0418967+0.161905im        0.235145-0.0917936im   -0.106964+0.0149314im     -0.146155-0.0907993im    -0.134412-0.109821im    -0.0819679-0.0933551im    -0.0497208-0.0584491im     -0.296724+0.135247im      -0.114626+0.00296969im   -0.162936+0.0976859im      0.071457+0.231884im      0.0835505+0.231478im     0.0121356+0.0536463im    0.0679137-0.131157im     0.0216557+0.23493im        0.049955+0.0360477im   -0.0672337-0.0339495im    -0.113267-0.0771167im     0.128655+0.191404im       -0.0848652+0.276333im    -0.00219047+0.0367119im       0.106921-0.075408im      -0.168515-0.0929422im      0.112567+0.0102368im      0.229805-0.0286994im   0.0112789-0.0317072im    0.0707499-0.0705594im     -0.18172-0.155207im      -0.0737687-0.188113im       0.181279-0.0768932im
   0.135252-0.0422444im   -0.0959144-0.118433im      0.0765396-0.173188im        0.208035-0.322586im    -0.117126+0.115613im     0.00701142-0.147156im       0.14185-0.0885435im     0.124158-0.0966082im     0.0202606+0.121929im        0.22691+0.0960398im    -0.0109773+0.0651073im    -0.060758+0.110929im     0.00227998-0.159712im     -0.0620822+0.145348im     -0.219076+0.034202im     0.0274214-0.10518im      0.0352456+0.208453im     -0.0755002+0.0230071im    -0.120885-0.0475097im    0.0312196-0.184981im    -0.0173061+0.211482im        -0.060627-0.187672im      -0.197047-0.0288011im     0.00164764+0.00567449im   0.00404388-0.155966im     -0.0933443+0.108996im     -0.0999063-0.163444im   -0.0115725+0.0294021im    -0.215326-0.0129363im    0.0167486+0.189207im        0.201045+0.163379im      0.0345223-0.0635841im
  0.0465226+0.254053im     -0.257181+0.135346im      -0.164157-0.00990567im      0.057486+0.0938037im     0.19087+0.0952302im    -0.0489382-0.118402im      0.101207+0.0262438im    -0.207881-0.118234im      0.0900657+0.0383101im    0.00290387-0.0945516im     0.0589511-0.272028im     -0.137294+0.1515im         0.034851+0.150576im       0.122942-0.0148126im    -0.197468-0.0563336im    0.0688268-0.0241536im     0.118275+0.0135503im      0.239797-0.159588im    0.00776113-0.0562775im    0.0158732+0.314499im     -0.133004-0.102275im         0.219772-0.0686918im     -0.101077-0.138709im       0.0126437-0.0931252im    -0.0133306-0.113551im     -0.0625704-0.051795im      -0.161681-0.0914615im   -0.183649-0.0989846im    0.0958898+0.0114068im     0.029961+0.0228903im       0.159778+0.0379992im   -0.00976521-0.0249633im
   0.160473-0.0385634im    0.0965691-0.146988im       0.178182+0.116759im        0.163643+0.224278im    0.0790466+0.106459im      -0.026531-0.00436134im   -0.114823+0.0822395im   -0.0954675-0.093692im      0.0101603+0.323712im     -0.0109234-0.00445195im     -0.14387-0.172658im     -0.115833+0.177579im      -0.137418+0.114224im      0.0767986-0.0447669im   -0.0839607+0.13911im     -0.0566126+0.106934im     -0.172053-0.166551im     -0.0519105+0.280357im      0.126776+0.105789im    -0.0981715-0.187979im    -0.0896675-0.121117im        -0.044652+0.00163999im  -0.00204193+0.123625im       -0.111874+0.0718386im     -0.140671-0.0345158im     0.0961808-0.0284586im      -0.17173-0.11002im    -0.0758444-0.0656299im    -0.206085+0.00107824im   -0.164064-0.000933306im    0.0200717-0.0866569im     -0.216546+0.08015im
 -0.0643619-0.10835im      -0.190206-0.186882im     -0.0122957-0.0429904im      0.0640847-0.0637455im  0.00754479+0.140053im      0.0772784-0.0367023im     0.188567+0.162024im    -0.0970374+0.256303im     -0.0145905+0.197261im     -0.0440671+0.105773im      0.0948986-0.0356429im     0.113438-0.264847im      0.0722881-0.183755im       0.160285-0.112617im     -0.225254+0.119773im     0.0637471+0.0504275im   -0.0697001+0.0390887im     -0.132273-0.128536im    -0.0212098+0.152843im    -0.0232178+0.0181324im    0.0404068-0.0677604im       0.0200582+0.238537im      -0.198712+0.155662im      -0.0392251+0.116679im     0.00347738-0.0453236im    -0.0316555-0.00704929im    -0.106688+0.204616im   -0.0622154-0.16042im      0.0897029-0.0998049im    -0.109695-0.273711im        0.019454-0.0901939im      0.178253-0.0750959im
  0.0501807+0.0888848im   -0.0188044+0.0664147im     -0.111679-0.0052957im      0.0963874+0.0890771im  -0.0347849+0.253113im       -0.19027-0.0196179im     0.110686-0.169812im     0.0197474-0.0388906im      0.065798-0.173358im     -0.0759096+0.227839im      -0.148214-0.0514599im     0.255318-0.0732751im    -0.0908229+0.0050076im     -0.236785+0.0606359im   -0.0402472-0.0366256im    -0.239894-0.120958im   -0.00681576-0.0428366im    -0.0934306+0.0515426im     -0.12853+0.0433528im    -0.116219+0.0549601im    0.0136324-0.363789im        0.0549651-0.0394776im    -0.0533993+0.167513im     -0.00489694+0.182629im     -0.0135979-0.00811056im   -0.0705583+0.0824992im    -0.0386451-0.186565im    0.0324824+0.0591765im    0.0584319+0.133461im    -0.0373384-0.0456197im      -0.108501+0.142369im        0.20229+0.282318im
  0.0323315-0.201098im     0.0492173+0.151339im       0.120394+0.0354877im     -0.0244569+0.0230092im  -0.0493791+0.0831909im     0.0729362-0.276362im     0.0374563-0.17689im      -0.194133+0.144388im     -0.0657423-0.0855346im      0.208346-0.11788im        0.104341-0.0652311im     0.261636-0.17329im      -0.0343051+0.180015im       0.170589+0.0383129im    -0.019042-0.202276im      0.149525+0.0403852im    -0.197041-0.0505628im    -0.0330652-0.0021275im    0.0455317-0.0777798im   -0.0866786+0.0118794im   -0.0207862+0.0459022im      0.00231024-0.0342237im    -0.0814923+0.0492403im      0.0363609-0.00158059im    -0.342123-0.0135151im     -0.123624+0.123395im        0.27298-0.0615071im   0.0260344-0.0965786im     0.129906-0.0197347im    -0.157045+0.172716im       0.0543981+0.0855226im     -0.170352+0.0507657im
  -0.220512-0.0373568im   -0.0932657+0.327245im       0.157454-0.224128im       0.0755567+0.0148226im   0.0439465+0.132683im       0.152568-0.0550501im   -0.0634924+0.0237689im    0.0318426-0.072183im     -0.0963676+0.254216im      -0.181961-0.0324963im     -0.136087-0.121936im       0.11199-0.0661674im      0.041572-0.132897im        0.17452+0.0613303im    0.0707394+0.214265im     -0.356249-0.0377024im   -0.0919127-0.124496im       0.109184-0.0599932im   -0.0710488+0.0383394im   -0.0461145+0.106123im    -0.0209426+0.194555im        0.0400487-0.116641im       0.139629-0.0967983im     -0.0125377+0.00524612im    0.0729201-0.18447im       0.0258575-0.0308858im      0.165992+0.0191357im    0.231024+0.0520031im   -0.0369767-0.121754im    -0.0206634-0.00347353im     0.0575779+0.0520207im     0.0329472+0.121255im
   -0.30499+0.0573876im   -0.0665435+0.081997im      -0.196487+0.208118im      -0.0501448+3.0912e-5im   -0.101528-0.0771699im     0.0271537-0.222072im      0.164312+0.117488im    -0.0734673+0.0251705im     -0.161801+0.0743347im    -0.0174112+0.05851im       -0.294085+0.0496889im      0.16087-0.0867983im      -0.00272-0.0803457im     0.0767925-0.0185026im    0.0481295-0.0434595im    0.0797237-0.0533621im   -0.0820291+0.00338103im   -0.0370223+0.202803im     0.0805586+0.0226257im   -0.0684787-0.119113im    -0.0667714+0.121753im        0.0305299-0.0280073im     0.0209754-0.00041932im      0.189822-0.298454im     -0.0225848-0.0363856im   -0.00330598+0.0155367im     -0.349041-0.193503im   -0.0505731+0.207405im     0.0665894+0.0918038im    0.0819195-0.0893713im      -0.155137+0.0818652im    -0.0937934-0.12376im
  0.0364846-0.216782im     -0.111209-0.057658im     -0.0617991+0.194898im       0.0292742+0.0272725im  0.00256303+0.223487im   -0.000684237-0.0592954im   -0.0431735-0.112705im     0.0227024+0.0226086im     0.0832615-0.114857im     -0.0226797-0.00672478im     -0.17594+0.164035im     0.0287482-0.119879im     -0.0632612+0.182425im      -0.053267-0.168913im    -0.0897845+0.0100905im   -0.0187004-0.0570962im   -0.0972408-0.0467414im      0.183618-0.325678im      0.199253+0.247761im      0.118141-0.0658489im    0.0228254+0.0851433im        0.059716+0.163842im      0.0532743-0.0795275im      -0.154969+0.0136706im      0.167392-0.163336im        0.24994+0.0437521im      0.118783-0.100047im   -0.0614674-0.0231448im    -0.218082+0.0921025im     0.199874+0.018352im      -0.0258123+0.195623im     -0.0943929-0.123735im
  0.0998374-0.0485899im   -0.0467422+0.162299im     -0.0624754+0.18277im        0.0169068+0.105311im     0.107638-0.0836854im      -0.13919-0.166508im    -0.0358279+0.162112im     -0.181452+0.00881536im  -0.00366121-0.0395373im       0.18618-0.0896769im     -0.125956+0.059348im    -0.0578955+0.0147441im      0.139218-0.224178im      -0.192336-0.116978im     -0.259906-0.118258im    -0.0500678+0.0142621im     0.070112+0.0280681im    -0.0814024+0.115141im      -0.21038-0.0187933im   -0.0674717+0.0644331im    0.0630189+0.0966311im    -0.000372661+0.232022im       0.282581-0.143751im        0.197588+0.267853im      0.0720621-0.0578414im     -0.129083+0.0614507im     0.0237207+0.0823484im     0.21887-0.133119im     -0.176101+0.045195im    -0.0229741-0.0131825im      0.0159738-0.0363238im      -0.13229+0.0167837im
  0.0303719+0.0970849im   -0.0559212-0.0100287im     -0.146656+0.0484403im     -0.0845765-0.201767im    -0.264432+0.0518544im       0.21828+0.0689443im    -0.156493+0.0504274im   -0.0283612+0.152515im      0.0894925-0.12049im        0.157534+0.0680788im    -0.0405154-0.0533588im    -0.164942-0.0889082im     0.0994662+0.0194788im    -0.0951706-0.00242706im   -0.189921-0.0208515im    -0.108206+0.0831587im   -0.0210518-0.193747im      0.0462458+0.0225983im     0.256977-0.0101985im     -0.13615+0.0315171im     0.224175+0.101649im       -0.0309951-0.174415im      0.0655799-0.117747im       0.0320086+0.0708963im     0.0236261-0.179863im       0.134378+0.147202im      -0.124115-0.0282611im   -0.135608+0.0333922im     0.143933-0.175575im     -0.120929+0.0949991im     -0.0893089-0.226952im      0.0191155+0.294422im
   0.279066+0.0396604im    -0.207234+0.191369im      -0.109441-0.183952im        0.116557+0.0618314im  -0.0933278-0.0784676im     0.0477759-0.0258366im    -0.218803-0.043574im      0.120771+0.135984im     -0.0631718+0.3312im         0.155339-0.0527716im     0.0797818+0.150974im    -0.0239469-0.103691im      0.0315498-0.0310755im   -0.00318102+0.099124im      0.132781-0.0388564im      0.12677+0.0969044im   -0.0736287-0.0390297im    -0.0176393-0.0904196im    -0.274754-0.1284im        0.119629+0.0497739im    0.0271661-0.0646166im       0.0521274+0.0225785im      0.145327+0.0843787im     -0.0846973-0.045929im     -0.0384523-0.0513672im      0.193307+0.131842im     -0.0475249-0.0815485im   -0.184321+0.0249012im    0.0110115+0.286053im     0.0234991-0.175965im       -0.210513+0.00655293im   -0.0718042+0.0663421im
  0.0432077-0.00305294im   0.0327326+0.0456107im    0.00490591+0.196679im       0.0690246+0.0224095im  -0.0447873+0.148918im      -0.067557-0.0653674im   -0.0504392+0.172084im     0.0341554-0.0602506im      0.205767+0.0407375im   -0.00887332-0.0250784im      0.261085+0.128723im      0.256505+0.0975091im     -0.168915+0.00435789im    0.0613331-0.0397131im    0.0194762+0.0856253im   -0.0297838+0.151348im      0.127992+0.0392122im     -0.162917+0.125895im      0.176549-0.287177im      0.172182+0.23895im      -0.117987+0.259003im        0.0700927+0.127513im     -0.0716139+0.185525im        0.041773-0.0143213im      0.278408+0.0248259im      0.107522+0.156642im       0.036097-0.222089im    0.0552367+0.0434745im    0.0325607-0.128086im      0.003095-0.050398im       0.0334214-0.0548382im     0.0233142+0.109732im</code></pre><p>and then generate the state <span>$ψ$</span></p><pre><code class="language-julia hljs">psi = P[:, 3]</code></pre><pre><code class="nohighlight hljs">32-element Vector{ComplexF64}:
  -0.014864980328573592 + 0.00028427999033400504im
    0.12722256330559115 + 0.1446500167652163im
   -0.09014757874185189 + 0.12394225943271114im
    0.15547425253927089 + 0.07114460941276254im
     0.2978610029653393 + 0.0im
   0.008054191322369043 - 0.1438841586054072im
   -0.18937990413048492 - 0.03405250263263127im
  0.0007704581306142363 + 0.12888411265174352im
 -0.0021488966195883086 - 0.07718050858155351im
    0.13694623013765025 + 0.19588242043102533im
    0.18203287299869236 - 0.04814984596950703im
  -0.024500839660610133 + 0.028354753966870847im
  -0.055397506308511174 + 0.1518519875895533im
    0.14606216425631974 - 0.1430962946274506im
     -0.259821852003583 - 0.08758570629128606im
   -0.13997400502091428 - 0.13814039168816056im
    0.01967035131936965 + 0.019526382122515177im
   0.011425001687142469 + 0.06430905708374696im
  -0.009940498450923797 - 0.12208547894652416im
    -0.1826196827651385 - 0.09211280643728337im
    0.04208518983866706 - 0.04537812878258955im
   -0.11496774592876637 + 0.09032994827996613im
    0.16698683370831433 + 0.12414666168324628im
    -0.2422411159208436 - 0.09485133206230269im
   -0.05511696489554793 - 0.20975780875711603im
   0.027930761827679583 + 0.10150094512074197im
   -0.12486768114003119 - 0.23991497054294486im
 0.00021074059946689372 - 0.1769868977415986im
    0.04567864072750813 + 0.018746187009239496im
   -0.07146779865859798 + 0.11637231042136592im
   -0.23384126203512193 + 0.06589917613697555im
    0.12264285651803727 - 0.09634837615478808im</code></pre><p>In the phase estimation process, we will feed the state to circuit and measure the first <code>n</code> qubits processed by iQFT.</p><pre><code class="language-julia hljs">r = join(ArrayReg(psi), zero_state(N))
r |&gt; PE(N, M, U)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qudits: 8/8
    nlevel: 2</code></pre><p>Since our phase can be represented by 3 qubits precisely, we only need to measure once</p><pre><code class="language-julia hljs">results = measure(r, 1:N; nshots=1)</code></pre><pre><code class="nohighlight hljs">1-element Vector{BitBasis.BitStr64{3}}:
 011 ₍₂₎</code></pre><p>Recall that our QFT&#39;s bit numbering is reversed, let&#39;s reverse it back</p><pre><code class="language-julia hljs">using BitBasis
estimated_phase = bfloat(results[]; nbits=N)</code></pre><pre><code class="nohighlight hljs">0.75</code></pre><p>the phase is exactly <code>0.75</code>!</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../1.prepare-ghz-state/index.html">« Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a><a class="docs-footer-nextpage" href="../3.grover-search/index.html">Grover Search »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.15 on <span class="colophon-date" title="Wednesday 30 March 2022 17:16">Wednesday 30 March 2022</span>. Using Julia version 1.7.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
