<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quantum Fourier Transformation and Phase Estimation · Documentation | Yao</title><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/indigo.css" rel="stylesheet" type="text/css"/><link href="https://yaoquantum.org/assets/favicon-light.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../index.html"><img src="../../../assets/logo.png" alt="Documentation | Yao logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../index.html">Documentation | Yao</a></span></div><form class="docs-search" action="../../../search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../index.html">Home</a></li><li><span class="tocitem">Quick Start</span><ul><li><a class="tocitem" href="../1.prepare-ghz-state/index.html">Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a></li><li class="is-active"><a class="tocitem" href="index.html">Quantum Fourier Transformation and Phase Estimation</a><ul class="internal"><li><a class="tocitem" href="#Quantum-Fourier-Transformation"><span>Quantum Fourier Transformation</span></a></li><li><a class="tocitem" href="#Wrap-QFT-to-an-external-block"><span>Wrap QFT to an external block</span></a></li><li><a class="tocitem" href="#Phase-Estimation"><span>Phase Estimation</span></a></li></ul></li><li><a class="tocitem" href="../3.grover-search/index.html">Grover Search</a></li><li><a class="tocitem" href="../4.shor-algorithm/index.html">Shor&#39;s Algorithm</a></li><li><a class="tocitem" href="../5.shor-9-code/index.html">Shor&#39;s 9 qubit code</a></li><li><a class="tocitem" href="../6.quantum-circuit-born-machine/index.html">Quantum Circuit Born Machine</a></li><li><a class="tocitem" href="../7.variation-quantum-eigen-solver/index.html">Variational Quantum Eigen Solver</a></li></ul></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../../man/array_registers.html">Array Registers</a></li><li><a class="tocitem" href="../../../man/symbolic.html">Symbolic Computation</a></li><li><a class="tocitem" href="../../../man/blocks.html">Blocks</a></li><li><a class="tocitem" href="../../../man/automatic_differentiation.html">Automatic Differentiation</a></li><li><a class="tocitem" href="../../../man/simplification.html">Simplification</a></li><li><a class="tocitem" href="../../../man/base.html">Base</a></li><li><a class="tocitem" href="../../../man/registers.html">Abstract Registers</a></li><li><a class="tocitem" href="../../../man/bitbasis.html">BitBasis</a></li><li><a class="tocitem" href="../../../man/extending_blocks.html">Extending Blocks</a></li></ul></li><li><a class="tocitem" href="../../../benchmarks.html">Benchmark</a></li><li><a class="tocitem" href="../../../dev/index.html">Developer Notes</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Quick Start</a></li><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/QuantumBFS/Yao.jl/blob/master/docs/src/quick-start/2.qft-phase-estimation/main.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><p><a href="https://mybinder.org/v2/gh/QuantumBFS/Yao.jl/gh-pages?filepath=dev/generated/quick-start/2.qft-phase-estimation/main.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a> <a href="https://nbviewer.jupyter.org/github/QuantumBFS/Yao.jl/blob/gh-pages/dev/generated/quick-start/2.qft-phase-estimation/main.ipynb"><img src="https://img.shields.io/badge/show-nbviewer-579ACA.svg" alt/></a> <a href="https://minhaskamal.github.io/DownGit/#/home?url=https://github.com/QuantumBFS/tutorials/tree/gh-pages/dev/generated/quick-start/2.qft-phase-estimation"><img src="https://img.shields.io/badge/download-project-orange" alt/></a></p><h1 id="example-qft"><a class="docs-heading-anchor" href="#example-qft">Quantum Fourier Transformation and Phase Estimation</a><a id="example-qft-1"></a><a class="docs-heading-anchor-permalink" href="#example-qft" title="Permalink"></a></h1><p>Let&#39;s use Yao first</p><pre><code class="language-julia hljs">using Yao</code></pre><h2 id="Quantum-Fourier-Transformation"><a class="docs-heading-anchor" href="#Quantum-Fourier-Transformation">Quantum Fourier Transformation</a><a id="Quantum-Fourier-Transformation-1"></a><a class="docs-heading-anchor-permalink" href="#Quantum-Fourier-Transformation" title="Permalink"></a></h2><p>The Quantum Fourier Transformation (QFT) circuit is to repeat two kinds of blocks repeatly:</p><p><img src="assets/qft.png" alt="qft-circuit"/></p><p>The basic building block control phase shift gate is defined as</p><p class="math-container">\[R(k)=\begin{bmatrix}
1 &amp; 0\\
0 &amp; \exp\left(\frac{2\pi i}{2^k}\right)
\end{bmatrix}\]</p><p>Let&#39;s define block <code>A</code> and block <code>B</code>, block <code>A</code> is actually a control block.</p><pre><code class="language-julia hljs">A(i, j) = control(i, j=&gt;shift(2π/(1&lt;&lt;(i-j+1))))</code></pre><pre><code class="nohighlight hljs">A (generic function with 1 method)</code></pre><p>Once you construct the blockl you can inspect its matrix using <code>mat</code> function. Let&#39;s construct the circuit in dash box A, and see the matrix of <span>$R_4$</span> gate.</p><pre><code class="language-julia hljs">R4 = A(4, 1)</code></pre><pre><code class="nohighlight hljs">(n -&gt; control(n, 4, 1 =&gt; shift(0.39269908169872414)))</code></pre><p>If you have read about <a href="generated/quick-start/2.qft-phase-estimation/@ref example-ghz">preparing GHZ state</a>, you probably know that in Yao, we could just leave the number of qubits, and it will be evaluated when possible.</p><pre><code class="language-julia hljs">R4(5)</code></pre><pre><code class="nohighlight hljs">nqubits: 5
control(4)
└─ (1,) shift(0.39269908169872414)</code></pre><p>its matrix will be</p><pre><code class="language-julia hljs">mat(R4(5))</code></pre><pre><code class="nohighlight hljs">32×32 LinearAlgebra.Diagonal{ComplexF64, Vector{ComplexF64}}:
 1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im</code></pre><p>Then we repeat this control block over and over on different qubits, and put a Hadamard gate to <code>i</code>th qubit to construct <code>i</code>-th <code>B</code> block.</p><pre><code class="language-julia hljs">B(n, k) = chain(n, j==k ? put(k=&gt;H) : A(j, k) for j in k:n)</code></pre><pre><code class="nohighlight hljs">B (generic function with 1 method)</code></pre><p>We need to input the total number of qubits <code>n</code> here because we have to iterate through from <code>k</code>-th location to the last.</p><p>Now, let&#39;s construct the circuit by chaining all the <code>B</code> blocks together</p><pre><code class="language-julia hljs">qft(n) = chain(B(n, k) for k in 1:n)
qft(4)</code></pre><pre><code class="nohighlight hljs">nqubits: 4
chain
├─ chain
│  ├─ put on (1)
│  │  └─ H
│  ├─ control(2)
│  │  └─ (1,) shift(1.5707963267948966)
│  ├─ control(3)
│  │  └─ (1,) shift(0.7853981633974483)
│  └─ control(4)
│     └─ (1,) shift(0.39269908169872414)
├─ chain
│  ├─ put on (2)
│  │  └─ H
│  ├─ control(3)
│  │  └─ (2,) shift(1.5707963267948966)
│  └─ control(4)
│     └─ (2,) shift(0.7853981633974483)
├─ chain
│  ├─ put on (3)
│  │  └─ H
│  └─ control(4)
│     └─ (3,) shift(1.5707963267948966)
└─ chain
   └─ put on (4)
      └─ H
</code></pre><h2 id="Wrap-QFT-to-an-external-block"><a class="docs-heading-anchor" href="#Wrap-QFT-to-an-external-block">Wrap QFT to an external block</a><a id="Wrap-QFT-to-an-external-block-1"></a><a class="docs-heading-anchor-permalink" href="#Wrap-QFT-to-an-external-block" title="Permalink"></a></h2><p>In most cases, <code>function</code>s are enough to wrap quantum circuits, like <code>A</code> and <code>B</code> we defined above, but sometimes, we need to dispatch specialized methods on certain kinds of quantum circuit, or we want to define an external block to export, thus, it&#39;s useful to be able to wrap circuit to custom blocks.</p><p>First, we define a new type as subtype of <code>PrimitiveBlock</code> since we are not going to use the subblocks of <code>QFT</code>, if you need to use its subblocks, it&#39;d be better to define it under <code>CompositeBlock</code>.</p><pre><code class="language-julia hljs">struct QFT &lt;: PrimitiveBlock{2}
    n::Int
end

YaoBlocks.nqudits(q::QFT) = q.n</code></pre><p>Now, let&#39;s define its circuit</p><pre><code class="language-julia hljs">circuit(q::QFT) = qft(q.n)</code></pre><pre><code class="nohighlight hljs">circuit (generic function with 1 method)</code></pre><p>And forward <code>mat</code> to its circuit&#39;s matrix</p><pre><code class="language-julia hljs">YaoBlocks.mat(::Type{T}, x::QFT) where T = mat(T, circuit(x))</code></pre><p>You may notice, it is a little ugly to print <code>QFT</code> at the moment, this is because we print the type summary by default, you can define your own printing by overloading <code>print_block</code></p><pre><code class="language-julia hljs">YaoBlocks.print_block(io::IO, x::QFT) = print(io, &quot;QFT($(x.n))&quot;)</code></pre><p>Since it is possible to use FFT to simulate the results of QFT (like cheating), we could define our custom <code>apply!</code> method:</p><pre><code class="language-julia hljs">using FFTW, LinearAlgebra

function YaoBlocks.apply!(r::ArrayReg, x::QFT)
    α = sqrt(length(statevec(r)))
    invorder!(r)
    lmul!(α, ifft!(statevec(r)))
    return r
end</code></pre><p>Now let&#39;s check if our <code>apply!</code> method is correct:</p><pre><code class="language-julia hljs">r = rand_state(5)
r1 = r |&gt; copy |&gt; QFT(5)
r2 = r |&gt; copy |&gt; circuit(QFT(5))
r1 ≈ r2</code></pre><pre><code class="nohighlight hljs">true</code></pre><p>We can get iQFT (inverse QFT) directly by calling <code>adjoint</code></p><pre><code class="language-julia hljs">QFT(5)&#39;</code></pre><pre><code class="nohighlight hljs"> [†]QFT(5)</code></pre><p>QFT and iQFT are different from FFT and IFFT in three ways,</p><ol><li>they are different by a factor of <span>$\sqrt{2^n}$</span> with <span>$n$</span> the number of qubits.</li><li>the <a href="https://quantumbfs.github.io/BitBasis.jl/stable/tutorial/#Conventions-1">bit numbering</a> will exchange after applying QFT or iQFT.</li><li>due to the convention, QFT is more related to IFFT rather than FFT.</li></ol><h2 id="Phase-Estimation"><a class="docs-heading-anchor" href="#Phase-Estimation">Phase Estimation</a><a id="Phase-Estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Phase-Estimation" title="Permalink"></a></h2><p>Since we have QFT and iQFT blocks we can then use them to realize phase estimation circuit, what we want to realize is the following circuit:</p><p><img src="assets/phaseest.png" alt="phase estimation"/></p><p>First we call Hadamard gates repeatly on first <code>n</code> qubits.</p><pre><code class="language-julia hljs">Hadamards(n) = repeat(H, 1:n)</code></pre><pre><code class="nohighlight hljs">Hadamards (generic function with 1 method)</code></pre><p>Then in dashed box <code>B</code>, we have controlled unitaries:</p><pre><code class="language-julia hljs">ControlU(n, m, U) = chain(n+m, control(k, n+1:n+m=&gt;matblock(U^(2^(k-1)))) for k in 1:n)</code></pre><pre><code class="nohighlight hljs">ControlU (generic function with 1 method)</code></pre><p>each of them is a <code>U</code> of power <span>$2^{(k-1)}$</span>.</p><p>Since we will only apply the qft and Hadamard on first <code>n</code> qubits, we could use <code>Subroutine</code>, which creates a context of a sub-scope of the qubits.</p><pre><code class="language-julia hljs">PE(n, m, U) =
    chain(n+m, # total number of the qubits
        subroutine(Hadamards(n), 1:n), # apply H in local scope
        ControlU(n, m, U),
        subroutine(QFT(n)&#39;, 1:n))</code></pre><pre><code class="nohighlight hljs">PE (generic function with 1 method)</code></pre><p>we use the first <code>n</code> qubits as the output space to store phase <span>$ϕ$</span>, and the other <code>m</code> qubits as the input state which corresponds to an eigenvector of oracle matrix <code>U</code>.</p><p>The subroutine here uses <code>focus!</code> and <code>relax!</code> to manage a local scope of quantum circuit, and only activate the first <code>n</code> qubits while applying the block inside the subroutine context, and the scope will be <code>relax!</code>ed back, after the context. This is equivalent to manually <code>focus!</code> then <code>relax!</code></p><p>fullly activated</p><pre><code class="language-julia hljs">r = rand_state(5)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qudits: 5/5
    nlevel: 2</code></pre><p>first 3 qubits activated</p><pre><code class="language-julia hljs">focus!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qudits: 3/5
    nlevel: 2</code></pre><p>relax back to the original</p><pre><code class="language-julia hljs">relax!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qudits: 5/5
    nlevel: 2</code></pre><p>In this way, we will be able to apply small operator directly on the subset of the qubits.</p><p>Details about the algorithm can be found here: <a href="https://en.wikipedia.org/wiki/Quantum_phase_estimation_algorithm">Quantum Phase Estimation Algorithm</a></p><p>Now let&#39;s check the results of our phase estimation.</p><p>First we need to set up a unitary with known phase, we set the phase to be 0.75, which is <code>0.75 * 2^3 == 6 == 0b110</code> .</p><pre><code class="language-julia hljs">N, M = 3, 5
P = eigen(rand_unitary(1&lt;&lt;M)).vectors
θ = Int(0b110) / 1&lt;&lt;N
phases = rand(1&lt;&lt;M)
phases[0b010+1] = θ
U = P * Diagonal(exp.(2π * im * phases)) * P&#39;</code></pre><pre><code class="nohighlight hljs">32×32 Matrix{ComplexF64}:
 -0.0232682-0.256037im     -7.5562e-5+0.00497256im    0.0295549+0.00385136im    -0.0832651-0.324438im      0.239699-0.151746im       0.117442-0.219365im      0.0336765-0.00357626im     0.044704+0.0778521im    0.101765+0.0113366im    -0.0187467+0.171172im     -0.0198697+0.034901im   -0.00137449-0.0855348im     -0.162726+0.00609953im   0.0110896+0.0114879im      -0.04009+0.0443953im       0.12679-0.0241277im    -0.0329662-0.00715059im   -0.0723635-0.22766im      -0.230434+0.0173341im     0.417676-0.140147im     -0.0681053+0.144686im     -0.0775062+0.114525im       0.142295+0.00544823im    -0.101777+0.061706im        -0.2504-0.122242im     0.00748738-0.116708im     -0.0733311-0.0941429im        0.12453-0.0429733im     -0.016788+0.0896367im      0.112064-0.145857im       0.102969-0.0666818im  -0.0528581-0.073317im
 -0.0642498-0.0601308im      0.141018-0.101648im     -0.0560769-0.00425298im   -0.00356644-0.0373879im    -0.261143-0.0573629im      0.141553+0.110365im      0.0767697-0.0850275im     -0.171617-0.0637705im     0.22008+0.118539im      0.0556514-0.0686093im    -0.0379978+0.171851im      0.185525+0.132808im       0.101982-0.352786im      0.116482-0.128875im      0.0775328+0.0242042im    -0.0699253-0.00690377im     0.118424-0.19222im       0.0571357+0.0835194im   -0.0552057-0.129003im     0.0721842-0.133751im     -0.0609431-0.115203im      -0.112629+0.126113im       0.116239+0.0971506im        0.1828-0.0803383im    -0.0602151+0.156122im       0.155187+0.280329im     -0.0811755-0.0340916im      0.0140318-0.0342647im    -0.0639643+0.160993im      0.0535038-0.120117im    0.000646469-0.201im       -0.159904+0.108469im
  0.0471599-0.0443826im     0.0673296-0.133808im      -0.058024-0.508062im      -0.0111737+0.0532726im   -0.0210825+0.1144im        -0.225022-0.207028im      0.0711353+0.0679691im     0.0176738+0.0896984im     0.22966-0.0913317im      0.178674+0.0148874im    -0.0848348-0.0386821im    -0.169081+0.11057im       0.0712238-0.133463im     -0.143006-0.180247im      0.0654876+0.00739775im   -0.0137475-0.177076im     -0.0787074+0.0396138im      0.149044-0.00725487im    0.173393+0.025315im     0.0476727+0.081819im     -0.0985751+0.0491746im     -0.056104+0.0170105im     0.0158805-0.0951384im     0.0610634-0.128736im      -0.164657-0.0812085im   0.000335453+0.0132328im      0.224131-0.0400695im      0.0713728-0.0309153im     0.0662285+0.199307im      -0.137353+0.141449im      0.0986022+0.0513418im    0.114832-0.119218im
 -0.0375946+0.135227im       0.208509-0.0434743im    -0.0562806-0.00823767im    -0.0595902-0.334475im     0.0710662-0.0774335im     0.0324697-0.0391193im     -0.162747-0.203527im      -0.165653+0.0239202im    0.215383-0.0445879im     0.0163158-0.104097im     -0.0797268+0.026666im    -0.0389717-0.171976im       0.184352+0.0309181im   -0.0241411+0.11432im       0.0489128-0.0188392im     -0.212618-0.0416293im     0.0984155-0.0192534im     0.0900836+0.246776im     0.0267228-0.216573im     -0.183695+0.00593273im     0.120977+0.253146im      0.0511343+0.0437263im    -0.0866963-0.109062im        0.10254-0.0162908im    -0.0453617-0.12966im        0.017087-0.281695im     -0.0763191-0.145438im      0.00869764-0.0841148im     -0.136265-0.168466im       0.100086-0.00935417im    0.0557159-0.0189904im     0.20268+0.0515353im
 -0.0685988-0.101072im      0.0736221+0.0242404im     0.0931632-0.047014im       -0.107098-0.015526im     0.0467699-0.146593im       0.153328+0.148372im      0.0341654+0.270225im      0.0768347+0.153076im    -0.121569-0.192867im     -0.0915331+0.0344001im     0.0735787-0.0743425im   -0.0340067-0.0864429im      0.215774+0.0124084im   -0.0292571+0.0158013im     0.0384738+0.0965963im     -0.102181+0.0973558im     -0.218326+0.111687im      0.0273951+0.32834im        0.11393-0.117184im      0.157535+0.0109344im     0.0854424-0.0567663im     -0.060085+0.275683im      -0.123247+0.0752212im     -0.229685-0.0719977im     -0.112662-0.00943691im     0.168077+0.0464001im      0.166334+0.101021im      -0.0859021-0.0127021im      0.219119+0.020475im      0.0617889+0.0177573im     0.0513589-0.0363043im  -0.0266851+0.298312im
   0.097533+0.369922im    -0.00150318+0.0667791im     -0.200953+0.027453im        0.117223+0.126437im      0.146636-0.0482533im     0.0598941-0.130675im     -0.0542077-0.00848972im    -0.113278+0.160838im   0.00638369+0.020212im     0.00520628-0.0358924im     -0.172792+0.0165063im   -0.0703726+0.157696im     -0.0969044+0.0664261im   0.00891719-0.0756112im     -0.204398+0.0878884im    -0.0223073-0.0600393im    -0.0726884-0.079835im      0.0206437+0.207035im     0.0922793-0.0345198im    0.0300884-0.0975316im    -0.0871473-0.199183im       0.293795-0.148344im      0.0853523-0.0862849im      -0.20402+0.104627im     -0.0890595-0.114808im       0.078204-0.0307955im     0.0460224+0.0399417im      -0.144227-0.07946im      -0.0663949+0.166624im       0.106084-0.297293im       0.181815-0.0857276im   -0.167314+0.00441184im
  0.0806266-0.0442175im     0.0154276+0.0291902im      0.110342-0.065021im      -0.0446557+0.031553im   -0.00362913-0.140103im      -0.136977-0.0491651im    -0.0212979-0.219466im      0.0327885+0.0613311im   0.0421465-0.0886335im     -0.206796-0.124975im      0.0215764-0.115858im     0.0625456+0.160652im       0.136225+0.143226im      0.136918+0.128371im       0.183307+0.251806im        0.12334+0.0152654im      0.147054-0.0729594im     -0.086569-0.0676204im   -0.0115161-0.246187im     0.0533312-0.0609575im     -0.254508-0.150012im     -0.0352929+0.175424im      0.0614378-0.0955822im     -0.113446-0.0807561im      0.245517+0.136133im       0.035849-0.14575im       0.0872434+0.18279im        -0.148348-0.151234im     -0.0071187+0.133055im       0.127109+0.042434im     -0.0828489+0.0143254im    0.159326-0.25512im
 0.00338336-0.269103im     -0.0482268-0.00119613im    -0.104521+0.130164im      -0.0766855-0.292391im     -0.110951+0.0112508im     0.0400556+0.028331im     0.00590701+0.00868328im    -0.177181-0.144772im     0.178036-0.0207746im     0.0180657+0.0569142im    -0.0110649-0.234075im     -0.122055+0.0594738im     -0.149956+0.110101im      0.075486+0.0343132im   -0.00338175+0.0722841im      0.176366-0.1047im         0.116042+0.200259im       0.217044+0.183582im    -0.0354691+0.143907im     -0.206103+0.0110414im     -0.065332-0.0535093im      0.117197-0.132112im     -0.0303713+0.0517791im    -0.0991162-0.252124im     -0.0788533+0.0802908im     0.0763743+0.0844696im   -0.00855246+0.132613im       -0.180083+0.241515im        0.15902-0.0412378im      0.085195+0.0309913im      0.157949-0.041422im   -0.0699129-0.160614im
 -0.0848813+0.0527656im    -0.0154303-0.189569im     -0.0886613+0.0369397im      0.0457055-0.214247im    0.00824344-0.0295156im     0.0996738-0.0162238im    -0.0538826-0.0848716im     0.0196244-0.0188968im   -0.228096-0.195012im      0.0578009+0.093257im      -0.163585-0.0825514im    0.0406616+0.283603im     -0.0113156-0.10762im       0.152581+0.0208032im     -0.074669+0.0577933im    0.00454116-0.255792im      0.0135684+0.0714377im     -0.176088-0.12267im     -0.0970949+0.0416725im     0.101065+0.135959im      0.0856914-0.03272im       0.0969587-0.00848068im   -0.0650308-0.150553im       0.207473+0.0462573im      0.144939-0.0668636im     -0.050186-0.00417702im   -0.0190763+0.170806im      -0.0679936+0.154727im      0.0116428+0.218885im       0.014617+0.162932im      0.0730328-0.0475743im    0.233863+0.377766im
  -0.179926-0.0598312im      0.144474+0.112962im       -0.10257-0.19833im         0.145842+0.0581851im   -0.0626838+0.128442im       0.013466-0.104229im     0.00613204+0.034554im     -0.0904377+0.132771im    -0.193655+0.220355im     -0.0236275-0.267594im     -0.0146426+0.10389im      0.0459473+0.0438119im      0.063916+0.168008im      0.146253+0.027502im      -0.160522+0.177023im       0.147854-0.159035im      -0.211989-0.0159275im     0.0910564-0.059914im     -0.160648+0.0257097im    -0.115129+0.113784im      0.0598024+0.165785im      -0.063865+0.183256im      -0.127596+0.21541im      -0.0300327-0.0951872im     0.0782722-0.00799113im   -0.0918164-0.0248952im     -0.246617-0.0179471im     -0.0130475-0.0425104im      0.194864+0.00757957im   -0.0815121-0.149124im       0.109007-0.20666im      0.102144-0.063301im
  0.0641641-0.105027im       0.145635+0.0436426im     0.0181534+0.0759983im     -0.0248256+0.32523im       0.166856-0.0948597im    -0.0129688+0.0373462im    -0.0515595-0.0572285im     -0.116385-0.0657021im  -0.0237824+0.0389486im     0.0804941+0.0830194im    -0.0497755-0.28197im       0.157177-0.0367971im     0.0349482-0.0235401im    -0.164627-0.0195689im     0.0295895-0.0626388im     -0.177871-0.0573099im     -0.202093+0.098492im       0.194499+0.0541442im    -0.191879+0.0373201im     0.186647-0.033997im     -0.0107403+0.176437im       0.104534-0.11173im      -0.0947656+0.054591im       0.196352+0.0460131im      0.102929+0.150712im        0.19239-0.0819459im     -0.108067+0.331162im        0.128279-0.117181im      -0.115955+0.0461939im     0.0224329+0.126907im        0.14617-0.139037im   -0.0166501-0.141544im
  0.0921461-0.0385751im    -0.0961162-0.0594543im      0.113858+0.171972im       -0.200445-0.0307913im   -0.0398885+0.210737im       0.116956+0.0248459im      0.154908-0.249606im     -0.0182808+0.186857im   -2.4838e-5+0.0943688im     0.0325056+0.02641im        0.160517+0.239951im     -0.226598-0.0428559im      0.135616+0.008512im    -0.0198536+0.00367324im    -0.190924-0.103477im      0.0639814-0.14408im       -0.127012+0.0600627im    -0.0415807+0.00629012im  -0.0153255-0.0647247im    0.0775213+0.0422585im     -0.124531-0.0976769im      0.141569+0.0808111im     -0.132902-0.0417447im      0.279946+0.019643im      0.0640645+0.0327775im     -0.118792-0.118428im       0.268161-0.0148018im     -0.0699829-0.124929im       0.121208-0.102897im      0.0670446+0.145822im      0.0987352-0.213002im    -0.228782-0.075566im
 -0.0387816-0.022698im     0.00959827-0.148446im      0.0120507+0.137581im         0.13142+0.0911091im     0.256861-0.00929992im     0.142225+0.00855493im   -0.0511336-0.0849642im      0.156873-0.166727im     0.181738+0.0518614im     0.0574981-0.0899448im      0.209389-0.0626227im    0.0490221+0.10886im       0.0452412-0.0758804im     0.173423+0.18062im        0.174271-0.165284im       0.145821-0.117062im      -0.078053-0.320838im       0.193773-0.00686411im    0.252285+0.13872im      0.0436033-0.192293im       0.171979-0.158593im     -0.0527517+0.0155073im     -0.216812-0.0530336im     -0.108736-0.003715im     0.00785373-0.0829553im    -0.0976594-0.139714im      0.0476872+0.0180917im       0.128043+0.070028im        0.13931+0.0232785im     -0.112092-0.0369778im      0.111663-0.105917im    0.0682854-0.0193142im
  -0.185716+0.0531692im     -0.116977+0.204161im      -0.105016+0.165174im       0.0603582+0.190478im    -0.0807555-0.123146im       0.182352+0.135687im     -0.0353884+0.202424im     0.00942246-0.0115329im     0.25048-0.0877813im    -0.0456361-0.000642043im    0.109205+0.188518im      0.100019+0.0936188im     -0.129504+0.172959im     -0.049492-0.268369im       0.105415-0.0589423im      0.170557-0.0803098im      0.092893+0.255107im    -0.00036391+0.0546405im    0.0207063-0.0819931im    0.0814736+0.0393816im    -0.0330319+0.0981327im   -0.00758336+0.146008im     -0.0581802+0.0169066im     0.0558882-0.0905791im    0.00845978-0.0428353im     -0.157037-0.172014im       0.106276-0.0733937im     -0.0676729+0.0313215im     -0.319278+0.122009im      -0.134795+0.0662638im     0.0922683-0.111997im     0.157767-0.019399im
  -0.128355-0.00514409im    -0.165374-0.112735im         0.1377-0.0639083im       0.132464+0.046193im     -0.183116-0.0909303im      0.114062-0.047879im      0.0118277-0.211617im       0.117263-0.100638im   -0.0996238-0.0231884im      -0.28135+0.00230054im    0.0634154-0.143839im    -0.0609229+0.150566im      -0.089683+0.05781im     -0.0624276-0.124527im     -0.0533492-0.113997im      -0.103083-0.0499244im      0.104507-0.137195im     -0.0569918+0.160992im    -0.0473045+0.0553539im    0.0942228+0.245489im       0.195188+0.0986222im     -0.244764-0.162445im       0.108212-0.0267983im     0.0474661+0.056336im      -0.203058-0.00650898im     0.208746-0.0958716im     0.0570591-0.0410197im      -0.243443-0.199326im       0.106725-0.102269im      -0.124612-0.0743425im     0.0782419-0.149843im    0.0290401-0.136801im
  0.0651364-0.131068im      0.0295771-0.359974im    -0.00682638+0.121667im       -0.159879+0.132973im     0.0751181+0.0422759im    0.00219781-0.0216965im      0.166123+0.16682im        0.056815-0.150806im    -0.139749+0.115817im      -0.125156-0.0252973im    -0.0603895-0.0444455im     0.205614-0.0667491im    -0.0154539+0.177009im      0.141815-0.0245198im    -0.0881407+0.170875im    -0.00302808-0.175251im      -0.100994-0.114155im      0.0904685+0.0352857im     0.199013-0.0265392im    -0.104709+0.0107161im     0.0798799+0.129669im       0.114767+0.0491154im      0.239649+0.0700093im      0.143849-0.101381im      -0.101856+0.0321289im     0.0397786-0.213909im      0.0415248-0.23857im        -0.113593+0.00935711im    -0.145853+0.198473im       0.120947+0.101671im     -0.0965529+0.153734im    -0.116946+0.0195258im
 0.00540405-0.25454im        -0.13526-0.016429im      -0.115049+0.166301im        0.215139+0.0223472im    -0.144425+0.0844643im     -0.135703-0.208946im       0.162724-0.0423258im    0.00529482+0.111511im    0.0999142-0.192119im      0.0335938+0.0167314im    -0.0780102-0.0441092im  -0.00375879-0.0147236im     -0.140535+0.144831im    -0.0199601+0.107318im       0.120032+0.144609im      -0.185795-0.0878725im    -0.0382544-0.221819im      0.0845215+0.210899im     -0.116595+0.051199im      0.113784+0.0295057im     0.0607728-0.0861971im     0.0480756+0.136616im     -0.0373686+0.197941im       0.111352+0.075723im       0.104039-0.0215423im     -0.218433+0.153157im       0.172733+0.0315692im      0.0658424-0.142332im      -0.164313-0.191656im     0.00316765-0.150144im      0.0698838+0.202717im    0.0620573+0.119344im
  0.0980645+0.156477im       0.109889-0.15448im       0.0398812+0.0238227im      0.0312837+0.155857im      0.148412-0.00820541im      0.22162-0.155654im      -0.164992-0.101951im      -0.196477-0.0873662im  0.00920126-0.167585im       0.128897+0.0174598im     -0.142771+0.111183im      0.216401+0.0457869im       0.10315+0.152027im     0.0309123+0.105285im       0.258782-0.0186464im       0.24864+0.12515im      -0.0222646+0.171812im       -0.04906-0.0128191im   -0.0544361+0.161635im     0.0682429+0.230706im     -0.0617912-0.00159286im    0.0649403+0.0635873im     0.0477458-0.0142617im     0.0942611-0.0899017im     -0.229115+0.155667im     -0.0646456+0.174382im      0.0407428-0.126472im       -0.066073-0.179678im       0.192693-0.178808im     -0.0252751-0.0261168im   -0.00725744+0.131739im   -0.0316351+0.0186397im
 -0.0342723+0.0111948im     -0.160474+0.126365im     -0.0831276-0.0350224im      -0.118796-0.142552im      0.246866-0.0234532im      0.182366-0.13351im        0.189965+0.188836im     -0.0904706+0.15048im     -0.142435+0.116051im      0.0666052-0.100792im     0.00529268-0.247748im     0.0460538+0.147127im     0.00531301-0.0670556im   -0.0357062+0.0654034im      0.164751-0.138629im     -0.0751451+0.168195im       0.140256-0.0931302im    -0.0684866+0.00318883im   0.0864782-0.221922im    -0.0550997-0.0303631im   -0.00998171+0.147056im      0.0521175+0.0104563im      0.148231+0.0157589im      0.256203-0.175625im      0.0862978-0.0197515im     -0.163181-0.0178507im     0.0384238+0.138543im      -0.0998266+0.00863928im    0.0810758-0.0278257im     -0.349705-0.122102im      0.0385622+0.0309258im   -0.157943-0.0306506im
  -0.113255+0.0995177im     0.0239067+0.14318im       0.0527516-0.000815459im   0.00681364+0.072738im     -0.173721+0.233352im      -0.206348+0.000875992im  -0.0699249-0.00173422im    -0.139023+0.12647im     0.0144761-0.171771im     -0.0792168-0.0493134im      0.176439-0.119723im       0.21279-0.0993386im    -0.0623465-0.150377im      0.222723+0.0165434im     0.0096293+0.220097im       0.255114+0.0800514im     0.0398249+0.0732764im    0.00709461-0.00997814im   0.0885876-0.215714im      0.170258-0.163301im       0.226292+0.0374194im     0.0193754-0.253604im      0.0988623+0.0359947im       0.18553+0.0936711im     -0.191947-0.106522im     -0.0353092-0.104114im       0.047482+0.062559im       0.0717519+0.0225158im      0.138851-0.0875993im     0.0622534+0.0952644im      0.184848+0.0615926im  -0.0679845+0.0437784im
    -0.2889-0.211983im       0.196554-0.0217499im    -0.0974184+0.102838im       0.0165012+0.131476im    -0.0511372+0.00250132im    -0.121793-0.0589455im     -0.208615+0.134779im     -0.0776198-0.0677178im   -0.101201+0.13324im       -0.189134-0.00317674im    0.0739268-0.0371328im    0.0277201-0.137475im      0.0448653-0.0690775im    -0.157237+0.212466im      -0.110387-0.0571388im     -0.114268-0.0633478im      0.215163-0.0212955im    -0.0497025-0.0587894im   -0.0400727-0.0135685im   0.00148444+0.131456im      -0.333649-0.343066im       0.110028+0.00261im     -0.00983826-0.150455im       0.044688-0.105989im      -0.244065-0.0864157im    -0.0600885-0.130135im     0.00872614+0.00235557im     0.0674693-0.0802181im     0.0251681+0.00476679im    -0.178653-0.0245777im     0.0758024+0.0161443im   0.0106822+0.124078im
  -0.113025-0.0343261im       0.13032-0.0552841im     -0.225078-0.193357im      -0.0621967-0.011204im     0.0783488+0.0244251im      0.169316-0.134146im      0.0262934-0.0290635im     0.0415052+0.0505068im   0.0741633-0.00432498im     0.166643+0.0297981im       0.34122+0.0640119im      0.22535-0.0673142im     0.0783741+0.151789im      0.161534-0.0357787im    -0.0947215-0.101192im      -0.262331+0.126009im     -0.0379308+0.00728985im   -0.0774244-0.0517068im     -0.16622+0.0376235im    -0.138963-0.0107217im    -0.0512901-0.131282im       -0.21022-0.206775im       0.108784+0.0865276im      -0.10639+0.15275im       0.0391631+0.162009im     -0.0884352-0.0382948im      0.171269+0.0615629im      -0.206346+0.0937752im    -0.0644969+0.0288762im       0.11132+0.1162im          0.23551+0.121698im    0.0461821-0.00058188im
  0.0705695-0.101089im     -0.0796171+0.273823im        0.09942-0.113406im       0.0122176-0.0729666im    0.0843458+0.132463im     -0.0195667-0.044004im       0.128612+0.18736im        0.082157-0.267046im    0.0102172-0.0322071im        0.1448-0.163432im      0.0236548+0.0443387im     0.156371-0.139439im     -0.0998893-0.1541im        0.217441-0.00532696im    0.0290566+0.0941675im    -0.0890671+0.0336874im      0.116972-0.0176819im      0.139796+0.00609745im  -0.0299503+0.123203im    -0.0429516+0.253485im      0.0404104+0.0375697im      0.149295+0.0863856im    -0.0138687-0.37123im      -0.0742171+0.143952im     -0.0437021+0.00444289im   -0.0731078+0.00370619im     0.060521+0.101693im       -0.139538-0.265913im     -0.0591213-0.00460177im     0.122118+0.0313183im     -0.058986-0.265401im   -0.0577288+0.0510936im
   0.162749+0.0170531im     0.0918235-0.046358im     -0.0988004+0.0234911im     -0.0199326+0.0109507im   -0.0815814-0.0426041im     0.0593775-0.0407292im    -0.0533999-0.225688im      -0.109328-0.0523im      -0.259962+0.0532958im     -0.187174+0.140132im       0.126678+0.0395422im   -0.0488829+0.0653894im    -0.0839854+0.0440876im    0.0816486-0.276111im     -0.0570113+0.0505493im     -0.112588+0.126358im       0.186145+0.0442128im      0.298782-0.108582im      0.202366+0.109824im   -0.00971494-0.191203im     -0.0938533+0.21578im      -0.0976396+0.174188im     -0.0219471-0.106249im      -0.136257-0.0972034im    0.00657317-0.102215im      -0.221373+0.0947896im     -0.022415+0.14793im        0.0820567-0.205601im     0.00755909-0.0552108im    -0.0270383+0.113636im       0.175319+0.109368im   -0.0686579+0.166034im
   0.014155+0.050143im      -0.215431-0.133554im      -0.169272+0.00983601im     0.0961252+0.100497im     -0.119703+0.0973899im     0.0740156-0.0641097im      0.110085-0.0155136im     0.0288989-0.141098im   -0.0786424-0.0747345im      0.211139-0.139081im      0.0441322-0.0315704im    -0.116092-0.0593737im      0.269778+0.223309im      0.127715-0.0274988im     0.0394867+0.026339im      0.0100972+0.03554im     -0.00588575-0.034361im     -0.0163245-0.127934im     -0.197401-0.14456im      0.0390729-0.146512im      -0.110282+0.0435851im    -0.0581395-0.0143383im       -0.1642-0.0807753im    -0.0117155-0.141932im      -0.315207-0.29424im        0.208329-0.00682163im   -0.0397917+0.252691im    -0.000628572+0.0923583im     -0.197811-0.109194im     -0.0176993+0.0166356im      -0.20526-0.0201455im  -0.0959802+0.0247056im
   0.195574-0.201451im       0.150493+0.0305805im     0.0186184+0.117651im      0.00895354+0.0883856im   -0.0455778+0.0706101im     -0.083087+0.226632im      0.0141311-0.114037im     -0.0832345+0.0329994im   0.0147456-0.0630579im      0.351462-0.0750079im    -0.0990562-0.113004im    -0.0546849+0.00185979im    0.0373965-0.0135049im     0.052264-0.23229im      -0.0545842-0.129876im     -0.0141951+0.07485im       0.0247642-0.125585im      -0.157823+0.0815669im    0.0645437+0.0353005im       0.1557+0.0319424im    -0.0834083-0.0445787im      0.047056+0.0194382im      0.296229+0.184684im      -0.182875-0.00395167im   -0.0726178-0.106549im      -0.213646-0.260356im      -0.197378+0.00974786im     -0.195141-0.0021613im      0.123541-0.0816428im      -0.09534+0.0759455im    -0.0877534-0.100269im     0.178061+0.0848298im
   0.250639+0.0101802im     0.0937942+0.0966976im     0.0230172+0.0387527im      -0.102337+0.0973229im    -0.246284+0.135082im       0.227184-0.0634044im    -0.0768612+0.229692im      -0.055998-0.121466im     0.150955+0.0252503im     -0.212496-0.289641im      -0.119149-0.10083im      -0.229342+0.0558751im   -0.00224785+0.0634233im    0.0433322+0.0996614im      0.157112+0.0313725im     -0.274152-0.0212698im     -0.124565+0.00690624im    -0.167721-0.251074im    -0.0505926+0.0913443im     0.129763-0.180715im      0.0402323+0.0214781im     0.0314579-0.00593254im    0.0774517-0.122872im    -0.00550924+0.0123499im     0.0808788+0.00447596im    0.0506989+0.0222892im     0.0109111-0.185742im      -0.0477195+0.0814194im     0.0503604-0.0907896im     -0.018905+0.0913885im      0.259269-0.0178397im   0.0509314+0.0435569im
  -0.105099+0.0652404im     0.0732867-0.0973008im    0.00331709+0.101433im       -0.177324-0.125711im    -0.0385042+0.241052im    0.000841187-0.222211im     0.00856407+0.0403055im      0.236439-0.359944im    0.0188532-0.0261373im   -0.00832225-0.0755718im     -0.195733+0.059877im     0.0406407-0.0853827im     0.0672948-0.109194im      -0.26241-0.0895957im     0.0369258+0.0183535im      0.170837-0.0129485im     -0.056589+0.0640976im    -0.0619419+0.0565493im    0.0747076-0.160563im     0.0990285-0.045722im      -0.080642+0.0119002im     -0.157927-0.23253im       -0.139094+0.186728im      -0.162045-0.0648999im      0.201961-0.00123855im    -0.125819-0.0264831im      -0.10163+0.128823im        -0.16385-0.232112im       -0.04231+0.0240673im   -0.00559986-0.0751226im       0.12895+0.0338786im  -0.0775705+0.0968769im
 -0.0445071+0.0798323im    -0.0889815+0.0524055im    0.00858658+0.0402136im     -0.0973238-0.0435372im   0.00154548-0.170153im     -0.0161774+0.126981im       0.270894+0.167473im      -0.172614+0.132282im    0.0442175-0.0588471im    -0.0448605+0.00844376im    0.0703919-0.0612864im      0.18644+0.168224im       0.222095-0.14658im      -0.265198-0.0487484im    -0.0301946+0.106857im       0.118942-0.0852719im     -0.109329-0.123352im        0.11705-0.141327im    -0.0971418+0.320319im    -0.0958106-0.104194im     -0.0710589-0.112971im      -0.116244-0.0856292im    -0.0294853-0.103894im      0.0618335-0.0310757im     0.0326149-0.240271im    -0.00703955-0.0717483im     -0.127275-0.0947925im      -0.202115-0.183707im    -0.00792197-0.225762im       0.167835+0.0320874im      0.028193+0.122219im    0.0964608+0.0157953im
   0.129688+0.044099im      0.0244359-0.130593im       0.142251-0.0888095im      -0.034305-0.0243256im    0.0361676+0.121229im      -0.112144+0.249448im       0.129266+0.000586496im   0.0652255-0.115325im     0.201566-0.0712293im    -0.0880109-0.0230445im    -0.0545024-0.0933442im     0.257246+0.0241849im      0.128362+0.102946im     0.0189594-0.0378624im     -0.449946-0.110594im     -0.0330378+0.0341178im      0.119427+0.102147im      -0.015024-0.132501im    -0.0724956-0.0172299im    0.0888939-0.0664678im     0.0644498+0.0604891im      0.116286+0.11472im      -0.0810134-0.0749036im   -0.00056693-0.114615im    0.000795626+0.0979006im    -0.0242264+0.0445176im      0.159978+0.0723555im      0.0291872+0.0661999im     0.0120326-0.108247im      -0.146806-0.432432im       0.124382+0.089109im     0.134304+0.0126334im
  0.0549884-0.0161679im   0.000134069+0.250979im       -0.23259-0.070013im       0.0303212+0.0363478im  -0.00439095-0.112253im      0.0434686-0.0123512im    -0.0360556+0.054004im      0.0934131-0.218306im   -0.0085375-0.177118im      -0.157131+0.198011im      0.0339157+0.213828im     -0.136591-0.0600846im      0.160968-0.00674522im  -0.0496949+0.0653245im    -0.0745057-0.0297793im     0.0979803-0.00930414im    -0.129388-0.277019im     -0.0121137-0.0949874im      0.15489+0.0044639im   -0.0478109+0.0501527im     -0.053775+0.150527im      0.0950286-0.132025im       0.298286+0.0931952im      0.172727-0.207299im     -0.0220475+0.120111im     -0.0292699-0.00162125im     0.115542+0.213053im        0.093973+0.0594081im     0.0720413-0.130132im       0.211526-0.111458im     -0.0239256-0.154095im     0.188567+0.0627744im
   -0.11921+0.0104421im      0.191201+0.131686im        0.14575+0.267304im        0.138712+0.123345im      0.187055-0.0452233im    -0.0189806-0.164807im     -0.0190417+0.0800352im       0.16443-0.0426543im   0.0307382-0.138423im       0.142899+0.0848307im     -0.119478+0.194471im     -0.140395+0.023422im     -0.0322571-0.176382im     0.0953315-0.208125im      -0.139858+0.164079im      -0.146191-0.0128231im      0.120326-0.0784587im     0.0177986-0.124206im    -0.0143569-0.0885862im    -0.106345-0.0260361im     0.0499423-0.0132825im     -0.054212+0.202984im     -0.0801947-0.00238807im     0.152208-0.0474363im    -0.0143388+0.00623284im     0.197846-0.0423119im    -0.0528861+0.0582952im      -0.227861+0.13733im        0.171564-0.138059im     -0.0247441+0.0457223im      0.120987+0.256825im   -0.0386241-0.212782im</code></pre><p>and then generate the state <span>$ψ$</span></p><pre><code class="language-julia hljs">psi = P[:, 3]</code></pre><pre><code class="nohighlight hljs">32-element Vector{ComplexF64}:
  -0.11730284775316896 - 0.029842704923908843im
  -0.21203649687322204 + 0.0007150931301060787im
  -0.29659233763389176 + 0.01250174050527525im
   0.19621926980582477 + 0.06291864539805543im
  -0.09202485835174826 - 0.1567267729758094im
  -0.10521477794904241 + 0.14997351094975292im
   0.03345982480116189 - 0.039810622041603794im
   0.10668618135270196 - 0.07772267595561012im
  -0.03717821283115207 + 0.1176930293732798im
   0.08721920302557837 + 0.07273572899914979im
   -0.0778698665208735 - 0.0314347270019085im
   0.14203769428674745 + 0.00247898372925396im
  -0.07244701570874854 - 0.0032381682198102633im
  -0.03924182549601331 - 0.054764808054206256im
  -0.07280158285764642 + 0.10686092056968964im
 -0.039299374549183905 - 0.0026259188451640443im
  -0.04444157568249865 + 0.1467768322289531im
  -0.06044500328472205 - 0.16731148230359777im
  -0.05997115981820013 + 0.14228834179449792im
  -0.08237373103875885 + 0.2636638786982636im
 -0.052051677681228314 + 0.03451579429857576im
 -0.036419446100522376 + 0.22099618085286898im
    0.3739420990300563 + 0.0im
   0.08339908620652443 - 0.10485047033502662im
    0.0875453965776591 - 0.026134664207145376im
   -0.0796786098775994 + 0.2143947278342299im
  -0.11874564325226904 + 0.004413004109986227im
  0.009387901165476442 + 0.14962481507931066im
   0.22220979497087062 + 0.03723536660869255im
   0.01175994902537461 - 0.21360545247996457im
   0.15628907586376684 + 0.18495179312250629im
    0.0839278400082684 - 0.11413954378689894im</code></pre><p>In the phase estimation process, we will feed the state to circuit and measure the first <code>n</code> qubits processed by iQFT.</p><pre><code class="language-julia hljs">r = join(ArrayReg(psi), zero_state(N))
r |&gt; PE(N, M, U)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qudits: 8/8
    nlevel: 2</code></pre><p>Since our phase can be represented by 3 qubits precisely, we only need to measure once</p><pre><code class="language-julia hljs">results = measure(r, 1:N; nshots=1)</code></pre><pre><code class="nohighlight hljs">1-element Vector{BitBasis.BitStr64{3}}:
 011 ₍₂₎</code></pre><p>Recall that our QFT&#39;s bit numbering is reversed, let&#39;s reverse it back</p><pre><code class="language-julia hljs">using BitBasis
estimated_phase = bfloat(results[]; nbits=N)</code></pre><pre><code class="nohighlight hljs">0.75</code></pre><p>the phase is exactly <code>0.75</code>!</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../1.prepare-ghz-state/index.html">« Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a><a class="docs-footer-nextpage" href="../3.grover-search/index.html">Grover Search »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.15 on <span class="colophon-date" title="Wednesday 13 April 2022 19:13">Wednesday 13 April 2022</span>. Using Julia version 1.7.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
