<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quantum Fourier Transformation and Phase Estimation · Documentation | Yao</title><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/indigo.css" rel="stylesheet" type="text/css"/><link href="https://yaoquantum.org/assets/favicon-light.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../index.html"><img src="../../../assets/logo.png" alt="Documentation | Yao logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../index.html">Documentation | Yao</a></span></div><form class="docs-search" action="../../../search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../index.html">Home</a></li><li><span class="tocitem">Quick Start</span><ul><li><a class="tocitem" href="../1.prepare-ghz-state/index.html">Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a></li><li class="is-active"><a class="tocitem" href="index.html">Quantum Fourier Transformation and Phase Estimation</a><ul class="internal"><li><a class="tocitem" href="#Quantum-Fourier-Transformation"><span>Quantum Fourier Transformation</span></a></li><li><a class="tocitem" href="#Wrap-QFT-to-an-external-block"><span>Wrap QFT to an external block</span></a></li><li><a class="tocitem" href="#Phase-Estimation"><span>Phase Estimation</span></a></li></ul></li><li><a class="tocitem" href="../3.grover-search/index.html">Grover Search</a></li><li><a class="tocitem" href="../4.shor-algorithm/index.html">Shor&#39;s Algorithm</a></li><li><a class="tocitem" href="../5.shor-9-code/index.html">Shor&#39;s 9 qubit code</a></li><li><a class="tocitem" href="../6.quantum-circuit-born-machine/index.html">Quantum Circuit Born Machine</a></li><li><a class="tocitem" href="../7.variation-quantum-eigen-solver/index.html">Variational Quantum Eigen Solver</a></li></ul></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../../man/array_registers.html">Array Registers</a></li><li><a class="tocitem" href="../../../man/symbolic.html">Symbolic Computation</a></li><li><a class="tocitem" href="../../../man/blocks.html">Blocks</a></li><li><a class="tocitem" href="../../../man/automatic_differentiation.html">Automatic Differentiation</a></li><li><a class="tocitem" href="../../../man/simplification.html">Simplification</a></li><li><a class="tocitem" href="../../../man/base.html">Base</a></li><li><a class="tocitem" href="../../../man/registers.html">Abstract Registers</a></li><li><a class="tocitem" href="../../../man/bitbasis.html">BitBasis</a></li><li><a class="tocitem" href="../../../man/extending_blocks.html">Extending Blocks</a></li></ul></li><li><a class="tocitem" href="../../../benchmarks.html">Benchmark</a></li><li><a class="tocitem" href="../../../dev/index.html">Developer Notes</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Quick Start</a></li><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/QuantumBFS/Yao.jl/blob/master/docs/src/quick-start/2.qft-phase-estimation/main.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><p><a href="https://mybinder.org/v2/gh/QuantumBFS/Yao.jl/gh-pages?filepath=dev/generated/quick-start/2.qft-phase-estimation/main.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a> <a href="https://nbviewer.jupyter.org/github/QuantumBFS/Yao.jl/blob/gh-pages/dev/generated/quick-start/2.qft-phase-estimation/main.ipynb"><img src="https://img.shields.io/badge/show-nbviewer-579ACA.svg" alt/></a> <a href="https://minhaskamal.github.io/DownGit/#/home?url=https://github.com/QuantumBFS/tutorials/tree/gh-pages/dev/generated/quick-start/2.qft-phase-estimation"><img src="https://img.shields.io/badge/download-project-orange" alt/></a></p><h1 id="example-qft"><a class="docs-heading-anchor" href="#example-qft">Quantum Fourier Transformation and Phase Estimation</a><a id="example-qft-1"></a><a class="docs-heading-anchor-permalink" href="#example-qft" title="Permalink"></a></h1><p>Let&#39;s use Yao first</p><pre><code class="language-julia hljs">using Yao</code></pre><h2 id="Quantum-Fourier-Transformation"><a class="docs-heading-anchor" href="#Quantum-Fourier-Transformation">Quantum Fourier Transformation</a><a id="Quantum-Fourier-Transformation-1"></a><a class="docs-heading-anchor-permalink" href="#Quantum-Fourier-Transformation" title="Permalink"></a></h2><p>The Quantum Fourier Transformation (QFT) circuit is to repeat two kinds of blocks repeatly:</p><p><img src="assets/qft.png" alt="qft-circuit"/></p><p>The basic building block control phase shift gate is defined as</p><p class="math-container">\[R(k)=\begin{bmatrix}
1 &amp; 0\\
0 &amp; \exp\left(\frac{2\pi i}{2^k}\right)
\end{bmatrix}\]</p><p>Let&#39;s define block <code>A</code> and block <code>B</code>, block <code>A</code> is actually a control block.</p><pre><code class="language-julia hljs">A(i, j) = control(i, j=&gt;shift(2π/(1&lt;&lt;(i-j+1))))</code></pre><pre><code class="nohighlight hljs">A (generic function with 1 method)</code></pre><p>Once you construct the blockl you can inspect its matrix using <code>mat</code> function. Let&#39;s construct the circuit in dash box A, and see the matrix of <span>$R_4$</span> gate.</p><pre><code class="language-julia hljs">R4 = A(4, 1)</code></pre><pre><code class="nohighlight hljs">(n -&gt; control(n, 4, 1 =&gt; shift(0.39269908169872414)))</code></pre><p>If you have read about <a href="generated/quick-start/2.qft-phase-estimation/@ref example-ghz">preparing GHZ state</a>, you probably know that in Yao, we could just leave the number of qubits, and it will be evaluated when possible.</p><pre><code class="language-julia hljs">R4(5)</code></pre><pre><code class="nohighlight hljs">nqubits: 5
control(4)
└─ (1,) shift(0.39269908169872414)</code></pre><p>its matrix will be</p><pre><code class="language-julia hljs">mat(R4(5))</code></pre><pre><code class="nohighlight hljs">32×32 LinearAlgebra.Diagonal{ComplexF64, Vector{ComplexF64}}:
 1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im</code></pre><p>Then we repeat this control block over and over on different qubits, and put a Hadamard gate to <code>i</code>th qubit to construct <code>i</code>-th <code>B</code> block.</p><pre><code class="language-julia hljs">B(n, k) = chain(n, j==k ? put(k=&gt;H) : A(j, k) for j in k:n)</code></pre><pre><code class="nohighlight hljs">B (generic function with 1 method)</code></pre><p>We need to input the total number of qubits <code>n</code> here because we have to iterate through from <code>k</code>-th location to the last.</p><p>Now, let&#39;s construct the circuit by chaining all the <code>B</code> blocks together</p><pre><code class="language-julia hljs">qft(n) = chain(B(n, k) for k in 1:n)
qft(4)</code></pre><pre><code class="nohighlight hljs">nqubits: 4
chain
├─ chain
│  ├─ put on (1)
│  │  └─ H
│  ├─ control(2)
│  │  └─ (1,) shift(1.5707963267948966)
│  ├─ control(3)
│  │  └─ (1,) shift(0.7853981633974483)
│  └─ control(4)
│     └─ (1,) shift(0.39269908169872414)
├─ chain
│  ├─ put on (2)
│  │  └─ H
│  ├─ control(3)
│  │  └─ (2,) shift(1.5707963267948966)
│  └─ control(4)
│     └─ (2,) shift(0.7853981633974483)
├─ chain
│  ├─ put on (3)
│  │  └─ H
│  └─ control(4)
│     └─ (3,) shift(1.5707963267948966)
└─ chain
   └─ put on (4)
      └─ H
</code></pre><h2 id="Wrap-QFT-to-an-external-block"><a class="docs-heading-anchor" href="#Wrap-QFT-to-an-external-block">Wrap QFT to an external block</a><a id="Wrap-QFT-to-an-external-block-1"></a><a class="docs-heading-anchor-permalink" href="#Wrap-QFT-to-an-external-block" title="Permalink"></a></h2><p>In most cases, <code>function</code>s are enough to wrap quantum circuits, like <code>A</code> and <code>B</code> we defined above, but sometimes, we need to dispatch specialized methods on certain kinds of quantum circuit, or we want to define an external block to export, thus, it&#39;s useful to be able to wrap circuit to custom blocks.</p><p>First, we define a new type as subtype of <code>PrimitiveBlock</code> since we are not going to use the subblocks of <code>QFT</code>, if you need to use its subblocks, it&#39;d be better to define it under <code>CompositeBlock</code>.</p><pre><code class="language-julia hljs">struct QFT &lt;: PrimitiveBlock{2}
    n::Int
end

YaoBlocks.nqudits(q::QFT) = q.n</code></pre><p>Now, let&#39;s define its circuit</p><pre><code class="language-julia hljs">circuit(q::QFT) = qft(q.n)</code></pre><pre><code class="nohighlight hljs">circuit (generic function with 1 method)</code></pre><p>And forward <code>mat</code> to its circuit&#39;s matrix</p><pre><code class="language-julia hljs">YaoBlocks.mat(::Type{T}, x::QFT) where T = mat(T, circuit(x))</code></pre><p>You may notice, it is a little ugly to print <code>QFT</code> at the moment, this is because we print the type summary by default, you can define your own printing by overloading <code>print_block</code></p><pre><code class="language-julia hljs">YaoBlocks.print_block(io::IO, x::QFT) = print(io, &quot;QFT($(x.n))&quot;)</code></pre><p>Since it is possible to use FFT to simulate the results of QFT (like cheating), we could define our custom <code>apply!</code> method:</p><pre><code class="language-julia hljs">using FFTW, LinearAlgebra

function YaoBlocks.apply!(r::ArrayReg, x::QFT)
    α = sqrt(length(statevec(r)))
    invorder!(r)
    lmul!(α, ifft!(statevec(r)))
    return r
end</code></pre><p>Now let&#39;s check if our <code>apply!</code> method is correct:</p><pre><code class="language-julia hljs">r = rand_state(5)
r1 = r |&gt; copy |&gt; QFT(5)
r2 = r |&gt; copy |&gt; circuit(QFT(5))
r1 ≈ r2</code></pre><pre><code class="nohighlight hljs">true</code></pre><p>We can get iQFT (inverse QFT) directly by calling <code>adjoint</code></p><pre><code class="language-julia hljs">QFT(5)&#39;</code></pre><pre><code class="nohighlight hljs"> [†]QFT(5)</code></pre><p>QFT and iQFT are different from FFT and IFFT in three ways,</p><ol><li>they are different by a factor of <span>$\sqrt{2^n}$</span> with <span>$n$</span> the number of qubits.</li><li>the <a href="https://quantumbfs.github.io/BitBasis.jl/stable/tutorial/#Conventions-1">bit numbering</a> will exchange after applying QFT or iQFT.</li><li>due to the convention, QFT is more related to IFFT rather than FFT.</li></ol><h2 id="Phase-Estimation"><a class="docs-heading-anchor" href="#Phase-Estimation">Phase Estimation</a><a id="Phase-Estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Phase-Estimation" title="Permalink"></a></h2><p>Since we have QFT and iQFT blocks we can then use them to realize phase estimation circuit, what we want to realize is the following circuit:</p><p><img src="assets/phaseest.png" alt="phase estimation"/></p><p>First we call Hadamard gates repeatly on first <code>n</code> qubits.</p><pre><code class="language-julia hljs">Hadamards(n) = repeat(H, 1:n)</code></pre><pre><code class="nohighlight hljs">Hadamards (generic function with 1 method)</code></pre><p>Then in dashed box <code>B</code>, we have controlled unitaries:</p><pre><code class="language-julia hljs">ControlU(n, m, U) = chain(n+m, control(k, n+1:n+m=&gt;matblock(U^(2^(k-1)))) for k in 1:n)</code></pre><pre><code class="nohighlight hljs">ControlU (generic function with 1 method)</code></pre><p>each of them is a <code>U</code> of power <span>$2^{(k-1)}$</span>.</p><p>Since we will only apply the qft and Hadamard on first <code>n</code> qubits, we could use <code>Subroutine</code>, which creates a context of a sub-scope of the qubits.</p><pre><code class="language-julia hljs">PE(n, m, U) =
    chain(n+m, # total number of the qubits
        subroutine(Hadamards(n), 1:n), # apply H in local scope
        ControlU(n, m, U),
        subroutine(QFT(n)&#39;, 1:n))</code></pre><pre><code class="nohighlight hljs">PE (generic function with 1 method)</code></pre><p>we use the first <code>n</code> qubits as the output space to store phase <span>$ϕ$</span>, and the other <code>m</code> qubits as the input state which corresponds to an eigenvector of oracle matrix <code>U</code>.</p><p>The subroutine here uses <code>focus!</code> and <code>relax!</code> to manage a local scope of quantum circuit, and only activate the first <code>n</code> qubits while applying the block inside the subroutine context, and the scope will be <code>relax!</code>ed back, after the context. This is equivalent to manually <code>focus!</code> then <code>relax!</code></p><p>fullly activated</p><pre><code class="language-julia hljs">r = rand_state(5)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>first 3 qubits activated</p><pre><code class="language-julia hljs">focus!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 3/5
    nlevel: 2</code></pre><p>relax back to the original</p><pre><code class="language-julia hljs">relax!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>In this way, we will be able to apply small operator directly on the subset of the qubits.</p><p>Details about the algorithm can be found here: <a href="https://en.wikipedia.org/wiki/Quantum_phase_estimation_algorithm">Quantum Phase Estimation Algorithm</a></p><p>Now let&#39;s check the results of our phase estimation.</p><p>First we need to set up a unitary with known phase, we set the phase to be 0.75, which is <code>0.75 * 2^3 == 6 == 0b110</code> .</p><pre><code class="language-julia hljs">N, M = 3, 5
P = eigen(rand_unitary(1&lt;&lt;M)).vectors
θ = Int(0b110) / 1&lt;&lt;N
phases = rand(1&lt;&lt;M)
phases[0b010+1] = θ
U = P * Diagonal(exp.(2π * im * phases)) * P&#39;</code></pre><pre><code class="nohighlight hljs">32×32 Matrix{ComplexF64}:
  -0.0388676+0.0440897im      0.328548-0.0114978im     0.0845621+0.226289im    0.0477137-0.105033im       -0.159769+0.032879im    -0.0484018-0.221805im      -0.107614-0.0973742im      -0.273755+0.118419im      0.133308+0.0151451im       0.165594-0.128756im     -0.0855365-0.0635627im   -0.0272605-0.0980089im   0.0569518-0.0266796im    -0.186818+0.177964im        0.0198916-0.132573im    -0.0751311+0.342121im      0.0812867+0.0589812im     -0.107306-0.041637im     0.0357575-0.00489424im  -0.0357296-0.106911im     0.0891102+0.0755006im    -0.0355915+0.043589im   -0.0540859+0.110805im      0.0359803+0.0742749im      0.0469883+0.0179583im        0.245849-0.0842376im     0.0545815-0.0630056im     -0.217462-0.19706im       -0.111217+0.157393im      0.0466869-0.120127im     -0.0806735-0.182558im      0.0240883+0.0161357im
   -0.165383+0.154106im     0.00400705-0.140303im      -0.093158+0.0116209im   -0.107477+0.10367im        -0.239754-0.164368im    -0.0534469+0.0648061im      0.178236-0.257215im       -0.223008-0.0940514im    -0.128863-0.113903im      -0.0807436-0.162472im      -0.052063+0.0194772im      0.32993+0.0788751im   -0.261865+0.0867668im   -0.0343602-0.124199im       -0.0373051+0.191331im      0.176728-0.00571091im    0.0332667+0.164044im       0.012282-0.157553im    -0.0687753+0.103184im    -0.0169657-0.0279469im    0.0231659-0.13404im       -0.106127-0.0180626im    0.113835+0.00508282im    0.0403484-0.0735234im     -0.0842174-0.0333969im       0.0139421-0.0650792im     0.0695737-0.265392im      0.0538251+0.0959423im      0.138874+0.096467im      0.0963772+0.0831881im     0.0168361-0.204757im     -0.0280309-0.00598949im
     0.22897-0.211789im      0.0243163+0.0232879im    -0.0569195+0.152722im   -0.0109299-0.139158im     -0.00810414-0.108171im      0.168602-0.0871854im     0.0389677+0.142744im      0.00208224-0.00126664im   0.0565263+0.00864545im   -0.00411137+0.152438im     -0.0333073-0.144516im      0.121134-0.0799035im  -0.0731149+0.00460045im   0.0655378-0.207496im         0.130487-0.0663847im      0.15711+0.208719im       0.228361-0.00749201im     0.245057-0.126717im      0.155678-0.0215241im   0.00219099+0.0542707im     0.378571-0.0398563im     -0.135469+0.182457im   -0.0578887-0.0590664im    -0.0775467-0.248145im         0.10308-0.0531482im      -0.0874663-0.0207128im   -0.00401447-0.000754354im    0.134154+0.184122im    -0.00648258+0.0267153im       0.03656-0.0119534im     -0.231091+0.0515594im     0.0939383+0.0797527im
    -0.16844-0.110162im     0.00727126-0.0441525im      0.196162+0.0277755im    0.235909-0.0358707im       0.118969+0.151197im   -0.00978878-0.0683647im     0.0779564-0.0633842im      -0.174138-0.163063im     -0.244569+0.159105im       -0.218439+0.159923im     -0.0165424+0.0744283im    0.0368641+0.0970887im    0.184249+0.0793153im    0.0817943+0.0139239im      0.00541998+0.0538095im    0.0422148+0.0600914im      0.191005+0.104953im       0.169252+0.215377im     -0.182482-0.0382135im   -0.0994403-0.067183im   -0.00541312-0.212483im      -0.108573+0.168465im   -0.0640766+0.158818im      -0.048706-0.104002im    -0.000229632+0.135689im         0.176957+0.0041309im      0.251108+0.128209im      -0.040923-0.0692484im      0.147104-0.14759im       -0.104581-0.0091112im     -0.012954+0.0385109im     -0.159023-0.0735044im
   0.0396506-0.0393857im    -0.0922006+0.134766im      0.0668991+0.189697im    0.0764161-0.112165im         0.26021-0.232444im     0.0196294+0.427724im     -0.0864365+0.0218197im    -0.00491633-0.166226im      0.085922+0.147771im      -0.0729666-0.171696im     -0.0410222+0.19976im       0.203459-0.0453174im  -0.0326162-0.00848617im   0.0737582+0.127371im      0.000746615-0.0662001im    0.0976659+0.0292385im    -0.0300272+0.039202im     -0.0892027+0.0264518im    0.0673756-0.0718425im   -0.0469835-0.226756im    -0.0388018-0.054969im       0.154072+0.137499im    -0.114912-0.0912614im     -0.099086-0.056587im      -0.0390736+0.0381319im       0.0953756-0.21158im       -0.074793-0.0512157im     0.0542523-0.194386im      0.0101648+0.137848im     -0.0848178+0.078678im      0.0713481-0.0141191im      0.290159+0.0106951im
  -0.0279061-0.189378im      0.0286621-0.0953746im     -0.192719+0.169304im     0.129576+0.134604im       0.0424059-0.04637im      -0.170198-0.112515im    -0.00849831+0.0750667im       0.166502-0.223689im      0.157853+0.26657im         -0.14614+0.057222im      -0.107204-0.0502468im    -0.108627-0.198005im   -0.0109764+0.0314587im    -0.155829+0.0464243im       -0.138278+0.0982095im    0.0419548-0.146928im     -0.0890281-0.139818im     -0.0602232-0.171385im     -0.178121+0.150504im     -0.261489+0.0272439im   -0.0345478-0.00322081im     -0.10414-0.0580814im  -0.0115918-0.0579139im     0.0774642-0.00269009im     0.0795636+0.182798im        0.0431584-0.0149145im     0.0295719-0.0128444im     -0.185503+0.168442im     -0.0594502+0.0491786im     0.0467893+0.267724im      -0.186799-0.111546im      0.0965758-0.0858209im
   0.0415833+0.0406755im    -0.0678203+0.0599206im     0.0344833+0.0876969im   0.0013829-0.128788im       0.0180604-0.172326im      0.077647+0.0103703im     -0.113805-0.130886im        0.149176+0.0997717im   -0.0459673-0.000684227im      0.01851-0.138062im      -0.066154+0.114249im    -0.0919484+0.190455im     0.129462+0.206557im    -0.0316392-0.175761im        -0.116617-0.0865854im    -0.063978+0.0573581im      0.209336-0.0420769im     -0.270001-0.153234im    -0.0907432+0.0665769im   -0.0570677-0.088901im      0.246925+0.163251im     -0.0471196+0.105044im       0.1335-0.0761989im   -0.00775965+0.0329584im       0.176969+0.122885im        0.0548817+0.142017im      0.0226731-0.119409im      -0.181028+0.127379im       0.197284-0.160032im      0.0784152+0.0843798im      0.303053+0.222062im     -0.0630463-0.115268im
  -0.0540519-0.0838506im     -0.335836+0.0605529im    -0.0856716+0.1712im      -0.126531-0.0128173im     -0.0809848+0.0759045im    0.0185378+0.126916im      -0.114909-0.0584073im     -0.0785328-0.0839908im    0.0641635-0.14201im        0.0562403+0.0721168im    -0.0730568-0.0229303im    -0.097708+0.0804468im  -0.0779553+0.0190431im    -0.124811+0.125877im        -0.128227+0.111288im    -0.0965336+0.138722im      0.0571567-0.180483im        0.32733+0.0567592im    0.0765077-0.04431im      -0.148971-0.280774im     -0.151764-0.0471693im     -0.173664+0.0260938im   0.0473498+0.150566im     -0.0759192-0.0613583im      0.0452694-0.142984im        -0.147003+0.178165im      -0.190948-0.146579im      -0.206005+0.0472729im    -0.0989617-0.0741383im     -0.156196-0.120403im      0.0721942-0.0533007im     0.0141298-0.160902im
   0.0651463-0.342069im      -0.259047-0.225607im    -0.00734138-0.192141im    -0.183482-0.0278732im     -0.0446384-0.0723912im     0.104174-0.0923473im     -0.116384-0.219582im      0.00631686-0.0504395im    -0.159523-0.0273715im      0.0696197-0.101503im       0.080926+0.0729361im   -0.0957029-0.0931096im    0.179355-0.0600692im    0.0287584+0.131732im         0.132198+0.100419im     0.0975637+0.0249023im     -0.162336+0.111956im     0.00479487+0.0433428im     0.181655+0.116528im     -0.130032+0.0803151im    0.0163826+0.191664im      -0.140782+0.154266im   -0.0144386-0.0758423im     -0.227146+0.220861im      -0.0284488+0.0649068im       0.0309041+0.0538637im      0.284711-0.0266743im     0.0196571-0.0286986im     0.0051666+0.0905146im     0.0306054-0.021128im      0.0217449-0.0931676im      0.162055+0.0332788im
    0.186892-0.0326156im     -0.317932+0.154565im      0.0757097-0.0919179im    0.157601-0.0107395im      -0.213916-0.076021im     0.0651869+0.00927403im    -0.141955+0.125352im      -0.0131757+0.0980502im     0.133659+0.0106987im      0.0407096-0.268393im      -0.284171-0.0171891im   -0.0576794-0.0962009im  -0.0189162+0.0135911im     0.111766-0.168975im        0.0191602+0.141233im    -0.0711094-0.118925im     -0.0363469+0.0631224im      0.028507-0.0567196im    -0.186063+0.189979im      0.192771-0.0636408im    0.0144175-0.219749im      0.0483836-0.0197303im  -0.0192786+0.260948im     -0.0638014+0.0480438im        0.12855+0.0724343im        0.134199-0.0574625im      0.108326+0.176341im     0.00107345+0.0985476im    -0.0718662+0.160791im      -0.103012-0.117093im    -0.00189596-0.105858im      -0.126974+0.0796595im
   -0.205119+0.00572612im    0.0948773+0.0639552im     0.0823435-0.0497678im  -0.0311921-0.131126im       0.0425234-0.0557372im   -0.0856629-0.198301im      -0.153867+0.0311413im       0.134026-0.171093im     -0.105619-0.00785712im     0.0879647-0.0281843im     0.0249796+0.0513396im    0.0404123-0.0328035im   0.0654543+0.336083im     0.0730524-0.0383584im      0.00254125+0.319879im     0.0476383+0.152902im        0.05433-0.0768417im       0.13446+0.018423im    0.00535168-0.0271746im      0.41786+0.146331im     -0.165215+0.0705223im    -0.0268581-0.142262im    -0.188627-0.145231im      -0.120507+0.0147479im       0.203568+0.0180093im    -0.000101637-0.0489463im     -0.187468-0.0651155im      -0.14853+0.00227056im     0.132091+0.110776im      -0.105227+0.0475031im    -0.0403246-0.0356858im      0.112181+0.0577407im
   0.0790444+0.0500988im      0.195229+0.0728973im     -0.149737+0.118592im     0.156234+0.118647im        0.106322+0.149268im     -0.082778-0.00872574im    -0.250354-0.2462im         -0.054902-0.330166im    0.00681406-0.211299im     -0.00333261-0.0668302im     0.0774598+0.00257369im    -0.11088-0.150704im   -0.0966253-0.0440414im     0.187077-0.0560075im       -0.140131-0.0772994im     0.103112-0.0738591im      0.265059+0.0808547im   -0.00837104-0.0320471im     0.120466-0.0162821im    0.0278731+0.0133913im    -0.036837+0.00937763im     0.129776-0.0393426im   0.0591139+0.0688484im     -0.270165+0.146521im       -0.029016-0.15788im         -0.066636-0.119735im       0.129441+0.14903im      -0.0407107+0.263788im       -0.12065-0.0800977im     0.0563194-0.0128733im       0.12989+0.00303921im   -0.0170746+0.057761im
   0.0168877+0.0978764im     -0.078422-0.0822945im      0.120226+0.134252im     0.222486+0.039387im      -0.0640008+0.0607487im   -0.0261057-0.0357816im      0.142991+0.0187896im       0.228962+0.105155im    -0.0216569-0.0952886im       0.108878-0.00370328im     0.162139-0.104041im     0.0834201+0.148281im     0.124506-0.281654im    -0.0762422-0.194433im      -0.00563979+0.204439im     -0.134461-0.121275im      0.0912288+0.103538im       0.015639-0.119755im     -0.021144-0.348939im     -0.149604-0.0474273im    -0.124087+0.00247821im     -0.15779+0.0246205im   0.0864839-0.0982401im     -0.206299+0.109135im        0.236043+0.0109974im       0.0829617-0.257081im     -0.0550396+0.0482618im     0.0295066-0.0149715im     0.0389546+0.0639795im     0.0728544-0.0906792im    -0.0181561-0.095368im       0.176114-0.106281im
    0.113159-0.100206im    -0.00891405-0.0594897im      0.138184+0.203439im   -0.0970423-0.148573im       0.0380547+0.137789im      0.115873-0.0644485im    -0.0343192-0.0613758im      0.0181289-0.05461im      0.0630876+0.0889015im       0.211644+0.00309736im   0.00065838-0.0888036im    -0.138982+0.160098im   -0.0714836-0.0794809im   -0.0890301-0.144237im       -0.0576687-0.117026im       0.15191-0.248086im      0.0406113+0.101575im    -0.00057817+0.0154473im     0.146319+0.201255im      0.136236+0.134862im      -0.13074+0.0820515im     -0.153802+0.0994902im  -0.0423534+0.118899im       0.150097-0.0687764im       -0.18632-0.0385693im       0.0985162-0.181904im      -0.198307+0.0723252im     0.0341953-0.0549631im       0.22185-0.079772im      -0.194891+0.228563im       0.141896-0.261909im     -0.0531207-0.0862199im
    0.208163+0.0582025im     0.0766856-0.0391881im      0.160113+0.0790651im    -0.21308+0.167002im       -0.135232-0.103263im    0.00120158+0.185044im    -0.00561783+0.0497369im      0.0283673-0.239331im     -0.100359+0.0345835im      -0.062075+0.121464im      0.0195298+0.157543im    -0.0630909-0.112946im   -0.0234881-0.116157im    -0.0774493-0.0110788im      -0.0284898-0.245814im     0.0487324-0.0116879im    -0.0197567-0.053288im      0.0862694+0.00788432im  -0.0175303-0.127343im      0.321195+0.039178im     -0.139561+0.077886im     -0.0464965+0.116478im     0.327155-0.142182im    -0.00416497-0.00556383im      0.242332+0.138874im          0.14061+0.0764742im      0.118885-0.0646374im    -0.0246148-0.0161872im     -0.050329+0.134846im     -0.0723231-0.069947im      -0.124307-0.0436549im     -0.244395-0.172951im
    0.033864-0.0776623im      0.182149-0.0269736im     0.0669888-0.0822281im    0.104295-0.0556872im     -0.0730146+0.0182329im      -0.1319+0.09535im       -0.111586-0.0711541im       0.117371-0.0018913im     0.340247-0.248144im      -0.0939895-0.0658524im      0.319838+0.0743269im   -0.0497246-0.0785614im   0.0626734-0.00889141im   -0.109108+0.0572307im       0.0445224+0.227446im     0.0176364-0.176642im        0.10917+0.0866159im      0.174056-0.0419085im    -0.273712-0.0325033im    0.0725383+0.0333028im     0.174977+0.106272im      0.0663494+0.239275im    0.0594766+0.102796im      0.0823881-0.107424im       -0.112058+0.0272914im       0.0773803+0.282422im      -0.032771-0.145644im       0.123029-0.116061im     -0.0279597-0.00925488im    -0.156261+0.0305609im     0.0241018-0.0324847im     0.0960881+0.044727im
   0.0473772-0.0392487im    -0.0318356-0.211503im      -0.127524+0.177474im   -0.0342678+0.0244124im      0.0991958+0.231385im    -0.0119579+0.205703im     -0.0263699+0.119248im        0.079944+0.06894im       0.143833+0.0098544im      0.0779799+0.0510425im      0.164245+0.170769im      0.297123+0.0191591im  -0.0370376+0.111866im     -0.155428-0.0469705im        0.025617-0.0657155im    -0.136088+0.0911257im    -0.0929357+0.00709747im    0.0965073-0.0404268im    0.0706132-0.0188778im   0.00238414+0.116022im      0.163878-0.092616im        0.12219-0.101308im    -0.151863+0.190803im      -0.191702+0.329853im       0.0703573+0.0361929im      -0.0374859+0.107865im       0.084047+0.00705356im   -0.0718183-0.00543006im     0.265843+0.099089im    -0.00135409+0.141507im     -0.0140377-0.0802446im     -0.280135+0.0375924im
   0.0992031+0.0331905im     -0.078241-0.0148809im      0.225673-0.196547im     0.169168+0.0907192im     -0.0492934-0.0743875im    -0.202628+0.00287384im   -0.0211584-0.0653294im      0.0631242-0.0664567im    0.0149556-0.0514309im      0.0491133+0.0853371im     0.0256278-0.0944365im   -0.0804013-0.1618im      0.0953294+0.103417im    -0.0606694-0.123348im         0.157693-0.00996463im  -0.0864713+0.128879im      0.0593288+0.0562584im     0.0816052-0.0548274im      0.32768-0.134141im     -0.129417-0.0536907im     -0.04994-0.207992im      0.0619554+0.0968722im   -0.074871-0.109254im       0.290357-0.0539201im      -0.104666+0.0123717im       -0.127708-0.00040507im    0.0229591-0.00547326im     -0.12793+0.0233104im    -0.0364438+0.309866im      0.0407006+0.269042im       0.282732-0.00491953im    -0.172482-0.0241228im
   0.0777459-0.0347741im    -0.0432263+0.0195563im     -0.163259+0.249316im    -0.161345+0.057103im       0.0155861-0.0911653im    -0.052799-0.00411011im    0.0554446-0.0163096im      0.0138556-0.0562621im    0.0544797-0.121863im        0.176472-0.171514im     -0.0804956+0.0371963im    -0.171583+0.0617179im   0.0633624+0.157416im    -0.0570818-0.0814088im        0.332939+0.156022im      0.218801-0.122284im       0.099308-0.0550629im      0.174376+0.227439im     -0.110844-0.09952im      -0.234444+0.0167749im    0.0124074+0.0578846im      0.165639-0.14915im      0.033564-0.155605im      0.0997006-0.0120764im      0.0434007-0.000407656im      0.070598-0.206024im      0.0598547+0.0210123im    -0.0208017-0.241802im     -0.0272193-0.0823871im     0.0723882-0.0222999im    -0.0515787+0.105258im      -0.281599+0.136105im
   -0.124096+0.0184821im     -0.136265+0.146088im     -0.0755628+0.0757119im    0.280332-0.161832im       -0.175072+0.0933872im   -0.0119443-0.00221078im     0.187505+0.103874im     -0.00771936+0.0320872im    -0.184724+0.0127548im       0.292818+0.041358im       0.153291+0.207731im    -0.0282546-0.131822im    0.0193076-0.0473641im   -0.0923876+0.226222im     -0.000319456-0.0200388im     0.195485-0.0073318im     0.0239598-0.0496541im     0.0396868+0.111591im    -0.0855798+0.076694im      0.185603-0.0761447im     0.286123+0.0135727im   -0.00610938-0.0551782im    0.217006-0.0732957im    -0.0327549+0.0285152im      -0.120671+0.217735im        -0.282616-0.130373im     -0.0166933+0.0548277im    -0.0172353+0.0487168im      -0.10598+0.0439851im     0.0506537+0.108385im       0.112905-0.108298im     0.00221493-0.0851874im
  -0.0964197-0.134702im       0.136413-0.00374563im   -0.0604886-0.019439im   -0.0737441+0.0226328im      0.0293342-0.319077im     -0.182157+0.132507im      0.0459567+0.000583567im    0.0165046+0.0948036im    -0.321286+0.0692552im       0.177004+0.0667674im      0.104771+0.0141659im    -0.100612-0.0408269im  -0.0608415+0.0969256im   -0.0662074-0.0484605im      -0.0142975-0.0919929im    -0.146807-0.125256im       0.107413+0.233943im      -0.104218+0.213087im    -0.0785973+0.0576902im    -0.152429+0.0142859im   0.00952003-0.0644325im   -0.00575853+0.193293im    0.0784249+0.212429im     -0.0432496+0.0671478im       0.199211-0.138203im         -0.08149+0.0721203im     -0.292029+0.122018im     -0.0525513+0.0809371im    -0.0646255+0.11841im        -0.09703+0.0188182im     -0.124574-0.0798781im    -0.0049976+0.248762im
   -0.279217-0.144189im      0.0452408+0.00700861im    0.0124473-0.0981215im   0.0387984-0.161064im      -0.0128759-0.121769im   -0.00528797+0.150645im      -0.286057-0.0740304im       0.206604+0.0526386im    0.0508449+0.127588im       -0.146322+0.154966im     -0.0547461+0.00235815im   0.0366822-0.0114732im  -0.0283468-0.0792959im   -0.0411122+0.0877572im      -0.0504829+0.0505308im     0.149743-0.0964722im     0.0648511+0.088267im      0.0369403-0.224778im       0.10073-0.00475476im  0.00998653-0.0768813im     0.134573+0.022373im      -0.269142-0.246037im     0.131504-0.0421505im   -0.00167663+0.00874261im    -0.0705397-0.198936im        0.0308031-0.0450699im    -0.0579875+0.216028im      0.0135155-0.232762im    0.000387616+0.107206im       0.145597-0.169927im      0.0142587+0.0294863im     -0.321461+0.0257088im
   -0.102442-0.238745im        0.19325-0.144298im      0.0244925+0.0615769im    0.167256+0.0958029im     -0.0868516+0.0656902im     0.129653+0.067562im       0.104527+0.0318827im      0.0179375-0.0470237im    0.0846888-0.0243765im      0.0642039-0.00791713im     -0.34496-0.143433im      0.295755+0.0233399im    0.142119-0.204372im       0.22358+0.0460345im        0.146474+0.0903953im      0.13552-0.0983666im      0.160038-0.0390232im     -0.130254+0.0898827im     0.127073+0.0614949im     0.034785-0.0834325im    -0.135942+0.13778im        0.100965+0.0306492im   0.0898665+0.00399831im    0.0833536+0.12513im         0.148695+0.137308im        -0.206127+0.263156im      -0.125462-0.0839195im     -0.061853-0.0189448im    0.00352455+0.0112047im    -0.0876206-0.0189396im      0.105933+0.00203952im   -0.0691482+0.101896im
 -0.00451673-0.104442im       0.139255+0.015106im      -0.174454+0.0416611im   0.0338683+0.00576125im    -0.0542271+0.0640401im     0.163937+0.252949im     -0.0365293-0.153404im       0.0537483+0.239629im    -0.0978106-0.129192im     -0.00488434+0.00111227im   -0.0901287+0.167651im    -0.0932953+0.0310878im   0.0497439-0.111808im      0.137787-0.12963im        -0.0549577+0.120795im    0.00356465+0.0772925im    -0.0736183-0.130036im     -0.0166936+0.0197466im   -0.0931521-0.0798537im     0.218645+0.0601705im   -0.0710107-0.187186im      -0.176919+0.260251im    -0.191718-0.0508789im      0.151199+0.103625im      -0.0130711-0.142927im       -0.0146447-0.0512643im     0.0618443+0.0166829im     -0.176785-0.1119im        -0.225392-0.11153im        0.215738+0.319454im      -0.142729-0.00955011im  -0.00844429-0.0354339im
  -0.0660048-0.00432793im   -0.0440107-0.111065im     0.00605429-0.0218466im  -0.0890281-0.0614701im       0.143474+0.145687im      0.213703+0.134406im       0.277245-0.119914im      -0.0438776+0.0382757im     0.131191+0.218515im       -0.228131+0.0449314im    -0.0703853-0.0497276im     -0.23021+0.0761842im   0.0323157+0.192668im     -0.140519+0.000924133im      0.198741+0.126513im     0.0467179-0.0158744im     0.0367664+0.185819im      -0.163055-0.0880002im    0.0282289-0.238823im      0.160478+0.0815049im     0.143712-0.0177892im      0.140465-0.063491im     0.088921-0.0179936im    -0.0950873-0.0124145im       0.023604-0.101565im       -0.0348271-0.0228286im    0.00227232-0.0186858im     -0.188024+0.155867im      -0.296807+0.0226899im     -0.171395-0.0546146im     0.0874056-0.207565im      0.0295359+0.0092637im
   0.0213637-0.0582162im      -0.15631-0.151759im      -0.126626-0.0242633im   -0.107705-0.159761im       -0.149977+0.237215im     0.0121728-0.0748025im      -0.12333+0.021326im      -0.0898938-0.17831im      0.0129313+0.00987843im     0.0505756-0.0304059im        0.1646+0.0711534im     0.214457+0.098714im     0.129883+0.2436im        0.191139+0.00445791im      -0.103143-0.145632im     0.0235179+0.00343735im    0.0263889+0.0583099im     -0.144216-0.170694im     -0.116747-0.127608im     -0.100115+0.0629481im     -0.08002+0.0367583im    -0.0342264-0.0197589im   0.0771978+0.149234im       0.265217-0.11113im         0.287959-0.0298516im       -0.114626-0.0865764im   -0.00591327+0.12106im        0.168225-0.164341im      -0.305014+0.106439im      -0.044702+0.104681im      0.0333056+0.0699461im     0.0435485-0.0158309im
    0.199858-0.122466im      -0.068359-0.0285764im     0.0269836+0.248242im    -0.194214-0.26042im        -0.204805-0.0265208im    -0.208241-0.174887im     -0.0919561+0.0709677im      -0.127989+0.0722301im   -0.0352473+0.112974im       -0.144912+0.100464im      -0.046461+0.0476304im     0.058209-0.0175974im   -0.113289-0.223825im     0.0854044+0.152074im        0.0691351+0.125976im     -0.127978+0.00659259im  -0.00878434+0.296268im    -0.00536437-0.0129583im    -0.133167-0.19158im      0.0962017-0.0241216im    -0.115213-0.0845784im     0.0894063-0.102087im    0.0726348-0.145603im     -0.0709555+0.0284715im      -0.127596-0.0185141im       0.0195012+0.120427im     -0.0605712+0.0579967im    -0.0949842+0.0949026im     0.0374514-0.106292im      0.0751779+0.246505im       0.148375+0.177538im      0.0126029+0.153229im
   -0.110451+0.113979im     -0.0236863-0.124703im       0.101026+0.111573im   -0.0620465+0.000130082im   0.00177546+0.0113835im   -0.0280029+0.0294623im    -0.0707917+0.0577159im       0.130818-0.0758392im   -0.0545322-0.0723151im      0.0919797+0.0710484im     -0.230791+0.143868im     -0.137076-0.0707221im    0.288211-0.0613137im    0.0834383-0.164663im        -0.172197-0.0544798im   -0.0955336+0.174047im     -0.0494491+0.357294im      0.0943331-0.206207im      -0.11855+0.14939im     -0.0850589-0.0611247im    0.0450911-0.0106495im       0.24527-0.0281812im  -0.0678892-0.210785im       0.016501-0.0289289im     -0.0932891-0.0412065im       -0.252408+0.0345149im   0.000234843-0.0638222im      0.125749-0.0901764im    -0.0161873-0.189929im      -0.086194-0.0726679im     -0.168038-0.25069im      -0.0315193-0.0155122im
   0.0961274-0.173109im      0.0187733-0.147915im     -0.0951946-0.0135144im   0.0613883+0.0222099im      0.0449025-0.117183im    -0.0143131-0.130767im       0.212715+0.084215im       0.0662152-0.0562327im    0.0116237+0.167173im        0.069028-0.224266im       0.114562+0.239846im     -0.033514-0.0757681im   0.0875762+0.0197108im     0.353145+0.110236im        0.0971465-0.0146721im    -0.309386+0.00740662im     0.201061-0.157839im     -0.0443618-0.135995im     0.0038156-0.0373069im    0.0302486+0.0378134im   -0.0642715-0.0412738im    -0.0742937-0.0111922im   0.0509212+0.0732013im    -0.0786157-0.0878717im      -0.273585-0.182812im        0.0626543-0.0631327im     -0.152385-0.226566im       0.017512+0.00641564im  -0.00167144-0.00760315im    0.0569651-0.121185im     -0.0126029-0.105217im      -0.230322-0.157718im
    0.106801-0.139015im     -0.0264731+0.08207im       -0.178907-0.0190649im   -0.125176-0.140952im       0.0692805-0.0232249im   -0.0964994+0.0414012im      0.209191-0.119369im       -0.162163+0.0414487im    -0.034237-0.130481im      -0.0154947+0.120868im    -0.00480714+0.133868im      0.175797-0.0189751im    0.201374-0.00375303im  -0.0851659+0.00265512im      -0.211259+0.0850901im   -0.0561897-0.165392im       0.128918-0.017404im       0.104972-0.163748im     0.0852196+0.0576858im     0.051651+0.0296303im   -0.0208686+0.0385775im      0.171618+0.0731865im   -0.117927-0.13239im        0.319618+0.1376im        -0.0999591+0.118291im         0.135705-0.0747149im    -0.0629304+0.244551im      -0.175558+0.16937im        0.054995+0.102594im     -0.0218871-0.3523im       -0.0393708+0.0420426im     0.0463919-0.0778124im
  -0.0492276-0.0586049im     -0.135672+0.00119176im  -7.96384e-5+0.118068im     0.226399-0.142435im       -0.151459-0.183909im     -0.166758+0.014471im      0.0451344+0.10457im         0.103466+0.178612im    0.00193443-0.12697im       0.00235193+0.0133844im       0.20129-0.13795im       0.148798+0.081292im   -0.0437443+0.190732im     0.0419187+0.0136966im       0.0351873-0.192761im      0.165156-0.10025im     -0.00586731+0.0283719im     -0.144923+0.0235915im     0.115876+0.0307333im    0.0432019-0.0695655im    -0.214188+0.100572im        0.09137-0.0329852im   -0.148229-0.154747im     -0.0513773-0.0962883im     -0.0363609-0.214673im        0.0972775+0.182604im       0.312855+0.0228553im     -0.159473+0.0666086im     -0.119202-0.17339im       -0.151628-0.00699568im    -0.175647-0.151046im      -0.085593-0.125709im
  -0.0850673-0.214728im       0.161453-0.0163858im    -0.0132894-0.190783im    0.0279309-0.0354865im      0.0677169+0.101752im      0.048432+0.139766im      -0.218413+0.0492062im      -0.158986-0.0410034im      0.12063+0.0352303im       0.291865-0.199489im      0.0474298-0.00845842im    0.160136-0.0437252im    0.059887+0.0155341im    -0.136775-0.221143im         0.117676-0.0778339im   -0.0522499+0.0040587im     -0.150054+0.211567im      -0.012734+0.125917im      -0.05372-0.0357059im   -0.0417073+0.0279812im   -0.0455436-0.221362im      -0.152187-0.144513im     0.173539-0.219873im     -0.0121574-0.0795345im      -0.119862+0.0789026im        0.050109-0.0152015im    -0.0678448-0.0573605im     -0.119866+0.225643im     -0.0613942-0.13131im      -0.0886178-0.0722362im     -0.103475+0.203426im      0.0319487-0.222098im</code></pre><p>and then generate the state <span>$ψ$</span></p><pre><code class="language-julia hljs">psi = P[:, 3]</code></pre><pre><code class="nohighlight hljs">32-element Vector{ComplexF64}:
    0.16817366721786062 + 0.061162506397098214im
     -0.057942711128433 + 0.01152848861086489im
 -0.0013993634438537485 - 0.050968612177713im
    0.18447838898917449 - 0.2374930684597049im
    -0.2015037574285252 + 0.1332134967748682im
     0.3044847417545886 + 0.0im
  -0.019864183940228222 + 0.08273833409728838im
    0.11480967467379083 - 0.048882114228662586im
    0.21005747670785474 + 0.06862654143069968im
    0.12567759942534373 + 0.11976380105902203im
   0.006242433721265735 - 0.12907335640517684im
    0.11828824209638276 + 0.08052224774101564im
    0.15566640320103156 + 0.10406049812384836im
    -0.1235340980086494 + 0.11664115651015142im
   -0.21609351354314835 + 0.14420996972915665im
      0.233020853401457 + 0.08486508500440401im
   0.011866233034514692 - 0.05078591072796447im
    -0.0924899222842685 - 0.009665512578075191im
   -0.06312620454970178 + 0.044474852034028865im
    0.17150408971271808 + 0.2461218160804729im
   -0.03174057786821709 - 0.2231690313259438im
    0.03333866159796085 + 0.10998949166846135im
 -0.0019723330824031175 + 0.18907171105890364im
   -0.09471581587834825 + 0.09637410293416346im
   -0.17583580822443406 - 0.031161153983735746im
   -0.13626130309044984 - 0.03287555457015225im
   0.033648619728623215 - 0.11011991427882778im
   -0.08440390735104163 + 0.17782182386380124im
    -0.0769657399802911 - 0.017777133617477025im
    0.06469553732504084 - 0.0224190119017463im
    0.07058611304335814 + 0.20559726471247633im
   -0.03538060293247757 + 0.01370561685901615im</code></pre><p>In the phase estimation process, we will feed the state to circuit and measure the first <code>n</code> qubits processed by iQFT.</p><pre><code class="language-julia hljs">r = join(ArrayReg(psi), zero_state(N))
r |&gt; PE(N, M, U)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 8/8
    nlevel: 2</code></pre><p>Since our phase can be represented by 3 qubits precisely, we only need to measure once</p><pre><code class="language-julia hljs">results = measure(r, 1:N; nshots=1)</code></pre><pre><code class="nohighlight hljs">1-element Vector{BitBasis.BitStr64{3}}:
 011 ₍₂₎</code></pre><p>Recall that our QFT&#39;s bit numbering is reversed, let&#39;s reverse it back</p><pre><code class="language-julia hljs">using BitBasis
estimated_phase = bfloat(results[]; nbits=N)</code></pre><pre><code class="nohighlight hljs">0.75</code></pre><p>the phase is exactly <code>0.75</code>!</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../1.prepare-ghz-state/index.html">« Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a><a class="docs-footer-nextpage" href="../3.grover-search/index.html">Grover Search »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.15 on <span class="colophon-date" title="Monday 18 April 2022 06:35">Monday 18 April 2022</span>. Using Julia version 1.7.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
