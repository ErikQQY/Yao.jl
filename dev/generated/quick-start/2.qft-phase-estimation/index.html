<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quantum Fourier Transformation and Phase Estimation · Documentation | Yao</title><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.044/juliamono.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/indigo.css" rel="stylesheet" type="text/css"/><link href="https://yaoquantum.org/assets/favicon-light.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../index.html"><img src="../../../assets/logo.png" alt="Documentation | Yao logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../index.html">Documentation | Yao</a></span></div><form class="docs-search" action="../../../search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../index.html">Home</a></li><li><span class="tocitem">Quick Start</span><ul><li><a class="tocitem" href="../1.prepare-ghz-state/index.html">Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a></li><li class="is-active"><a class="tocitem" href="index.html">Quantum Fourier Transformation and Phase Estimation</a><ul class="internal"><li><a class="tocitem" href="#Quantum-Fourier-Transformation"><span>Quantum Fourier Transformation</span></a></li><li><a class="tocitem" href="#Wrap-QFT-to-an-external-block"><span>Wrap QFT to an external block</span></a></li><li><a class="tocitem" href="#Phase-Estimation"><span>Phase Estimation</span></a></li></ul></li><li><a class="tocitem" href="../3.grover-search/index.html">Grover Search</a></li><li><a class="tocitem" href="../4.shor-algorithm/index.html">Shor&#39;s Algorithm</a></li><li><a class="tocitem" href="../5.shor-9-code/index.html">Shor&#39;s 9 qubit code</a></li><li><a class="tocitem" href="../6.quantum-circuit-born-machine/index.html">Quantum Circuit Born Machine</a></li><li><a class="tocitem" href="../7.variation-quantum-eigen-solver/index.html">Variational Quantum Eigen Solver</a></li></ul></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../../man/array_registers.html">Array Registers</a></li><li><a class="tocitem" href="../../../man/symbolic.html">Symbolic Computation</a></li><li><a class="tocitem" href="../../../man/blocks.html">Blocks</a></li><li><a class="tocitem" href="../../../man/automatic_differentiation.html">Automatic Differentiation</a></li><li><a class="tocitem" href="../../../man/simplification.html">Simplification</a></li><li><a class="tocitem" href="../../../man/registers.html">Abstract Registers</a></li><li><a class="tocitem" href="../../../man/bitbasis.html">BitBasis</a></li><li><a class="tocitem" href="../../../man/extending_blocks.html">Extending Blocks</a></li></ul></li><li><a class="tocitem" href="../../../benchmarks.html">Benchmark</a></li><li><a class="tocitem" href="../../../dev/index.html">Developer Notes</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Quick Start</a></li><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/QuantumBFS/Yao.jl/blob/master/docs/src/quick-start/2.qft-phase-estimation/main.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><p><a href="https://mybinder.org/v2/gh/QuantumBFS/Yao.jl/gh-pages?filepath=dev/generated/quick-start/2.qft-phase-estimation/main.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a> <a href="https://nbviewer.jupyter.org/github/QuantumBFS/Yao.jl/blob/gh-pages/dev/generated/quick-start/2.qft-phase-estimation/main.ipynb"><img src="https://img.shields.io/badge/show-nbviewer-579ACA.svg" alt/></a> <a href="https://minhaskamal.github.io/DownGit/#/home?url=https://github.com/QuantumBFS/tutorials/tree/gh-pages/dev/generated/quick-start/2.qft-phase-estimation"><img src="https://img.shields.io/badge/download-project-orange" alt/></a></p><h1 id="example-qft"><a class="docs-heading-anchor" href="#example-qft">Quantum Fourier Transformation and Phase Estimation</a><a id="example-qft-1"></a><a class="docs-heading-anchor-permalink" href="#example-qft" title="Permalink"></a></h1><p>Let&#39;s use Yao first</p><pre><code class="language-julia hljs">using Yao</code></pre><h2 id="Quantum-Fourier-Transformation"><a class="docs-heading-anchor" href="#Quantum-Fourier-Transformation">Quantum Fourier Transformation</a><a id="Quantum-Fourier-Transformation-1"></a><a class="docs-heading-anchor-permalink" href="#Quantum-Fourier-Transformation" title="Permalink"></a></h2><p>The Quantum Fourier Transformation (QFT) circuit is to repeat two kinds of blocks repeatly:</p><p><img src="assets/qft.png" alt="qft-circuit"/></p><p>The basic building block control phase shift gate is defined as</p><p class="math-container">\[R(k)=\begin{bmatrix}
1 &amp; 0\\
0 &amp; \exp\left(\frac{2\pi i}{2^k}\right)
\end{bmatrix}\]</p><p>Let&#39;s define block <code>A</code> and block <code>B</code>, block <code>A</code> is actually a control block.</p><pre><code class="language-julia hljs">A(i, j) = control(i, j=&gt;shift(2π/(1&lt;&lt;(i-j+1))))</code></pre><pre><code class="nohighlight hljs">A (generic function with 1 method)</code></pre><p>Once you construct the blockl you can inspect its matrix using <code>mat</code> function. Let&#39;s construct the circuit in dash box A, and see the matrix of <span>$R_4$</span> gate.</p><pre><code class="language-julia hljs">R4 = A(4, 1)</code></pre><pre><code class="nohighlight hljs">(n -&gt; control(n, 4, 1 =&gt; shift(0.39269908169872414)))</code></pre><p>If you have read about <a href="generated/quick-start/2.qft-phase-estimation/@ref example-ghz">preparing GHZ state</a>, you probably know that in Yao, we could just leave the number of qubits, and it will be evaluated when possible.</p><pre><code class="language-julia hljs">R4(5)</code></pre><pre><code class="nohighlight hljs">nqubits: 5
control(4)
└─ (1,) shift(0.39269908169872414)</code></pre><p>its matrix will be</p><pre><code class="language-julia hljs">mat(R4(5))</code></pre><pre><code class="nohighlight hljs">32×32 LinearAlgebra.Diagonal{ComplexF64, Vector{ComplexF64}}:
 1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im</code></pre><p>Then we repeat this control block over and over on different qubits, and put a Hadamard gate to <code>i</code>th qubit to construct <code>i</code>-th <code>B</code> block.</p><pre><code class="language-julia hljs">B(n, k) = chain(n, j==k ? put(k=&gt;H) : A(j, k) for j in k:n)</code></pre><pre><code class="nohighlight hljs">B (generic function with 1 method)</code></pre><p>We need to input the total number of qubits <code>n</code> here because we have to iterate through from <code>k</code>-th location to the last.</p><p>Now, let&#39;s construct the circuit by chaining all the <code>B</code> blocks together</p><pre><code class="language-julia hljs">qft(n) = chain(B(n, k) for k in 1:n)
qft(4)</code></pre><pre><code class="nohighlight hljs">nqubits: 4
chain
├─ chain
│  ├─ put on (1)
│  │  └─ H
│  ├─ control(2)
│  │  └─ (1,) shift(1.5707963267948966)
│  ├─ control(3)
│  │  └─ (1,) shift(0.7853981633974483)
│  └─ control(4)
│     └─ (1,) shift(0.39269908169872414)
├─ chain
│  ├─ put on (2)
│  │  └─ H
│  ├─ control(3)
│  │  └─ (2,) shift(1.5707963267948966)
│  └─ control(4)
│     └─ (2,) shift(0.7853981633974483)
├─ chain
│  ├─ put on (3)
│  │  └─ H
│  └─ control(4)
│     └─ (3,) shift(1.5707963267948966)
└─ chain
   └─ put on (4)
      └─ H
</code></pre><h2 id="Wrap-QFT-to-an-external-block"><a class="docs-heading-anchor" href="#Wrap-QFT-to-an-external-block">Wrap QFT to an external block</a><a id="Wrap-QFT-to-an-external-block-1"></a><a class="docs-heading-anchor-permalink" href="#Wrap-QFT-to-an-external-block" title="Permalink"></a></h2><p>In most cases, <code>function</code>s are enough to wrap quantum circuits, like <code>A</code> and <code>B</code> we defined above, but sometimes, we need to dispatch specialized methods on certain kinds of quantum circuit, or we want to define an external block to export, thus, it&#39;s useful to be able to wrap circuit to custom blocks.</p><p>First, we define a new type as subtype of <code>PrimitiveBlock</code> since we are not going to use the subblocks of <code>QFT</code>, if you need to use its subblocks, it&#39;d be better to define it under <code>CompositeBlock</code>.</p><pre><code class="language-julia hljs">struct QFT &lt;: PrimitiveBlock{2}
    n::Int
end

YaoBlocks.nqudits(q::QFT) = q.n</code></pre><p>Now, let&#39;s define its circuit</p><pre><code class="language-julia hljs">circuit(q::QFT) = qft(q.n)</code></pre><pre><code class="nohighlight hljs">circuit (generic function with 1 method)</code></pre><p>And forward <code>mat</code> to its circuit&#39;s matrix</p><pre><code class="language-julia hljs">YaoBlocks.mat(::Type{T}, x::QFT) where T = mat(T, circuit(x))</code></pre><p>You may notice, it is a little ugly to print <code>QFT</code> at the moment, this is because we print the type summary by default, you can define your own printing by overloading <code>print_block</code></p><pre><code class="language-julia hljs">YaoBlocks.print_block(io::IO, x::QFT) = print(io, &quot;QFT($(x.n))&quot;)</code></pre><p>Since it is possible to use FFT to simulate the results of QFT (like cheating), we could define our custom <code>apply!</code> method:</p><pre><code class="language-julia hljs">using FFTW, LinearAlgebra

function YaoBlocks.apply!(r::ArrayReg, x::QFT)
    α = sqrt(length(statevec(r)))
    invorder!(r)
    lmul!(α, ifft!(statevec(r)))
    return r
end</code></pre><p>Now let&#39;s check if our <code>apply!</code> method is correct:</p><pre><code class="language-julia hljs">r = rand_state(5)
r1 = r |&gt; copy |&gt; QFT(5)
r2 = r |&gt; copy |&gt; circuit(QFT(5))
r1 ≈ r2</code></pre><pre><code class="nohighlight hljs">true</code></pre><p>We can get iQFT (inverse QFT) directly by calling <code>adjoint</code></p><pre><code class="language-julia hljs">QFT(5)&#39;</code></pre><pre><code class="nohighlight hljs"> [†]QFT(5)</code></pre><p>QFT and iQFT are different from FFT and IFFT in three ways,</p><ol><li>they are different by a factor of <span>$\sqrt{2^n}$</span> with <span>$n$</span> the number of qubits.</li><li>the <a href="https://quantumbfs.github.io/BitBasis.jl/stable/tutorial/#Conventions-1">bit numbering</a> will exchange after applying QFT or iQFT.</li><li>due to the convention, QFT is more related to IFFT rather than FFT.</li></ol><h2 id="Phase-Estimation"><a class="docs-heading-anchor" href="#Phase-Estimation">Phase Estimation</a><a id="Phase-Estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Phase-Estimation" title="Permalink"></a></h2><p>Since we have QFT and iQFT blocks we can then use them to realize phase estimation circuit, what we want to realize is the following circuit:</p><p><img src="assets/phaseest.png" alt="phase estimation"/></p><p>First we call Hadamard gates repeatly on first <code>n</code> qubits.</p><pre><code class="language-julia hljs">Hadamards(n) = repeat(H, 1:n)</code></pre><pre><code class="nohighlight hljs">Hadamards (generic function with 1 method)</code></pre><p>Then in dashed box <code>B</code>, we have controlled unitaries:</p><pre><code class="language-julia hljs">ControlU(n, m, U) = chain(n+m, control(k, n+1:n+m=&gt;matblock(U^(2^(k-1)))) for k in 1:n)</code></pre><pre><code class="nohighlight hljs">ControlU (generic function with 1 method)</code></pre><p>each of them is a <code>U</code> of power <span>$2^{(k-1)}$</span>.</p><p>Since we will only apply the qft and Hadamard on first <code>n</code> qubits, we could use <code>Subroutine</code>, which creates a context of a sub-scope of the qubits.</p><pre><code class="language-julia hljs">PE(n, m, U) =
    chain(n+m, # total number of the qubits
        subroutine(Hadamards(n), 1:n), # apply H in local scope
        ControlU(n, m, U),
        subroutine(QFT(n)&#39;, 1:n))</code></pre><pre><code class="nohighlight hljs">PE (generic function with 1 method)</code></pre><p>we use the first <code>n</code> qubits as the output space to store phase <span>$ϕ$</span>, and the other <code>m</code> qubits as the input state which corresponds to an eigenvector of oracle matrix <code>U</code>.</p><p>The subroutine here uses <code>focus!</code> and <code>relax!</code> to manage a local scope of quantum circuit, and only activate the first <code>n</code> qubits while applying the block inside the subroutine context, and the scope will be <code>relax!</code>ed back, after the context. This is equivalent to manually <code>focus!</code> then <code>relax!</code></p><p>fullly activated</p><pre><code class="language-julia hljs">r = rand_state(5)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>first 3 qubits activated</p><pre><code class="language-julia hljs">focus!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 3/5
    nlevel: 2</code></pre><p>relax back to the original</p><pre><code class="language-julia hljs">relax!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>In this way, we will be able to apply small operator directly on the subset of the qubits.</p><p>Details about the algorithm can be found here: <a href="https://en.wikipedia.org/wiki/Quantum_phase_estimation_algorithm">Quantum Phase Estimation Algorithm</a></p><p>Now let&#39;s check the results of our phase estimation.</p><p>First we need to set up a unitary with known phase, we set the phase to be 0.75, which is <code>0.75 * 2^3 == 6 == 0b110</code> .</p><pre><code class="language-julia hljs">N, M = 3, 5
P = eigen(rand_unitary(1&lt;&lt;M)).vectors
θ = Int(0b110) / 1&lt;&lt;N
phases = rand(1&lt;&lt;M)
phases[0b010+1] = θ
U = P * Diagonal(exp.(2π * im * phases)) * P&#39;</code></pre><pre><code class="nohighlight hljs">32×32 Matrix{ComplexF64}:
   -0.101004+0.127962im     -0.0666865+0.226331im     0.0160031-0.0878324im   -0.269824+0.07264im       0.0385744-0.0870877im      0.0516519-0.0955132im     0.0992489+0.126677im      0.017808+0.0726312im     -0.16063+0.00665302im      -0.095463-0.168917im     -0.0498325-0.0200738im    0.0631563-0.0198715im     0.0941931+0.0698865im     -0.103864+0.304374im      0.0961023+0.0417128im     0.311417+0.226802im     0.0977954+0.141828im      0.147058+0.0659309im   -0.116263-0.208104im     -0.185399-0.0256262im     0.0167026-0.0460288im     -0.13781-0.0987276im      0.0903444+0.0168628im      0.283673-0.0686564im      0.106059-0.0027374im  -1.6524e-5+0.123713im    -0.0121245-0.0373082im   0.0170775-0.0739992im     0.116382-0.178467im     -0.00332222+0.122994im      0.112646+0.160061im      -0.0829582+0.141899im
   0.0915976-0.0707763im     -0.408077-0.0186745im     0.162774+0.166183im   -0.0168861+0.193016im        -0.0352-0.0187389im       0.120304+0.0105373im      0.179584+0.029632im    -0.0020126-0.0983466im    0.0387359+0.211862im        0.0405068-0.13506im        0.158268+0.0245483im    0.0499304+0.0410443im    0.00220942-0.0878875im      0.108034-0.12642im        0.039511+0.121029im     -0.223397-0.0279786im     0.178748+0.00132144im   -0.226154+0.0284533im   -0.146546+0.0129897im    -0.400323-0.0017475im     0.0723852+0.116394im    -0.0175746-0.240684im       0.0676213+0.0275674im    -0.0532775-0.0454747im    -0.0186767-0.0164059im   0.0212735+0.0180556im    0.0942487-0.197593im      0.18246-0.0229315im    -0.108559+0.0256915im    -0.00631364-0.0226562im     0.122839-0.0799628im     0.00413149-0.000608864im
  0.00286519-0.0164305im     -0.160865+0.0206773im    -0.206859+0.0464845im    0.134931-0.184306im      0.0342162-0.242387im       0.0495291-0.0888906im    -0.0612851+0.100788im     0.0180426-0.120323im      0.149659-0.133843im        0.0354063+0.0559142im    -0.0138534+0.152463im      0.214524+0.0527578im     -0.265197-0.00945714im    0.0572621+0.0162899im     -0.153394-0.0181523im     0.135589+0.0845532im    0.0966722-0.124289im     0.0582449+0.04634im     -0.197959-0.154194im     -0.152474+0.0424334im     0.0299981+0.189118im    -0.0896901+0.242606im       0.0164559+0.291612im      0.0991291-0.0335815im    -0.0263024-0.0808505im   -0.117987-0.23329im     0.00544889+0.144973im   -0.0566746+0.0199884im    -0.284946-0.0456546im     -0.0895718+0.0562857im    -0.129831-0.00710693im    -0.0278767-0.080284im
  0.00917349+0.00237601im   -0.0762588+0.105488im      0.208808-0.202049im   -0.0848283-0.0285224im    -0.0457449-0.206866im      -0.0846057-0.18909im       -0.110224-0.0515829im    0.0384229-0.131963im     -0.265889+0.281523im       -0.0516835-0.0846005im    -0.0822976+0.112316im     -0.204407+0.132019im     -0.0392059+0.019401im     -0.0733947-0.18213im       -0.227505-0.15758im       0.022365-0.0211162im     0.118546-0.0527347im    0.0851196+0.0357177im    0.114918+0.24028im     -0.0375678-0.163109im      -0.110452-0.00511488im  -0.0449068-0.15195im        0.0500929-0.0108823im     -0.100669-0.0363583im     0.0861907+0.0260461im   -0.140345+0.104932im    -0.0909334+0.0783271im   -0.222545+0.130094im     -0.242282+0.000763049im   -0.0138609+0.0314408im    -0.197891+0.11531im        -0.064246+0.0279788im
   -0.003046-0.0210307im     0.0247303-0.0708488im    0.0158317+0.239482im   -0.0738341+0.341396im      -0.279448+0.083099im       0.0620671-0.0189253im    0.00375479-0.0675135im   -0.0746213-0.0706397im     0.042288+0.000960898im     0.0927336-0.19813im       0.0644709+0.299524im    -0.0214152+0.0513376im     -0.188299+0.0830159im     -0.149135+0.0678822im      0.231369-0.175335im      0.157728-0.0925619im    -0.112411-0.00620913im   -0.110046+0.130168im    0.0324835+0.128035im      0.026527-0.0907534im    -0.0624973+0.0526369im    -0.200422+0.0529273im      -0.137062+0.0940883im      0.141807+0.0299014im      0.134887+0.128389im    0.0129865-0.13121im       0.077841+0.155424im    -0.122414+0.00319397im    0.151002+0.125923im       0.0769786-0.115705im     -0.120558-0.126691im       -0.140934+0.065949im
  -0.0279462-0.0218834im     0.0608195+0.0242657im       0.1293+0.0895559im    0.112044+0.100648im       -0.23434-0.0599196im      -0.178948-0.0167398im      0.179151+0.166176im    -0.0823358+0.0803842im  -0.00797692-0.120086im       -0.0556619-0.0998058im    -0.0680395-0.0267641im    -0.140179+0.0217515im      0.113229-0.146065im       0.024677+0.0582061im     0.0810621+0.164793im     -0.249238+0.0400397im     0.191578-0.127578im      0.360351-0.0224257im    -0.14241+0.0477052im    0.0803081-0.290096im     -0.0344135-0.012764im    -0.0980847+0.270994im        -0.18895+0.135037im     -0.0121663+0.155228im      0.0427586+0.170572im   -0.0980555+0.0979568im   -0.0836764-0.0896212im    0.192871-0.071858im    -0.0902553-0.0281504im     0.00766104-0.035234im    -0.0429423+0.055836im     0.000667795-0.113326im
    -0.12143-0.192341im     -0.0595055+0.054748im      0.194711+0.0996698im   0.0271717-0.0290836im      0.123068-0.0404321im      -0.171231+0.0919635im     -0.438424+0.180839im    -0.0838359+0.0413834im     0.047505-0.067615im        0.0795589-0.224007im      0.0251735-0.0472936im     0.146578+0.0940085im      0.159299-0.154924im      -0.105909+0.0410736im    -0.0258182-0.171727im      0.190268-0.151124im    -0.0794103-0.0689492im   -0.0904753-0.28319im    0.00660647+0.141492im    -0.0719005-0.0236317im   -0.00862486-0.156566im    -0.0571017+0.0374987im     -0.0791518-0.0713105im     0.0737834+0.039248im      0.0186102+0.0949697im  -0.0564002-0.12123im      0.0184346-0.0826731im   0.0467936-0.142629im     -0.156173+0.0451921im     -0.0177933+0.180461im      0.246152-0.0392489im       0.069436-0.00480718im
    0.161697+0.139585im       0.020624+0.170939im   -0.00797536-0.0617475im    0.302428-0.0580409im      0.182067-0.0837813im     -0.0769288+0.241826im      0.0658865-0.0424183im    -0.338216+0.143947im      0.007955+0.107976im        0.0465669-0.039893im     -0.0660988+0.0371764im    -0.110051-0.240058im      0.0635223+0.110343im     -0.0298182+0.0500933im     0.0141364-0.0310428im     0.123221+0.0235554im    0.0460415+0.130301im     0.0490833-0.0918148im   0.0583575+0.0399605im   -0.0314068-0.0675798im     0.0919355+0.346042im    -0.0112285-0.221611im      -0.0316128-0.0499994im     0.0432224-0.0911869im       0.04629+0.221799im   -0.0541312-0.112842im      0.119591+0.14893im     0.0676165-0.0347868im   -0.0455224+0.0420115im       0.153436-0.0675411im   0.00414302-0.0193854im      -0.074894-0.271841im
   0.0449232-0.128281im      0.0576387-0.0132984im    -0.136499-0.0221505im    -0.14551-0.0129192im    -0.0501012-0.0200776im      0.0648798-0.13516im       -0.106112-0.254419im      -0.19409-0.0317719im    -0.287074+0.176302im       -0.0791335-0.204721im       0.063569-0.169203im      0.116189-0.250667im      -0.179496-0.039348im      0.0676127+0.231924im      0.0577833-0.0537983im    -0.186267-0.0828967im   0.00801268+0.0274485im   -0.0568179-0.156079im     0.110466-0.168188im     -0.115144+0.0213385im    -0.0235906-0.159306im    -0.0854492+0.0955895im      0.0530742+0.0119438im     -0.136492+0.167535im      -0.046661-0.0488252im   -0.173529-0.0655342im    -0.113863+0.259294im     0.188417-0.0859729im   -0.0284486-0.0516095im     -0.0547244-0.138927im      0.014829+0.000189036im   0.00284571-0.155595im
    0.194341+0.056759im       0.105041+0.0487196im    0.0156633+0.201224im    0.0358835+0.0327861im     0.0775168-0.202641im       0.0371642-0.0849711im     0.0311276+0.093489im     -0.169455-0.279743im     0.0433921-0.0197197im       -0.335794+0.124607im    0.000995865-0.121257im      0.075428-0.0381986im      0.189425-0.220356im       0.001268+0.0312708im    -0.0150468-0.139046im     0.0210856+0.138474im     -0.156147+0.0403245im   -0.0949189-0.0332527im   -0.126495-0.0126028im    0.0840981-0.159559im       0.027226+0.112014im       0.11723-0.0808149im     0.00647871-0.0512283im     -0.151571+0.149133im       0.204384-0.107367im   0.00715175-0.126033im    -0.0714206+0.0569057im   0.0842984-0.0490013im    0.0422979+0.185959im      -0.0550042-0.0226806im   -0.0779645+0.0535745im      -0.164381+0.352027im
   -0.191148-0.101603im      0.0691512+0.231701im    -0.0513956+0.025321im   0.00749002+0.0371833im       0.12042+0.0734708im      0.0513984-0.0736928im      0.121884+0.0220044im     0.112562-0.119382im     0.0461376+0.068638im         0.181042+0.0457869im     -0.140723-0.00399726im   0.0463166-0.0240649im     0.0460102-0.0268535im      0.100075-0.0695688im     -0.175959-0.126082im     -0.132496+0.202449im     0.0425546-0.0321889im    -0.147698-0.0915927im   -0.145483+0.197272im      0.049049-0.127626im      0.0931454-0.0683369im    -0.119259+0.171426im         0.13566-0.12229im        0.108592+0.0528491im      0.265604-0.0670102im   -0.144954-0.0832593im    0.0938999+0.104653im     0.054728+0.338662im      0.227112-0.0819563im       0.147713-0.12359im       0.230645-0.00460711im   -0.00428691-0.163036im
   -0.289452-0.00585048im    0.0630975+0.202165im      -0.25247+0.0581062im    0.172595+0.13646im      -0.0733833-0.000612037im    -0.136511-0.0381696im     -0.124314-0.0255969im      0.16547+0.0407385im    -0.121338-0.0693298im       0.0555528-0.123736im       0.041044-0.0177182im    -0.270684+0.142188im     -0.0903351-0.045188im     -0.0670641+0.152486im      -0.101238-0.0739306im    0.0265926+0.103565im     0.0734484+0.0557132im    -0.093792+0.0145535im     -0.0754-0.134558im    -0.0731856-0.0473178im      0.243574-0.00223148im    0.280418-0.140536im     -0.00516763+0.0529611im      -0.10851+0.0567468im    -0.0828139-0.0434139im   0.0349047-0.0550943im  -0.00750494-0.0445245im    0.073573-0.0745975im   -0.0805529+0.124648im        0.304003-0.1777im       -0.124048-0.0356869im        0.23375+0.137448im
    0.130953-0.0879651im      0.151691+0.141814im     0.0764864+0.0784152im    0.145825+0.00699962im  -0.00530316+0.0825415im        0.26019-0.185233im     -0.0549323+0.197126im    -0.0378933-0.126849im     -0.158616+0.0459594im       0.0155794+0.0145609im     -0.115317+0.110686im    -0.0412036+0.0489663im     -0.210725+0.0662048im    -0.0478986-0.0926138im     0.0749909+0.063513im    -0.0351313-0.0657389im   -0.0225805-0.174891im      0.127126+0.0775521im     0.22774-0.185687im      0.244842+0.00371917im   -0.0172151+0.0679663im    0.0677342-0.11286im         0.106275+0.107902im     -0.0029058+0.0504464im        0.1911-0.140996im    0.0316496-0.0039247im     0.212681-0.0890638im   0.0252448-0.236086im     -0.125255-0.0786399im       0.101982+0.0228214im     0.378685+0.0268668im      0.0791216-0.0271397im
  -0.0238331+0.0730666im    -0.0593012+0.0033934im    0.0339152+0.114508im     0.230027-0.036918im     -0.0221458-0.0641531im      0.0430536-0.00919948im     0.224684+0.00389245im   0.0718794-0.161136im     -0.028343-0.0490529im       0.0640606-0.0753287im    -0.0160773+0.103443im     -0.406529-0.0280343im    -0.0372687+0.0109594im     -0.288207+0.18122im       -0.103462-0.00969566im  -0.0724099-0.0829813im   -0.0330632+0.0833362im    -0.107391-0.0749353im  -0.0609041-0.0867036im    -0.118994+0.0851115im    -0.0797333-0.0596589im     -0.02897+0.192922im       0.0100611-0.288781im      -0.109793-0.0156423im   -0.00927711-0.107642im     0.128271-0.104528im    -0.0237875+0.0723951im   -0.109947-0.105213im     0.0796485+0.0861075im      -0.287896+0.243008im       0.11238+0.202206im     0.000281884-0.157156im
    0.219532+0.0640004im     -0.114056-0.0353146im   -0.0536317-0.0472528im   -0.173632+0.00860433im  -0.00997911-0.0346218im      -0.140084-0.148506im      -0.166766-0.00675113im  -0.0799666+0.0894051im     0.107147-0.20736im        -0.0846712+0.00856949im     0.206026-0.0662424im     -0.11915+0.105707im      -0.250577-0.00385005im    -0.139884+0.0313254im     -0.297123+0.168482im     -0.119426-0.00649513im   -0.109657+0.0607717im    0.0129408-0.0421548im   -0.190092+0.131091im     0.0358822-0.0136375im    -0.0470427+0.0804095im    0.0227038-0.00726354im      0.156646-0.084991im       0.023716-0.131631im       0.252137+0.197771im     0.144556+0.0385228im    -0.126308+0.0641645im  -0.0395058-0.167985im     0.0754222-0.191013im       0.0223172-0.259605im      0.185987-0.110448im       0.0269954-0.0281576im
  -0.0756967-0.0617943im   -0.00320876+0.0104335im  -0.00238497-0.0097719im   -0.157499-0.0161088im     0.0868467+0.0542939im     -0.0816323-0.0349805im    -0.0778172-0.095217im     0.0278278+0.053181im    -0.0378246+0.0737024im       0.0207864+0.113797im      -0.193657+0.338358im    -0.0640574+0.0469834im      0.133467-0.0172991im     0.0929586+0.306707im      0.0288028+0.0541211im    -0.209955+0.0490249im    -0.218196-0.0721989im   -0.0983865+0.121749im   0.00756188+0.104209im      0.125234+0.078291im     -0.0206712+0.19599im     -0.0601912-0.077694im     0.000700182+0.0865447im     0.0672386-0.329969im      0.0769542-0.0222893im   -0.201027-0.13241im      -0.179479-0.109085im     0.261968-0.107507im    -0.0367064+0.146021im       -0.204836-0.0112151im   -0.0177541+0.10758im         0.183537+0.00448105im
 -0.00325517+0.0215859im     -0.123369-0.209217im   -0.00838337-0.225577im    0.0925802+0.0776452im    -0.0966466-0.149597im       0.0437544+0.306582im       0.062271-0.0986573im     0.020723-0.0312535im     0.138923+0.0502378im    -0.000445771-0.236916im     -0.0653092-0.12743im      -0.176444-0.0256184im      0.037436+0.0116047im   0.000120793+0.0252111im   -0.00563053+0.0762364im   -0.0141022+0.116619im     -0.260306+0.0865079im     0.207026+0.0997262im   -0.123199+0.0571536im     0.136123+0.036343im     -0.0800217-0.28285im     -0.0474366-0.0952161im       0.209067+0.204043im     -0.0115837-0.00085339im    0.0284301-0.127544im     -0.14019-0.215272im       0.14172+0.106044im     0.010014+0.0820853im    -0.160137+0.0590481im      0.0167674-0.0270978im     0.210554-0.073448im       0.0410301+0.167131im
    0.227082+0.063752im       0.124566-0.0745635im   -0.0677143-0.178043im    0.0651925+0.199735im       0.111369-0.0199983im       0.273815-0.0260614im    -0.0360206-0.107246im      -0.10931+0.105222im     -0.101338-0.163541im       -0.0030256-0.0560901im     0.0017149+0.115083im      0.106093-0.0540155im      0.125666+0.277108im       0.104543+0.0421771im     -0.175022+0.0559306im   0.00551647+0.151166im    -0.0100972-0.052556im     -0.268272+0.166482im   -0.0613006+0.0765173im   -0.0870634-0.218979im      0.0529334-0.1617im      -0.0280468+0.176346im      -0.0321022-0.0315273im     0.0193683+0.171138im      0.0153659+0.161362im     0.103625+0.0740618im   -0.0521773-0.141785im   -0.0934094-0.0249156im    -0.230303+0.196156im       0.0196308+0.0922108im    0.0618906+0.0977852im       0.200874-0.00581365im
  0.00345032+0.00524078im     0.147274+0.0593693im    0.0631058-0.245333im    0.0216459-0.0684639im     -0.231696+0.181041im        0.126042-0.0371089im     -0.218707+0.051909im     0.0100134-0.083856im     0.0990897+0.127609im         0.157704-0.250059im     -0.0130034+0.0894463im    0.0737803-0.255586im      0.0372586-0.2199im        0.0196194+0.0161461im     0.0916566+0.198685im     0.0677537+0.0489844im   -0.0650078+0.129828im    -0.0285801-0.0513515im   -0.278559+0.0125182im  0.000126419+0.049099im     -0.0216463+0.229249im      0.176839+0.00647765im    -0.0953638-0.0351944im     -0.128901+0.102947im      0.0975737-0.0363136im   -0.019756-0.0469521im     0.030108-0.201187im    -0.254954+0.065265im    0.00820744-0.134829im       -0.161398-0.137596im    -0.0832281+0.140853im       0.0705939-0.0265164im
    0.219109+0.280473im     -0.0941055+0.234098im      0.068041-0.0135588im   0.0727086-0.0988992im     -0.015001-0.109712im       0.0194893-0.105937im      -0.139052+0.148613im        0.1371+0.215718im      -0.14098+0.0261949im       0.0924256-0.101678im      -0.093839+0.1265im       0.0380019-0.0180125im     -0.147037+0.0253061im      0.136037-0.0196333im     0.0626627-0.160654im     -0.199783+0.00686233im    -0.27273+0.0451476im     0.173002-0.0495709im  -0.0801322+0.0710853im   -0.0711636+0.0236038im      0.109063-0.0370349im   -0.0284978+0.0195119im      -0.215335-0.0349553im     0.0378526+0.0648644im     -0.174841-0.0923131im    0.245036+0.0916543im    0.0578867+0.118379im     0.158372+0.207862im     0.0814959+0.105543im       -0.157923-0.0422109im    0.0805247-0.150981im       0.0225278+0.145717im
  -0.0684344-0.200963im       0.128415-0.0174624im    -0.243583+0.039612im    0.0526533-0.0923619im      0.214463-0.0454018im       0.090474+0.259757im     0.00714026-0.0391478im    -0.156033-0.0741763im    -0.129464+0.203865im         0.141817-0.207842im       0.104511-0.0471831im     0.112406+0.0246611im     -0.178913-0.0344922im    -0.0305418-0.0596131im    -0.0521549+0.00621379im   -0.202084-0.0414974im     0.230808+0.00653013im    0.195053+0.0735493im   -0.171151+0.118744im      0.117996-0.0181445im    -0.0487307+0.045988im     0.0363425+0.0608561im     -0.0645979-0.139321im       0.233583-0.174876im      0.0806846-0.0303514im    0.109635+0.148883im    -0.0141458-0.0108948im  -0.0543997-0.132252im     0.0926567+0.163382im      -0.0884138+0.096118im     -0.069852-0.0125082im      0.0432551+0.292356im
   0.0390199+0.0488704im     -0.155576-0.129311im     -0.232144-0.0100732im    0.135837+0.0175473im    -0.0518679+0.122589im      -0.0816039+0.0621588im    -0.0122615+0.145131im     -0.103541+0.168316im     -0.410973+0.101385im       -0.0371166+0.0996397im      0.141927+0.0516784im    0.0300077-0.0793296im    -0.0251699-0.137314im      -0.177484+0.0310056im      -0.12638-0.0583913im     0.100462+0.251048im    -0.0344969-0.233046im     -0.117579-0.0192488im   -0.126622+0.133143im      0.163364+0.074094im     -0.0872592-0.00831473im   -0.244314+0.00550599im     -0.014493+0.085224im      -0.237724-0.0334949im     -0.138701-0.0696455im  -0.0112007-0.0251097im     0.145129-0.244519im    0.0150178+0.0127689im      0.12331-0.106427im       0.0361294+0.0290649im    0.0173011+0.0154828im      -0.159441+0.00966966im
    0.037406-0.16004im       -0.233939+0.0229492im    0.0403462-0.125743im   -5.4072e-5+0.113402im       0.164218+0.0934725im     -0.0721958-0.111208im       0.174989-0.139343im      0.139482-0.10042im     -0.0426167-0.00457058im       -0.20244-0.14622im       -0.123535-0.0855854im     0.057692-0.00509938im   -0.0827545-0.0622325im     0.0047324-0.0884105im     -0.153534+0.162595im       0.24913-0.0583004im   -0.0582565-0.0729961im    -0.028659-0.085571im   -0.0246781-0.130958im       0.20417-0.112452im       0.202392+0.0235537im    0.0370439+0.042805im       -0.372155+0.0466949im   -0.00973782-0.154181im      -0.132869+0.0838303im   -0.127204+0.0909067im     0.146114+0.0929355im    -0.08135-0.053069im      0.129816+0.219581im       -0.162131-0.169354im      0.143183+0.0415696im      0.0293981-0.0223527im
  -0.0126641+0.039138im      0.0504643-0.0273264im     0.242739-0.121169im   -0.0513476+0.0456725im      0.146299+0.0138037im    -0.00562283+0.0182786im    -0.0901082-0.124332im      0.271194+0.258417im     0.0602338+0.0608249im       -0.125514+0.0329385im     0.0724799+0.0588692im     0.138961-0.0278481im     -0.232954+0.0431295im     -0.134182+0.0060226im     0.0322903+0.094101im       0.10962-0.146348im      0.162174-0.00192407im    0.028305+0.0772072im   -0.276042+0.0458585im      0.11747-0.178345im      -0.124984+0.00941701im   0.0370711-0.0310927im      0.0713271-0.10158im      -0.0980432+0.123572im      0.0858273-0.251876im    0.0661615-0.18328im        0.07677+0.0316069im    0.306623-0.0567322im    0.0579269+0.183571im         0.13243+0.13809im      -0.126595+0.0949023im     -0.0832501-0.162819im
    0.197501-0.0304011im      0.111564+0.0744822im    0.0162225+0.125893im     0.112433-0.0193995im      0.036656-0.108585im       -0.269814-0.0374974im     -0.059766-0.135016im     0.0847669+0.0428889im  -0.00275745-0.164816im        0.0149553-0.355538im      -0.118139-0.140122im    -0.0223041+0.0170203im   -0.00164784-0.100224im       0.140222-0.0647391im     0.0576446+0.166423im    -0.0811658-0.00853827im  -0.0440629-0.0283796im    -0.277152-0.0155109im    0.100825-0.0416105im    0.0862899-0.115496im      -0.127733+0.196744im     -0.235257-0.00469089im      0.279746+0.147846im       0.146751-0.0578119im      -0.18452-0.204595im      0.11006+0.0758332im   -0.0160882-0.0468188im   -0.135951+0.0557179im     0.124096-0.0100383im        0.11424+0.08256im     -0.0605597+0.170595im      -0.0303705+0.0166876im
    0.428155-0.022857im     -0.0140716+0.0107433im     0.091805+0.0358097im  -0.0990876+0.0909018im      0.281585-0.0363598im     -0.0354622+0.138892im     -0.0805346+0.155275im    -0.0525115-0.0223547im    0.0749012+0.0806125im       0.0699932+0.00152927im   -0.0787261+0.0546984im    -0.124927+0.0869085im      0.002456+0.0356902im     -0.272494+0.0496224im      0.217853-0.0376184im    0.0197487+0.0924191im      0.11744-0.0974103im   -0.0382363-0.0295018im   -0.102739-0.0773774im   -0.0775477+0.157692im     -0.0590959-0.113117im      0.171015+0.203924im    -0.000958354+0.115853im     -0.0925837-0.0311703im    -0.0201196-0.159869im    -0.288841+0.195561im    -0.0857993+0.0251003im  -0.0771279+0.100054im      0.148214+0.0245506im       0.138176-0.130206im    -0.0823303-0.0533509im       0.207246-0.0445022im
    0.137113-0.0729023im     -0.136378+0.213694im   -0.00519786-0.0216893im    0.026698-0.115088im      -0.325697+0.227265im       0.0392487+0.175271im      -0.124587+0.0784126im    -0.106275-0.0576616im     0.126225-0.0074026im        0.079145+0.0235005im   -0.00874112-0.0444724im   -0.0761961-0.124854im      0.0347954+0.157722im       0.106838-0.00748772im    -0.123466-0.104669im     0.0950965+0.00373895im    0.136264-0.131281im     -0.104708+0.089899im   -0.0586119-0.153034im     0.0747558-0.30522im      -0.0891728-0.200426im      0.081356-0.106538im       -0.091873+0.0309281im      0.019297-0.26568im      -0.0461647-0.213587im     0.077164-0.017539im     -0.358397+0.0614366im   0.0803502-0.0102674im    0.0572411+0.0173979im     -0.0246308+0.00480817im   0.0640545-0.0298637im      -0.147704-0.0332703im
    0.087941+0.0513444im     0.0400338+0.196888im     -0.154542+0.163222im    0.0585793-0.056463im     -0.0981608-0.00316445im    -0.0729005+0.0759226im      0.115081-0.158621im      0.237667+0.209054im     0.0724786-0.0131767im       -0.172271+0.00705573im     0.249509+0.143426im      0.197975-0.109993im       0.112303-0.110784im      -0.265901-0.0829461im     0.0578219-0.0803311im    -0.185044+0.0132442im   -0.0369141-0.0867399im   -0.0720448+0.107347im   -0.0141904-0.0445672im    0.0508565-0.120339im      -0.102714-0.0523342im    0.0834941-0.190711im       -0.101932-0.122117im       0.146434+0.0335156im    -0.0230722+0.0049971im   -0.289794+0.0534661im    0.0504091+0.16188im     -0.169975+0.006012im     -0.179461-0.192761im       -0.080484+0.0520495im     0.126535+0.0353765im       0.161521+0.0227841im
  -0.0300914+0.0234417im    -0.0315466+0.0104925im   -0.0779325-0.119449im    0.0512754-0.264823im     0.00807439-0.017752im       -0.106558-0.2436im         0.124544+0.117106im    -0.0756307+0.0287608im     0.112404+0.0502714im        0.128686+0.0438133im     0.0454652-0.193263im     0.0628892+0.10652im      -0.0828638-0.00777138im    0.0114841+0.0185223im      0.355711-0.126454im    0.00109446+0.0319857im   -0.0232077+0.173426im      -0.20819+0.153455im   -0.0273443+0.10029im     -0.0234872-0.129879im      -0.196191-0.176217im    -0.0225823+0.0962648im        -0.1042-6.84709e-5im    -0.162236-0.282468im      0.0577813+0.0821523im   0.0623931+0.0479884im     0.241211+0.0498747im   0.0505462-0.0968281im    -0.158189+0.0734591im      0.0908792-0.157816im      0.032173+0.281975im       0.0476096+0.0296887im
    0.094247+0.152666im     -0.0214863-0.0711676im   0.00554082-0.19128im    -0.0316551-0.0774449im    -0.0567128+0.0214033im     -0.0742466-0.0991972im   -0.00949779+0.0789334im    0.0519723-0.0526705im    0.0413434+0.0553662im         0.11001-0.0529005im     0.0438028-0.115223im    -0.0503148-0.0361223im     0.0408162-0.178851im      0.0327178+0.210966im      0.0923581-0.029868im      0.055391+0.00208993im    0.191975-0.398732im    -0.0730412+0.153652im     0.112046-0.029958im     0.0511438-0.183152im       0.135615+0.0338924im     0.100142+0.0122855im        0.28994-0.111941im      0.0138437-0.00484436im    0.0150331+0.218767im    0.0166642-0.0850098im     0.225023+0.128854im    0.0200658+0.0136453im     0.139939+0.0454519im       -0.22797+0.164216im    -0.0880524-0.304712im        0.171597+0.0493058im
  -0.0285786+0.134395im       0.045754+0.217676im    -0.0496543-0.0651328im   -0.284882+0.141225im     -0.0307825-0.0810852im       0.163302+0.105644im     -0.0213966-0.0275771im    -0.170851+0.0351017im    -0.104668+0.0986659im      -0.0295745+0.109907im       0.185931-0.260118im     -0.155009+0.215982im       0.132377-0.145577im     -0.0759807-0.174765im      0.0319525-0.101099im    -0.0102883-0.104451im      -0.13724-0.00528216im  -0.0144662+0.0899139im  -0.0424105+0.023879im     0.0461546-0.0893063im     0.0857555+0.10343im       0.059438+0.184584im     -0.00810174+0.117im          0.254816-0.0259401im     -0.162542-0.1925im      0.0941271-0.188824im      0.116743-0.0913906im  -0.0439789-0.0540663im   -0.0475467+0.0223032im      -0.141392-0.0797509im    -0.034254+0.0545781im       0.060022-0.310905im
   0.0314159-0.0743763im    -0.0789652+0.190683im     0.0683807+0.0734565im   -0.130887+0.0487728im      0.211316+0.0436551im     -0.0353919+0.0336902im    -0.0146436+0.0137143im   -0.0991323+0.0104005im     0.106507-0.0623732im      -0.0724572+0.0863319im     0.0973605+0.297145im    -0.0465122-0.166237im      -0.105879-0.251326im       0.144786+0.197541im     -0.0254228+0.121684im    -0.0940156+0.107726im       0.13982-0.00689973im    0.158042-0.039395im      0.21242+0.0222695im   0.00496512-0.0515588im    -0.0769957-0.313098im     0.0753917-0.003825im       0.0875654-0.0693581im     0.0524382-0.0254386im     -0.187808+0.0167379im    0.168764-0.231345im      0.168433-0.109787im     -0.24011+0.0693576im   -0.0706688+0.101155im       0.0362609-0.20662im     -0.0465451+0.115255im       -0.142516+0.0292714im</code></pre><p>and then generate the state <span>$ψ$</span></p><pre><code class="language-julia hljs">psi = P[:, 3]</code></pre><pre><code class="nohighlight hljs">32-element Vector{ComplexF64}:
  -0.09789953545084859 - 0.14658552202112426im
  0.028679597267012528 - 0.11545078940274602im
    0.2348207520020593 - 0.02600356743885904im
  -0.03155812528889163 + 0.040619562033067304im
  -0.09216422630292569 + 0.01988708228171578im
  -0.06871257705936326 + 0.022579170995804736im
  -0.24047591692718942 + 0.12196298621224497im
    0.1714852144399279 - 0.08245725004927656im
   0.03850325264670765 - 0.0009466634397086575im
  -0.09353307297510143 - 0.15354595621044922im
 0.0003730965764470047 - 0.17570550510208274im
   0.17316964526460363 + 0.008137969293770926im
   0.01317353780900701 + 0.16266373534848125im
  -0.06391844687529416 - 0.03929701651687707im
   0.03812276263034655 + 0.04323708397730954im
   -0.2332193333282903 + 0.12369271346407695im
  -0.07981556959271185 - 0.17565572513653413im
  0.022867985281527423 - 0.05217568461147713im
    0.3090064202486513 + 0.0im
 -0.005557087618876153 + 0.13397115621638214im
  -0.16479715515973878 - 0.14353100418170522im
 -0.007241474714331381 - 0.18729358937067175im
  -0.10583562348490902 - 0.11412407023043208im
  -0.04043244213986739 + 0.08872834353622307im
  -0.08274579730901761 + 0.11633480919090063im
   0.16108127315088394 - 0.06419853300181919im
   0.03859979546766632 - 0.0851564409890572im
    -0.157243940206796 + 0.24634828729987204im
  -0.08375283923820455 + 0.07721407808349354im
   0.18484859734436937 - 0.07494466369704657im
   0.08802262127041331 + 0.11247462835057082im
    0.2778912980058357 + 0.08789145506994595im</code></pre><p>In the phase estimation process, we will feed the state to circuit and measure the first <code>n</code> qubits processed by iQFT.</p><pre><code class="language-julia hljs">r = join(ArrayReg(psi), zero_state(N))
r |&gt; PE(N, M, U)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 8/8
    nlevel: 2</code></pre><p>Since our phase can be represented by 3 qubits precisely, we only need to measure once</p><pre><code class="language-julia hljs">results = measure(r, 1:N; nshots=1)</code></pre><pre><code class="nohighlight hljs">1-element Vector{BitBasis.BitStr64{3}}:
 011 ₍₂₎</code></pre><p>Recall that our QFT&#39;s bit numbering is reversed, let&#39;s reverse it back</p><pre><code class="language-julia hljs">using BitBasis
estimated_phase = bfloat(results[]; nbits=N)</code></pre><pre><code class="nohighlight hljs">0.75</code></pre><p>the phase is exactly <code>0.75</code>!</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../1.prepare-ghz-state/index.html">« Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a><a class="docs-footer-nextpage" href="../3.grover-search/index.html">Grover Search »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.16 on <span class="colophon-date" title="Friday 29 April 2022 02:21">Friday 29 April 2022</span>. Using Julia version 1.7.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
