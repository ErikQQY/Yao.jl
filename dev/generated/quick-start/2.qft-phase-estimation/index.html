<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quantum Fourier Transformation and Phase Estimation · Documentation | Yao</title><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/indigo.css" rel="stylesheet" type="text/css"/><link href="https://yaoquantum.org/assets/favicon-light.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../index.html"><img src="../../../assets/logo.png" alt="Documentation | Yao logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../index.html">Documentation | Yao</a></span></div><form class="docs-search" action="../../../search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../index.html">Home</a></li><li><span class="tocitem">Quick Start</span><ul><li><a class="tocitem" href="../1.prepare-ghz-state/index.html">Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a></li><li class="is-active"><a class="tocitem" href="index.html">Quantum Fourier Transformation and Phase Estimation</a><ul class="internal"><li><a class="tocitem" href="#Quantum-Fourier-Transformation"><span>Quantum Fourier Transformation</span></a></li><li><a class="tocitem" href="#Wrap-QFT-to-an-external-block"><span>Wrap QFT to an external block</span></a></li><li><a class="tocitem" href="#Phase-Estimation"><span>Phase Estimation</span></a></li><li class="toplevel"><a class="tocitem" href="#using-LinearAlgebra"><span>using LinearAlgebra</span></a></li></ul></li><li><a class="tocitem" href="../3.grover-search/index.html">Grover Search</a></li><li><a class="tocitem" href="../4.shor-algorithm/index.html">Shor&#39;s Algorithm</a></li><li><a class="tocitem" href="../5.shor-9-code/index.html">Shor&#39;s 9 qubit code</a></li><li><a class="tocitem" href="../6.quantum-circuit-born-machine/index.html">Quantum Circuit Born Machine</a></li><li><a class="tocitem" href="../7.variation-quantum-eigen-solver/index.html">Variational Quantum Eigen Solver</a></li></ul></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../../man/array_registers.html">Array Registers</a></li><li><a class="tocitem" href="../../../man/symbolic.html">Symbolic Computation</a></li><li><a class="tocitem" href="../../../man/blocks.html">Blocks</a></li><li><a class="tocitem" href="../../../man/automatic_differentiation.html">Automatic Differentiation</a></li><li><a class="tocitem" href="../../../man/simplification.html">Simplification</a></li><li><a class="tocitem" href="../../../man/base.html">Base</a></li><li><a class="tocitem" href="../../../man/registers.html">Abstract Registers</a></li><li><a class="tocitem" href="../../../man/bitbasis.html">BitBasis</a></li><li><a class="tocitem" href="../../../man/extending_blocks.html">Extending Blocks</a></li></ul></li><li><a class="tocitem" href="../../../benchmarks.html">Benchmark</a></li><li><a class="tocitem" href="../../../dev/index.html">Developer Notes</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Quick Start</a></li><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/QuantumBFS/Yao.jl/blob/master/docs/src/quick-start/2.qft-phase-estimation/main.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><p><a href="https://mybinder.org/v2/gh/QuantumBFS/Yao.jl/gh-pages?filepath=dev/generated/quick-start/2.qft-phase-estimation/main.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a> <a href="https://nbviewer.jupyter.org/github/QuantumBFS/Yao.jl/blob/gh-pages/dev/generated/quick-start/2.qft-phase-estimation/main.ipynb"><img src="https://img.shields.io/badge/show-nbviewer-579ACA.svg" alt/></a> <a href="https://minhaskamal.github.io/DownGit/#/home?url=https://github.com/QuantumBFS/tutorials/tree/gh-pages/dev/generated/quick-start/2.qft-phase-estimation"><img src="https://img.shields.io/badge/download-project-orange" alt/></a></p><h1 id="example-qft"><a class="docs-heading-anchor" href="#example-qft">Quantum Fourier Transformation and Phase Estimation</a><a id="example-qft-1"></a><a class="docs-heading-anchor-permalink" href="#example-qft" title="Permalink"></a></h1><p>Let&#39;s use Yao first</p><pre><code class="language-julia hljs">using Yao</code></pre><h2 id="Quantum-Fourier-Transformation"><a class="docs-heading-anchor" href="#Quantum-Fourier-Transformation">Quantum Fourier Transformation</a><a id="Quantum-Fourier-Transformation-1"></a><a class="docs-heading-anchor-permalink" href="#Quantum-Fourier-Transformation" title="Permalink"></a></h2><p>The Quantum Fourier Transformation (QFT) circuit is to repeat two kinds of blocks repeatly:</p><p><img src="assets/qft.png" alt="qft-circuit"/></p><p>The basic building block control phase shift gate is defined as</p><p class="math-container">\[R(k)=\begin{bmatrix}
1 &amp; 0\\
0 &amp; \exp\left(\frac{2\pi i}{2^k}\right)
\end{bmatrix}\]</p><p>Let&#39;s define block <code>A</code> and block <code>B</code>, block <code>A</code> is actually a control block.</p><pre><code class="language-julia hljs">A(i, j) = control(i, j=&gt;shift(2π/(1&lt;&lt;(i-j+1))))</code></pre><pre><code class="nohighlight hljs">A (generic function with 1 method)</code></pre><p>Once you construct the blockl you can inspect its matrix using <code>mat</code> function. Let&#39;s construct the circuit in dash box A, and see the matrix of <span>$R_4$</span> gate.</p><pre><code class="language-julia hljs">R4 = A(4, 1)</code></pre><pre><code class="nohighlight hljs">(n -&gt; control(n, 4, 1 =&gt; shift(0.39269908169872414)))</code></pre><p>If you have read about <a href="generated/quick-start/2.qft-phase-estimation/@ref example-ghz">preparing GHZ state</a>, you probably know that in Yao, we could just leave the number of qubits, and it will be evaluated when possible.</p><pre><code class="language-julia hljs">R4(5)</code></pre><pre><code class="nohighlight hljs">nqubits: 5
control(4)
└─ (1,) shift(0.39269908169872414)</code></pre><p>its matrix will be</p><pre><code class="language-julia hljs">mat(R4(5))</code></pre><pre><code class="nohighlight hljs">32×32 LinearAlgebra.Diagonal{ComplexF64, Vector{ComplexF64}}:
 1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im</code></pre><p>Then we repeat this control block over and over on different qubits, and put a Hadamard gate to <code>i</code>th qubit to construct <code>i</code>-th <code>B</code> block.</p><pre><code class="language-julia hljs">B(n, k) = chain(n, j==k ? put(k=&gt;H) : A(j, k) for j in k:n)</code></pre><pre><code class="nohighlight hljs">B (generic function with 1 method)</code></pre><p>We need to input the total number of qubits <code>n</code> here because we have to iterate through from <code>k</code>-th location to the last.</p><p>Now, let&#39;s construct the circuit by chaining all the <code>B</code> blocks together</p><pre><code class="language-julia hljs">qft(n) = chain(B(n, k) for k in 1:n)
qft(4)</code></pre><pre><code class="nohighlight hljs">nqubits: 4
chain
├─ chain
│  ├─ put on (1)
│  │  └─ H
│  ├─ control(2)
│  │  └─ (1,) shift(1.5707963267948966)
│  ├─ control(3)
│  │  └─ (1,) shift(0.7853981633974483)
│  └─ control(4)
│     └─ (1,) shift(0.39269908169872414)
├─ chain
│  ├─ put on (2)
│  │  └─ H
│  ├─ control(3)
│  │  └─ (2,) shift(1.5707963267948966)
│  └─ control(4)
│     └─ (2,) shift(0.7853981633974483)
├─ chain
│  ├─ put on (3)
│  │  └─ H
│  └─ control(4)
│     └─ (3,) shift(1.5707963267948966)
└─ chain
   └─ put on (4)
      └─ H
</code></pre><h2 id="Wrap-QFT-to-an-external-block"><a class="docs-heading-anchor" href="#Wrap-QFT-to-an-external-block">Wrap QFT to an external block</a><a id="Wrap-QFT-to-an-external-block-1"></a><a class="docs-heading-anchor-permalink" href="#Wrap-QFT-to-an-external-block" title="Permalink"></a></h2><p>In most cases, <code>function</code>s are enough to wrap quantum circuits, like <code>A</code> and <code>B</code> we defined above, but sometimes, we need to dispatch specialized methods on certain kinds of quantum circuit, or we want to define an external block to export, thus, it&#39;s useful to be able to wrap circuit to custom blocks.</p><p>First, we define a new type as subtype of <code>PrimitiveBlock</code> since we are not going to use the subblocks of <code>QFT</code>, if you need to use its subblocks, it&#39;d be better to define it under <code>CompositeBlock</code>.</p><pre><code class="language-julia hljs">struct QFT{N} &lt;: PrimitiveBlock{N} end
QFT(n::Int) = QFT{n}()</code></pre><pre><code class="nohighlight hljs">Main.##276.QFT</code></pre><p>Now, let&#39;s define its circuit</p><pre><code class="language-julia hljs">circuit(::QFT{N}) where N = qft(N)</code></pre><pre><code class="nohighlight hljs">circuit (generic function with 1 method)</code></pre><p>And forward <code>mat</code> to its circuit&#39;s matrix</p><pre><code class="language-julia hljs">YaoBlocks.mat(::Type{T}, x::QFT) where T = mat(T, circuit(x))</code></pre><p>You may notice, it is a little ugly to print <code>QFT</code> at the moment, this is because we print the type summary by default, you can define your own printing by overloading <code>print_block</code></p><pre><code class="language-julia hljs">YaoBlocks.print_block(io::IO, x::QFT{N}) where N = print(io, &quot;QFT($N)&quot;)</code></pre><p>Since it is possible to use FFT to simulate the results of QFT (like cheating), we could define our custom <code>apply!</code> method:</p><pre><code class="language-julia hljs">using FFTW, LinearAlgebra

function YaoBlocks.apply!(r::ArrayReg, x::QFT)
    α = sqrt(length(statevec(r)))
    invorder!(r)
    lmul!(α, ifft!(statevec(r)))
    return r
end</code></pre><p>Now let&#39;s check if our <code>apply!</code> method is correct:</p><pre><code class="language-julia hljs">r = rand_state(5)
r1 = r |&gt; copy |&gt; QFT(5)
r2 = r |&gt; copy |&gt; circuit(QFT(5))
r1 ≈ r2</code></pre><pre><code class="nohighlight hljs">true</code></pre><p>We can get iQFT (inverse QFT) directly by calling <code>adjoint</code></p><pre><code class="language-julia hljs">QFT(5)&#39;</code></pre><pre><code class="nohighlight hljs"> [†]QFT(5)</code></pre><p>QFT and iQFT are different from FFT and IFFT in three ways,</p><ol><li>they are different by a factor of <span>$\sqrt{2^n}$</span> with <span>$n$</span> the number of qubits.</li><li>the <a href="https://quantumbfs.github.io/BitBasis.jl/stable/tutorial/#Conventions-1">bit numbering</a> will exchange after applying QFT or iQFT.</li><li>due to the convention, QFT is more related to IFFT rather than FFT.</li></ol><h2 id="Phase-Estimation"><a class="docs-heading-anchor" href="#Phase-Estimation">Phase Estimation</a><a id="Phase-Estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Phase-Estimation" title="Permalink"></a></h2><p>Since we have QFT and iQFT blocks we can then use them to realize phase estimation circuit, what we want to realize is the following circuit:</p><p><img src="assets/phaseest.png" alt="phase estimation"/></p><pre><code class="language-julia hljs">using Yao</code></pre><p>First we call Hadamard gates repeatly on first <code>n</code> qubits.</p><pre><code class="language-julia hljs">Hadamards(n) = repeat(H, 1:n)</code></pre><pre><code class="nohighlight hljs">Hadamards (generic function with 1 method)</code></pre><p>Then in dashed box <code>B</code>, we have controlled unitaries:</p><pre><code class="language-julia hljs">ControlU(n, m, U) = chain(n+m, control(k, n+1:n+m=&gt;matblock(U^(2^(k-1)))) for k in 1:n)</code></pre><pre><code class="nohighlight hljs">ControlU (generic function with 1 method)</code></pre><p>each of them is a <code>U</code> of power <span>$2^(k-1)$</span>.</p><p>Since we will only apply the qft and Hadamard on first <code>n</code> qubits, we could use <code>Subroutine</code>, which creates a context of a sub-scope of the qubits.</p><pre><code class="language-julia hljs">PE(n, m, U) =
    chain(n+m, # total number of the qubits
        subroutine(Hadamards(n), 1:n), # apply H in local scope
        ControlU(n, m, U),
        subroutine(QFT(n)&#39;, 1:n))</code></pre><pre><code class="nohighlight hljs">PE (generic function with 1 method)</code></pre><p>we use the first <code>n</code> qubits as the output space to store phase <span>$ϕ$</span>, and the other <code>m</code> qubits as the input state which corresponds to an eigenvector of oracle matrix <code>U</code>.</p><p>The concentrator here uses <code>focus!</code> and <code>relax!</code> to manage a local scope of quantum circuit, and only active the first <code>n</code> qubits while applying the block inside the concentrator context, and the scope will be <code>relax!</code>ed back, after the context. This is equivalent to manually <code>focus!</code> then <code>relax!</code></p><p>fullly activated</p><pre><code class="language-julia hljs">r = rand_state(5)</code></pre><pre><code class="nohighlight hljs">ArrayReg{1, ComplexF64, Array...}
    active qubits: 5/5</code></pre><p>first 3 qubits activated</p><pre><code class="language-julia hljs">focus!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{1, ComplexF64, Array...}
    active qubits: 3/5</code></pre><p>relax back to the original</p><pre><code class="language-julia hljs">relax!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{1, ComplexF64, Array...}
    active qubits: 5/5</code></pre><p>In this way, we will be able to apply small operator directly on the subset of the qubits.</p><p>Details about the algorithm can be found here: <a href="ttps://en.wikipedia.org/wiki/Quantum_phase_estimation_algorithm">Quantum Phase Estimation Algorithm</a></p><p>Now let&#39;s check the results of our phase estimation.</p><p>First we need to set up a unitary with known phase, we set the phase to be 0.75, which is <code>0.75 * 2^3 == 6 == 0b110</code> .</p><h1 id="using-LinearAlgebra"><a class="docs-heading-anchor" href="#using-LinearAlgebra">using LinearAlgebra</a><a id="using-LinearAlgebra-1"></a><a class="docs-heading-anchor-permalink" href="#using-LinearAlgebra" title="Permalink"></a></h1><pre><code class="language-julia hljs">N, M = 3, 5
P = eigen(rand_unitary(1&lt;&lt;M)).vectors
θ = Int(0b110) / 1&lt;&lt;N
phases = rand(1&lt;&lt;M)
phases[0b010+1] = θ
U = P * Diagonal(exp.(2π * im * phases)) * P&#39;</code></pre><pre><code class="nohighlight hljs">32×32 Matrix{ComplexF64}:
     0.146108-0.217553im     0.0713444-0.0157566im   -0.0866118-0.0213556im      0.0210945+0.199526im        -0.09163+0.144596im     -0.0197557-0.0266034im      0.10362+0.113595im       0.0815566+0.0827672im   -0.0682761-0.172381im      0.162705+0.00157177im    0.0793985-0.166819im      0.0678795-0.0660103im   -0.0475732-0.11646im     -0.0459755-0.10725im      0.0438467+0.0318416im     -0.194927-0.352543im        0.14106+0.0175906im     0.149622-0.247967im      -0.18867-0.0619222im   -0.0973974-0.225852im     -0.0565715+0.0378708im     -0.041032+0.00029344im    0.0508291-0.245133im     0.280916-0.156995im     0.0691605-0.240478im     -0.0462248+0.0638623im    0.0451899+0.00249185im  -0.00170705-0.097014im     0.0036811+0.0917801im       0.021674-0.0114205im       0.137626+0.0567652im   0.00563084+0.153398im
    -0.103278-0.0594841im     0.105669+0.0906596im    -0.219661-0.166252im      -0.0520957+0.0451321im      0.0837187-0.126972im      0.0922751-0.0271036im   -0.0234621+0.0470806im     -0.0506983-0.0342935im   -0.0247392+0.16545im       -0.16355+0.0979426im    -0.0467723-0.0273im      -0.00814852+0.00931972im    0.193301+0.00542666im   -0.119275-0.125733im     0.0404854-0.209718im     -0.0193659+0.216403im       0.070787+0.0700195im    -0.168643-0.0452619im   -0.0739106+0.160843im     -0.187146-0.123213im     -0.0101206+0.036388im      -0.214214-0.189902im     -0.0767011-0.272283im      0.13892+0.189722im     0.0394331+0.155472im     -0.0770197+0.0701334im   -0.0435617+0.0561223im     0.0499561-0.0184875im    -0.191464+0.0336766im      -0.191972-0.247143im       0.0483892+0.199088im     -0.237028-0.0150732im
     0.159162-0.0110819im   -0.0341939-0.104393im      0.199569+0.045197im       -0.034763-0.0559024im      0.0336118+0.126348im    -0.00263376-0.163215im    -0.0505883-0.11819im        0.0947095+0.114443im    -0.0334056+0.0812093im    0.0473372+0.0692248im     0.0269698+0.0857988im    -0.0484253-0.172558im     0.0254413+0.122022im    -0.0347051+0.0560814im   -0.0732512-0.188021im       0.131754+0.146045im     -0.0653462-0.0876543im    -0.175384-0.0731098im    0.0588817+0.074411im    0.00208615-0.28331im        -0.24141-0.0969059im    -0.0654737+0.00127074im     0.186176+0.0752098im    0.236828-0.0413803im    -0.115649+0.220688im      -0.209435-0.0142875im    0.0433671-0.139994im       0.168386-0.0438776im   -0.0104623+0.0658527im      0.0953044+0.0658416im       0.357852-0.0860926im     0.236688-0.0709039im
 -0.000466703-0.00854963im   0.0597003+0.0980726im   -0.0316976-0.231926im     -0.00440953-0.129824im        0.100794+0.0414433im   -0.00567871+0.0864047im    -0.111027+0.000276746im   -0.0941465-0.245877im     -0.218191+0.0760917im     0.133517-0.0553145im    -0.0737914+0.0906948im     -0.073432-0.205319im     -0.107983+0.137814im      0.198005+0.00112075im  -0.0484417+0.195036im     -0.0230465+0.0399008im    0.00133555-0.248322im     0.0518904+0.0451751im   -0.0805735-0.174295im    -0.0175617+0.218624im     -0.0580281-0.164811im     -0.0358805-0.0330989im   0.000375629+0.0950019im    0.263925+0.0985563im     0.117089-0.160867im      -0.237629-0.0883317im    0.0946322-0.0264569im     -0.263097-0.0531368im    -0.102046+0.0391043im      -0.251088-0.0372787im       0.137489-0.0974353im    -0.047956-0.029475im
   0.00853344+0.210931im     0.0745924+0.10317im        0.25141-0.210862im       0.0145933+0.00862838im     -0.120076-0.195564im    -0.00261354-0.0439695im   -0.0518105+0.134238im      -0.0919435-0.205237im    -0.0680523-0.132893im     0.0932055+0.220534im       0.147989+0.0321814im    0.00902671+0.0562838im    -0.132123-0.193704im    -0.0109719-0.200032im    -0.0846944-0.018244im      0.0588076-0.000331611im   0.0163855-0.227688im     -0.214482+0.134201im     -0.178062+0.0363338im    -0.010689-0.150148im      0.0668687+0.0330494im   -0.00136137-0.110768im     -0.0154332-0.187108im   -0.0578798-0.232215im     -0.170801-0.0093967im     0.0112683-0.174924im       0.18492+0.110163im       0.106812+0.16031im      0.0628527+0.0397091im       -0.11411+0.102178im       -0.121831-0.00748899im    0.133413-0.0789552im
     0.103058+0.027019im     -0.198815+0.0656378im    -0.148034-0.220197im      -0.0989294+0.0312205im      0.0710423+0.117596im     -0.0218499-0.306546im      0.113612-0.0317747im     -0.0428189-0.0991701im    0.0996355+0.0786338im   -0.0172547-0.130953im       0.112492+0.16283im       -0.197677+0.0776022im   -0.0696852-0.0520979im     0.037672+0.104165im     -0.207582-0.101509im      0.0401926+0.032898im       0.153704-0.153727im    0.00485676-0.292474im     -0.165502-0.0785513im    0.0667036+0.0150501im     -0.134225+0.00179017im   -0.0666065+0.0817043im     -0.145822-0.0303132im  -0.0813712+0.140863im     0.0332199+0.00956402im    0.0258303+0.0314121im    -0.129934+0.192077im      0.0678489-0.0518606im      0.26028-0.309077im      -0.0507632+0.18063im       -0.0402891+0.112925im     0.0389596+0.062124im
   -0.0501819-0.086374im     0.0283364-0.0643658im     0.047256-0.0523342im     -0.0745567-0.245418im       0.0469229-0.158978im      0.0998734-0.17112im     -0.0119802-0.095391im      -0.0499716-0.16938im      0.0103434-0.0689384im    -0.146137+0.0784831im     0.0590335-0.0983136im     0.0642257+0.263804im    -0.0704667-0.208293im     -0.322002+0.0349055im     0.161168+0.163588im      -0.197492-0.00836397im     0.045034-0.0136961im       0.1091+0.124449im     0.0762895+0.175416im    -0.0971123-0.123991im      -0.270969-0.0406303im    -0.0121859+0.147503im       0.111121+0.171026im     0.102059+0.0184861im      0.15933+0.0106871im     -0.202499-0.0812954im    -0.119048-0.0371137im     -0.181444+0.0592385im     0.142523-0.121174im      -0.0120403-0.102004im      -0.0671047+0.00636396im    0.135887+0.0941123im
   -0.0319596+0.0867876im     -0.10275+0.00314105im  -0.0707564+0.0203018im      0.0505319+0.0164811im     -0.0233466-0.0656811im      0.175605-0.124786im     -0.308277-0.0443362im    0.000113508+0.0192065im     0.140544-0.162351im       0.20803-0.152298im      -0.111577+0.0508645im     0.0882063+0.147081im     -0.145903-0.0417316im   -0.0435268-0.141333im     0.0503562-0.241447im      -0.220707-0.0455413im      0.107121+0.106554im    -0.0097876-0.0608241im   -0.0664943-0.0660781im    0.0242255+0.0552974im     0.0412019+0.156016im      -0.185292+0.127032im       0.127201+0.0383287im  -0.0266698+0.102195im    -0.0676741+0.231063im     -0.0506268-0.0138477im     0.261845+0.0194447im     -0.262765-0.0458823im   -0.0547235+0.000801551im    0.0531203+0.212334im        0.108406-0.162523im     -0.207187-0.1824im
    0.0642742-0.179157im     -0.178944-0.147498im      0.208403-0.0104296im       0.215251+0.0660597im     -0.0275143-0.187228im      0.0502151-0.189469im    -0.0972625-0.0203414im     -0.0570211-0.0803357im    0.0151271-0.0456975im    -0.157762-0.0410996im     0.0495998-0.0690389im     0.0649941+0.045394im     0.0692266+0.2827im       -0.104564-0.0417911im   -0.0450024+0.0254379im   -0.00366304-0.237493im      0.0119825-0.0626501im   -0.0436419+0.00642336im    0.181583-0.0840127im    0.0383142+0.334565im      -0.292275+0.0193274im     0.0880829-0.00791669im    -0.141237-0.148847im    0.0577665-0.0824077im    -0.178052-0.0367458im    -0.0382392-0.162578im    -0.0500313-0.00221664im     0.174887+0.0797095im    -0.107884-0.0159266im     -0.0221658+0.0489619im      0.0905408+0.134003im     -0.275954+0.0168101im
     0.186104-0.125696im    -0.0313065-0.338106im    -0.0507003+0.046238im     -0.00364968-0.0908386im      0.0599297+0.0744979im     -0.124194-0.0764883im    0.0875757-0.129061im       -0.137956+0.219346im     0.0112324+0.0581502im   -0.0606306+0.0238087im     0.0223574+0.16121im        0.208124-0.179197im     -0.158934-0.224649im    0.00536452-0.125322im     -0.120173+0.158759im       0.156569+0.0453961im     0.0711508-0.0411013im   -0.0225893-0.0187532im   -0.0978435-0.0694151im   -0.0406037-0.0129982im     -0.164127+0.27309im      -0.0957347-0.158637im      0.0198378+0.0204543im   -0.168538+0.123555im      -0.17005-0.00532965im  -2.45623e-5-0.109701im     0.0430002+0.0594278im     -0.163576+0.0973287im   -0.0354419+0.117725im      -0.0369406-0.237328im       -0.128891-0.184125im     -0.119288+0.0881429im
    0.0202587+0.0959998im    -0.166398-0.0402006im    -0.171061+0.0463966im        0.25193-0.119351im     -0.00791447-0.159372im     -0.0926158+0.135705im     -0.192532-0.0175035im      -0.156686+0.0663735im    -0.106558-0.0292531im    -0.234907+0.0670702im    0.00255363-0.0730041im     -0.028257-0.180493im     -0.115531-0.0624477im   0.00910042-0.0949472im     0.304371-0.144635im       0.179264-0.0721391im      0.133432-0.138336im    -0.0309174-0.0426546im    0.0659427-0.0853665im   -0.0134977-0.183783im     0.00890551-0.254537im     -0.0973281+0.0613235im     0.0157129-0.0547686im    -0.16229-0.088371im      0.114456-0.107861im     -0.0104209+0.0748283im   -0.0042674-0.0600782im       0.12469-0.172977im     0.0425381-0.276127im       0.0022352+0.0159309im      0.0369153-0.248408im     -0.122872+0.0920937im
    -0.229671-0.103444im    -0.0714645+0.038669im       0.17057-0.0885552im      0.0175212+0.206088im       -0.170291+0.00406064im     0.213365+0.0815298im     0.137219+0.0103565im    -0.00136889+0.00499954im    0.035934-0.0577493im   -0.0333737+0.0427422im     0.0894934+0.00214102im    0.0364451-0.177098im     -0.222804-0.056679im     0.0326311+0.0110891im   -0.0448089+0.061193im      0.0821996+0.0619715im     0.0314722-0.0545992im     0.108891+0.0718058im    0.0500971+0.160077im     0.0569944-0.0949679im     -0.120279-0.155579im       0.163052-0.158196im      -0.141267+0.104161im     0.203296-0.00918584im   -0.173421+0.229097im      0.0303022+0.386278im    0.00090124+0.163859im      -0.210215-0.0695012im   -0.0157293-0.142664im        0.117989+0.041333im      -0.0684724-0.0927587im    -0.216616+0.0502233im
    0.0292616+0.118492im      0.182567+0.123002im      0.164701-0.226022im       -0.154209-0.0851391im      0.0816372+0.117127im      -0.182416+0.038944im     -0.200987-0.185862im       0.0843273-0.0672049im     0.196065+0.168695im     -0.213042-0.0566434im     0.0507793+0.0103238im     0.0267798-0.0514215im    -0.148973-0.082022im      -0.11229-0.224241im     0.0219663-0.168659im       0.123575-0.103735im       0.171946+0.0069091im     0.142081-0.0518688im    0.0515182+0.170067im     0.0339817+0.248048im      0.0527394+0.0737967im     0.0821647-0.0235682im     -0.077273-0.0537502im   -0.087525-0.0677158im   -0.0585417-0.10963im      -0.0743401+0.174397im     0.0848289-0.155137im     -0.0887747-0.123532im    -0.0870186+0.104884im        0.197749-0.00168325im     0.0993486+0.144097im      0.112885+0.164636im
   0.00078441-0.0705742im     0.185667-0.100551im     0.0212553+0.086022im    -0.000693453-0.0837793im       0.019496+0.0585457im        -0.195-0.0401964im     0.101171-0.179959im       0.0233562-0.00753755im   -0.210026-0.0960997im    -0.137952+0.151424im    -0.00897586+0.0833145im     -0.159641+0.18584im      0.0346477-0.0255668im    0.0297832-0.150781im     -0.201582-0.170751im      -0.176625-0.0809764im     -0.158252-0.00378736im   0.0986274-0.00382084im    0.316897-0.185467im    -0.0815132+0.0644348im      0.255351-0.0598697im     -0.154533-0.244401im      0.0731592-0.0543896im    0.143814+0.0756739im    -0.095004+0.0028811im     -0.178483+0.148972im     0.0629078+0.0833771im     0.0076306+0.127449im      0.133392-0.161943im        0.054755+0.140563im      -0.0967186-0.100345im    -0.0670025+0.0707299im
      0.14062+0.113935im     0.0514729+0.137801im      0.139457-0.055982im        0.123919-0.012627im          0.1467-0.0749728im    -0.0747797+0.00166828im  -0.0541879-0.0853927im      0.0729262+0.249881im     0.0742383-0.12068im       0.281315+0.215999im      -0.273783+0.223714im       -0.14951+0.166597im     -0.169774-0.0354358im   -0.0993818-0.0419049im    0.0980873+0.14117im      -0.0567119+0.145767im     -0.0561588+0.0201506im    0.0220806-0.0943013im   -0.0676576+0.148781im     0.0839536+0.0372402im    -0.0542276+0.108086im       0.105819-0.162769im      -0.159181+0.005522im     0.152227+0.0260313im    0.0924563-0.139633im      0.0565646+0.0250813im    -0.190992-0.208642im       0.179978-0.00797511im   0.0388735-0.12911im      -0.00271292-0.0357272im      0.0272976-0.0943143im    -0.238756-0.00241605im
    -0.202718+0.0261072im    0.0421443-0.254756im    -0.0289144-0.0431392im      0.0587689-0.0689072im    -0.00575581+0.0794161im      0.253209+0.190616im      0.059477-0.00122718im    -0.0515827+0.0700592im     0.174999+0.119503im     0.0871702+0.148196im      0.0664409+0.168461im       0.178694+0.120323im      0.148541+0.176219im      0.247752-0.023206im    -0.0570168-0.0802546im    -0.0713102-0.0910758im      0.145955-0.375202im     0.0618946+0.107442im     -0.105312+0.117155im    -0.0888553+0.0449597im      0.122551+0.205036im      0.0195475+0.028152im       0.137966-0.0424118im   0.0521068-0.0648284im    0.0731775+0.0206889im    -0.0604135-0.0776971im   -0.0232791-0.148297im       0.066011-0.0310945im     0.126348-0.241951im        0.166193-0.0897032im      0.0613692+0.0547048im   -0.0317253+0.107412im
      0.13634+0.0566405im     -0.15768+0.0371093im    0.0320408+0.0325482im      -0.160897+0.14467im       -0.0843782-0.388394im     -0.0882458+0.129763im     0.0983973-0.235298im      -0.0272371-0.0796337im     0.117347+0.107631im    0.00169209+0.0808672im     0.0716011+0.174221im     -0.0232529-0.167126im      0.128954+0.0975322im   -0.0379995+0.0875704im   -0.0953389-0.0241809im     -0.201293-0.0407558im     0.0239627+0.00930095im    0.109311-0.205346im    -0.0685492+0.0228857im    -0.246093-0.158419im      0.0751721-0.0856127im     0.0249352-0.153228im     -0.0971043+0.208462im    -0.165649-0.174092im      0.180203-0.00695422im    -0.120218-0.142105im     0.0016454-0.0251569im     -0.129491+0.122149im    -0.0851564+0.103627im        0.133969+0.121148im       0.0345369+0.00962501im   -0.143093+0.0117115im
   -0.0142059+0.126604im     0.0451065+0.0892292im   -0.0222304-0.00935768im     0.0105812-0.256596im        0.197766-0.270826im      0.0660532-0.0425502im   -0.0184415+0.0483755im      -0.120104+0.271056im     0.0888448-0.0344773im    0.0591797-0.0609824im      0.234492-0.145im       -0.00657437+0.0273949im    0.0311011+0.0629499im     0.160681+0.203279im     0.0340115+0.204968im     -0.0634077+0.140105im       0.165723-0.0417946im    0.0881806-0.12366im       0.197669-0.0793551im    -0.177161-0.00790083im   -0.0242546-0.040368im      0.0161601-0.124956im      -0.101977-0.265548im     0.112055+0.135946im     -0.165007+0.0362783im     0.0453769-0.00715627im    0.127002-0.0360296im    -0.0317617-0.166916im      0.124575+0.218504im        0.164913+0.130086im      -0.0955141-0.0236504im     0.109333+0.0303455im
   -0.0537083-0.189041im    -0.0252488-0.146725im      0.249633+0.0473972im       0.045991-0.0775257im      0.0684563+0.00971567im   0.00643415-0.127498im    -0.0953237+0.0338722im      -0.206147+0.111971im    0.00740426+0.0389456im   -0.0134101+0.00635662im    0.0530049-0.0849074im      0.020808+0.0460205im    -0.176154+0.102807im     0.0186828+0.0369065im    0.0851009-0.168671im       0.013695+0.0278773im     -0.191712-0.0295097im    -0.052702+0.117937im     -0.238854+0.0469955im    0.0816383+0.056131im       0.115786-0.0876126im     -0.166785-0.24065im      -0.0749049-0.0785336im  -0.0256274+0.0420442im     0.399657-0.113113im       0.107363+0.0126159im    -0.184809+0.278598im      -0.145908-0.0101399im    0.0731609+0.182146im        0.221658+0.0945758im       0.131607+0.0541045im    0.0660901-0.0534521im
   -0.0484934-0.0388282im   -0.0819414-0.244867im    -0.0649526-0.0324962im       0.116652-0.166473im       -0.108521-0.0442102im      -0.12281+0.0483697im   -0.0996329-0.0629445im      -0.188676-0.232355im     -0.031671-0.130115im      0.152984+0.123209im     0.00495927-0.0425892im     -0.118234-0.13198im       0.091572-0.0605626im    0.0450447+0.0682704im   -0.0823638-0.134442im       0.177888+0.0498949im     -0.236641+0.288762im     -0.085042-0.222531im    -0.0507712+0.1802im       0.0312051+0.0160844im     0.0346372+0.0519656im      0.205663+0.0277381im     0.0641594-0.0940238im    0.158205+0.00427771im  -0.0582424-0.00877887im    0.0734956-0.12424im      0.0698494-0.175515im      -0.255805-0.164383im      0.175239-0.0706731im      0.0432323+0.0048854im      -0.103797+0.222728im    -0.0584238+0.0975933im
    -0.161134+0.308807im       0.14753-0.109499im     0.0609784-0.112701im        0.103202-0.306894im       -0.070202-0.0344836im     -0.029299+0.144063im      0.178847-0.103846im       0.0501599+0.0201171im      0.19192-0.0807206im   -0.0672336-0.207947im       0.032959-0.289415im     -0.0361866-0.0731088im    -0.155657-0.0291244im   -0.0804669+0.125698im     -0.182039-0.0103153im     0.0176918-0.110954im     -0.0448062+0.0265605im    -0.140348-0.0972195im    -0.195457-0.144474im    -0.0608354-0.0624714im     0.0594203+0.0575137im    -0.0552896+0.0720259im      0.114545+0.103326im     0.121122+0.0352943im   -0.0787122-0.0583008im    -0.0876017+0.0711924im    -0.301362+0.0344293im      0.122196+0.127241im     -0.130729+0.0385929im     -0.0156357+0.0387908im       0.051614+0.0172513im     -0.20695-0.0974116im
   -0.0303847-0.0673548im   -0.0850631+0.0483323im   -0.0742563+0.135424im      -0.0103222-0.141613im      -0.0578185+0.0139627im     -0.108519-0.0521926im    0.0894451+0.173967im        0.179575-0.0955999im     0.380846-0.0658269im   -0.0550445-0.0817448im     -0.134798+0.183017im     -0.0680908-0.00988322im  -0.0820017-0.00489957im   -0.127899+0.177287im     0.0392008+0.147766im    -0.00510838+0.0730097im     -0.110263-0.0878054im   -0.0367441+0.194752im    -0.0339534-0.151945im    -0.0129312-0.0482637im    -0.0562477-0.133396im      -0.135718-0.284597im        0.22874-0.169336im    -0.119123-0.143587im    -0.0906849-0.109037im      0.0126248+0.0881404im     0.222478-0.106151im      -0.110193-0.0601221im    0.0425844-0.113091im      0.00743225-0.0407965im       0.145273+0.264158im     -0.102231+0.0151464im
     0.104228-0.0406036im   -0.0454298+0.284816im    -0.0930433+0.108653im        0.148026-0.131666im       -0.218526-0.115221im     -0.0560448+0.0145151im     0.297999-0.267729im       -0.115175-0.0645474im     0.048593+0.0533745im    0.0609746+0.0899041im     -0.053138+0.0682828im      0.123373-0.0751712im   -0.0886267+0.174473im    0.00891336-0.11531im     -0.0982737+0.00896434im   -0.0576676-0.0358757im      0.170124+0.00982801im  -0.0220463-0.0092807im    0.0970621+0.144399im      0.317335+0.109391im     -0.0234236-0.0172249im      -0.22764+0.0834564im      0.176406-0.206152im    0.0771838-0.107593im      0.037123+0.0533637im     0.0239876+0.0596082im    -0.165684+0.0191149im    -0.0684241-0.115749im     0.0529893+0.0961361im     0.00379241-0.108429im       -0.144369-0.00648315im    0.125253-0.230066im
     0.184028-0.101345im      0.242872+0.00775618im     0.11056+0.0209857im     -0.0252385-0.0564311im       0.283868-0.192918im         0.1808-0.0113544im    0.0526186+0.108499im       0.0841034+0.00981406im   -0.136625+0.064234im      0.076492+0.0789208im     0.0153151-0.10841im       -0.120829-0.320683im    0.00416231-0.262724im      0.143403+0.270187im    -0.0378009-0.0235424im    -0.0990183-0.0855735im      0.017248+0.0314287im   -0.0624596+0.0077223im    0.0751669+0.156133im      0.240022+0.13272im      -0.0202292+0.11574im       -0.209797+0.106145im      0.0911673-0.0139964im   -0.142453-0.101482im     0.0692657+0.0366453im    -0.0359536+0.0493325im     0.113071+0.0366366im     0.0222381+0.0889982im    -0.109891-0.224178im        0.114078+0.041853im    -0.000640994+0.116088im     -0.137653+0.0370776im
    0.0304251-0.0709993im    0.0781882-0.00758381im    0.151728-0.221268im     -0.00506453+0.0682562im     -0.0514846+0.0673982im      0.159636+0.27971im        0.17702+0.110036im      -0.0959678+0.153346im      0.254844-0.058615im     -0.252242-0.0963049im     -0.138704+0.138102im      0.0690906-0.0358263im    -0.119382-0.00332791im  -0.0386683-0.0477324im    0.0175886+0.0331094im    -0.0530268+0.0943686im     -0.215541+0.145387im     -0.172313-0.222364im      0.202433-0.0860814im   -0.0083799+0.0535749im    -0.0314256+0.0358173im    -0.0149818+0.0955712im    -0.0274185-0.165964im    0.0524608-0.064677im      0.253819+0.0780841im     -0.106775-0.238275im      0.135967+0.0669662im   -0.00832144-0.073073im    -0.0438303-0.110557im       -0.103564+0.125201im      -0.0721797-0.117628im      0.158283+0.103246im
    -0.228191-0.077168im    -0.0126785+0.133257im     -0.155636-0.117999im       -0.132982+0.0277634im    -0.00900659-0.00294368im    0.0124124-0.0357253im   -0.0983962+0.0572818im      0.0906154+0.216476im      -0.21009-0.0205836im    -0.214049+0.131378im       0.106287+0.144536im      0.0421414-0.0926765im    -0.185987-0.147358im      0.106511-0.156292im     -0.136131+0.0757189im     -0.116805+0.0743415im     -0.141946-0.0176824im    0.0262442-0.00154383im   0.0942247+0.00112804im  -0.0847412+0.0438627im    -0.0500478-0.0319816im    -0.0559492+0.120084im       0.220795+0.0782604im  -0.0356083-0.121872im     -0.083219-0.0193757im      0.222964-0.23638im       -0.28063-0.110299im    -0.00341813-0.138343im      0.082054+0.127328im       0.0466653+0.195514im        0.139328+0.196614im     -0.171338-0.0851467im
   -0.0122073-0.102551im      0.128064+0.0767295im     0.167768-0.15362im        -0.140583+0.100952im        0.161319+0.0515037im     -0.157363-0.267452im      0.157017-0.0375187im      -0.163527+0.161im         0.176867+0.00851994im     0.15829+0.163987im    -0.00399886-0.158166im       0.137798+0.0265434im    0.0663961+0.161336im     0.0589409+0.00592089im    0.117938-0.041684im     -0.0176719-0.0820751im     0.0805187+0.0619642im    -0.274589+0.0181376im   -0.0412266-0.0654565im   -0.0597973+0.0464666im      0.159869-0.306014im      0.0491827+0.104842im       0.189961+0.0989897im   -0.136149-0.0559606im    -0.118055+0.0709807im     0.0291228+0.0186926im   -0.0729321-0.126479im      -0.155238-0.0603732im    0.0342608-0.0522757im       -0.22362+0.00850767im     -0.064094-0.0698486im    -0.148698+0.211498im
    -0.111979+0.0904785im     0.128022-0.249518im     0.0601694+0.0337299im      -0.124866+0.0548661im      -0.247535+0.121187im      -0.188567-0.181293im     -0.061959+0.129667im      -0.0615676+0.0385642im     0.082795+0.00450401im  -0.0840017+0.00801703im     0.124196+0.0978807im     -0.282173-0.188018im      0.112772+0.0041105im    -0.105143+0.0602112im     0.137833+0.122245im      -0.192932-0.00528601im     0.251046+0.0608641im    0.0244832+0.0377224im   -0.0626903+0.144715im    0.00720253+0.150413im      0.0635199-0.0461848im      -0.11798-0.0974822im    0.00754696+0.0120681im    0.159672+0.0107355im   -0.0197629-0.00739511im     0.111706-0.206053im    -0.0414433-0.01284im       0.0457032-0.169474im     -0.244685-0.182645im       0.0381849+0.0432743im      -0.148057-0.170578im     0.0626704-0.207578im
    0.0654422-0.0321263im    0.0842758-0.0421039im    0.0423542+0.0821398im       0.230679+0.000189696im    0.0173511+0.0818648im    -0.0493601-0.104424im     -0.269486+0.197741im       0.0802161-0.0863146im     0.194409-0.0338637im   -0.0963043+0.146436im      -0.211495-0.120949im      0.0970106-0.0433225im   -0.0332347+0.167628im      0.315418-0.105019im     -0.163773+0.175168im      0.0129026+0.109798im      0.0639782+0.127492im      0.189872-0.0628558im   -0.0173295+0.105253im    -0.0841939-0.204926im     0.00253396+0.0149212im     -0.201678+0.00888959im    -0.125574+0.0541297im    -0.10856-0.0846371im   -0.0666092+0.0292687im     -0.232971+0.0390533im    -0.227132-0.00752965im   -0.0771485+0.0359531im   -0.0747157-0.0591009im     -0.0913361+0.189525im       -0.167754+0.120855im      0.112097+0.0164928im
     0.200385+0.0120729im   0.00716172+0.0897748im     0.124215-0.0384479im       0.177612+0.202256im       0.0861257-0.156539im      0.0526875+0.0215815im    0.0199612-0.0223741im       -0.26613+0.166898im    -0.0268088-0.0898017im   -0.0815093-0.117493im     -0.0550335+0.0129555im     -0.234072-0.0848029im    0.0493833+0.0573224im    -0.174971-0.0398842im   -0.0644676-0.0710849im     0.0371218+0.204808im      0.0329162+0.0298307im     0.230303+0.251955im     -0.119264-0.215501im     -0.133503+0.000626736im    0.185792+0.171488im     -0.0354616+0.180969im       0.102128+0.0943075im    0.122866-0.125698im     -0.197823-0.00774774im     0.013875-0.0232761im   -0.0857872+0.0969364im      -0.12294-0.117058im     0.0222621-0.140867im       0.0459281-0.176894im       0.0778538+0.169065im       0.13949+0.0642924im
     0.285356-0.1119im       -0.173266-0.0258664im    0.0563663-0.146659im      0.00824765-0.119886im      -0.0907785+0.0737862im     0.0552916+0.135159im       0.11927-0.0175222im       0.164391-0.0754025im   0.00975408+0.130849im    -0.0341553+0.100544im       0.109461-0.316415im      0.0478316+0.00746959im    0.138742+0.0415056im   -0.0926562-0.128716im    0.00343215+0.0402439im    -0.0117411+0.292521im       0.138535+0.00684264im   0.0224787+0.109237im     0.0619515+0.0130436im    0.0172681-0.0287297im     0.0794529+0.166007im    0.000169034-0.0871933im     0.0814275-0.0148341im   0.0304438+0.120745im     0.0250227-0.158432im       0.308626+0.0043209im    0.0026196-0.106653im       -0.14775+0.108017im     -0.025977-0.148441im       -0.115215+0.359002im        0.173202-0.117836im    -0.0448581-0.0174498im
    -0.137857-0.212365im     0.0690395+0.00538714im   -0.055264+0.193281im       -0.229982-0.133889im        0.120739-0.0329696im     0.0217856+0.0952055im    0.0544534+0.0297012im     -0.0670921-0.0123119im    0.0582134-0.291714im      0.091125-0.0379858im     0.0922587-0.230811im      -0.111257-0.00799977im   -0.102406+0.134664im    -0.0386614-0.214672im     -0.215834-0.156067im      0.0565629+0.24666im        0.178466+0.0387974im     0.178606-0.0451864im   -0.0810101+0.00411911im   0.0742154+0.108274im      -0.140017+0.00793851im    0.0998348-0.17488im       0.0610008+0.166241im    -0.120001-0.185338im      0.145541+0.051958im     -0.0646405-0.0943011im     0.129348+0.0159504im      0.263546-0.136568im    0.00660472-0.0142773im       -0.15174-0.0378711im     -0.0209017-0.0434134im   -0.0421667+0.015503im</code></pre><p>and then generate the state <span>$ψ$</span></p><pre><code class="language-julia hljs">psi = P[:, 3]</code></pre><pre><code class="nohighlight hljs">32-element Vector{ComplexF64}:
     -0.161276910847981 + 0.11738504281056081im
  -0.021676523663098683 + 0.055928971393379975im
    0.14016305743066115 - 0.04743142044094927im
    0.10264620403425552 + 0.13223768676112818im
     0.1571537737727045 + 0.06006099132889066im
    0.06341115128710544 - 0.013289248475285708im
  -0.003155947581240804 + 0.04863025306698496im
 -0.0028200173930209055 + 0.11506547021527927im
   -0.07781302909056242 + 0.09817120805930775im
   -0.10471806091600565 + 0.04455425385131647im
    0.31477295737751876 + 0.0im
    0.19240117821816285 + 0.13201308399670467im
   -0.05726722834504373 + 0.032247087423522336im
   -0.26577470600367187 - 0.03571757292849249im
  -0.029606572406410563 - 0.13276629802745724im
   -0.12613333468435187 - 0.1853707767154208im
     0.1870460100151969 - 0.07531463519403049im
    0.23341586568780986 + 0.20241944452659744im
   -0.07514114308185574 + 0.053074295523824984im
    0.22425546741773716 - 0.06270240671559106im
    0.12639431292188819 + 0.03333821068976151im
   -0.08851725165977081 - 0.04645498283715369im
   -0.14469266682416942 + 0.13640452149356813im
    0.12558257342922333 + 0.03840357026718666im
   -0.07004887005000578 + 0.02480387605717663im
   0.014243851458199543 - 0.0683769590680008im
     0.2331979412799191 - 0.19379561800704298im
    0.03462516395875121 + 0.12775770372055656im
   -0.03974675913381561 - 0.09107613244282275im
   -0.21148529797648727 + 0.024100968523969923im
    0.11572201579817541 + 0.08631005758223244im
   0.006724344564308388 + 0.2297727437049969im</code></pre><p>In the phase estimation process, we will feed the state to circuit and measure the first <code>n</code> qubits processed by iQFT.</p><pre><code class="language-julia hljs">r = join(ArrayReg(psi), zero_state(N))
r |&gt; PE(N, M, U)</code></pre><pre><code class="nohighlight hljs">ArrayReg{1, ComplexF64, Array...}
    active qubits: 8/8</code></pre><p>Since our phase can be represented by 3 qubits precisely, we only need to measure once</p><pre><code class="language-julia hljs">results = measure(r, 1:N; nshots=1)</code></pre><pre><code class="nohighlight hljs">1-element Vector{BitBasis.BitStr64{3}}:
 011 ₍₂₎</code></pre><p>Recall that our QFT&#39;s bit numbering is reversed, let&#39;s reverse it back</p><pre><code class="language-julia hljs">using BitBasis
estimated_phase = bfloat(results[]; nbits=N)</code></pre><pre><code class="nohighlight hljs">0.75</code></pre><p>the phase is exactly <code>0.75</code>!</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../1.prepare-ghz-state/index.html">« Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a><a class="docs-footer-nextpage" href="../3.grover-search/index.html">Grover Search »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.10 on <span class="colophon-date" title="Monday 20 December 2021 01:04">Monday 20 December 2021</span>. Using Julia version 1.7.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
