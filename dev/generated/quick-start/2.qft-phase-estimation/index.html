<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quantum Fourier Transformation and Phase Estimation · Documentation | Yao</title><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.044/juliamono.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/indigo.css" rel="stylesheet" type="text/css"/><link href="https://yaoquantum.org/assets/favicon-light.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../index.html"><img src="../../../assets/logo.png" alt="Documentation | Yao logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../index.html">Documentation | Yao</a></span></div><form class="docs-search" action="../../../search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../index.html">Home</a></li><li><span class="tocitem">Quick Start</span><ul><li><a class="tocitem" href="../1.prepare-ghz-state/index.html">Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a></li><li class="is-active"><a class="tocitem" href="index.html">Quantum Fourier Transformation and Phase Estimation</a><ul class="internal"><li><a class="tocitem" href="#Quantum-Fourier-Transformation"><span>Quantum Fourier Transformation</span></a></li><li><a class="tocitem" href="#Wrap-QFT-to-an-external-block"><span>Wrap QFT to an external block</span></a></li><li><a class="tocitem" href="#Phase-Estimation"><span>Phase Estimation</span></a></li></ul></li><li><a class="tocitem" href="../3.grover-search/index.html">Grover Search</a></li><li><a class="tocitem" href="../4.shor-algorithm/index.html">Shor&#39;s Algorithm</a></li><li><a class="tocitem" href="../5.shor-9-code/index.html">Shor&#39;s 9 qubit code</a></li><li><a class="tocitem" href="../6.quantum-circuit-born-machine/index.html">Quantum Circuit Born Machine</a></li><li><a class="tocitem" href="../7.variation-quantum-eigen-solver/index.html">Variational Quantum Eigen Solver</a></li></ul></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../../man/array_registers.html">Array Registers</a></li><li><a class="tocitem" href="../../../man/symbolic.html">Symbolic Computation</a></li><li><a class="tocitem" href="../../../man/blocks.html">Blocks</a></li><li><a class="tocitem" href="../../../man/automatic_differentiation.html">Automatic Differentiation</a></li><li><a class="tocitem" href="../../../man/simplification.html">Simplification</a></li><li><a class="tocitem" href="../../../man/registers.html">Abstract Registers</a></li><li><a class="tocitem" href="../../../man/bitbasis.html">BitBasis</a></li><li><a class="tocitem" href="../../../man/extending_blocks.html">Extending Blocks</a></li></ul></li><li><a class="tocitem" href="../../../benchmarks.html">Benchmark</a></li><li><a class="tocitem" href="../../../dev/index.html">Developer Notes</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Quick Start</a></li><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/QuantumBFS/Yao.jl/blob/master/docs/src/quick-start/2.qft-phase-estimation/main.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><p><a href="https://mybinder.org/v2/gh/QuantumBFS/Yao.jl/gh-pages?filepath=dev/generated/quick-start/2.qft-phase-estimation/main.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a> <a href="https://nbviewer.jupyter.org/github/QuantumBFS/Yao.jl/blob/gh-pages/dev/generated/quick-start/2.qft-phase-estimation/main.ipynb"><img src="https://img.shields.io/badge/show-nbviewer-579ACA.svg" alt/></a> <a href="https://minhaskamal.github.io/DownGit/#/home?url=https://github.com/QuantumBFS/tutorials/tree/gh-pages/dev/generated/quick-start/2.qft-phase-estimation"><img src="https://img.shields.io/badge/download-project-orange" alt/></a></p><h1 id="example-qft"><a class="docs-heading-anchor" href="#example-qft">Quantum Fourier Transformation and Phase Estimation</a><a id="example-qft-1"></a><a class="docs-heading-anchor-permalink" href="#example-qft" title="Permalink"></a></h1><p>Let&#39;s use Yao first</p><pre><code class="language-julia hljs">using Yao</code></pre><h2 id="Quantum-Fourier-Transformation"><a class="docs-heading-anchor" href="#Quantum-Fourier-Transformation">Quantum Fourier Transformation</a><a id="Quantum-Fourier-Transformation-1"></a><a class="docs-heading-anchor-permalink" href="#Quantum-Fourier-Transformation" title="Permalink"></a></h2><p>The Quantum Fourier Transformation (QFT) circuit is to repeat two kinds of blocks repeatly:</p><p><img src="assets/qft.png" alt="qft-circuit"/></p><p>The basic building block control phase shift gate is defined as</p><p class="math-container">\[R(k)=\begin{bmatrix}
1 &amp; 0\\
0 &amp; \exp\left(\frac{2\pi i}{2^k}\right)
\end{bmatrix}\]</p><p>Let&#39;s define block <code>A</code> and block <code>B</code>, block <code>A</code> is actually a control block.</p><pre><code class="language-julia hljs">A(i, j) = control(i, j=&gt;shift(2π/(1&lt;&lt;(i-j+1))))</code></pre><pre><code class="nohighlight hljs">A (generic function with 1 method)</code></pre><p>Once you construct the blockl you can inspect its matrix using <code>mat</code> function. Let&#39;s construct the circuit in dash box A, and see the matrix of <span>$R_4$</span> gate.</p><pre><code class="language-julia hljs">R4 = A(4, 1)</code></pre><pre><code class="nohighlight hljs">(n -&gt; control(n, 4, 1 =&gt; shift(0.39269908169872414)))</code></pre><p>If you have read about <a href="generated/quick-start/2.qft-phase-estimation/@ref example-ghz">preparing GHZ state</a>, you probably know that in Yao, we could just leave the number of qubits, and it will be evaluated when possible.</p><pre><code class="language-julia hljs">R4(5)</code></pre><pre><code class="nohighlight hljs">nqubits: 5
control(4)
└─ (1,) shift(0.39269908169872414)</code></pre><p>its matrix will be</p><pre><code class="language-julia hljs">mat(R4(5))</code></pre><pre><code class="nohighlight hljs">32×32 LinearAlgebra.Diagonal{ComplexF64, Vector{ComplexF64}}:
 1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im</code></pre><p>Then we repeat this control block over and over on different qubits, and put a Hadamard gate to <code>i</code>th qubit to construct <code>i</code>-th <code>B</code> block.</p><pre><code class="language-julia hljs">B(n, k) = chain(n, j==k ? put(k=&gt;H) : A(j, k) for j in k:n)</code></pre><pre><code class="nohighlight hljs">B (generic function with 1 method)</code></pre><p>We need to input the total number of qubits <code>n</code> here because we have to iterate through from <code>k</code>-th location to the last.</p><p>Now, let&#39;s construct the circuit by chaining all the <code>B</code> blocks together</p><pre><code class="language-julia hljs">qft(n) = chain(B(n, k) for k in 1:n)
qft(4)</code></pre><pre><code class="nohighlight hljs">nqubits: 4
chain
├─ chain
│  ├─ put on (1)
│  │  └─ H
│  ├─ control(2)
│  │  └─ (1,) shift(1.5707963267948966)
│  ├─ control(3)
│  │  └─ (1,) shift(0.7853981633974483)
│  └─ control(4)
│     └─ (1,) shift(0.39269908169872414)
├─ chain
│  ├─ put on (2)
│  │  └─ H
│  ├─ control(3)
│  │  └─ (2,) shift(1.5707963267948966)
│  └─ control(4)
│     └─ (2,) shift(0.7853981633974483)
├─ chain
│  ├─ put on (3)
│  │  └─ H
│  └─ control(4)
│     └─ (3,) shift(1.5707963267948966)
└─ chain
   └─ put on (4)
      └─ H
</code></pre><h2 id="Wrap-QFT-to-an-external-block"><a class="docs-heading-anchor" href="#Wrap-QFT-to-an-external-block">Wrap QFT to an external block</a><a id="Wrap-QFT-to-an-external-block-1"></a><a class="docs-heading-anchor-permalink" href="#Wrap-QFT-to-an-external-block" title="Permalink"></a></h2><p>In most cases, <code>function</code>s are enough to wrap quantum circuits, like <code>A</code> and <code>B</code> we defined above, but sometimes, we need to dispatch specialized methods on certain kinds of quantum circuit, or we want to define an external block to export, thus, it&#39;s useful to be able to wrap circuit to custom blocks.</p><p>First, we define a new type as subtype of <code>PrimitiveBlock</code> since we are not going to use the subblocks of <code>QFT</code>, if you need to use its subblocks, it&#39;d be better to define it under <code>CompositeBlock</code>.</p><pre><code class="language-julia hljs">struct QFT &lt;: PrimitiveBlock{2}
    n::Int
end

YaoBlocks.nqudits(q::QFT) = q.n</code></pre><p>Now, let&#39;s define its circuit</p><pre><code class="language-julia hljs">circuit(q::QFT) = qft(q.n)</code></pre><pre><code class="nohighlight hljs">circuit (generic function with 1 method)</code></pre><p>And forward <code>mat</code> to its circuit&#39;s matrix</p><pre><code class="language-julia hljs">YaoBlocks.mat(::Type{T}, x::QFT) where T = mat(T, circuit(x))</code></pre><p>You may notice, it is a little ugly to print <code>QFT</code> at the moment, this is because we print the type summary by default, you can define your own printing by overloading <code>print_block</code></p><pre><code class="language-julia hljs">YaoBlocks.print_block(io::IO, x::QFT) = print(io, &quot;QFT($(x.n))&quot;)</code></pre><p>Since it is possible to use FFT to simulate the results of QFT (like cheating), we could define our custom <code>apply!</code> method:</p><pre><code class="language-julia hljs">using FFTW, LinearAlgebra

function YaoBlocks.apply!(r::ArrayReg, x::QFT)
    α = sqrt(length(statevec(r)))
    invorder!(r)
    lmul!(α, ifft!(statevec(r)))
    return r
end</code></pre><p>Now let&#39;s check if our <code>apply!</code> method is correct:</p><pre><code class="language-julia hljs">r = rand_state(5)
r1 = r |&gt; copy |&gt; QFT(5)
r2 = r |&gt; copy |&gt; circuit(QFT(5))
r1 ≈ r2</code></pre><pre><code class="nohighlight hljs">true</code></pre><p>We can get iQFT (inverse QFT) directly by calling <code>adjoint</code></p><pre><code class="language-julia hljs">QFT(5)&#39;</code></pre><pre><code class="nohighlight hljs"> [†]QFT(5)</code></pre><p>QFT and iQFT are different from FFT and IFFT in three ways,</p><ol><li>they are different by a factor of <span>$\sqrt{2^n}$</span> with <span>$n$</span> the number of qubits.</li><li>the <a href="https://quantumbfs.github.io/BitBasis.jl/stable/tutorial/#Conventions-1">bit numbering</a> will exchange after applying QFT or iQFT.</li><li>due to the convention, QFT is more related to IFFT rather than FFT.</li></ol><h2 id="Phase-Estimation"><a class="docs-heading-anchor" href="#Phase-Estimation">Phase Estimation</a><a id="Phase-Estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Phase-Estimation" title="Permalink"></a></h2><p>Since we have QFT and iQFT blocks we can then use them to realize phase estimation circuit, what we want to realize is the following circuit:</p><p><img src="assets/phaseest.png" alt="phase estimation"/></p><p>First we call Hadamard gates repeatly on first <code>n</code> qubits.</p><pre><code class="language-julia hljs">Hadamards(n) = repeat(H, 1:n)</code></pre><pre><code class="nohighlight hljs">Hadamards (generic function with 1 method)</code></pre><p>Then in dashed box <code>B</code>, we have controlled unitaries:</p><pre><code class="language-julia hljs">ControlU(n, m, U) = chain(n+m, control(k, n+1:n+m=&gt;matblock(U^(2^(k-1)))) for k in 1:n)</code></pre><pre><code class="nohighlight hljs">ControlU (generic function with 1 method)</code></pre><p>each of them is a <code>U</code> of power <span>$2^{(k-1)}$</span>.</p><p>Since we will only apply the qft and Hadamard on first <code>n</code> qubits, we could use <code>Subroutine</code>, which creates a context of a sub-scope of the qubits.</p><pre><code class="language-julia hljs">PE(n, m, U) =
    chain(n+m, # total number of the qubits
        subroutine(Hadamards(n), 1:n), # apply H in local scope
        ControlU(n, m, U),
        subroutine(QFT(n)&#39;, 1:n))</code></pre><pre><code class="nohighlight hljs">PE (generic function with 1 method)</code></pre><p>we use the first <code>n</code> qubits as the output space to store phase <span>$ϕ$</span>, and the other <code>m</code> qubits as the input state which corresponds to an eigenvector of oracle matrix <code>U</code>.</p><p>The subroutine here uses <code>focus!</code> and <code>relax!</code> to manage a local scope of quantum circuit, and only activate the first <code>n</code> qubits while applying the block inside the subroutine context, and the scope will be <code>relax!</code>ed back, after the context. This is equivalent to manually <code>focus!</code> then <code>relax!</code></p><p>fullly activated</p><pre><code class="language-julia hljs">r = rand_state(5)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>first 3 qubits activated</p><pre><code class="language-julia hljs">focus!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 3/5
    nlevel: 2</code></pre><p>relax back to the original</p><pre><code class="language-julia hljs">relax!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>In this way, we will be able to apply small operator directly on the subset of the qubits.</p><p>Details about the algorithm can be found here: <a href="https://en.wikipedia.org/wiki/Quantum_phase_estimation_algorithm">Quantum Phase Estimation Algorithm</a></p><p>Now let&#39;s check the results of our phase estimation.</p><p>First we need to set up a unitary with known phase, we set the phase to be 0.75, which is <code>0.75 * 2^3 == 6 == 0b110</code> .</p><pre><code class="language-julia hljs">N, M = 3, 5
P = eigen(rand_unitary(1&lt;&lt;M)).vectors
θ = Int(0b110) / 1&lt;&lt;N
phases = rand(1&lt;&lt;M)
phases[0b010+1] = θ
U = P * Diagonal(exp.(2π * im * phases)) * P&#39;</code></pre><pre><code class="nohighlight hljs">32×32 Matrix{ComplexF64}:
  -0.0398341-0.0577269im     0.114612+0.017279im        0.0340241+0.0876151im   -0.129763+0.0642409im    0.0272952+0.183618im      -0.0271538-0.103245im     0.0245286+0.0468004im      0.220894+0.0552261im    0.0109886-0.162393im      0.292406-0.0640339im     0.157693-0.326155im     0.00239582+0.0817041im       0.144796+0.11302im       -0.239637+0.150568im      -0.0479489-0.169536im     0.132783-0.190964im     -0.00144329+0.216412im     -0.0220969+0.071358im      0.00860249+0.0551227im   -0.0809926+0.0226494im    -0.0692813+0.158269im     -0.0650638+0.000358589im   0.0899519-0.0274794im     0.0661179+0.0189939im     0.0724419-0.0222013im        -0.1275-0.0762085im    -0.259247-0.1429im        0.134092+0.141351im     -0.0151409+0.084884im         0.1485-0.0805118im     0.185113+0.0510207im   -0.0244161-0.24752im
    0.132966-0.0939926im     0.112007-0.291852im        -0.136591-0.0278989im  -0.0924069-0.198124im   -0.00163942+0.0778978im     -0.0445064-0.0617846im     0.085093+0.10612im      -0.0509213+0.00390334im    0.255557+0.0683653im   -0.0140359+0.155598im     -0.134472+0.126254im      0.0269794+0.0179707im      0.0978293-0.158502im      -0.175223+0.113696im       -0.186242-0.0263975im   -0.116389-0.094193im       -0.207676+0.124637im       0.133349-0.0881092im     -0.0649704-0.0146023im   -0.0330294-0.0121092im    -0.0125297-0.0186461im     -0.134235+0.108729im     -0.0321087-0.0998815im     0.0734172-0.113659im      0.0232071+0.0256593im     0.00197458+0.448184im     -0.174911-0.161796im    0.00465094-0.0519604im    -0.0843284-0.0137932im    -0.0494997+0.254155im    0.00553596-0.0590927im    0.0699146+0.126902im
  -0.0597966+0.067746im     0.0825382-0.184347im       -0.0754737+0.0188646im  -0.0811662+0.0421592im    -0.208975-0.0496049im     -0.0275115-0.0464749im     0.127383+0.0310736im    0.00480075+0.0188654im   -0.0794221-0.143287im    -0.0629591-0.16648im      -0.070418-0.0610453im     -0.168196+0.254914im       0.0814516+0.0532874im      0.106849-0.0873834im      0.0206483+0.0191047im   -0.212787-0.0844117im      -0.194858+0.0703906im     -0.124666+0.0217327im       0.109849+0.0519188im   -0.0547819-0.102615im       0.201439-0.250459im        0.24323-0.208279im        0.17444+0.0602453im     0.0413856+0.00062916im    0.0263062-0.269885im      -0.0754044-0.125825im     -0.173024-0.0932863im    -0.132101-0.200598im      0.0744698-0.119695im      0.0860275+0.022158im    -0.0304516+0.0124642im     0.266821+0.0868105im
   -0.124197-0.0989497im      0.10086+0.147657im         0.118053+0.0744099im   0.0195175+0.0640845im    0.0175553-0.0542275im      0.0825755-0.0892157im     0.110697-0.220477im       0.118553-0.0300454im   -0.0476043+0.168269im     0.0361057+0.0622594im    -0.116969-0.0194376im     -0.209311-0.0705819im     0.00176943-0.0994795im     -0.274951+0.103713im       0.0811373+0.130065im    -0.294884+0.0161134im      0.0872722+0.093552im     -0.0106903+0.292665im       0.0280234-0.0301555im     0.164314+0.0635219im      0.151732-0.181419im      -0.089304-0.040414im       0.142791-0.0943666im     -0.138349-0.0024945im      0.282786-0.0345809im       0.124409+0.0435777im     0.107232-0.124899im    -0.0833621+0.248048im      -0.147615+0.0623341im     0.0427305-0.0080093im    -0.101384+0.124188im    -0.0624405+0.13887im
   -0.295739+0.120589im     -0.178663-0.183404im        -0.110101+0.0415679im     0.18388-0.178414im     0.0981248+0.000351308im   -0.0809955+0.0335103im    -0.018373+0.0029031im     0.0822171+0.00666553im  -0.0282122-0.15419im      0.0423913+0.125435im       0.11587-0.0548926im     0.0847168+0.107645im      -0.0547304+0.0296374im    -0.0992868-0.234598im       0.0316937+0.0455226im   0.0413787-0.0855921im      -0.152262+0.102102im       0.028447+0.140381im       0.0581088-0.0106931im     0.124499+0.0699212im     -0.230653-0.224081im       0.256094+0.00548199im    -0.144356-0.0731677im     -0.188627-0.0650588im      0.172198+0.0308944im     -0.0899465+0.0117797im   -0.0100887+0.0522385im    0.0582377-0.00782224im  -0.00562484+0.130155im     -0.0817573-0.0224508im     0.200918-0.151876im     -0.259207+0.239493im
   -0.189564+0.0563427im     0.119645-0.119503im       -0.0877773-0.186355im   -0.0931741-0.0457089im    -0.159362-0.117181im      -0.0318037+0.0767756im   -0.0637355+0.0850603im    -0.0286536-0.0915817im   -0.0937665-0.00967115im    0.112123-0.215211im     -0.125646+0.0046663im      -0.05094+0.0687461im       0.201577-0.196703im      -0.014767+0.0321672im   -0.000325267-0.0144358im    0.179657-0.0304898im      -0.164086+0.139232im      -0.118788+0.135295im       -0.206109+0.0301769im    -0.055849+0.00189001im    -0.108147+0.0312642im     0.0602147+0.0892772im     0.0751076-0.058894im      0.0142085+0.220224im     -0.0839164+0.13143im         0.193276+0.0885776im     0.394437+0.159278im    0.00647175+0.0667512im     -0.281544+0.0103705im     0.0975312-0.145634im     0.0704265-0.0682389im     0.158174-0.0253337im
 -0.00274164+0.199052im      0.146105+0.152284im        0.0720523+0.0728632im   -0.230309-0.0370769im   -0.0449905+0.153875im       -0.121773+0.039645im     0.0728636-0.0892153im     -0.173719-0.0234497im     0.232425+0.0547988im   -0.0255455-0.102737im     -0.124303+0.05783im      -0.0382208-0.0487641im      -0.213636+0.0884255im   -0.00602155-0.0349224im     -0.0900503-0.0187599im   0.0614753-0.111913im         -0.2638-0.102694im     -0.0434929+0.00797287im     -0.104981-0.22646im       0.145267-0.0273168im    -0.0427424+0.0268804im      0.141757+0.0109421im      0.088018-0.202543im      -0.011561-0.0707906im     0.0659735+0.149023im      -0.0390251-0.147175im     -0.272017+0.234549im    -0.0447959+0.195096im     -0.0467408+0.103288im     -0.0102616-0.157151im     -0.253049-0.173517im     0.0224791-0.0206im
   -0.193222-0.185435im     -0.248029-0.0165429im      -0.0667688+0.184487im   -0.0218733+0.03472im      -0.155024+0.0461457im       0.150828+0.163124im     0.0392703-0.172606im      0.0664652-0.330933im    -0.0502257+0.275786im     0.0156667+0.0535611im   -0.0515577+0.00643949im    0.0245254+0.0710248im       0.128594+0.00909497im    -0.023086-0.0235387im      0.0716337-0.0222958im  0.00104013-0.0132576im      -0.154957+0.0578132im     0.0484629-0.123956im       -0.104921+0.0786796im   -0.0399147-0.164438im    -0.00932719+0.00814859im    0.0100625+0.27037im      -0.0453724+0.0107616im     -0.114962-0.0259385im      0.203981+0.126216im       -0.150403-0.0797006im   -0.0457077-0.00175402im    0.223196-0.0413847im      0.149648-0.269087im      -0.112732-0.0693889im    -0.124065+0.0463951im     0.147007-0.141548im
  -0.0796613-0.318541im     0.0599026+0.00329957im    -0.00904041-0.165959im    0.0223511+0.177649im      0.207212+0.0916997im       0.247558-0.0251494im    0.0275406-0.118561im      0.0129661-0.0664641im      0.12911-0.22702im     -0.0645742-0.066815im     -0.147607-0.076942im      0.0957153-0.133959im      -0.0412788-0.0603988im    -0.0604169-0.126009im       0.0385223-0.078104im     0.206202+0.0896142im      -0.047183-0.0493652im      0.285242+0.283814im       -0.119588-0.0728346im     -0.11458+0.0917251im    -0.0261249+0.0405412im      0.217343-0.0883424im    -0.0611876+0.0961893im    -0.0458048-0.112516im     -0.0782476-0.159146im       0.0684316+0.011541im    -0.0116007-0.157776im    -0.0437829+0.0322418im     0.0457078-0.131346im     -0.0234098-0.00983619im   -0.137123-0.246339im      0.158098+0.00216649im
  -0.0334853-0.0400324im    -0.209778-0.0370747im        0.142084-0.0442265im    0.240851+0.0637237im    -0.286942+0.0758812im      0.0889511+0.157343im    -0.0552073+0.183285im     0.00135062+0.0157442im     0.254966+0.0351844im     0.138114-0.274138im      0.136157+0.0772807im    -0.0899069-0.0849085im       0.111144-0.0425548im    -0.0927885-0.0242457im     0.00140347+0.167791im    0.0261578-0.0739701im      0.0454526+0.0222469im      0.224053-0.0313821im    -0.00373884+0.0115028im    0.0778301-0.0904341im     0.0885581+0.0988393im      0.155166-0.124048im       0.176382-0.157884im       -0.11663+0.00350354im    -0.213226+0.0795555im   -0.000605025+0.176066im    -0.0558035-0.00734792im   -0.161183+0.136434im       0.272577+0.00965759im    0.0460932-0.071716im     0.0267105+0.163276im     -0.101719+0.0853562im
  -0.0668282-0.138947im     0.0739881+0.000928897im    -0.0914381-0.0697918im  -0.0212463+0.0979264im    0.0458964-0.0202779im     -0.0923745+0.0522674im    -0.160162-0.0814553im      0.147574+0.122704im     0.0327406-0.0724665im    -0.157016-0.00477701im  -0.0969394+0.0468095im    -0.0493879-0.211649im      0.00912937-0.213091im      -0.229727+0.101097im      -0.0857211-0.160822im    -0.097434+0.179789im      -0.0813852-0.095827im      -0.223791-0.24691im         0.255713+0.0523608im   -0.0265951-0.324712im      -0.243664+0.00461027im     0.125404-0.118086im       0.201342-0.0239372im     -0.106127+0.0205607im     0.0911823+0.0553115im     0.00934482+0.0243348im    0.0824085-0.059625im    -0.0311295-0.0845986im        0.1887+0.139921im     -0.0771839-0.102598im     0.0234708-0.132852im    -0.0645608-0.153893im
  0.00172854+0.11411im       0.212703-0.140492im       -0.0736398+0.0560384im   0.0184406+0.104696im      0.039656-0.0308915im       0.325755-0.255511im      0.178243+0.0525532im   -0.00218892-0.095066im     0.0830102+0.05562im       0.116825-0.00743824im   0.0480259+0.236858im    -0.00796161-0.220378im        0.190505+0.147384im       0.177495-0.140591im        0.111956+0.0207538im  -0.0808383+0.107887im       0.0514592+0.273717im     -0.0681324-0.0798582im     -0.0440736-0.0455532im    0.0438211-0.0516319im    -0.0888935+0.0286165im     -0.145271+0.00223928im     0.157344+0.1166im       -0.0477743+0.0605247im   -0.00292898+0.0398762im       0.111554-0.113753im     -0.124475+0.048297im      -0.06052+0.0591328im     0.0726408+0.0170048im     -0.256235-0.110205im      0.212639-0.236991im    -0.0603117+0.0424684im
   0.0759629-0.22107im     0.00173714+0.0614535im        0.166367+0.159654im     0.129769-0.0879455im   -0.0302373+0.232948im       -0.107552-0.0150588im   -0.0454644+0.229171im     -0.0862528-0.152618im     -0.185477-0.108805im    -0.0121065+0.120591im    -0.0236051+0.188366im      -0.105289+0.00143682im     -0.255802-0.035345im       -0.17423+0.145843im        0.160854-0.0193833im   -0.146754-0.00317598im    -0.0966853+0.0552967im   -0.00210669+0.162814im      -0.0908503+0.0254675im   -0.0493811+0.0120044im     0.0484226+0.0168821im      0.136325+0.0530822im      0.273321+0.275544im       0.104526-0.0371842im     -0.183788+0.0538183im     -0.0475934-0.0416752im    0.0243044+0.195588im      0.195622-0.017942im      0.0125958+0.117008im      -0.158066+0.0367355im     0.166564-0.0516876im    0.0968823+0.0437388im
 -0.00587852-0.0937036im   -0.0618592+0.188691im       -0.0918112-0.103622im     -0.30508+0.109863im    -0.0136366-0.164802im         -0.1005-0.230832im      0.152691-0.067209im     -0.0634973-0.0547045im   -0.0710308+0.112562im    -0.0899584-0.23397im       0.049301+0.0926742im     0.0355668+0.12589im        -0.229041-0.0767746im      0.065576+0.0196543im       0.103434+0.0154738im    0.166365-0.12656im       -0.0436279+0.0735954im    -0.0267425-0.0673523im      -0.120566+0.104875im     -0.303488-0.0668651im     -0.106004-0.0635722im    -0.0801412-0.000893347im   0.0687919+0.105164im      -0.227828-0.147534im     -0.0434821-0.100209im       -0.190622+0.158119im     0.0353384-0.0254526im    -0.035912+0.19141im        0.137356+0.103307im    -0.00764002+0.0615706im     0.113853+0.0735461im    -0.186472+0.173288im
 0.000239755+0.0895081im    0.0363653+0.0255699im       -0.137724+0.0224252im   -0.097748-0.0512416im     -0.12216+0.100021im        0.191214+0.0324708im     0.044517-0.0853292im       0.26165+0.0950319im   -0.0758992-0.0865486im     0.150239+0.111149im     0.0622672+0.236364im      0.0884028-0.025262im        0.150093+0.0620749im     0.0456288+0.212657im      0.00020572-0.229332im    -0.231483-0.163817im        0.112365-0.246299im       0.105758-0.0292799im     -0.0139618+0.037829im     -0.280557+0.0292097im    -0.0621083-0.145358im        0.26874+0.150684im     0.00369061-0.0465608im     0.0982784+0.044009im      -0.166731-0.024645im      -0.0535732-0.0609051im    0.0881639+0.0778108im   -0.0734036+0.188089im     -0.0641986-0.0580878im    0.00165984+0.0485944im    -0.185229-0.0468621im    -0.196181+0.106496im
     0.13631-0.170472im     0.0740008+0.0833834im    -0.000669839+0.230203im    0.0473329-0.0525295im   -0.0410703+0.115396im       0.0025469-0.0354588im     0.220752+0.0577599im    -0.0663476+0.0512673im    -0.118743-0.0883502im    0.0757716-0.00474004im   -0.273806+0.208694im      -0.210875-0.0977449im      -0.052314-0.00874865im    0.0819012-0.0754285im      -0.182979-0.0126229im    0.132954-0.141823im        0.172125-0.0198456im    -0.0390275-0.0614678im     -0.0611182+0.0615258im     0.222933+0.0350236im     -0.350265+0.00588376im    0.0600692+0.00787689im   -0.0444589-0.274747im     -0.0712836-0.0211384im    0.00958353-0.213412im      -0.0791397-0.0600683im     0.144984-0.0713796im    0.0481685-0.0765269im     0.0339494-0.241099im       0.161014-0.0436397im       0.1765+0.0884055im    0.0122492+0.0231709im
     0.16574+0.0240404im   -0.0684674-0.0757526im       0.0597971+0.0186228im   -0.209971+0.195424im     -0.039036-0.0597084im      -0.148489-0.0261155im    0.0848774-0.038747im      -0.187362-0.0856119im   -0.0473236-0.107417im      0.128492+0.327496im      0.033018-0.153061im      -0.245638-0.00276544im     0.0565724-0.102908im        0.12811+0.049908im        0.185304+0.166326im   -0.0316237-0.10436im       -0.0865408-0.194597im       0.258831-0.0565204im       0.041026-0.109675im    -0.0404849+0.0982044im    -0.0474775-0.0691057im      0.115317-0.0998392im    -0.0129405-0.00384291im   -0.0424069+0.269846im      0.0977864+0.0555308im     -0.0106488+0.178799im     0.0609076-0.048636im    -0.0994026+0.0596418im     0.0617106-0.0588702im     -0.159927-0.0916324im     0.149508-0.102878im    -0.0742904-0.27892im
    0.057229-0.282541im     0.0516391-0.122167im       -0.0371145+0.0535915im   0.0350346+0.0300265im   -0.0831122-0.0398519im     0.00731855-0.0308734im    0.0621387-0.106244im     -0.0998011-0.0552517im    0.0093192+0.0459379im    0.0275226-0.127009im      0.221926-0.17386im         0.16363-0.197509im       -0.225482+0.00873937im    -0.162057+0.119051im      -0.0934485-0.034866im   -0.0725738-0.0824363im      -0.123166+0.0393095im      0.183218-0.0825845im     -0.0459106-0.0923052im    -0.118248-0.00415004im   -0.0340602-0.081895im      -0.128204+0.0347728im    -0.0573114-0.159142im       0.070988+0.243525im      0.0232972-0.0407885im    -0.00868507-0.275495im     0.0602519+0.129773im     -0.282498-0.322945im      -0.119625+0.0192526im    -0.0911701-0.128293im     0.0739742+0.111293im    -0.0432169+0.188205im
  -0.0876652-0.0631808im   -0.0259594-0.0417728im       -0.265997+0.162338im    -0.044149+0.238167im      0.125177-0.056742im        0.151643-0.0626355im     0.150054+0.388311im      -0.130037+0.119719im       0.12643-0.00325058im  -0.0894346+0.00470207im   0.0406096-0.15724im     -0.00416744+0.261797im      -0.0960184-0.0436803im    -0.0362546+0.0855916im     -0.0229736-0.0997136im   -0.169406+0.21057im        0.0725843-0.0499968im     0.0300367+0.0146903im    0.000232955-0.137556im      0.250051-0.113756im     -0.0205696+0.107751im      0.0422072+0.132096im     0.00319787+0.106217im      -0.137278+0.187794im      -0.104605+0.0470168im       -0.25557+0.0303251im    0.0771506+0.0276513im    0.0120117+0.0799617im     -0.130402-0.0614373im       0.12139-0.0673182im    -0.130953-0.00155792im  -0.0728717+0.0495711im
   0.0157135-0.0807015im    -0.156317-0.104967im       -0.0509946-0.183115im    0.0709836-0.0490817im    0.0259733-0.121414im       0.0308384+0.0973545im    0.0534324+0.00963188im     0.173244-0.00384809im     0.11441+0.01693im      -0.115666-0.214639im      0.133311+0.190503im      0.0273018-0.0329358im      -0.103913+0.141057im     0.00816803-3.55164e-5im    -0.0185183+0.126594im   -0.0441451-0.137562im        0.143731-0.102322im        0.01686-0.0941101im     0.00719961-0.367803im   -0.00835189+0.142055im      -0.164316+0.0140657im     0.0330204-0.0592877im      0.270247+0.152051im       0.172675+0.0638058im      0.355384-0.14im           -0.124581+0.107899im     0.0180319+0.0499402im     0.176941+0.061107im      -0.214298-0.0422338im     0.0309135+0.0182677im    0.0590693+0.0177862im     0.118075-0.152665im
    0.034118+0.114198im    0.00201213+0.113127im        -0.283717-0.0952555im    0.161844+0.0505197im      0.18169+0.229885im      -0.0962991+0.259766im      0.154455-0.170722im      -0.149251+0.132906im    -0.0542899+0.0384695im     0.154776-0.0227277im     0.061041+0.0501906im     -0.192499-0.0418782im       0.178295-0.104104im     -0.0870875+0.124384im       0.0397184+0.131982im     0.111954+0.0695015im       0.112401+0.0115909im     -0.145813-0.0703344im      -0.203027-0.162235im     -0.120809+0.138859im      0.0258182-0.130239im    -0.00317084+0.0430336im     0.0295741+0.114497im      -0.126944+0.0345563im     -0.106616+0.0230738im      -0.157669+0.0035934im    -0.132074-0.17904im      0.0486974-0.213845im     -0.0235588+0.14994im      -0.0812081-0.179869im    -0.0781759+0.051969im     0.0929305+0.134705im
  0.00791125-0.164414im     0.0229552+0.0558851im       0.0785064-0.0109302im   -0.095352-0.339021im     -0.161642-0.0413693im     -0.0179127-0.0879231im    -0.100835-0.0277942im     0.0530125+0.239306im     0.0993861+0.0562275im    0.0279189+0.0183655im    0.0326722-0.114176im       0.103927+0.000205009im   -0.0688822-0.0842494im      0.104166-0.0250135im      -0.325148+0.26362im     -0.120819+0.0921615im      0.0277712+0.143797im     -0.0360557+0.0118998im      -0.219685+0.0307006im  -0.00197459+0.100569im      0.0478746-0.188882im     0.00615943-0.0714957im     0.0521751+0.119991im      -0.114393+0.233303im      -0.144771-0.0701407im     -0.0502866-0.0839461im     0.025085-0.11284im       0.247116+0.0507345im       0.12034-0.114247im     -0.0833799-0.119084im     -0.124499-0.200396im     -0.153032-0.145538im
   0.0419188+0.210354im     0.0400011+0.122837im        -0.116791+0.0592081im    0.217862+0.139278im     0.0976526-0.05008im       -0.0160559-0.0265035im   -0.0881971+0.0735354im    -0.0140441+0.114475im     0.0563779+0.00824999im    0.203896+0.0017135im     0.116787-0.163295im     -0.0143631-0.0137327im      -0.130842-0.0366982im     0.0246387+0.0481802im     -0.0849553+0.333975im       -0.112-0.0837052im      -0.103753-0.0783979im      0.143074+0.03911im        0.0542185+0.202498im     -0.156147-0.224212im      -0.163084-0.0623105im       -0.1551+0.115015im       0.159027-0.0367428im     0.0656336-0.378867im     0.00926013-0.0762993im      0.0233701-0.00193329im     0.12898+0.0391434im    0.0313625+0.0279504im     -0.124126-0.226104im     -0.0360563-0.126457im    -0.0281013-0.181512im       0.15687-0.0162698im
  -0.0411255+0.11099im       0.118823-0.352726im         0.134474+0.0532801im  -0.0781409-0.0528748im    0.0279308+0.314705im        0.143991+0.0753135im    0.0658755-0.0916432im     -0.140271+0.0325931im    -0.117642+0.0564967im    -0.121386+0.0250679im   -0.0185421-0.170256im       0.117049+0.183139im       0.0413971+0.0152885im     -0.136149+0.0511918im      -0.105208+0.172797im     0.182919+0.00450067im    -0.0142659-0.222887im     -0.0122366-0.178403im       0.0376654+0.0219734im    0.0242071+0.0730815im    -0.0795741+0.11874im      -0.0313122+0.07625im        0.268047+0.200296im      -0.149407-0.0419955im     0.0322892-0.207081im        0.231989-0.0925179im     0.122139+0.0274234im   -0.0469371+0.133228im      0.0669539-0.0360573im    -0.0804134+0.0682091im   -0.0216978+0.131968im     -0.118985+0.0872574im
   0.0908885+0.105951im    -0.0334026-0.0966497im       0.0719874+0.102061im    -0.118434-0.121241im     0.0462849-0.256743im        0.196648+0.3639im       0.0246983-0.304564im      -0.246641-0.157663im     0.0585376-0.330235im    -0.0319447-0.0745924im    0.0236684+0.00503832im    -0.126651-0.0769953im      -0.107907+0.0267216im    -0.0565623-0.0459213im     -0.0561269-0.089576im   -0.0287636+0.113946im      -0.0416121+0.108229im      0.0172087+0.015375im        0.172138+0.0841277im   -0.0133433-0.0144764im      0.034535-0.046802im      -0.132038+0.080307im       0.159825+0.0347526im      0.134585-0.0125162im      -0.17668+0.0894204im      -0.149597+0.0249132im    0.0105952-0.162312im      0.137998+0.107223im     -0.0787288-0.0934708im      0.139486-0.0647476im    0.0861705-0.00470426im   -0.172632+0.0695992im
  -0.0742117-0.161806im     0.0581983+0.186046im       -0.0689771+0.199838im   -0.0247296-0.0191284im      0.02992-0.197675im       -0.177897+0.0163908im   -0.0682996+0.0263995im     -0.275202+0.023624im     0.0668059-0.140246im    -0.0932008-0.102386im     -0.063288+0.131086im       0.233337+0.150497im        0.432695+0.0367714im    -0.0442655+0.153325im       0.0127344+0.234418im   -0.0812192+0.0144747im   -0.000847755-0.067739im       0.058954+0.118264im      -0.0158156-0.133024im     -0.076145+0.00672959im    -0.166831+0.0695529im     0.0343702-0.101884im      0.0194236+0.00559397im    0.0933882-0.0875894im     0.0761953+0.201916im       0.0759777-0.27782im     -0.0418611-0.116938im    -0.0178537+0.0286854im      0.048611-0.0690402im    -0.0417287+0.172534im     0.0901185+0.0629791im   -0.0878533+0.0461331im
   0.0519162+0.213978im    -0.0523187+0.111371im         0.157508-0.201902im    0.0560674+0.0547177im     0.110821+0.0325061im     -0.0988759-0.0408801im    0.0555271+0.0874472im     0.0192149+0.027228im     -0.309394-0.108791im      -0.15723-0.189855im      0.125106+0.0558797im     0.0234893-0.121558im     -0.00212133+0.0241607im    -0.0223181-0.0596317im      -0.131906-0.0306216im   -0.196226+0.105001im       -0.223152+0.0422107im     0.0581667+0.128489im       -0.174722-0.0103757im    0.0874873-0.0214184im     -0.161711-0.00402826im    0.0521907+0.436641im      0.0279524+0.0133478im   -0.00686272+0.169198im      0.0510217+0.00280148im     0.0885111+0.0562881im    -0.152504-0.224207im     -0.159006+0.00326853im     0.117165-0.149158im     -0.0159343+0.093259im    -0.0194972+0.124328im    -0.0549196-0.132245im
  -0.0468788+0.0690198im   0.00363314+0.233731im       -0.0745325-0.166992im     -0.01707+0.0244813im   -0.0949742+0.0791958im      0.0455769+0.00990329im   0.0457189-0.253535im       0.228749+0.0109152im     0.108983-0.156266im     0.0326067+0.152472im     -0.117381-0.0354718im     -0.106886+0.242661im       -0.049363-0.169169im       0.151798-0.176008im       -0.242985+0.0346489im   -0.108412-0.0176688im     0.00845881+0.134937im       0.239518-0.0151071im      0.0605407-0.156863im     0.0223224-0.014472im     0.00525933+0.28789im      -0.0607075+0.097735im       0.175822+0.0333237im     -0.101384+0.0132506im    -0.0595518+0.121231im      -0.0686673-0.161339im      0.100434+0.10484im     -0.0680529-0.154024im    -0.00875164+0.124939im     -0.0845232+0.241202im      0.164781+0.0947721im     0.065041+0.034173im
   0.0260493+0.0820002im    -0.124031+0.0542584im        0.214785+0.0702331im  -0.0462655+0.0223928im     0.175802-0.110891im     -0.00132124-0.06658im     -0.0134145+0.128641im       0.165024+0.0702307im     0.191978+0.0579538im    -0.122089+0.0675324im    -0.115003+0.154956im      -0.183172+0.237742im       0.0965361+0.00219493im    -0.228062-0.106794im      0.00729456-0.0281708im   -0.019125+0.131767im       -0.105058-0.00435254im     0.131829-0.167768im       -0.103344+0.137276im     -0.236296+0.345543im     -0.0187491+0.0495447im    -0.0681742+0.0761169im     0.0439961-0.00716886im     0.137013+0.0292197im      0.102159-0.0282507im       0.019954-0.101523im     0.0508241+0.0510196im   -0.0829725-0.136891im       0.138656+0.00616074im     0.187484-0.344014im    0.00134896-0.0899274im   -0.0368504+0.12069im
  -0.0149968-0.106163im      0.103091+0.0244576im      -0.0374928+0.0811473im   0.0410003-0.202105im      0.138301+0.157957im       -0.133702-0.152129im     -0.147624-0.132195im     -0.0145714+0.00116862im  -0.0171668-0.012325im    -0.0999373+0.068883im      0.115428-0.0116484im     0.0157889+0.0273612im      0.0857289-0.0935592im      0.267636+0.00278516im      0.224198-0.0217309im   0.0528176-0.173509im      -0.0262287+0.307522im      0.0979644-0.0268298im       0.181582-0.255802im      0.093326-0.130335im     -0.0475412+0.0557081im     0.0236916+0.129579im       0.111733+0.0961149im      0.196466-0.025001im      -0.013483-0.0457053im      0.0271786+0.138427im      0.145758-0.0414736im    -0.086084-0.0180142im      0.149568-0.0665532im      0.188061-0.290981im     -0.251718+0.0913693im   -0.0880479+0.0930719im
  -0.0142992+0.00516256im    0.168167+0.0630225im        0.345194+0.0536025im     0.10434+0.202385im     0.0855738-0.127682im        0.148298+0.124528im     0.0785257+0.121659im       0.106838-0.20199im      0.0370093+0.0576942im    -0.182977+0.112117im      0.125318-0.11746im      -0.0507995+0.0801381im      0.0375337-0.141442im      -0.019778-0.019417im       -0.035223+0.114571im    0.0808373-0.26535im        0.0814744+0.122942im     -0.0853773-0.22166im       -0.0862005-0.151616im    -0.0263528-0.105342im      -0.191539-0.293477im      0.0644588+0.033534im     -0.0602794-0.029093im      0.0637946+0.0270762im     -0.204534+0.0575044im      0.0344506-0.0845587im   0.00440775-0.0910953im    0.0549938-0.0300833im    -0.0213037+0.176925im       0.109536+0.241927im     -0.123831-0.12119im      0.0265215-0.00935338im
   0.0251547+0.242884im     0.0572205-0.132856im       0.00369769+0.0939506im  -0.0426823+0.094185im     -0.141085-0.0401006im     -0.0467581-0.135728im     0.0145276-0.198498im       0.175468+0.121857im     0.0931861+0.0978097im   -0.0386281-0.125358im    0.00523881-0.0218108im    -0.0823133-0.0195352im      -0.139304+0.0377201im     -0.195125+0.232293im        0.144033-0.0481581im   0.0278938+0.0554973im     -0.0224499+0.075638im    -0.00291187+0.000376472im    -0.167162-0.270347im       0.13798+0.06772im       0.0259006-0.0229633im      0.132085-0.0549748im     -0.142883+0.145892im     0.00817143-0.279669im       -0.15543+0.171814im       0.0583083-0.00580487im    0.176544-0.0319565im    0.0445125-0.21939im       0.0828338-0.315169im      0.0534997+0.087649im      0.167347-0.0144457im    -0.138015-0.117008im</code></pre><p>and then generate the state <span>$ψ$</span></p><pre><code class="language-julia hljs">psi = P[:, 3]</code></pre><pre><code class="nohighlight hljs">32-element Vector{ComplexF64}:
 0.0016734059300869816 - 0.13052208401137558im
  -0.11155163546668062 + 0.1798636195870154im
   0.12124809592855412 - 0.03058418100972508im
 0.0018510889338003138 + 0.041376854438703765im
 -0.019583500659527624 + 0.07592474944713513im
  -0.19134579161452686 + 0.0049737095479774574im
   0.00437716187642653 + 0.060413568807245854im
 -0.039883235661370975 + 0.11508250410819072im
  -0.14262094765036426 - 0.2494365654626031im
   0.38797798828346514 + 0.0im
  -0.07585926907671124 - 0.18188385445354785im
   0.11901659334358695 - 0.1388302596692794im
    -0.215439355643223 - 0.06334999643539294im
    0.1221522934054862 + 0.0043887020103888326im
   -0.2835878626298873 - 0.035117829266125215im
   -0.1439879316941716 + 0.03036096526043135im
   -0.2603270644666969 + 0.02288724031220909im
   0.07894573401961698 + 0.0356359190290403im
  -0.10327950661349491 - 0.1794305960561572im
   0.11180486291541755 - 0.09041820832381602im
  0.019013098437352407 - 0.16112743472806565im
   0.05966566699640722 + 0.01788316274677805im
   -0.0572908959758879 + 0.048751660200239445im
  -0.03927259419009895 + 0.0983380957812037im
   0.13769082961937726 - 0.08780811765487588im
   0.13053031208139923 - 0.016731046277960133im
    0.0722501693592881 + 0.19329709951719687im
    -0.083484437744499 + 0.08406817717201075im
  -0.06324430185066975 - 0.04007080076325726im
  -0.07626028625820049 - 0.1759608185135379im
  -0.10903396574166518 - 0.17272573456489373im
  -0.10882782916744556 + 0.05019324316566338im</code></pre><p>In the phase estimation process, we will feed the state to circuit and measure the first <code>n</code> qubits processed by iQFT.</p><pre><code class="language-julia hljs">r = join(ArrayReg(psi), zero_state(N))
r |&gt; PE(N, M, U)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 8/8
    nlevel: 2</code></pre><p>Since our phase can be represented by 3 qubits precisely, we only need to measure once</p><pre><code class="language-julia hljs">results = measure(r, 1:N; nshots=1)</code></pre><pre><code class="nohighlight hljs">1-element Vector{BitBasis.BitStr64{3}}:
 011 ₍₂₎</code></pre><p>Recall that our QFT&#39;s bit numbering is reversed, let&#39;s reverse it back</p><pre><code class="language-julia hljs">using BitBasis
estimated_phase = bfloat(results[]; nbits=N)</code></pre><pre><code class="nohighlight hljs">0.75</code></pre><p>the phase is exactly <code>0.75</code>!</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../1.prepare-ghz-state/index.html">« Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a><a class="docs-footer-nextpage" href="../3.grover-search/index.html">Grover Search »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.16 on <span class="colophon-date" title="Thursday 28 April 2022 03:43">Thursday 28 April 2022</span>. Using Julia version 1.7.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
