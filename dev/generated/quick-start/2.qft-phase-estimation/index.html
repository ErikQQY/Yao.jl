<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quantum Fourier Transformation and Phase Estimation · Documentation | Yao</title><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/indigo.css" rel="stylesheet" type="text/css"/><link href="https://yaoquantum.org/assets/favicon-light.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../index.html"><img src="../../../assets/logo.png" alt="Documentation | Yao logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../index.html">Documentation | Yao</a></span></div><form class="docs-search" action="../../../search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../index.html">Home</a></li><li><span class="tocitem">Quick Start</span><ul><li><a class="tocitem" href="../1.prepare-ghz-state/index.html">Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a></li><li class="is-active"><a class="tocitem" href="index.html">Quantum Fourier Transformation and Phase Estimation</a><ul class="internal"><li><a class="tocitem" href="#Quantum-Fourier-Transformation"><span>Quantum Fourier Transformation</span></a></li><li><a class="tocitem" href="#Wrap-QFT-to-an-external-block"><span>Wrap QFT to an external block</span></a></li><li><a class="tocitem" href="#Phase-Estimation"><span>Phase Estimation</span></a></li><li class="toplevel"><a class="tocitem" href="#using-LinearAlgebra"><span>using LinearAlgebra</span></a></li></ul></li><li><a class="tocitem" href="../3.grover-search/index.html">Grover Search</a></li><li><a class="tocitem" href="../4.shor-algorithm/index.html">Shor&#39;s Algorithm</a></li><li><a class="tocitem" href="../5.shor-9-code/index.html">Shor&#39;s 9 qubit code</a></li><li><a class="tocitem" href="../6.quantum-circuit-born-machine/index.html">Quantum Circuit Born Machine</a></li><li><a class="tocitem" href="../7.variation-quantum-eigen-solver/index.html">Variational Quantum Eigen Solver</a></li></ul></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../../man/array_registers.html">Array Registers</a></li><li><a class="tocitem" href="../../../man/symbolic.html">Symbolic Computation</a></li><li><a class="tocitem" href="../../../man/blocks.html">Blocks</a></li><li><a class="tocitem" href="../../../man/automatic_differentiation.html">Automatic Differentiation</a></li><li><a class="tocitem" href="../../../man/simplification.html">Simplification</a></li><li><a class="tocitem" href="../../../man/base.html">Base</a></li><li><a class="tocitem" href="../../../man/registers.html">Abstract Registers</a></li><li><a class="tocitem" href="../../../man/bitbasis.html">BitBasis</a></li><li><a class="tocitem" href="../../../man/extending_blocks.html">Extending Blocks</a></li></ul></li><li><a class="tocitem" href="../../../benchmarks.html">Benchmark</a></li><li><a class="tocitem" href="../../../dev/index.html">Developer Notes</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Quick Start</a></li><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/QuantumBFS/Yao.jl/blob/master/docs/src/quick-start/2.qft-phase-estimation/main.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><p><a href="https://mybinder.org/v2/gh/QuantumBFS/Yao.jl/gh-pages?filepath=dev/generated/quick-start/2.qft-phase-estimation/main.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a> <a href="https://nbviewer.jupyter.org/github/QuantumBFS/Yao.jl/blob/gh-pages/dev/generated/quick-start/2.qft-phase-estimation/main.ipynb"><img src="https://img.shields.io/badge/show-nbviewer-579ACA.svg" alt/></a> <a href="https://minhaskamal.github.io/DownGit/#/home?url=https://github.com/QuantumBFS/tutorials/tree/gh-pages/dev/generated/quick-start/2.qft-phase-estimation"><img src="https://img.shields.io/badge/download-project-orange" alt/></a></p><h1 id="example-qft"><a class="docs-heading-anchor" href="#example-qft">Quantum Fourier Transformation and Phase Estimation</a><a id="example-qft-1"></a><a class="docs-heading-anchor-permalink" href="#example-qft" title="Permalink"></a></h1><p>Let&#39;s use Yao first</p><pre><code class="language-julia hljs">using Yao</code></pre><h2 id="Quantum-Fourier-Transformation"><a class="docs-heading-anchor" href="#Quantum-Fourier-Transformation">Quantum Fourier Transformation</a><a id="Quantum-Fourier-Transformation-1"></a><a class="docs-heading-anchor-permalink" href="#Quantum-Fourier-Transformation" title="Permalink"></a></h2><p>The Quantum Fourier Transformation (QFT) circuit is to repeat two kinds of blocks repeatly:</p><p><img src="assets/qft.png" alt="qft-circuit"/></p><p>The basic building block control phase shift gate is defined as</p><p class="math-container">\[R(k)=\begin{bmatrix}
1 &amp; 0\\
0 &amp; \exp\left(\frac{2\pi i}{2^k}\right)
\end{bmatrix}\]</p><p>Let&#39;s define block <code>A</code> and block <code>B</code>, block <code>A</code> is actually a control block.</p><pre><code class="language-julia hljs">A(i, j) = control(i, j=&gt;shift(2π/(1&lt;&lt;(i-j+1))))</code></pre><pre><code class="nohighlight hljs">A (generic function with 1 method)</code></pre><p>Once you construct the blockl you can inspect its matrix using <code>mat</code> function. Let&#39;s construct the circuit in dash box A, and see the matrix of <span>$R_4$</span> gate.</p><pre><code class="language-julia hljs">R4 = A(4, 1)</code></pre><pre><code class="nohighlight hljs">(n -&gt; control(n, 4, 1 =&gt; shift(0.39269908169872414)))</code></pre><p>If you have read about <a href="generated/quick-start/2.qft-phase-estimation/@ref example-ghz">preparing GHZ state</a>, you probably know that in Yao, we could just leave the number of qubits, and it will be evaluated when possible.</p><pre><code class="language-julia hljs">R4(5)</code></pre><pre><code class="nohighlight hljs">nqubits: 5
control(4)
└─ (1,) shift(0.39269908169872414)</code></pre><p>its matrix will be</p><pre><code class="language-julia hljs">mat(R4(5))</code></pre><pre><code class="nohighlight hljs">32×32 LinearAlgebra.Diagonal{ComplexF64, Vector{ComplexF64}}:
 1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im</code></pre><p>Then we repeat this control block over and over on different qubits, and put a Hadamard gate to <code>i</code>th qubit to construct <code>i</code>-th <code>B</code> block.</p><pre><code class="language-julia hljs">B(n, k) = chain(n, j==k ? put(k=&gt;H) : A(j, k) for j in k:n)</code></pre><pre><code class="nohighlight hljs">B (generic function with 1 method)</code></pre><p>We need to input the total number of qubits <code>n</code> here because we have to iterate through from <code>k</code>-th location to the last.</p><p>Now, let&#39;s construct the circuit by chaining all the <code>B</code> blocks together</p><pre><code class="language-julia hljs">qft(n) = chain(B(n, k) for k in 1:n)
qft(4)</code></pre><pre><code class="nohighlight hljs">nqubits: 4
chain
├─ chain
│  ├─ put on (1)
│  │  └─ H
│  ├─ control(2)
│  │  └─ (1,) shift(1.5707963267948966)
│  ├─ control(3)
│  │  └─ (1,) shift(0.7853981633974483)
│  └─ control(4)
│     └─ (1,) shift(0.39269908169872414)
├─ chain
│  ├─ put on (2)
│  │  └─ H
│  ├─ control(3)
│  │  └─ (2,) shift(1.5707963267948966)
│  └─ control(4)
│     └─ (2,) shift(0.7853981633974483)
├─ chain
│  ├─ put on (3)
│  │  └─ H
│  └─ control(4)
│     └─ (3,) shift(1.5707963267948966)
└─ chain
   └─ put on (4)
      └─ H
</code></pre><h2 id="Wrap-QFT-to-an-external-block"><a class="docs-heading-anchor" href="#Wrap-QFT-to-an-external-block">Wrap QFT to an external block</a><a id="Wrap-QFT-to-an-external-block-1"></a><a class="docs-heading-anchor-permalink" href="#Wrap-QFT-to-an-external-block" title="Permalink"></a></h2><p>In most cases, <code>function</code>s are enough to wrap quantum circuits, like <code>A</code> and <code>B</code> we defined above, but sometimes, we need to dispatch specialized methods on certain kinds of quantum circuit, or we want to define an external block to export, thus, it&#39;s useful to be able to wrap circuit to custom blocks.</p><p>First, we define a new type as subtype of <code>PrimitiveBlock</code> since we are not going to use the subblocks of <code>QFT</code>, if you need to use its subblocks, it&#39;d be better to define it under <code>CompositeBlock</code>.</p><pre><code class="language-julia hljs">struct QFT{N} &lt;: PrimitiveBlock{N} end
QFT(n::Int) = QFT{n}()</code></pre><pre><code class="nohighlight hljs">Main.##276.QFT</code></pre><p>Now, let&#39;s define its circuit</p><pre><code class="language-julia hljs">circuit(::QFT{N}) where N = qft(N)</code></pre><pre><code class="nohighlight hljs">circuit (generic function with 1 method)</code></pre><p>And forward <code>mat</code> to its circuit&#39;s matrix</p><pre><code class="language-julia hljs">YaoBlocks.mat(::Type{T}, x::QFT) where T = mat(T, circuit(x))</code></pre><p>You may notice, it is a little ugly to print <code>QFT</code> at the moment, this is because we print the type summary by default, you can define your own printing by overloading <code>print_block</code></p><pre><code class="language-julia hljs">YaoBlocks.print_block(io::IO, x::QFT{N}) where N = print(io, &quot;QFT($N)&quot;)</code></pre><p>Since it is possible to use FFT to simulate the results of QFT (like cheating), we could define our custom <code>apply!</code> method:</p><pre><code class="language-julia hljs">using FFTW, LinearAlgebra

function YaoBlocks.apply!(r::ArrayReg, x::QFT)
    α = sqrt(length(statevec(r)))
    invorder!(r)
    lmul!(α, ifft!(statevec(r)))
    return r
end</code></pre><p>Now let&#39;s check if our <code>apply!</code> method is correct:</p><pre><code class="language-julia hljs">r = rand_state(5)
r1 = r |&gt; copy |&gt; QFT(5)
r2 = r |&gt; copy |&gt; circuit(QFT(5))
r1 ≈ r2</code></pre><pre><code class="nohighlight hljs">true</code></pre><p>We can get iQFT (inverse QFT) directly by calling <code>adjoint</code></p><pre><code class="language-julia hljs">QFT(5)&#39;</code></pre><pre><code class="nohighlight hljs"> [†]QFT(5)</code></pre><p>QFT and iQFT are different from FFT and IFFT in three ways,</p><ol><li>they are different by a factor of <span>$\sqrt{2^n}$</span> with <span>$n$</span> the number of qubits.</li><li>the <a href="https://quantumbfs.github.io/BitBasis.jl/stable/tutorial/#Conventions-1">bit numbering</a> will exchange after applying QFT or iQFT.</li><li>due to the convention, QFT is more related to IFFT rather than FFT.</li></ol><h2 id="Phase-Estimation"><a class="docs-heading-anchor" href="#Phase-Estimation">Phase Estimation</a><a id="Phase-Estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Phase-Estimation" title="Permalink"></a></h2><p>Since we have QFT and iQFT blocks we can then use them to realize phase estimation circuit, what we want to realize is the following circuit:</p><p><img src="assets/phaseest.png" alt="phase estimation"/></p><pre><code class="language-julia hljs">using Yao</code></pre><p>First we call Hadamard gates repeatly on first <code>n</code> qubits.</p><pre><code class="language-julia hljs">Hadamards(n) = repeat(H, 1:n)</code></pre><pre><code class="nohighlight hljs">Hadamards (generic function with 1 method)</code></pre><p>Then in dashed box <code>B</code>, we have controlled unitaries:</p><pre><code class="language-julia hljs">ControlU(n, m, U) = chain(n+m, control(k, n+1:n+m=&gt;matblock(U^(2^(k-1)))) for k in 1:n)</code></pre><pre><code class="nohighlight hljs">ControlU (generic function with 1 method)</code></pre><p>each of them is a <code>U</code> of power <span>$2^(k-1)$</span>.</p><p>Since we will only apply the qft and Hadamard on first <code>n</code> qubits, we could use <code>Subroutine</code>, which creates a context of a sub-scope of the qubits.</p><pre><code class="language-julia hljs">PE(n, m, U) =
    chain(n+m, # total number of the qubits
        subroutine(Hadamards(n), 1:n), # apply H in local scope
        ControlU(n, m, U),
        subroutine(QFT(n)&#39;, 1:n))</code></pre><pre><code class="nohighlight hljs">PE (generic function with 1 method)</code></pre><p>we use the first <code>n</code> qubits as the output space to store phase <span>$ϕ$</span>, and the other <code>m</code> qubits as the input state which corresponds to an eigenvector of oracle matrix <code>U</code>.</p><p>The concentrator here uses <code>focus!</code> and <code>relax!</code> to manage a local scope of quantum circuit, and only active the first <code>n</code> qubits while applying the block inside the concentrator context, and the scope will be <code>relax!</code>ed back, after the context. This is equivalent to manually <code>focus!</code> then <code>relax!</code></p><p>fullly activated</p><pre><code class="language-julia hljs">r = rand_state(5)</code></pre><pre><code class="nohighlight hljs">ArrayReg{1, ComplexF64, Array...}
    active qubits: 5/5</code></pre><p>first 3 qubits activated</p><pre><code class="language-julia hljs">focus!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{1, ComplexF64, Array...}
    active qubits: 3/5</code></pre><p>relax back to the original</p><pre><code class="language-julia hljs">relax!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{1, ComplexF64, Array...}
    active qubits: 5/5</code></pre><p>In this way, we will be able to apply small operator directly on the subset of the qubits.</p><p>Details about the algorithm can be found here: <a href="ttps://en.wikipedia.org/wiki/Quantum_phase_estimation_algorithm">Quantum Phase Estimation Algorithm</a></p><p>Now let&#39;s check the results of our phase estimation.</p><p>First we need to set up a unitary with known phase, we set the phase to be 0.75, which is <code>0.75 * 2^3 == 6 == 0b110</code> .</p><h1 id="using-LinearAlgebra"><a class="docs-heading-anchor" href="#using-LinearAlgebra">using LinearAlgebra</a><a id="using-LinearAlgebra-1"></a><a class="docs-heading-anchor-permalink" href="#using-LinearAlgebra" title="Permalink"></a></h1><pre><code class="language-julia hljs">N, M = 3, 5
P = eigen(rand_unitary(1&lt;&lt;M)).vectors
θ = Int(0b110) / 1&lt;&lt;N
phases = rand(1&lt;&lt;M)
phases[0b010+1] = θ
U = P * Diagonal(exp.(2π * im * phases)) * P&#39;</code></pre><pre><code class="nohighlight hljs">32×32 Matrix{ComplexF64}:
  -0.281022+0.0985778im      0.203745-0.145782im       0.189474-0.286834im       0.199686-0.175078im    -0.0107454+0.0288114im       0.242981+0.105491im      -0.0262907+0.0608859im     -0.144273-0.106778im    -0.0586361+0.0964475im      0.0255617+0.0141687im   -0.00874254+0.019091im     0.00612823+0.0774822im    -0.0718886-0.00460612im    -0.125431+0.184914im    -0.0501834-0.0969938im    0.0592992+0.0355875im    -0.0650091-0.219455im      -0.101967-0.0194123im   -0.0227558+0.00553775im   -0.0655317-0.0604875im   -0.000104435+0.135783im    -0.000982935+0.20272im      -0.00212791-0.0462391im     0.193998-0.16434im        0.122724+0.0389596im     0.0893718+0.131961im     -0.0627488-0.161196im     0.0770567-0.129085im    -0.0640034-0.184717im     -0.0028424-0.117918im       -0.204905+0.0360166im      0.189962-0.19035im
  -0.133175-0.0371311im     -0.148669-0.175139im     -0.0149678-0.132584im      -0.115113+0.140446im    -0.0749042-0.0520916im      -0.211667-0.169258im       0.0354206+0.0512328im      0.111566+0.143406im     0.0894046-0.111809im      -0.0355542+0.101264im       0.121826-0.0196928im     0.0322427-0.107974im       0.127472-0.134793im      -0.165123-0.0675433im    0.0515422+0.0975669im    0.0660702+0.0540974im     -0.177677+0.0272795im     0.0942366+0.0391928im    0.0675007+0.253622im    -0.00275417-0.0517796im      -0.115207+0.185049im        -0.12148-0.0417276im      -0.120286-0.215843im     0.0375911-0.0709187im    -0.0797083+0.116215im      -0.134095-0.00801089im    -0.135308+0.0725148im     0.221141+0.132971im      0.191375-0.0870163im     0.0715996-0.346385im       -0.174137-0.0211226im     -0.104479-0.167778im
   0.271025-0.019977im      0.0555698-0.0617252im      0.045909-0.0801298im     -0.104678+0.13736im      0.0125684+0.181169im      -0.0371124+0.0516271im       0.144843+0.0684738im     0.0872208-0.0126964im   -0.0878484+0.079244im      -0.0421714-0.0764132im     -0.104136+0.0878518im   0.000163795+0.19935im       0.0739911-0.0507821im   -0.00660919-0.0790429im    -0.217226+0.0132723im     0.127264+0.167321im     -0.0387655-0.124395im     -0.0761193+0.0790915im     0.111712+0.0621337im     0.0310944-0.213245im       0.0389383-0.249697im        0.231127+0.0327793im     -0.0292918+0.134266im      0.087733+0.0333583im     -0.113967+0.296509im       -0.18609+0.0808925im     -0.179012+0.0328748im    -0.222952-0.280276im      0.117621-0.0870014im     0.0320373-0.212528im       0.0553974+0.0588592im     0.0114546+0.0950009im
  -0.254059+0.0909763im      0.137239-0.159489im    -0.00850442+0.123942im      0.0951121-0.0129758im    -0.049073+0.0261165im      0.0623494+0.196465im      -0.0189081-0.230308im     -0.0558838+0.257019im      0.153861+0.173919im        0.109011+0.28218im       -0.157998-0.146666im      -0.152115+0.100235im      -0.257332-0.186251im      -0.146581-0.0822368im    0.0630806+0.0317682im   -0.0496673-0.0478843im     -0.186436-0.0108474im     0.0923283+0.119972im    -0.0477565+0.0949672im       0.14577-0.0820314im      -0.100142-0.125875im        0.130478-0.0173535im      0.0015628-0.0391459im    -0.222416+0.158564im     -0.0211533+0.0303428im      0.010589+0.0167384im    -0.0174147+0.113172im    -0.0135294-0.0523069im    -0.119364+0.142635im       0.140194-0.0784272im      0.0527608+0.0743307im    -0.0393665+0.147109im
 0.00048365+0.00124058im   0.00536631+0.0700076im     -0.226679+0.00265107im    -0.101732+0.121327im     -0.150021+0.0671496im   -0.000407265-0.0274221im       0.231761-0.0290329im     -0.219465-0.167298im    -0.0917628+0.150305im       -0.102813+0.063109im       0.106152+0.125224im     -0.0347925+0.114345im     -0.0492745+0.37214im       -0.304595+0.231654im      0.183873-0.27283im      0.0611578+0.120795im     -0.0715702+0.1127im       -0.0736599-0.0197631im   -0.0476837+0.0164325im      0.240836-0.153389im      -0.0167584-0.0528102im     -0.0953599-0.137095im      -0.0039954-0.0553055im   -0.0313743+0.0900992im    -0.0296345-0.0129908im      0.173568+0.0627495im      0.033513-0.0592668im    -0.048921+0.132735im     0.0136801-0.0747919im     0.0849283-0.0866245im       0.059706-0.00927746im    -0.156974+0.000654123im
 -0.0744779-0.0524903im      0.146914+0.11163im       0.0324395-0.172517im     -0.0567222+0.00885828im  -0.0249422-0.0199124im       0.126739-0.0567533im       0.127227-0.021601im      0.0305821+0.237462im     0.0504843-0.205455im        0.093331+0.139112im      -0.208546-0.0134173im    -0.0119361-0.0870814im      0.207032+0.0165275im     -0.068208+0.183512im     0.0329648+0.127008im      0.101915+0.295232im     -0.0965034-0.118444im     -0.0451395-0.20289im       0.231952+0.00455137im   -0.0609705+0.212673im       0.0776996-0.143817im       -0.150618-0.130223im       -0.248829+0.163614im     0.0316152-0.121458im      0.0634933-0.0555261im      0.133601-0.00345705im     0.116346+0.122558im     -0.118796+0.0191692im   -0.0484215-0.000460692im    0.226515+0.0794613im     0.00599647-0.0879855im   -0.00690656+0.181361im
  0.0188869+0.364558im       0.111831+0.123083im       0.106797-0.101442im        0.19944+0.0979252im    0.0996115+0.192059im     0.000937794-0.180136im       0.0963413+0.143041im       0.111098-0.0215466im   -0.0695651+0.197386im      0.00385146+0.142509im      -0.061071+0.167644im      -0.123271+0.227478im       0.209754+0.041606im     -0.0939951-0.0806307im    0.0923843+0.134354im      0.136881-0.223426im     -0.0515962-0.0751165im      0.131983-0.0472393im   -0.0198477+0.00863942im     -0.11521+0.0897232im     -0.0353462-0.0147251im      -0.111854+0.0904017im       0.166672-0.148981im   0.000403629+0.0605288im    -0.0698029-0.0697587im     -0.023251+0.0237421im    -0.0386513+0.129041im    0.00905813-0.00586623im   0.0538632+0.0737611im     -0.105857+0.185668im      -0.0795676-0.203091im       -0.25725+0.0677712im
 0.00124581+0.00113634im   -0.0114257-0.0475432im      0.178945-0.0917879im     -0.205769+0.134156im    -0.0604236+0.039735im      -0.0915543+0.221603im       0.0349301-0.190904im      -0.149756-0.0154654im    -0.103838+0.0571381im     -0.0502248-0.103409im     -0.0728008+0.198372im       0.106712+0.203895im      -0.144911-0.133048im       0.330021+0.255608im       0.19791+0.225925im     0.0502317+0.0850858im       0.12601-0.0655307im    -0.0727845-0.255227im    -0.0475659+0.118336im     -0.0411729+0.121822im      -0.0795148+0.0867865im     -0.0949117-0.102142im      -0.0821819-0.174301im    -0.0942751+0.196633im     -0.0685191+0.0823097im   -0.00707198-0.0519442im     -0.189506+0.0146169im     0.036546+0.0127087im    -0.110877+0.0819693im    -0.0607457+0.0639375im       0.005777+0.0356131im    -0.0223306-0.118933im
  0.0590358+0.173749im        0.17547+0.0398407im    -0.0111255+0.111842im      -0.204488-0.123807im    -0.0724267+0.148684im      -0.0241644-0.00169387im     -0.251388-0.0872128im     -0.253513-0.0499585im   -0.0846858-0.0995195im      -0.226194+0.065159im       0.249601+0.0278517im     -0.167819+0.0299345im    -0.0407869-0.0585894im    -0.0391662+0.0804955im     0.165801+0.19996im     -0.0488551-0.132688im     0.00979416+0.0180878im    -0.0425332+0.0527608im    0.0272845-0.0427972im     -0.262795+0.0674087im      -0.104863-0.0131908im       0.141012+0.0333314im      -0.174003+0.102538im      0.146055-0.0645612im     0.0951078-0.22862im       -0.100213+0.0860661im     0.0197846-0.00333016im  -0.0282147-0.0283502im     0.231776+0.000436769im    0.100883-0.245208im        0.149931-0.0594163im    -0.0324303+0.148206im
  0.0739152+0.0460095im     0.0641152-0.156856im      0.0205736-0.0251402im    -0.0318738-0.018481im      0.107181+0.0524813im      -0.117732-0.0942481im       0.100521+0.0637981im    0.00593914+0.0961414im    0.0695964+0.078759im        -0.26329+0.0298081im   -0.00934572-0.0823949im    -0.0626717-0.226685im     -0.0836683+0.175456im       0.128636-0.0245879im    0.0992306+0.264001im       0.11031+0.110479im      0.0870776-0.000252772im    0.125933-0.204494im      0.142933-0.0627194im      0.161295-0.303183im      -0.0682531+0.160217im       0.0828103-0.0244729im       0.183122+0.110976im      0.154881+0.0940011im     0.0573318-0.146219im     -0.0073073+0.14677im         0.04612-0.112122im      0.110602-0.033892im     -0.172087+0.0586654im     0.0269221+0.0377072im      -0.268776+0.189119im      0.0127915+0.238372im
  -0.120395-0.185359im      -0.144124-0.0444164im     -0.252654+0.159693im     -0.0876301-0.0557585im    0.0864073+0.256188im       0.0930499+0.0742196im       -0.12626+0.0538088im     -0.117263+0.00687im      0.0599463-0.119956im        0.249477-0.141739im      -0.013694+0.016304im      0.0102525+0.140869im       0.122032+0.0845202im    -0.0654609-0.165161im     0.0296555+0.183568im      0.178754+0.0816732im      0.061071-0.212325im      0.0571812-0.120637im     -0.289023-0.152353im    -0.00651521+0.0528142im     -0.0593662+0.00656182im      0.144009+0.140435im       -0.101759+0.0574177im   -0.0171963+0.113065im     -0.0830754+0.0482116im      0.253805+0.0700952im     0.0255262+0.0790266im     0.124112+0.0297726im      0.13461-0.0901923im    -0.0204984+0.000161174im    -0.222681+0.115534im      -0.146341+0.0335519im
  -0.099423+0.0427267im     0.0292697-0.287005im     -0.0493186-0.110164im      0.0802472+0.0809513im   -0.0998397-0.181116im        -0.14999+0.0587182im      -0.128136+0.103068im    -0.00322642-0.0438262im    -0.342627+0.232207im        0.261399+0.135711im       0.141341-0.123961im      0.0564077-0.106724im      0.0315995+0.106471im     -0.0597534+0.0562793im    -0.172317+0.225641im     0.0546965-0.0371387im     0.0438563+0.153224im     -0.0443696-0.127082im     -0.169797+0.141511im      -0.109322+0.00535733im      0.170796+0.100107im      0.00204149-0.0218882im    -0.00784724+0.198072im       0.06087+0.132918im      0.0235064+0.085825im    -0.00919151-0.0700515im   -0.00909604-0.0179718im    -0.188363+0.103586im      0.180223-0.00111934im     0.125799+0.155388im        0.100349+0.101263im     -0.0300203+0.0994085im
  0.0974456+0.0942799im     0.0800295+0.0531044im    -0.0826597-0.104092im       0.108987+0.238018im     -0.240446-0.0142815im      0.0777456+0.0238632im      -0.145734-0.147817im        0.17175-0.0882879im     0.253156-0.0363034im      -0.108302+0.0133341im    -0.0453024+0.0325722im   -0.00868775-0.113413im     -0.0581479-0.0953319im    -0.0644907+0.0337971im    -0.163312-0.046234im     0.0636925-0.00477876im     0.050649-0.00460037im    -0.205029-0.0256239im   -0.0934791-0.0772728im    -0.0996888+0.138388im       0.0433948+0.169706im        0.304425-0.350248im         0.15408+0.0076804im   -0.0483878+0.098964im      -0.025246-0.0608407im      0.153126-0.121557im       -0.14011-0.118682im     0.0926744-0.0923182im    0.0581414-0.212904im      0.0804666+0.0136233im      -0.182241-0.129606im      -0.126428+0.106579im
  0.0498581+0.0168663im    -0.0464694+0.0737718im      0.129414-0.0842428im     0.0338875+0.124501im     -0.105524+0.0288436im     -0.0337053-0.113328im      -0.0803313+0.0440733im    -0.0795458+0.177565im     0.0489266+0.0766633im      0.0235105-0.205515im       0.160159-0.0884787im      0.126118+0.203346im      -0.167075-0.0912689im     -0.281809-0.0546241im   -0.0167993+0.0883395im    0.0572596+0.094399im      0.0949601-0.0858111im     -0.046376-0.0630692im    -0.069089-0.328289im     -0.0438013-0.072319im        0.297093+0.103838im      -0.0360503+0.0320849im     -0.0220661-0.0946312im   -0.0613298-0.201535im      0.0209918+0.0848928im     -0.118066-0.157189im      0.0734259-0.0933883im   -0.0643858+0.199902im     -0.230152+0.25241im       -0.019807-0.19178im       0.00619046-0.0248907im    -0.0577749+0.190939im
   0.157647+0.000368237im  -0.0708393-0.119444im     -0.0200936-0.0508158im     0.0400735-0.171192im      0.126584-0.126933im       0.0776945-0.0416252im      0.0560783+0.0885136im     -0.126288+0.00942666im  -0.0413359-0.0957498im    -0.00753478+0.0813684im     0.0340243-0.00226912im  -0.00161826+0.0159785im    -0.0573825+0.0174445im     -0.163698-0.109389im     0.0959629-0.0958334im     0.283057+0.21262im        0.165578+0.2889im        -0.118969-0.00202979im   -0.147425+0.0111729im     -0.231587+0.0880577im       -0.19388-0.0183949im     -0.0114175+0.0853657im      0.0555271+0.106074im     -0.102019+0.0758733im     0.0621531+0.110429im      -0.188358-0.026691im      -0.151998+0.12802im        0.30282-0.147462im     -0.292239-0.05998im         0.14818+0.0514068im       0.113311-0.175441im    -0.00283943+0.0586771im
  -0.123274-0.0234746im      0.101588-0.264057im        0.12174+0.100048im      -0.138073-0.108845im      0.109962+0.111106im       -0.320233+0.0358198im     -0.0619917-0.103155im       0.140058-0.134889im      0.154269+0.222088im       -0.155854-0.098364im      -0.150938-0.075438im      -0.087812+0.131272im    -0.00943876+0.195368im      0.0169397-0.0564257im    0.0351592-0.0884559im    0.0615646+0.124672im      0.0220559+0.0199318im     -0.136453+0.125544im    -0.0547829-0.00869011im    -0.122296+0.0730972im      0.0399002+0.0280257im     -0.0891606-0.129175im      -0.0872757+0.0372788im   -0.0312092-0.174081im       0.169276+0.0681402im     -0.063099-0.224283im       0.345392+0.131524im    -0.0448165-0.128492im     0.0510635-0.0357528im     0.0151596+0.0709112im       -0.15604-0.0442775im     -0.144841-0.110494im
  0.0396568-0.0444592im     0.0581611-0.0712879im    -0.0854892-0.0027274im    -0.0763154+0.0110536im    -0.118067+0.0557952im       0.236685-0.10495im        0.0552415-0.119775im       0.180901+0.0469559im   -0.0166608-0.109274im      -0.0372359-0.00132996im     0.342032-0.265327im     -0.0758932+0.20426im     -0.00359385-0.0337936im    0.00736099-0.113024im     0.0102668-0.0746499im    0.0110558+0.082338im      0.0436708-0.0895037im    -0.0439345-0.291525im     0.0659657+0.235317im      -0.140297-0.0359752im       0.024014-0.161017im      -0.0919146+0.101269im        0.178798-0.149505im     -0.199348+0.191252im       0.204579-0.152977im      -0.127899-0.0829772im      0.143005-0.0434693im    -0.157683-0.0103379im    0.0209059-0.19241im      -0.0919507+0.0359353im     -0.0899272+0.113356im       0.054098-0.0548919im
    0.02388+0.0223784im    -0.0265441+0.0421783im      0.089593+0.239429im       0.233868+0.0282603im     0.124425+0.0183331im        0.13927+0.0727426im     -0.0307766-0.126534im     -0.0055275+0.14989im     -0.0144248-0.000400428im    0.0694155-0.215764im      0.0957674-0.0388103im     -0.120653-0.09938im      -0.0440635+0.119534im     -0.0664845+0.121041im     0.0175262-0.0118753im    0.0708907+0.102329im      0.0236465+0.161362im       -0.14897-0.0579704im    0.0671582+0.0370729im     0.0177502+0.126168im       -0.208126+0.0656837im     -0.0394355-0.0358491im      0.0609575-0.0517747im    -0.132127-0.340648im      -0.159274+0.0265985im     -0.216765+0.202121im      -0.202063-0.0735718im    -0.230848-0.0145071im     0.205637+0.106268im      0.0941675+0.12387im        -0.191032+0.187346im      -0.166818-0.0468716im
 -0.0331136+0.0125387im     -0.158008-0.240965im     -0.0549503-0.168415im      0.0313867+0.199121im    -0.0401999-0.0344648im     -0.0560602-0.128072im       -0.148708-0.0147067im     -0.236121+0.0229993im    0.0110921-0.220728im      -0.0641733-0.207136im     -0.0678833-0.0785716im     -0.235055+0.0567234im     0.0016795-0.137895im     -0.0610486+0.223956im      0.081788-0.194988im    -0.0100788-0.155475im      0.0194966-0.185431im      0.0915899+0.0119056im    0.0334122-0.0704153im    0.00926766-0.278476im      -0.0118227-0.0391443im      0.0689842-0.0272641im   -0.000448985+0.115469im   -0.00360218-0.00453116im   -0.0638807+0.00820723im    -0.168207+0.00571734im    0.0101148+0.25171im     -0.0381149+0.0665562im    0.0445546-0.0433604im     0.0798451+0.394279im       -0.048928-0.11393im       0.0678138-0.0265145im
   -0.16135+0.191695im        0.25715-0.028001im     -0.0625382-0.0829084im    0.00105986+0.162685im     0.0254657-0.110962im       -0.156632+0.0775813im       0.129284+0.168276im      -0.102922+0.0705042im    0.0241318-0.252047im        0.126515-0.188132im       0.106925-0.0809835im     0.0258963+0.137897im      0.0421916+0.232959im       0.029982-0.202097im     0.0117924+0.0820489im    -0.125673-0.247105im       0.200739+0.0724im        -0.163236+0.141572im      0.242393-0.00499528im    -0.112505-0.0138259im      -0.116566-0.181432im       0.0343072-0.175629im      -0.0817105-0.0135216im    -0.140054+0.0499419im     0.0471613+0.165457im       0.158471+0.0859068im    -0.0218198-0.124973im     0.0680373+0.00234217im   -0.095248+0.0685461im     0.0408354-0.0220088im      -0.131035+0.0262934im     0.0654908-0.0446876im
  -0.075348-0.0310092im     -0.159772+0.0610469im     0.0196389+0.0338299im    -0.0289653-0.0475291im    0.0679518-0.226663im      -0.0364589-0.198765im      -0.0186192-0.224103im     -0.0242611+0.198416im    -0.0340873+0.22689im        0.0131988+0.100804im     0.00864751+0.268888im      0.0294378+0.159794im      -0.148249+0.168261im      -0.152429-0.0506484im    -0.163342+0.115078im    -0.0876083-0.114758im       0.141295-0.129637im     -0.0607713-0.0461972im     0.133373-0.146001im      0.0721656+0.043755im       0.0228049-0.199066im      -0.0993072-0.088717im      -0.0997219+0.126559im    -0.0219205-0.0260985im   -0.00145429-0.162768im      -0.151886-0.0904071im     -0.149839+0.0325496im     0.249043-0.0693945im     0.140102-0.277342im     -0.0751618+0.0590808im     -0.0724504+0.144631im       0.139658+0.0154399im
  -0.303269+0.132502im      -0.121678+0.153809im     -0.0383873-0.0614886im   -0.00674164-0.220607im     0.0886236-0.0103405im      -0.137995+0.0889747im      0.0711884+0.0794361im     0.0207655-0.0181708im   -0.0235595+0.00854341im     0.0272987-0.0617933im     0.0311814-0.183416im       0.196393+0.108719im      0.0627008-0.143029im       0.132456-0.112044im     0.0578202-0.119395im     0.0672261+0.0701492im     0.0254728+0.143793im     -0.0107969-0.0745774im    -0.111771-0.178872im       0.120939-0.185106im      0.00757635+0.00374837im    -0.0631664-0.208345im      -0.0862417-0.0422031im     0.028955+0.0612608im     0.0710277-0.304319im     -0.0644088+0.00135733im    -0.310658+0.0875116im    -0.281048-0.117773im      0.101083-0.0756095im     0.0661946-0.0564843im      -0.123216-0.217227im      0.0535747+0.100113im
 -0.0259702+0.0573645im    -0.0828134+0.0677835im     -0.164369-0.263197im      0.0468448-0.0627292im     0.231262+0.193872im       -0.165908+0.271578im      -0.0240268-0.0400197im      0.159736+0.183832im    -0.0408126-0.120304im       -0.154941+0.00308556im     0.135086-0.0155366im    -0.0768397+0.0328774im     -0.162039+0.0507381im     -0.150598+0.05504im      -0.177384+0.122549im     0.0894949+0.045978im       0.226897-0.019704im     -0.0061549+0.0668198im    0.0667473+0.134793im       0.184451+0.0257003im      -0.166846+0.0485851im      0.0652538+0.144099im       0.0465519-0.148533im     0.0741843-0.135701im      -0.142382-0.0742286im      0.191043-0.267138im      0.0613104-0.00120923im  -0.0648253+0.0409055im    0.0185306-0.0772846im      0.032229+0.11059im         0.235713-0.0848947im     0.0930889-0.0142764im
  0.0418392+0.0546695im      0.015622+0.0882313im        0.0246-0.0718689im     0.0327041+0.0937421im   0.00758891+0.312903im       0.0290859-0.050142im      -0.0525379-0.0845026im     -0.288361-0.0608816im   -0.0608236+0.112996im       0.0200279-0.058852im     -0.0913545-0.0687156im      0.226486-0.195364im         0.1035+0.0717799im    -0.0779985-0.121757im    -0.0102844+0.0652805im    0.0988611-0.052674im     -0.0705696+0.122644im       0.148608-0.092941im      0.166138-0.0753576im   -0.00775998+0.00703983im     0.0575897+0.165626im      0.00626714-0.0559204im      0.0390276-0.106815im     -0.381826+0.0243935im    -0.0763652-0.00685126im   -0.0463453-0.0769341im      0.175333+0.0793064im    0.0497134-0.235768im      0.140656-0.0575391im      0.169104-0.0231699im      0.0769477+0.0377704im      0.367293-0.126824im
 -0.0827331-0.00503898im    0.0678123-0.0786843im    -0.0164293+0.190659im      -0.130515+0.270523im      0.242153+0.227194im        0.016034-0.103531im        0.301853+0.0817989im       0.17983-0.100606im      0.184799-0.0268613im       0.110426+0.0034344im      0.105946+0.0872757im     0.0120486-0.00143139im    -0.237433-0.0591868im    -0.0145577+0.100531im     -0.080154+0.00600061im   -0.127127-0.00349792im    0.0820914-0.0947098im     0.0256501+0.110796im    -0.0402305-0.0293594im     -0.115911+0.00602631im      0.165668+0.240222im       -0.130926+0.1405im        -0.0251651+0.148227im    -0.0753491+0.0319187im      0.153367-0.140919im       0.014924+0.103288im      -0.213864+0.0156353im   0.00800433-0.00146862im   0.0139693-0.0138362im      0.322834+0.0726867im       0.142399-0.00963052im    0.0609778-0.0698479im
 -0.0635563+0.0866126im     0.0320364+0.0117391im    -0.0200962-0.0843325im     -0.179473+0.0299066im     0.145055+0.0536853im         0.2206+0.0732284im      0.0558524-0.169858im   -0.000825376+0.0328627im   -0.0341659-0.105854im      -0.0209698+0.0721584im      0.055514-0.125935im      0.0413342+0.193872im       0.171962-0.132446im      -0.041038+0.0783855im     -0.10865+0.192031im    -0.0982514+0.0844471im   0.000844027+0.287537im      -0.196635+0.12495im      -0.076583-0.132469im       0.213219-0.00964952im      0.236649+0.00827721im    0.00700492-0.152415im         0.23849-0.0345574im     0.215886+0.0149604im     0.0218089+0.0636816im     -0.126076+0.224394im       0.172856+0.135592im      0.261915+0.00725658im    0.116474+0.101415im     -0.0292734+0.114339im       0.0128868+0.0477881im     -0.015262-0.14378im
   0.133691-0.102844im      -0.144682-0.0274605im      0.251861+0.0398519im     0.0990925+0.00617547im   -0.165317+0.232245im       0.0210743-0.000995395im  -0.00456423-0.139361im       0.119056+0.0631843im     -0.12353-0.149541im      -0.0456564+0.16978im       -0.108996+0.0853715im      0.118227+0.0522882im      0.128062+0.0910994im    -0.0947704-0.072348im      0.150982+0.140596im     -0.165881-0.211696im       0.110377+0.21098im       -0.157482-0.027953im     -0.129962+0.153439im       0.129937-0.201044im       0.0841329-0.0232161im       0.173673+0.142043im       -0.149021+0.153272im    -0.0806172-0.146618im       0.140828-0.0867685im     0.0810952-0.0304734im    -0.0710606+0.0199049im    -0.098703+0.081618im     -0.180638-0.0562924im       0.11209+0.0237937im      -0.195448-0.113412im    0.000310075-0.170494im
  -0.192744-0.163737im      0.0280589-0.00660909im  -0.00784624-0.0854717im     -0.161555-0.0120903im   -0.0465436+0.0586453im       0.143306-0.0133509im     -0.0723703-0.0187486im      0.114405-0.0511046im    0.0773362+0.0253362im      -0.228511+0.00822118im    -0.024207-0.150874im       0.142821+0.0410788im    -0.0730096+0.0530155im    -0.0377183+0.10417im       0.106923-0.0625205im   -0.0333482-0.250827im      0.0856514+0.261849im       0.309879-0.107293im      0.113047-0.156607im      -0.106138+0.164049im       0.0563121-0.214074im      -0.0811749+0.15508im         0.162281+0.0964273im     0.176742-0.0119093im      -0.19983+0.233932im      0.0698647-0.177453im      -0.198623+0.00652202im  -0.0591925-0.0731218im   0.00678136+0.0129543im      0.183262-0.0275677im      -0.102197+0.103455im     -0.0959747+0.00129775im
  0.0568901+0.119747im      0.0126474-0.183218im     -0.0765397+0.163231im      -0.140431-0.156466im      0.120468+0.0860384im      -0.133573+0.0940521im      -0.316897-0.103382im      0.0582325-0.0488908im   -0.0922753-0.0162539im     -0.0564196-0.0461923im     0.0454767+0.0474259im      0.123764-0.085643im      0.0507176-0.0598449im     -0.163064-0.0780245im     -0.13074-0.123731im    -0.0082179-0.0825541im    -0.0694098-0.18725im      -0.0307087-0.30981im       0.158937+0.126293im       0.103546-0.0116279im       0.161453-0.110279im       -0.191797-0.111739im        0.175266+0.0484648im    -0.103975-0.125396im      0.0765926+0.112042im       0.174187+0.256863im       -0.19555-0.0258197im     0.116798+0.00372287im   -0.111313+0.10522im       0.0158706+0.00443098im     0.0716483-0.227902im      -0.054669+0.0155219im
  0.0387301-0.292069im       0.251687-0.141274im      0.0232353-0.124708im     -0.0664321-0.0168631im   -0.0308884+0.00507889im      0.044543+0.203282im       0.0776234+0.0551555im     0.0164753+0.149163im     -0.110903-0.10643im         0.167597-0.203507im      -0.196234+0.0623074im      0.110998-0.0664175im     -0.047125+0.14293im       0.0250605+0.00544588im  -0.0550687-0.0299333im   -0.0534983-0.259191im      -0.106764+0.0190737im    -0.0425572-0.0723783im   -0.0281288-0.0689152im    -0.0345742-0.136012im      -0.0162761+0.0539956im     -0.0486924+0.00544698im      0.158963-0.180712im   -0.00722807-0.0985955im     0.0134369-0.296097im      -0.179048-0.0253601im      0.027019+0.10513im       0.123937-0.0527215im   0.00961895-0.177544im      0.0134663-0.106314im        0.197698-0.00866644im    -0.338228+0.138685im
  -0.176704-0.0104524im      0.109755-0.14587im      -0.0931872+0.293501im       0.139692-0.156142im     -0.177635-0.0724141im     -0.0885445-0.0162087im       0.056868+0.178262im      -0.110096+0.0915181im    0.0814108-0.172176im       -0.123496+0.150132im     -0.0586693+0.24372im        0.320309+0.0471339im    -0.0428799-0.0845882im    -0.0445372+0.0628854im     0.130108+0.046587im     0.0506938+0.163527im       0.134538-0.0132462im     -0.152777+0.073808im      0.268512+0.00744685im    -0.057374-0.0477047im       0.198786+0.07667im         0.111878+0.156534im        0.246257-0.0119536im   -0.0664478+0.0490293im     -0.157148-0.00336359im   -0.0141001-0.0471397im     0.0486181+0.0782693im    -0.115951+0.0112032im     0.181072-0.0279288im     -0.144822+0.0829431im      0.0157507-0.0565256im    -0.0352062-0.0324304im
  0.0145682-0.0102464im       0.19506-0.100404im     -0.0330697+0.155148im      0.0766539+0.188862im    -0.0406359-0.0809048im      0.0112613+0.159992im       -0.180746+0.218686im        0.15715+0.0321818im   -0.0266715+0.134155im      -0.0820223-0.0892222im     0.0894154+0.192309im     -0.0166272+0.0781327im      0.153384-0.046352im     -0.0310334+0.0321506im   -0.0362603-0.137366im      0.185466+0.0997457im     0.0876246+0.159591im       0.239882-0.0640725im    0.0476593-0.0180823im     0.0659342+0.0940944im        0.10728-0.158985im         0.24308-0.0499536im      -0.187968-0.197406im     0.0766921-0.0525686im     0.0994483-0.275251im    -0.00946241+0.0522373im    -0.0379413+0.223787im      0.102852+0.101634im     -0.141199+0.0540709im     0.0951853+0.00384284im   -0.00829867+0.18368im        0.156914-0.156733im</code></pre><p>and then generate the state <span>$ψ$</span></p><pre><code class="language-julia hljs">psi = P[:, 3]</code></pre><pre><code class="nohighlight hljs">32-element Vector{ComplexF64}:
   -0.0392917117655863 + 0.01169250925662818im
 -0.027832169476660968 - 0.024019411439972167im
    0.1608296556113437 + 0.15544609735986656im
   0.04647494306028187 - 0.13173950855332947im
  0.027707321636648793 - 0.16544497393022708im
   0.17384844857116602 - 0.008534384934008352im
   0.03717716658508389 + 0.05509453304951809im
   -0.1709819624007903 + 0.04608355648448375im
  0.031471521295325815 + 0.09250418221750302im
  -0.09057295198773727 + 0.05984113928702156im
  0.005887207527914682 - 0.00332998094813004im
  0.006794194660199981 - 0.12324122470072045im
   0.14019142378194208 + 0.02783328348374847im
    0.1276057946077628 + 0.217275428467191im
   0.17752858064563906 - 0.14834400427250133im
 -0.030820129550514812 - 0.013129177346735237im
   0.11926808825009741 - 0.12635114980589587im
    0.1250932460426849 - 0.012267418023083305im
   0.24705321279891004 + 0.06814316938246716im
   0.07278580474353465 + 0.106046572993859im
    0.3354100249343451 - 0.09030851501757649im
    0.3493499959237276 + 0.0im
  -0.14799605752748987 + 0.0378132052788429im
   0.08856125685033135 + 0.22685417060811153im
  -0.05841565769821575 - 0.09636170121706261im
  -0.05366820581791491 + 0.2031118367149974im
 -0.012969120811513142 + 0.20739030204313932im
   0.07495339691414424 + 0.13047360838696354im
   0.16598234571306683 - 0.1768152394546915im
   -0.0600705966459604 - 0.08347701793297736im
   0.01920662383908154 + 0.10044186103290813im
 -0.041726639898197415 + 0.015544734553566543im</code></pre><p>In the phase estimation process, we will feed the state to circuit and measure the first <code>n</code> qubits processed by iQFT.</p><pre><code class="language-julia hljs">r = join(ArrayReg(psi), zero_state(N))
r |&gt; PE(N, M, U)</code></pre><pre><code class="nohighlight hljs">ArrayReg{1, ComplexF64, Array...}
    active qubits: 8/8</code></pre><p>Since our phase can be represented by 3 qubits precisely, we only need to measure once</p><pre><code class="language-julia hljs">results = measure(r, 1:N; nshots=1)</code></pre><pre><code class="nohighlight hljs">1-element Vector{BitBasis.BitStr64{3}}:
 011 ₍₂₎</code></pre><p>Recall that our QFT&#39;s bit numbering is reversed, let&#39;s reverse it back</p><pre><code class="language-julia hljs">using BitBasis
estimated_phase = bfloat(results[]; nbits=N)</code></pre><pre><code class="nohighlight hljs">0.75</code></pre><p>the phase is exactly <code>0.75</code>!</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../1.prepare-ghz-state/index.html">« Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a><a class="docs-footer-nextpage" href="../3.grover-search/index.html">Grover Search »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.10 on <span class="colophon-date" title="Monday 20 December 2021 01:10">Monday 20 December 2021</span>. Using Julia version 1.7.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
