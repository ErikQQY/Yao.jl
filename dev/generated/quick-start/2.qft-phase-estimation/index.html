<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quantum Fourier Transformation and Phase Estimation · Documentation | Yao</title><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/indigo.css" rel="stylesheet" type="text/css"/><link href="https://yaoquantum.org/assets/favicon-light.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../index.html"><img src="../../../assets/logo.png" alt="Documentation | Yao logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../index.html">Documentation | Yao</a></span></div><form class="docs-search" action="../../../search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../index.html">Home</a></li><li><span class="tocitem">Quick Start</span><ul><li><a class="tocitem" href="../1.prepare-ghz-state/index.html">Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a></li><li class="is-active"><a class="tocitem" href="index.html">Quantum Fourier Transformation and Phase Estimation</a><ul class="internal"><li><a class="tocitem" href="#Quantum-Fourier-Transformation"><span>Quantum Fourier Transformation</span></a></li><li><a class="tocitem" href="#Wrap-QFT-to-an-external-block"><span>Wrap QFT to an external block</span></a></li><li><a class="tocitem" href="#Phase-Estimation"><span>Phase Estimation</span></a></li><li class="toplevel"><a class="tocitem" href="#using-LinearAlgebra"><span>using LinearAlgebra</span></a></li></ul></li><li><a class="tocitem" href="../3.grover-search/index.html">Grover Search</a></li><li><a class="tocitem" href="../4.shor-algorithm/index.html">Shor&#39;s Algorithm</a></li><li><a class="tocitem" href="../5.shor-9-code/index.html">Shor&#39;s 9 qubit code</a></li><li><a class="tocitem" href="../6.quantum-circuit-born-machine/index.html">Quantum Circuit Born Machine</a></li><li><a class="tocitem" href="../7.variation-quantum-eigen-solver/index.html">Variational Quantum Eigen Solver</a></li></ul></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../../man/array_registers.html">Array Registers</a></li><li><a class="tocitem" href="../../../man/symbolic.html">Symbolic Computation</a></li><li><a class="tocitem" href="../../../man/blocks.html">Blocks</a></li><li><a class="tocitem" href="../../../man/automatic_differentiation.html">Automatic Differentiation</a></li><li><a class="tocitem" href="../../../man/simplification.html">Simplification</a></li><li><a class="tocitem" href="../../../man/base.html">Base</a></li><li><a class="tocitem" href="../../../man/registers.html">Abstract Registers</a></li><li><a class="tocitem" href="../../../man/bitbasis.html">BitBasis</a></li><li><a class="tocitem" href="../../../man/extending_blocks.html">Extending Blocks</a></li></ul></li><li><a class="tocitem" href="../../../benchmarks.html">Benchmark</a></li><li><a class="tocitem" href="../../../dev/index.html">Developer Notes</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Quick Start</a></li><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/QuantumBFS/Yao.jl/blob/master/docs/src/quick-start/2.qft-phase-estimation/main.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><p><a href="https://mybinder.org/v2/gh/QuantumBFS/Yao.jl/gh-pages?filepath=dev/generated/quick-start/2.qft-phase-estimation/main.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a> <a href="https://nbviewer.jupyter.org/github/QuantumBFS/Yao.jl/blob/gh-pages/dev/generated/quick-start/2.qft-phase-estimation/main.ipynb"><img src="https://img.shields.io/badge/show-nbviewer-579ACA.svg" alt/></a> <a href="https://minhaskamal.github.io/DownGit/#/home?url=https://github.com/QuantumBFS/tutorials/tree/gh-pages/dev/generated/quick-start/2.qft-phase-estimation"><img src="https://img.shields.io/badge/download-project-orange" alt/></a></p><h1 id="example-qft"><a class="docs-heading-anchor" href="#example-qft">Quantum Fourier Transformation and Phase Estimation</a><a id="example-qft-1"></a><a class="docs-heading-anchor-permalink" href="#example-qft" title="Permalink"></a></h1><p>Let&#39;s use Yao first</p><pre><code class="language-julia hljs">using Yao</code></pre><h2 id="Quantum-Fourier-Transformation"><a class="docs-heading-anchor" href="#Quantum-Fourier-Transformation">Quantum Fourier Transformation</a><a id="Quantum-Fourier-Transformation-1"></a><a class="docs-heading-anchor-permalink" href="#Quantum-Fourier-Transformation" title="Permalink"></a></h2><p>The Quantum Fourier Transformation (QFT) circuit is to repeat two kinds of blocks repeatly:</p><p><img src="assets/qft.png" alt="qft-circuit"/></p><p>The basic building block control phase shift gate is defined as</p><p class="math-container">\[R(k)=\begin{bmatrix}
1 &amp; 0\\
0 &amp; \exp\left(\frac{2\pi i}{2^k}\right)
\end{bmatrix}\]</p><p>Let&#39;s define block <code>A</code> and block <code>B</code>, block <code>A</code> is actually a control block.</p><pre><code class="language-julia hljs">A(i, j) = control(i, j=&gt;shift(2π/(1&lt;&lt;(i-j+1))))</code></pre><pre><code class="nohighlight hljs">A (generic function with 1 method)</code></pre><p>Once you construct the blockl you can inspect its matrix using <code>mat</code> function. Let&#39;s construct the circuit in dash box A, and see the matrix of <span>$R_4$</span> gate.</p><pre><code class="language-julia hljs">R4 = A(4, 1)</code></pre><pre><code class="nohighlight hljs">(n -&gt; control(n, 4, 1 =&gt; shift(0.39269908169872414)))</code></pre><p>If you have read about <a href="generated/quick-start/2.qft-phase-estimation/@ref example-ghz">preparing GHZ state</a>, you probably know that in Yao, we could just leave the number of qubits, and it will be evaluated when possible.</p><pre><code class="language-julia hljs">R4(5)</code></pre><pre><code class="nohighlight hljs">nqubits: 5
control(4)
└─ (1,) shift(0.39269908169872414)</code></pre><p>its matrix will be</p><pre><code class="language-julia hljs">mat(R4(5))</code></pre><pre><code class="nohighlight hljs">32×32 LinearAlgebra.Diagonal{ComplexF64, Vector{ComplexF64}}:
 1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im</code></pre><p>Then we repeat this control block over and over on different qubits, and put a Hadamard gate to <code>i</code>th qubit to construct <code>i</code>-th <code>B</code> block.</p><pre><code class="language-julia hljs">B(n, k) = chain(n, j==k ? put(k=&gt;H) : A(j, k) for j in k:n)</code></pre><pre><code class="nohighlight hljs">B (generic function with 1 method)</code></pre><p>We need to input the total number of qubits <code>n</code> here because we have to iterate through from <code>k</code>-th location to the last.</p><p>Now, let&#39;s construct the circuit by chaining all the <code>B</code> blocks together</p><pre><code class="language-julia hljs">qft(n) = chain(B(n, k) for k in 1:n)
qft(4)</code></pre><pre><code class="nohighlight hljs">nqubits: 4
chain
├─ chain
│  ├─ put on (1)
│  │  └─ H
│  ├─ control(2)
│  │  └─ (1,) shift(1.5707963267948966)
│  ├─ control(3)
│  │  └─ (1,) shift(0.7853981633974483)
│  └─ control(4)
│     └─ (1,) shift(0.39269908169872414)
├─ chain
│  ├─ put on (2)
│  │  └─ H
│  ├─ control(3)
│  │  └─ (2,) shift(1.5707963267948966)
│  └─ control(4)
│     └─ (2,) shift(0.7853981633974483)
├─ chain
│  ├─ put on (3)
│  │  └─ H
│  └─ control(4)
│     └─ (3,) shift(1.5707963267948966)
└─ chain
   └─ put on (4)
      └─ H
</code></pre><h2 id="Wrap-QFT-to-an-external-block"><a class="docs-heading-anchor" href="#Wrap-QFT-to-an-external-block">Wrap QFT to an external block</a><a id="Wrap-QFT-to-an-external-block-1"></a><a class="docs-heading-anchor-permalink" href="#Wrap-QFT-to-an-external-block" title="Permalink"></a></h2><p>In most cases, <code>function</code>s are enough to wrap quantum circuits, like <code>A</code> and <code>B</code> we defined above, but sometimes, we need to dispatch specialized methods on certain kinds of quantum circuit, or we want to define an external block to export, thus, it&#39;s useful to be able to wrap circuit to custom blocks.</p><p>First, we define a new type as subtype of <code>PrimitiveBlock</code> since we are not going to use the subblocks of <code>QFT</code>, if you need to use its subblocks, it&#39;d be better to define it under <code>CompositeBlock</code>.</p><pre><code class="language-julia hljs">struct QFT{N} &lt;: PrimitiveBlock{N} end
QFT(n::Int) = QFT{n}()</code></pre><pre><code class="nohighlight hljs">Main.##276.QFT</code></pre><p>Now, let&#39;s define its circuit</p><pre><code class="language-julia hljs">circuit(::QFT{N}) where N = qft(N)</code></pre><pre><code class="nohighlight hljs">circuit (generic function with 1 method)</code></pre><p>And forward <code>mat</code> to its circuit&#39;s matrix</p><pre><code class="language-julia hljs">YaoBlocks.mat(::Type{T}, x::QFT) where T = mat(T, circuit(x))</code></pre><p>You may notice, it is a little ugly to print <code>QFT</code> at the moment, this is because we print the type summary by default, you can define your own printing by overloading <code>print_block</code></p><pre><code class="language-julia hljs">YaoBlocks.print_block(io::IO, x::QFT{N}) where N = print(io, &quot;QFT($N)&quot;)</code></pre><p>Since it is possible to use FFT to simulate the results of QFT (like cheating), we could define our custom <code>apply!</code> method:</p><pre><code class="language-julia hljs">using FFTW, LinearAlgebra

function YaoBlocks.apply!(r::ArrayReg, x::QFT)
    α = sqrt(length(statevec(r)))
    invorder!(r)
    lmul!(α, ifft!(statevec(r)))
    return r
end</code></pre><p>Now let&#39;s check if our <code>apply!</code> method is correct:</p><pre><code class="language-julia hljs">r = rand_state(5)
r1 = r |&gt; copy |&gt; QFT(5)
r2 = r |&gt; copy |&gt; circuit(QFT(5))
r1 ≈ r2</code></pre><pre><code class="nohighlight hljs">true</code></pre><p>We can get iQFT (inverse QFT) directly by calling <code>adjoint</code></p><pre><code class="language-julia hljs">QFT(5)&#39;</code></pre><pre><code class="nohighlight hljs"> [†]QFT(5)</code></pre><p>QFT and iQFT are different from FFT and IFFT in three ways,</p><ol><li>they are different by a factor of <span>$\sqrt{2^n}$</span> with <span>$n$</span> the number of qubits.</li><li>the <a href="https://quantumbfs.github.io/BitBasis.jl/stable/tutorial/#Conventions-1">bit numbering</a> will exchange after applying QFT or iQFT.</li><li>due to the convention, QFT is more related to IFFT rather than FFT.</li></ol><h2 id="Phase-Estimation"><a class="docs-heading-anchor" href="#Phase-Estimation">Phase Estimation</a><a id="Phase-Estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Phase-Estimation" title="Permalink"></a></h2><p>Since we have QFT and iQFT blocks we can then use them to realize phase estimation circuit, what we want to realize is the following circuit:</p><p><img src="assets/phaseest.png" alt="phase estimation"/></p><pre><code class="language-julia hljs">using Yao</code></pre><p>First we call Hadamard gates repeatly on first <code>n</code> qubits.</p><pre><code class="language-julia hljs">Hadamards(n) = repeat(H, 1:n)</code></pre><pre><code class="nohighlight hljs">Hadamards (generic function with 1 method)</code></pre><p>Then in dashed box <code>B</code>, we have controlled unitaries:</p><pre><code class="language-julia hljs">ControlU(n, m, U) = chain(n+m, control(k, n+1:n+m=&gt;matblock(U^(2^(k-1)))) for k in 1:n)</code></pre><pre><code class="nohighlight hljs">ControlU (generic function with 1 method)</code></pre><p>each of them is a <code>U</code> of power <span>$2^(k-1)$</span>.</p><p>Since we will only apply the qft and Hadamard on first <code>n</code> qubits, we could use <code>Subroutine</code>, which creates a context of a sub-scope of the qubits.</p><pre><code class="language-julia hljs">PE(n, m, U) =
    chain(n+m, # total number of the qubits
        subroutine(Hadamards(n), 1:n), # apply H in local scope
        ControlU(n, m, U),
        subroutine(QFT(n)&#39;, 1:n))</code></pre><pre><code class="nohighlight hljs">PE (generic function with 1 method)</code></pre><p>we use the first <code>n</code> qubits as the output space to store phase <span>$ϕ$</span>, and the other <code>m</code> qubits as the input state which corresponds to an eigenvector of oracle matrix <code>U</code>.</p><p>The concentrator here uses <code>focus!</code> and <code>relax!</code> to manage a local scope of quantum circuit, and only active the first <code>n</code> qubits while applying the block inside the concentrator context, and the scope will be <code>relax!</code>ed back, after the context. This is equivalent to manually <code>focus!</code> then <code>relax!</code></p><p>fullly activated</p><pre><code class="language-julia hljs">r = rand_state(5)</code></pre><pre><code class="nohighlight hljs">ArrayReg{1, ComplexF64, Array...}
    active qubits: 5/5</code></pre><p>first 3 qubits activated</p><pre><code class="language-julia hljs">focus!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{1, ComplexF64, Array...}
    active qubits: 3/5</code></pre><p>relax back to the original</p><pre><code class="language-julia hljs">relax!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{1, ComplexF64, Array...}
    active qubits: 5/5</code></pre><p>In this way, we will be able to apply small operator directly on the subset of the qubits.</p><p>Details about the algorithm can be found here: <a href="ttps://en.wikipedia.org/wiki/Quantum_phase_estimation_algorithm">Quantum Phase Estimation Algorithm</a></p><p>Now let&#39;s check the results of our phase estimation.</p><p>First we need to set up a unitary with known phase, we set the phase to be 0.75, which is <code>0.75 * 2^3 == 6 == 0b110</code> .</p><h1 id="using-LinearAlgebra"><a class="docs-heading-anchor" href="#using-LinearAlgebra">using LinearAlgebra</a><a id="using-LinearAlgebra-1"></a><a class="docs-heading-anchor-permalink" href="#using-LinearAlgebra" title="Permalink"></a></h1><pre><code class="language-julia hljs">N, M = 3, 5
P = eigen(rand_unitary(1&lt;&lt;M)).vectors
θ = Int(0b110) / 1&lt;&lt;N
phases = rand(1&lt;&lt;M)
phases[0b010+1] = θ
U = P * Diagonal(exp.(2π * im * phases)) * P&#39;</code></pre><pre><code class="nohighlight hljs">32×32 Matrix{ComplexF64}:
  -0.0773273-0.0476238im    -0.112781-0.131501im       0.143331-0.16928im         0.0345993+0.0227662im     0.0990006+0.129734im      0.0201751+0.0554924im    0.0581793+0.0441302im   -0.0268296-0.000666321im     -0.156336+0.141913im       -0.174206-0.0721813im     -0.114887+0.140696im      0.0576453-0.0645268im     -0.040152-0.00218003im    0.191649-0.106762im       0.0519331+0.0672164im    0.0497629+0.172213im      -0.0216714-0.078461im     -0.138629-0.0134048im       0.228991-0.0397908im    -0.272153+0.0386579im   -0.0889146-0.0482933im    0.0575544+0.0753638im   -0.0168241-0.0974904im      0.0369106+0.265037im      -0.158952+0.0278895im     -0.168246-0.0207634im     -0.106788+0.350813im       0.168033-0.0870451im     -0.236451-0.0297642im     0.195807+0.00293334im    0.231159+0.0717988im    0.0572154+0.163211im
   0.0962837-0.285171im     0.0596881-0.0283227im   -0.00985797-0.0452571im       0.0431426-0.121772im    -0.00594187-0.110128im       0.137968-0.124434im     -0.104301-0.140386im     -0.145338-0.000776528im  -0.000465726-0.0405552im      -0.115594-0.0611165im      -0.21674+0.0913579im     0.0574264-0.179973im      0.0751501-0.0251001im   -0.0228407-0.0905823im      0.0166041-0.0495064im     -0.17672-0.137337im       0.0176464+0.0770538im     -0.13082+0.0771282im       0.106188+0.0261839im    0.0568263-0.140904im     0.0153086+0.0105286im      0.16369+0.0544771im     0.109746+0.192127im      -0.0781005+0.0948261im      0.443803+0.191125im      -0.185863+0.221816im       0.030171-0.0162312im     0.0625722+0.0385945im      0.152079+0.130529im      0.231992+0.0603769im     -0.12365-0.0139436im   -0.0242156+0.119202im
    0.238586+0.0153714im    0.0162584+0.0363136im     -0.182032-0.195534im       -0.0362142+0.0278419im    -0.0579386+0.110213im       -0.28812+0.172988im     0.0357637-0.285681im     0.0822054+0.0501389im       -0.114275+0.0516461im     -0.0392128-0.0437141im     -0.110804+0.0216922im   -0.00895222-0.129417im       0.146388+0.0901642im    -0.198865+0.0734076im   -0.000934401-0.192394im     -0.182425-0.177903im       -0.138564+0.163173im     0.0929751+0.0195832im       0.126767+0.00961955im   0.0203447+0.288809im      0.050635+0.0209952im    -0.127395-0.0436428im    0.0960006-0.0375882im     -0.0400174-0.127285im      0.0188953-0.152182im     -0.0286707+0.0450909im     -0.003077+0.224536im    -0.00967752-0.183698im     -0.0855934-0.104888im    -0.0135833+0.101359im    -0.0188173+0.237332im     -0.122897-0.0799176im
 -0.00243334+0.108974im    -0.0789711-0.0218825im    -0.0191155+0.0170729im      -0.0916692-0.16885im       0.0352931-0.0759173im      0.118567+0.148394im      0.032069+0.0631378im     -0.26235+0.376967im        -0.169139+0.115972im      -0.0805845-0.0666591im     -0.175949+0.0171879im      0.158678+0.019351im      -0.189975-0.0161966im    -0.139961+0.0307134im    -0.00482747+0.016401im     0.0602908-0.253958im        0.115269-0.151956im     -0.236276-0.228053im      -0.0331801-0.0177903im     0.118864-0.0127608im    -0.201675-0.0138514im    -0.104168-0.034444im      0.110454+0.0827372im      0.0153962-0.0506523im   0.000354576-0.143298im       0.124359+0.127528im      0.0117001-0.0491006im     -0.260126+0.051252im      -0.186574-0.0145426im    -0.117705+0.0616695im    0.0404776+0.0526609im     0.139072+0.116123im
    -0.16341+0.276832im     0.0225961-0.26078im       -0.181217-0.00618279im      -0.190801+0.0782297im     -0.133964+0.0387342im     0.0305254+0.0724756im   -0.0224213-0.0473862im    0.0634708-0.0965792im       -0.120138-0.0181512im       0.022454+0.032703im     -0.0723635+0.0598616im    -0.0308594-0.232736im     -0.0483908-0.0311712im     0.217093+0.16454im         0.133916-0.00413121im    0.017816-0.105144im       -0.101519-0.0759725im    -0.172952-0.0677887im        -0.1563-0.201057im     0.0524288+0.107034im     0.0706689+0.0395365im     0.395143+0.125985im    -0.0676452+0.15184im         -0.19708+0.0115786im    -0.0275579-0.135539im      -0.131859-0.0934323im     0.0574989-0.00590118im   -0.0336758-0.0374923im     0.0462045-0.081033im    -0.0589159-0.136371im     -0.177216-0.0950156im    -0.143502+0.0784286im
    0.121253+0.0790106im   -0.0932727-0.180761im    -0.00891251+0.0931588im     -0.00116298-0.0171883im     -0.212821-0.101435im     -0.0321096+0.0748327im    -0.116143-0.0970252im    -0.166638+0.0714367im        0.036007+0.0907891im     -0.0569471-0.110807im     -0.0555682-0.210266im      -0.209724+0.212514im      0.0881646-0.0488239im   -0.0373291+0.1897im         -0.199289+0.0155366im     0.180016-0.0031552im      -0.188199-0.0732366im    -0.132882+0.203543im       -0.153577-0.114896im     0.0626108+0.00115464im   -0.205389+0.141893im     -0.121711+0.108336im    -0.0513024-0.251216im       0.0177323-0.051798im      0.0113587+0.13652im        0.037102+0.0732092im    -0.0348849+0.0421479im       0.26613-0.0734485im     0.0809884-0.160243im      0.232394-0.0511403im    -0.128234-0.0371109im    0.0670733+0.123053im
  -0.0286246+0.116628im    -0.0647901+0.0486975im     -0.097926+0.054493im        0.0324822+0.0929683im    -0.0646687-0.149283im     -0.0357245+0.020087im     0.0446376-0.125209im     0.0375493-0.0643537im        0.263694+0.182403im        0.282326-0.173118im      0.0759411+0.146491im     -0.0873828+0.226637im      -0.134422+0.00118037im   0.0780085+0.160996im        0.163832+0.159381im     0.0214548-0.100552im       0.0317684+0.0291758im   -0.0448694-0.0818153im       0.273348-0.0305434im    0.0172363+0.0695335im     -0.10555-0.136661im     -0.103687+0.183783im    -0.0212465+0.0986991im     -0.0489769+0.334704im        0.20356-0.0187346im     0.0716471+0.056003im      0.0236517+0.0472397im      0.124016+0.0247357im     0.0456971+0.134823im     -0.167446-0.0621139im   -0.0576672+0.272516im      0.038316-0.0583863im
  -0.0995921-0.0128137im    0.0324307+0.1467im         0.248308+0.0814198im        0.272564+0.0717113im     0.0316559-0.0591243im      0.042356-0.231711im    0.00862708-0.0913188im   -0.0182612-0.0315605im       -0.123518+0.032432im       0.0849355-0.0524147im      0.193384-0.0877617im      0.238852-0.116451im       -0.19017-0.109979im     -0.108085+0.060267im      -0.0520346+0.0256632im   -0.0762181+0.131343im      -0.0411866+0.102226im     -0.218578+0.0422068im      -0.190174-0.200344im     0.0879648+0.110778im    -0.0399383+0.133839im    -0.0454453-0.0453605im   0.00581984-0.000814155im    -0.258526-0.107302im     0.00460294-0.0497089im    -0.0872935+0.174724im      0.0249923-0.0171684im      0.153782-0.0484606im     -0.264026+0.0403935im     0.010248-0.17497im      0.0192991+0.217111im     -0.152067-0.132794im
   -0.117183+0.129902im      0.383757-0.0201291im     0.0243243+0.0999568im        0.254066-0.242377im     -0.0335584+0.154621im       0.230647+0.0185402im   -0.0161351+0.141532im    0.00854932-0.244957im       -0.0236182+0.0912918im     -0.0965467+0.153581im     -0.0513852-0.10073im       -0.218533+0.141455im     -0.0861687+0.0888191im    0.0489999-0.0145447im      -0.086031-0.0928716im    -0.101188-0.210621im       -0.114862-0.0484223im    -0.137466+0.109319im        0.197501-0.0791028im    0.0422044+0.158834im      0.146832-0.0467482im   0.00578984-0.0744674im    0.0241626+0.0178869im       -0.02305-0.0281345im      0.145752+0.00099237im     0.160366-0.111778im        -0.1728+0.0497552im    -0.0472568-0.0626705im     -0.152687-0.00259325im   0.0481486+0.0196646im   0.00606867+0.0194435im     0.173846-0.114738im
    0.135166-0.0721064im     0.133243-0.37421im       0.0404019+0.0499624im      -0.0232018+0.208466im      0.0931702+0.211256im      -0.200389-0.0873366im    -0.107729-0.109152im      0.150256-0.00391013im     -0.0168703-0.00635232im     0.0383649+0.210003im    0.000479006-0.167975im      0.0795835+0.00130696im    -0.108526-0.215411im     0.0687301+0.0711869im     -0.0274113+0.00303742im   0.0505952-0.121267im       0.0448205+0.0917551im    -0.239363-0.0393468im      0.0736271-0.0800799im    -0.180904-0.126228im     0.0189529+0.00149018im   -0.119321-0.0784468im    -0.069126-0.133556im       0.0786834-0.0431409im      0.167563-0.0262071im     -0.093927+0.134139im       0.116239-0.0649452im     0.0325506-0.0599318im      0.039067+0.115295im      -0.30107+0.14849im       0.133563-0.10654im       0.202551+0.00968514im
  -0.0100468+0.0248862im    0.0757021-0.032979im       -0.10455+0.0904732im        0.135803-0.178745im       0.238078+0.0080999im     -0.118971-0.00277433im   -0.126413-0.0757604im    -0.175793-0.0363626im       -0.146871+0.0165792im      -0.081523-0.0757628im     0.0588198+0.280783im       0.108603-0.0843159im      0.192606+0.0309757im     0.023914+0.296876im        0.113873+0.0586163im   -0.0575082+0.0642057im      -0.266101-0.0202838im    0.0625062+0.0259123im     -0.0134903+0.0546439im    -0.183282-0.0206038im    -0.189617+0.0606185im   0.00841829-0.126723im     -0.126993-0.104888im        0.125616+0.18195im       0.0768216+0.116742im      0.0665444-0.134609im      0.0428878-0.355441im     -0.0186687-0.0168436im     -0.223529-0.0249922im   -0.0940081+0.0593923im    -0.122354-0.0586309im    -0.040412-0.115877im
    0.196364-0.0433588im   0.00949632+0.135149im      0.0424375-0.125243im       -0.0309484-0.0788502im     -0.237775+0.029433im      -0.116304+0.137462im     -0.181495+0.169671im    -0.0898331+0.0159896im       0.0524075-0.118079im       0.0284452+0.331765im      0.0949866-0.0301797im    -0.0846991-0.0288838im     -0.281457+0.0274806im    -0.127161+0.0414261im       0.164597-0.108483im    -0.0698627+0.0250343im    -0.00910388-0.0219307im      0.14231+0.0170356im      -0.102497-0.0994636im   -0.0668904-0.0340012im    -0.117954-0.237229im    -0.0195606+0.187122im     0.0906106+0.0475225im     -0.0557479+0.0569519im     0.0221167-0.0325391im     -0.218651-0.159221im       0.142426-0.112136im       0.206512+0.0557971im     -0.308107+0.0743508im    0.0628545+0.0763348im    -0.106099-0.0285112im     0.127381+0.0867458im
    0.101658+0.0272986im    0.0413073+0.0999486im     0.0974193+0.0291415im      -0.0485282-0.00713814im   -0.0222062-0.11982im      -0.0425097-0.012728im     0.0104469+0.0889487im   -0.0399063+0.0814584im      -0.0917446+0.0198899im       0.342933-0.210715im      -0.133142+0.0536203im     0.0532373-0.0398496im     0.0227452-0.161978im      0.252546-0.020833im        0.121035-0.0282124im    0.0197327-0.106776im       -0.313453-0.0667047im     0.152517-0.0918172im       0.110235-0.119271im     0.0673821-0.0166777im     0.302971-0.154792im     0.0362957-0.13769im       0.122191-0.180623im      -0.0344177-0.166561im     -0.0169426-0.0561876im      0.177516+0.0813026im      0.136663-0.118219im       0.174392-0.0691438im    -0.0697947+0.137732im      0.180878+0.00832095im    0.179917-0.153507im     0.0559855+0.118986im
    0.135061-0.0247092im    -0.013002-0.0314739im    -0.0586134+0.152085im        -0.117397-0.10137im       -0.244741+0.137773im      -0.111868+0.0168168im      0.02672+0.448698im    -0.0350088-0.162524im        -0.104471+0.017627im        -0.10252-0.117466im     -0.0116078+0.143178im       0.155944-0.0731272im    -0.0544157+0.111842im     -0.004696-0.0260182im      -0.100841+0.056494im    0.00451933+0.0898029im      0.0654981+0.11543im      -0.123731+0.0207472im       0.226974+0.141184im      0.121259+0.247204im    -0.0348888+0.11049im     -0.0904961-0.054669im    -0.0869411+0.0206095im     -0.0067606-0.0398466im    0.00985763+0.0247173im     0.0675217+0.150125im        0.22559+0.035841im       0.267771+0.208454im      0.0492477-0.0157436im     -0.16318-0.0450167im   -0.0480191-0.166294im     -0.114287-0.0153476im
   -0.227985-0.323025im     -0.142395-0.0605961im      0.132771-0.10333im      -0.000804297+0.146534im      -0.130464+0.11311im      -0.0533035-0.0348801im     -0.28851-0.0474616im    -0.211548+0.0918446im       0.0330199+0.0487305im        0.12819-0.00989538im     0.193198-0.00800301im    0.0204137-0.0319553im    -0.0244548+0.063233im    -0.0903638+0.0977252im    -0.00211365-0.0968811im     0.176046-0.224183im       -0.078926-0.0486882im   -0.0942528+0.0265022im       0.182183+0.123944im       0.30141-0.0533335im    0.0249809-0.0711949im     0.150043-0.202366im    -0.0497375-0.081354im       0.0535808+0.0593606im    -0.0520862-0.0174117im     0.0015174-0.222062im     -0.0766977+0.201921im     -0.0297682+0.0446116im    -0.0552627+0.0740287im   -0.0227294+0.00715488im  -0.0600456-0.136101im     -0.127583-0.176578im
   0.0531357+0.0699045im    0.0843071-0.0333275im       0.29879+0.130393im        -0.103304-0.047631im     0.00761567-0.163766im      0.0185374+0.141273im     0.0781471-0.02153im       0.247595+0.0332612im      -0.0520451-0.391779im      0.00114885+0.00865057im    0.0491241+0.141631im    -0.00791837+0.0281966im    0.00764629-0.0208431im    -0.119417+0.224351im      -0.0867476-0.0409028im    0.0230968-0.161809im        0.115547+0.0728629im    0.0945981+0.0111965im     -0.0480964-0.13891im      0.0254217+0.012561im    0.00660588-0.00405063im  0.00643199-0.249527im     -0.161646+0.125412im       0.0125003+0.344449im      -0.107622+0.0355284im     0.0905928+0.217945im     -0.0511701+0.217306im      0.0270599-0.067048im     -0.0849063+0.0449181im     0.114522+0.107162im     -0.110408-0.156204im     0.0252084+0.0156642im
    0.142426+0.0596862im   -0.0936083+0.0441244im      0.247387+0.197409im        -0.141535-0.155067im      0.0452477+0.0775368im     0.0706771+0.152406im     -0.284545-0.0691225im    0.0273028-0.0694465im       0.0302645+0.195627im        0.105646+0.0481767im    -0.0545352-0.221339im      0.0679747-0.131054im       0.136799+0.0146578im    -0.203292-0.0370402im       0.206207-0.0540402im    -0.245255+0.0603283im      0.0474972-0.22576im     0.00315935-0.0478183im       0.214659-0.0364484im    -0.128415-0.0579201im   -0.0748299-0.00771488im   0.0219479-0.0742292im     -0.12317+0.105122im      -0.0328707-0.0473254im     -0.169115+0.0762671im     0.0479982+0.0397547im    -0.0874488-0.0106571im       0.05317-0.162903im       0.165221+0.0582331im    -0.104356-0.333774im    -0.0557365-0.0111131im    0.0193121+0.0182758im
   0.0256391+0.0606454im     0.120496-0.0231308im      0.117991-0.111737im       -0.0987542-0.0949172im      0.135024+0.0393183im    -0.0591676+0.252412im     -0.147683-0.0422751im     0.149067-0.0138235im       -0.191632-0.095445im        0.126932-0.122768im       0.110764+0.239367im      -0.141384-0.0170871im      -0.20431+0.124573im    -0.0717606-0.247522im     0.000363552+0.200144im    0.00932293+0.0965058im      -0.089031-0.155137im     0.0620071+0.0445613im     -0.0291059-0.100944im      0.267908-0.153694im    -0.0124831+0.115101im     0.0786896+0.0141261im    -0.196291-0.181903im        0.056664-0.188274im       0.232937+0.132217im      -0.111498+0.0292725im    -0.0763247+0.0738868im   -0.00625066+0.123725im      0.0452394-0.0620131im    -0.137318+0.0383454im    0.0300344+0.210252im     0.0641625+0.0317407im
    0.146442+0.00590514im   -0.275524+0.17628im       0.0696936-0.113248im     -0.000454561-0.174578im      0.0058863+0.0714842im     0.0225266+0.073281im      0.291466-0.0708553im   -0.0619905-0.137407im       -0.0519317-0.0156792im      -0.161348+0.010553im     -0.0414239-0.10732im       -0.135083-0.0943066im    -0.0694033-0.202712im     0.0489032+0.247943im       -0.148502-0.191496im     0.0335928-0.0540988im    -0.00903052-0.0177434im   -0.0173307+0.0163844im      0.0472123-0.0534386im   -0.0316932-0.129328im     0.0350108-0.213247im       0.22567+0.0276036im     -0.24786-0.144646im        0.114742-0.0179467im     0.0723283-0.0842619im   0.000711769+0.114004im      -0.034255-0.0724207im    0.00171262+0.314823im      0.0614423+0.0501375im   -0.0606447-0.136435im        0.1419+0.107094im    -0.0481231-0.215074im
    0.220845+0.0710391im    0.0021422-0.0750501im     -0.189947+0.0233795im        0.169824+0.0293727im    -0.0710299-0.139775im       0.174217-0.0907076im   -0.0444234+0.186188im    -0.0862565+0.119384im       -0.0983419-0.138697im       0.0650378+0.13403im       0.0388503+0.164023im     -0.0818311-0.0708063im     0.0275255-0.130919im    -0.0872349-0.141746im      -0.0508697-0.0227795im     0.044366-0.0323352im       0.113262-0.0722131im   -0.0936387-0.000160425im     0.039697-0.00606126im   -0.194736-0.174312im     0.0104522-0.0728473im     0.128658+0.125232im      -0.09428-0.185105im     -0.00883085-0.0895667im    -0.0667642+0.0839107im      0.271942-0.0393902im    0.00348198+0.179171im      0.0578882-0.268174im   -0.000487643+0.186326im     -0.134112+0.109732im     -0.121378+0.172935im     -0.337756-0.0793215im
  0.00570432-0.0949857im     0.171196-0.0260839im     -0.125915+0.104998im         0.118828+0.0683942im     0.0371926+0.17127im         0.22735+0.102786im     0.0854871-0.0055212im    0.0846263-0.0420418im        0.126059+0.133761im       0.0278493-0.0119919im    -0.0958354-0.0456689im      0.267409-0.12188im       -0.149891-0.133034im     -0.153116+0.08932im         0.205756+0.0699912im    0.0837481+0.0944631im      -0.168702+0.00623174im      0.1303+0.171615im       -0.192481+0.0404434im    0.0401819+0.0413054im   -0.0232661-0.211746im    -0.0492497-0.0145605im   -0.0207632-0.078254im        0.310397-0.016182im      0.0421902-0.146183im      0.0727963+0.0918577im     -0.165026+0.209107im     0.00500687+0.155611im       0.040177+0.0551694im    -0.013556+0.0036621im    -0.206852-0.0306564im    -0.135106+0.268169im
  -0.0938796-0.0695791im    0.0815499-0.0306635im    -0.0686503-0.18273im        -0.0790016-0.0185429im    -0.0781111+0.0700362im   -0.00193259+0.138706im     0.0702686-0.0147622im    -0.162337-0.1187im           0.129063-0.0985319im      0.0298099-0.162343im       0.151893-0.0920098im     0.0469733-0.0277im         0.249388-0.293672im     0.0959219-0.11964im        0.0903715+0.0568674im    -0.124058-0.117285im        0.190834-0.117549im      0.104244+0.197644im      -0.0958113-0.00173145im   -0.131569+0.127131im     -0.202714+0.145194im     0.0874115-0.143143im    -0.0124141-0.110447im       -0.303767-0.0692629im     -0.011265+0.00977775im     0.154021-0.00325003im   0.00334065+0.112898im     0.00104125+0.211616im      -0.124023+0.206013im     -0.092327+0.0702201im   -0.0630313+0.0655092im     0.223462+0.0638372im
    0.039564-0.212217im      0.106349-0.0890814im    -0.0222341+0.156881im       0.00096093+0.0522663im     -0.122235+0.0407262im    -0.0591905-0.156144im     0.0465856+0.00449191im   0.0367781+0.0272179im       -0.106903+0.0447351im     -0.0983882+0.0211424im     -0.114585-0.0523718im     -0.201909+0.0349126im    -0.0654306+0.0800263im     0.211317-0.115352im        0.371164-0.127036im      0.137433-0.0791173im   -0.000765349-0.138202im      0.250896+0.0460882im      0.0767478-0.216703im    0.00778368-0.11203im      -0.179263+0.106849im      -0.19901+0.0116654im    -0.044349-0.0272969im       -0.10128+0.0292316im    -0.0812175+0.0576156im    -0.0115716+0.259622im      0.0292648+0.0173687im     -0.243553+0.149604im      -0.116994-0.0636155im    0.0340055-0.0838737im   -0.0327118+0.00717012im    -0.23927-0.192548im
  -0.0141539-0.149531im     -0.119882-0.123136im     -0.0714551-0.000878653im     0.0449371-0.143103im     -0.0185875-0.259187im      -0.136413+0.0236362im    0.0852427+0.060151im       0.25664-0.107158im         0.226343+0.1603im         -0.254133+0.0649904im     0.0517512-0.126509im       0.180575+0.0345513im    -0.0957164+0.0361742im     0.156824-0.00365677im     -0.198553+0.0233981im   -0.0901118+0.0787783im      -0.137323-0.334225im      0.147699-0.236956im     -0.00134791+0.0228209im     0.137309-0.0600082im   -0.0794182-0.0638953im     0.158453-0.191291im      0.112119-0.0769029im     -0.0818121-0.0336558im     0.0578177+0.0132696im     -0.030174+0.0870611im     0.0176111+0.063362im      0.0404621-0.198741im     -0.0908774+0.0180151im    -0.110632+0.128229im     -0.172406+0.0405442im   -0.0229191-0.0354235im
  -0.0534711-0.161026im     -0.191269+0.21265im       -0.171009+0.178918im       -0.0825505-0.360088im      0.0644701+0.165451im      0.0151246-0.10199im      -0.102884-0.126889im      0.140189-0.0594657im        -0.19273-0.126413im     -0.00119695-0.155933im      0.0454501+0.0556748im    -0.0251163+0.085593im       0.127392-0.038445im     0.0867396-0.0347685im      -0.015572-0.0933708im     0.237813+0.0580056im     -0.0493324-0.128365im     -0.151059+0.0524131im      -0.129681-0.0677747im   -0.0381625-0.0678397im     0.177714-0.0833616im    -0.240055+0.127889im      0.114222+0.0886821im      -0.089353+0.00263655im   -0.0272733-0.139593im      -0.115868-0.0378789im    -0.0214863+0.184487im      0.0637618-0.0641156im   -0.00981377+0.160215im     -0.189627+0.0554062im    -0.184926-0.0584981im     0.139181-0.0290411im
    0.107654-0.205548im     0.0828066-0.0767408im     -0.193596-0.100435im        0.0773996-0.0189991im     0.0812539-0.275871im    0.000105679+0.0904834im   -0.0471291+0.106326im     0.0435693-0.0693432im       -0.101435-0.0219982im        0.02471+0.152501im     -0.0552328+0.0015118im      0.289984-0.042158im      0.0358626+0.0754661im    0.0126556-0.0599262im      -0.104972-0.0649652im     0.240629-0.19926im       -0.0217617+0.033776im     0.0164634+0.171532im       0.0679141-0.238932im     0.0370852-0.0264666im    0.0721656+0.0391687im   -0.0668497-0.117455im    2.74281e-5+0.0262769im     -0.0458448+0.172505im      -0.240581-0.0178786im    -0.0350016-0.175364im     -0.0571322-0.160081im      0.0972019+0.138386im       0.184333-0.0593894im   -0.0473907-0.231095im     0.0352017+0.31719im       0.138018+0.0828692im
  -0.0692868-0.0512247im   -0.0870486+0.01883im       -0.111793+0.100853im        -0.239115+0.140309im      0.0670372+0.00300802im   -0.0702709-0.178688im     -0.147371+0.0309621im   -0.0126767+0.00655793im       0.038956-0.0817615im       -0.19665-0.128972im      -0.188649-0.159348im     -0.0403783+0.024176im    -0.00925262+0.293637im    -0.0624528+0.097403im        0.110083+0.146196im     -0.013007+0.0162234im       0.236032+0.0263486im    -0.050367-0.100012im       -0.119507-0.223579im    -0.0686881+0.206389im       0.24071-0.198986im      0.077151-0.150374im    -0.0907858-0.145053im        0.103527-0.0960245im     0.0588148+0.227039im      0.0937842-0.0512353im    -0.0882201-0.056813im      0.0723576+0.0780605im     -0.161915+0.165459im     0.0667959+0.0259186im   -0.0542118+0.230394im     0.0216458+0.0265737im
   -0.147262+0.0281594im   -0.0760169-0.0314922im    -0.0802699-0.0599281im      -0.0788795+0.109161im      -0.137339-0.101833im     -0.0760502-0.128548im     0.0407616-0.0157311im    -0.011038-0.310002im       -0.0797963-0.0509184im      -0.110976-0.0864067im      -0.18037+0.187521im     -0.0304834+0.237642im      -0.152801-0.182624im     -0.231235+0.0941417im      0.0318544-0.055002im    -0.0969928+0.00383763im    -0.0379738-0.0189im       0.0483292+0.183972im         0.18249+0.0242287im     0.108428-0.138444im    -0.0364521+0.153537im    0.00566472+0.00668429im  -0.0218304+0.115662im        0.116658-0.199432im      -0.241253-0.026175im      -0.129721+0.0386236im      -0.20508-0.183807im     -0.0338636-0.15735im       -0.102692+0.291884im    -0.0561593+0.0384628im    0.0547276-0.00891531im  0.00735172+0.170584im
    0.128174+0.0177463im    -0.118756+0.188671im     -0.0154776+0.00429596im       0.152362+0.01994im       0.0919573+0.0331065im     -0.133448-0.190276im     -0.057666+0.150137im     0.0890133-0.1103im          -0.220487+0.124265im    -0.000597928+0.0779835im     -0.135457-0.139365im      -0.133219-0.0688285im      0.107101-0.101109im    -0.0937488-0.0107983im      0.0659701+0.272443im    0.00578028-0.0741187im     -0.0264506+0.236475im      0.115917-0.25654im       -0.0306966-0.215863im      0.178506-0.0450493im    -0.256715+0.204331im       0.18925+0.0366818im     0.125226-0.0210817im      0.0201799+0.120528im      0.0189041-0.113581im       0.119164-0.137627im      -0.163221+0.148154im      0.0440997+0.0705223im     0.0970196+0.0881656im   -0.0131748+0.104092im    -0.0314139-0.12447im       0.123706+0.00241644im
    0.123196-0.038781im      0.011412+0.117937im     -0.0705805+0.245184im        -0.115837+0.256401im       0.216547-0.192174im     -0.0787311+0.072297im      0.112119+0.0459289im    -0.161473-0.165988im      -0.00890097-0.109242im       0.0192566-0.120382im      0.0288371-0.116568im     -0.0485867-0.14922im       -0.169012+0.163209im     0.0265457-0.00171727im     -0.197484-0.073687im    -0.0910613-0.108813im       0.0134371-0.107771im     0.0392822+0.0790076im      0.0308725+0.0572347im     -0.12159-0.102854im    0.00565161+0.182774im    -0.0862325+0.0743412im     0.057536-0.122292im       0.0105989+0.0672409im      0.254232-0.152919im     -0.0360029-0.207958im     -0.0213621+0.18051im       -0.117828-0.0546886im      -0.17316+0.0686206im   -0.0410825-0.290978im     0.0105168-0.185585im    -0.0359976+0.131257im
   -0.185175-0.0502901im     -0.11236+0.0788628im    -0.0692113-0.0302613im      -0.0813902-0.04847im       0.0307365-0.243838im      0.0818645+0.010476im      0.114122-0.0489693im    0.0101474+0.0506375im       -0.289488-0.081716im       0.0550769+0.189573im      0.0295285-0.204028im        0.11501+0.196192im     -0.0278673+0.0750515im      0.10692+0.0286143im       0.287959-0.224047im     -0.242348+0.153127im     -0.00610593+0.237932im    -0.0882111+0.136877im        0.096029+0.0669564im     0.149071+0.0210467im   -0.0282826-0.0551369im    0.0563856+0.06427im     -0.0513694-0.267998im      -0.0619731+0.069178im      0.0643977+0.15431im        0.118034+0.0189374im   -0.00121274+0.0826784im    0.00336974-0.0465663im     0.0289798-0.170641im     -0.220266+0.0601392im   -0.0226126-0.103542im     0.0584504+0.157945im
  -0.0622767+0.110119im     -0.161397+0.00142151im     0.206564-0.00290877im     0.00564073-0.0407835im    -0.0664425+0.0144014im      0.338574+0.150488im    -0.0509484-0.100838im      0.132121-0.093748im       -0.0447422+0.0901929im     -0.0894383+0.016535im      -0.122442+0.133361im      0.0204871+0.0665297im    -0.0579928+0.0586315im   -0.0310964+0.0577077im      0.0440909-0.0122525im     0.205561-0.111184im        0.208678+0.096598im      0.179882+0.0341357im     0.00374846-0.0324059im    -0.140049+0.0920863im   -0.0772984+0.0848364im   -0.0599979-0.19673im       0.315126-0.32253im        -0.136063-0.038958im       0.183584-0.0329066im     -0.161893-0.169565im      0.0807483-0.130008im      0.0732835-0.0440494im       0.12045+0.0913439im   -0.0985663+0.0386039im    0.0477681-0.0679068im    -0.230208+0.000857208im</code></pre><p>and then generate the state <span>$ψ$</span></p><pre><code class="language-julia hljs">psi = P[:, 3]</code></pre><pre><code class="nohighlight hljs">32-element Vector{ComplexF64}:
  -0.09954562075982305 + 0.005841897220965716im
   0.11919566303668251 + 0.10502255994028392im
   -0.1266533142298491 - 0.04596842688518965im
  -0.05864927607042054 + 0.031832396051828644im
  0.022431736296432612 + 0.09287381980360294im
   0.26690266269377033 - 0.003592505662894014im
   0.06006884005564221 + 0.06994650915206653im
   0.09055856583883552 - 0.04617972382408331im
   -0.0776854221455346 - 0.05721742220025132im
   0.06452811565181175 - 0.0815801069146866im
 -0.012156476497369844 - 0.1257154919812893im
  -0.18075135636660408 + 0.12447513061556964im
  -0.06854065023288713 - 0.19602851338743674im
 -0.029765131325904606 + 0.13946123101943528im
   0.06650079699596084 + 0.05675936994549552im
    0.0654432528340014 + 0.03700620594728102im
   0.21614759761739655 - 0.21607620237095038im
   0.00788889476120031 + 0.15675529678873257im
  -0.05900219229853536 - 0.07426626215780772im
   0.35126094943193076 + 0.0im
   -0.2159572503233046 + 0.07942702468753174im
 -0.024939935459637266 - 0.23798474563692992im
   0.04397757033747124 + 0.12891582108663366im
    0.1466076026144836 - 0.07455513755710534im
 -0.033936423168202064 + 0.00030877453554837707im
  -0.27497316998348414 - 0.08860529303833792im
   0.05455712914332401 - 0.07908973435569228im
   0.27952565743251684 - 0.13595132420390163im
  -0.05987724824518789 + 0.10111303653244248im
  -0.02735232221042695 - 0.08534299627485141im
  -0.07267190375137116 + 0.17342791681490632im
  -0.06792211517788972 + 0.15325789817913066im</code></pre><p>In the phase estimation process, we will feed the state to circuit and measure the first <code>n</code> qubits processed by iQFT.</p><pre><code class="language-julia hljs">r = join(ArrayReg(psi), zero_state(N))
r |&gt; PE(N, M, U)</code></pre><pre><code class="nohighlight hljs">ArrayReg{1, ComplexF64, Array...}
    active qubits: 8/8</code></pre><p>Since our phase can be represented by 3 qubits precisely, we only need to measure once</p><pre><code class="language-julia hljs">results = measure(r, 1:N; nshots=1)</code></pre><pre><code class="nohighlight hljs">1-element Vector{BitBasis.BitStr64{3}}:
 011 ₍₂₎</code></pre><p>Recall that our QFT&#39;s bit numbering is reversed, let&#39;s reverse it back</p><pre><code class="language-julia hljs">using BitBasis
estimated_phase = bfloat(results[]; nbits=N)</code></pre><pre><code class="nohighlight hljs">0.75</code></pre><p>the phase is exactly <code>0.75</code>!</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../1.prepare-ghz-state/index.html">« Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a><a class="docs-footer-nextpage" href="../3.grover-search/index.html">Grover Search »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.10 on <span class="colophon-date" title="Wednesday 8 December 2021 22:36">Wednesday 8 December 2021</span>. Using Julia version 1.7.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
