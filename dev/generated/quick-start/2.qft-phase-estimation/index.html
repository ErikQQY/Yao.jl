<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quantum Fourier Transformation and Phase Estimation · Documentation | Yao</title><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/indigo.css" rel="stylesheet" type="text/css"/><link href="https://yaoquantum.org/assets/favicon-light.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../index.html"><img src="../../../assets/logo.png" alt="Documentation | Yao logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../index.html">Documentation | Yao</a></span></div><form class="docs-search" action="../../../search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../index.html">Home</a></li><li><span class="tocitem">Quick Start</span><ul><li><a class="tocitem" href="../1.prepare-ghz-state/index.html">Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a></li><li class="is-active"><a class="tocitem" href="index.html">Quantum Fourier Transformation and Phase Estimation</a><ul class="internal"><li><a class="tocitem" href="#Quantum-Fourier-Transformation"><span>Quantum Fourier Transformation</span></a></li><li><a class="tocitem" href="#Wrap-QFT-to-an-external-block"><span>Wrap QFT to an external block</span></a></li><li><a class="tocitem" href="#Phase-Estimation"><span>Phase Estimation</span></a></li></ul></li><li><a class="tocitem" href="../3.grover-search/index.html">Grover Search</a></li><li><a class="tocitem" href="../4.shor-algorithm/index.html">Shor&#39;s Algorithm</a></li><li><a class="tocitem" href="../5.shor-9-code/index.html">Shor&#39;s 9 qubit code</a></li><li><a class="tocitem" href="../6.quantum-circuit-born-machine/index.html">Quantum Circuit Born Machine</a></li><li><a class="tocitem" href="../7.variation-quantum-eigen-solver/index.html">Variational Quantum Eigen Solver</a></li></ul></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../../man/array_registers.html">Array Registers</a></li><li><a class="tocitem" href="../../../man/symbolic.html">Symbolic Computation</a></li><li><a class="tocitem" href="../../../man/blocks.html">Blocks</a></li><li><a class="tocitem" href="../../../man/automatic_differentiation.html">Automatic Differentiation</a></li><li><a class="tocitem" href="../../../man/simplification.html">Simplification</a></li><li><a class="tocitem" href="../../../man/base.html">Base</a></li><li><a class="tocitem" href="../../../man/registers.html">Abstract Registers</a></li><li><a class="tocitem" href="../../../man/bitbasis.html">BitBasis</a></li><li><a class="tocitem" href="../../../man/extending_blocks.html">Extending Blocks</a></li></ul></li><li><a class="tocitem" href="../../../benchmarks.html">Benchmark</a></li><li><a class="tocitem" href="../../../dev/index.html">Developer Notes</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Quick Start</a></li><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/QuantumBFS/Yao.jl/blob/master/docs/src/quick-start/2.qft-phase-estimation/main.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><p><a href="https://mybinder.org/v2/gh/QuantumBFS/Yao.jl/gh-pages?filepath=dev/generated/quick-start/2.qft-phase-estimation/main.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a> <a href="https://nbviewer.jupyter.org/github/QuantumBFS/Yao.jl/blob/gh-pages/dev/generated/quick-start/2.qft-phase-estimation/main.ipynb"><img src="https://img.shields.io/badge/show-nbviewer-579ACA.svg" alt/></a> <a href="https://minhaskamal.github.io/DownGit/#/home?url=https://github.com/QuantumBFS/tutorials/tree/gh-pages/dev/generated/quick-start/2.qft-phase-estimation"><img src="https://img.shields.io/badge/download-project-orange" alt/></a></p><h1 id="example-qft"><a class="docs-heading-anchor" href="#example-qft">Quantum Fourier Transformation and Phase Estimation</a><a id="example-qft-1"></a><a class="docs-heading-anchor-permalink" href="#example-qft" title="Permalink"></a></h1><p>Let&#39;s use Yao first</p><pre><code class="language-julia hljs">using Yao</code></pre><h2 id="Quantum-Fourier-Transformation"><a class="docs-heading-anchor" href="#Quantum-Fourier-Transformation">Quantum Fourier Transformation</a><a id="Quantum-Fourier-Transformation-1"></a><a class="docs-heading-anchor-permalink" href="#Quantum-Fourier-Transformation" title="Permalink"></a></h2><p>The Quantum Fourier Transformation (QFT) circuit is to repeat two kinds of blocks repeatly:</p><p><img src="assets/qft.png" alt="qft-circuit"/></p><p>The basic building block control phase shift gate is defined as</p><p class="math-container">\[R(k)=\begin{bmatrix}
1 &amp; 0\\
0 &amp; \exp\left(\frac{2\pi i}{2^k}\right)
\end{bmatrix}\]</p><p>Let&#39;s define block <code>A</code> and block <code>B</code>, block <code>A</code> is actually a control block.</p><pre><code class="language-julia hljs">A(i, j) = control(i, j=&gt;shift(2π/(1&lt;&lt;(i-j+1))))</code></pre><pre><code class="nohighlight hljs">A (generic function with 1 method)</code></pre><p>Once you construct the blockl you can inspect its matrix using <code>mat</code> function. Let&#39;s construct the circuit in dash box A, and see the matrix of <span>$R_4$</span> gate.</p><pre><code class="language-julia hljs">R4 = A(4, 1)</code></pre><pre><code class="nohighlight hljs">(n -&gt; control(n, 4, 1 =&gt; shift(0.39269908169872414)))</code></pre><p>If you have read about <a href="generated/quick-start/2.qft-phase-estimation/@ref example-ghz">preparing GHZ state</a>, you probably know that in Yao, we could just leave the number of qubits, and it will be evaluated when possible.</p><pre><code class="language-julia hljs">R4(5)</code></pre><pre><code class="nohighlight hljs">nqubits: 5
control(4)
└─ (1,) shift(0.39269908169872414)</code></pre><p>its matrix will be</p><pre><code class="language-julia hljs">mat(R4(5))</code></pre><pre><code class="nohighlight hljs">32×32 LinearAlgebra.Diagonal{ComplexF64, Vector{ComplexF64}}:
 1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im</code></pre><p>Then we repeat this control block over and over on different qubits, and put a Hadamard gate to <code>i</code>th qubit to construct <code>i</code>-th <code>B</code> block.</p><pre><code class="language-julia hljs">B(n, k) = chain(n, j==k ? put(k=&gt;H) : A(j, k) for j in k:n)</code></pre><pre><code class="nohighlight hljs">B (generic function with 1 method)</code></pre><p>We need to input the total number of qubits <code>n</code> here because we have to iterate through from <code>k</code>-th location to the last.</p><p>Now, let&#39;s construct the circuit by chaining all the <code>B</code> blocks together</p><pre><code class="language-julia hljs">qft(n) = chain(B(n, k) for k in 1:n)
qft(4)</code></pre><pre><code class="nohighlight hljs">nqubits: 4
chain
├─ chain
│  ├─ put on (1)
│  │  └─ H
│  ├─ control(2)
│  │  └─ (1,) shift(1.5707963267948966)
│  ├─ control(3)
│  │  └─ (1,) shift(0.7853981633974483)
│  └─ control(4)
│     └─ (1,) shift(0.39269908169872414)
├─ chain
│  ├─ put on (2)
│  │  └─ H
│  ├─ control(3)
│  │  └─ (2,) shift(1.5707963267948966)
│  └─ control(4)
│     └─ (2,) shift(0.7853981633974483)
├─ chain
│  ├─ put on (3)
│  │  └─ H
│  └─ control(4)
│     └─ (3,) shift(1.5707963267948966)
└─ chain
   └─ put on (4)
      └─ H
</code></pre><h2 id="Wrap-QFT-to-an-external-block"><a class="docs-heading-anchor" href="#Wrap-QFT-to-an-external-block">Wrap QFT to an external block</a><a id="Wrap-QFT-to-an-external-block-1"></a><a class="docs-heading-anchor-permalink" href="#Wrap-QFT-to-an-external-block" title="Permalink"></a></h2><p>In most cases, <code>function</code>s are enough to wrap quantum circuits, like <code>A</code> and <code>B</code> we defined above, but sometimes, we need to dispatch specialized methods on certain kinds of quantum circuit, or we want to define an external block to export, thus, it&#39;s useful to be able to wrap circuit to custom blocks.</p><p>First, we define a new type as subtype of <code>PrimitiveBlock</code> since we are not going to use the subblocks of <code>QFT</code>, if you need to use its subblocks, it&#39;d be better to define it under <code>CompositeBlock</code>.</p><pre><code class="language-julia hljs">struct QFT &lt;: PrimitiveBlock{2}
    n::Int
end

YaoBlocks.nqudits(q::QFT) = q.n</code></pre><p>Now, let&#39;s define its circuit</p><pre><code class="language-julia hljs">circuit(q::QFT) = qft(q.n)</code></pre><pre><code class="nohighlight hljs">circuit (generic function with 1 method)</code></pre><p>And forward <code>mat</code> to its circuit&#39;s matrix</p><pre><code class="language-julia hljs">YaoBlocks.mat(::Type{T}, x::QFT) where T = mat(T, circuit(x))</code></pre><p>You may notice, it is a little ugly to print <code>QFT</code> at the moment, this is because we print the type summary by default, you can define your own printing by overloading <code>print_block</code></p><pre><code class="language-julia hljs">YaoBlocks.print_block(io::IO, x::QFT) = print(io, &quot;QFT($(x.n))&quot;)</code></pre><p>Since it is possible to use FFT to simulate the results of QFT (like cheating), we could define our custom <code>apply!</code> method:</p><pre><code class="language-julia hljs">using FFTW, LinearAlgebra

function YaoBlocks.apply!(r::ArrayReg, x::QFT)
    α = sqrt(length(statevec(r)))
    invorder!(r)
    lmul!(α, ifft!(statevec(r)))
    return r
end</code></pre><p>Now let&#39;s check if our <code>apply!</code> method is correct:</p><pre><code class="language-julia hljs">r = rand_state(5)
r1 = r |&gt; copy |&gt; QFT(5)
r2 = r |&gt; copy |&gt; circuit(QFT(5))
r1 ≈ r2</code></pre><pre><code class="nohighlight hljs">true</code></pre><p>We can get iQFT (inverse QFT) directly by calling <code>adjoint</code></p><pre><code class="language-julia hljs">QFT(5)&#39;</code></pre><pre><code class="nohighlight hljs"> [†]QFT(5)</code></pre><p>QFT and iQFT are different from FFT and IFFT in three ways,</p><ol><li>they are different by a factor of <span>$\sqrt{2^n}$</span> with <span>$n$</span> the number of qubits.</li><li>the <a href="https://quantumbfs.github.io/BitBasis.jl/stable/tutorial/#Conventions-1">bit numbering</a> will exchange after applying QFT or iQFT.</li><li>due to the convention, QFT is more related to IFFT rather than FFT.</li></ol><h2 id="Phase-Estimation"><a class="docs-heading-anchor" href="#Phase-Estimation">Phase Estimation</a><a id="Phase-Estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Phase-Estimation" title="Permalink"></a></h2><p>Since we have QFT and iQFT blocks we can then use them to realize phase estimation circuit, what we want to realize is the following circuit:</p><p><img src="assets/phaseest.png" alt="phase estimation"/></p><p>First we call Hadamard gates repeatly on first <code>n</code> qubits.</p><pre><code class="language-julia hljs">Hadamards(n) = repeat(H, 1:n)</code></pre><pre><code class="nohighlight hljs">Hadamards (generic function with 1 method)</code></pre><p>Then in dashed box <code>B</code>, we have controlled unitaries:</p><pre><code class="language-julia hljs">ControlU(n, m, U) = chain(n+m, control(k, n+1:n+m=&gt;matblock(U^(2^(k-1)))) for k in 1:n)</code></pre><pre><code class="nohighlight hljs">ControlU (generic function with 1 method)</code></pre><p>each of them is a <code>U</code> of power <span>$2^{(k-1)}$</span>.</p><p>Since we will only apply the qft and Hadamard on first <code>n</code> qubits, we could use <code>Subroutine</code>, which creates a context of a sub-scope of the qubits.</p><pre><code class="language-julia hljs">PE(n, m, U) =
    chain(n+m, # total number of the qubits
        subroutine(Hadamards(n), 1:n), # apply H in local scope
        ControlU(n, m, U),
        subroutine(QFT(n)&#39;, 1:n))</code></pre><pre><code class="nohighlight hljs">PE (generic function with 1 method)</code></pre><p>we use the first <code>n</code> qubits as the output space to store phase <span>$ϕ$</span>, and the other <code>m</code> qubits as the input state which corresponds to an eigenvector of oracle matrix <code>U</code>.</p><p>The subroutine here uses <code>focus!</code> and <code>relax!</code> to manage a local scope of quantum circuit, and only activate the first <code>n</code> qubits while applying the block inside the subroutine context, and the scope will be <code>relax!</code>ed back, after the context. This is equivalent to manually <code>focus!</code> then <code>relax!</code></p><p>fullly activated</p><pre><code class="language-julia hljs">r = rand_state(5)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>first 3 qubits activated</p><pre><code class="language-julia hljs">focus!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 3/5
    nlevel: 2</code></pre><p>relax back to the original</p><pre><code class="language-julia hljs">relax!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>In this way, we will be able to apply small operator directly on the subset of the qubits.</p><p>Details about the algorithm can be found here: <a href="https://en.wikipedia.org/wiki/Quantum_phase_estimation_algorithm">Quantum Phase Estimation Algorithm</a></p><p>Now let&#39;s check the results of our phase estimation.</p><p>First we need to set up a unitary with known phase, we set the phase to be 0.75, which is <code>0.75 * 2^3 == 6 == 0b110</code> .</p><pre><code class="language-julia hljs">N, M = 3, 5
P = eigen(rand_unitary(1&lt;&lt;M)).vectors
θ = Int(0b110) / 1&lt;&lt;N
phases = rand(1&lt;&lt;M)
phases[0b010+1] = θ
U = P * Diagonal(exp.(2π * im * phases)) * P&#39;</code></pre><pre><code class="nohighlight hljs">32×32 Matrix{ComplexF64}:
 -0.0947004+0.204938im       0.304871-0.0487776im      0.283324-0.0740289im    0.0590008+0.165511im     -0.176614+0.00694912im   0.0216952-0.12912im       0.197079+0.00326722im   -0.100381-0.160709im      -0.199455-0.0222322im      0.0398846-0.0491857im     0.125825-0.0622566im     0.0105668-0.00666334im     0.205837+0.0660492im     0.168714-0.0558961im     -0.14457-0.0201945im    -0.197652-0.141589im       -0.190727-0.00259583im    -0.157864-0.0401223im    0.0665443-0.0449028im      -0.11486-0.0329846im      0.051253+0.138734im      0.0439685+0.107881im     0.192143-0.1201im         -0.119274-0.0697502im    0.0853581-0.123619im       0.156185+0.0105381im  -0.000511961-0.137315im    -0.155909-0.110926im     0.0203453-0.00622909im    0.0346654+0.116723im       0.0297512+0.107455im       -0.262627+0.0480088im
 0.00110539-0.0732353im     -0.066848+0.00638381im    0.0631269+0.100384im      0.254135+0.0474118im     0.286138+0.117233im     -0.133951+0.129097im     0.0757932-0.0824303im   -0.0487893+0.0655296im    0.00306989-0.024685im      -0.0364701+0.183231im     -0.122335+0.0741086im    -0.0139974-0.36696im      -0.0351892+0.106797im    -0.0849201+0.157324im     0.0598577-0.0439364im  -0.00969046+0.13767im         0.276735+0.00293245im    -0.119646-0.226314im      0.169092+0.134274im      0.0912003+0.0425745im      0.141629+0.236647im     -0.0284783-0.0347617im   0.0890207-0.0497321im      -0.278485+0.0704643im    0.0542361+0.0768584im     0.0728836+0.0869439im     0.0949279-0.120617im   -0.0958525-0.0241227im    -0.113534-0.0980853im      0.132137-0.060916im      -0.0200128+0.0186236im      -0.174444+0.00256484im
  0.0677636-0.0999846im      0.228137-0.23739im       0.0688365+0.200247im      0.203637-0.0758929im    0.0897527+0.146884im      0.202782-0.00333928im   0.0943184+0.105665im      0.138717+0.0275411im   -0.00819734-0.113217im        0.105451+0.14413im      -0.258375+0.122824im      -0.156796+0.0376419im     0.0671509-0.156434im    -0.0497658-0.135616im    -0.0720507+0.11189im     -0.0605698-0.0521816im      0.0886778-0.12406im      -0.0417446+0.164595im     -0.156737+0.0629643im     -0.164994+0.0343944im     0.0347592-0.107354im       0.018127+0.0565938im    0.213894+0.324966im       0.0199326-0.0608924im     0.012183+0.0355046im    -0.0310446-0.224222im      0.0520055+0.211595im   -0.0726553+0.101614im     0.0671578-0.00327843im     0.133588-0.0404894im     -0.0826413-0.0165648im      -0.090352-0.108603im
    0.15734+0.100242im      0.0983193+0.0859039im     0.0328784-0.217632im      0.213675+0.135812im    -0.0638107-0.0451348im    -0.115998+0.0323232im    0.0557661+0.132628im     0.0597503-0.00441775im    0.0357851-0.252704im        0.165833-0.0699981im    -0.185073+0.0715339im     0.0210719-0.00563243im    -0.176629+0.0463631im    0.0849043-0.0596101im     0.150827+0.023608im   -0.00976918+0.116306im       -0.170768-0.0671159im     -0.178823+0.0982795im      0.30316+0.20385im       -0.118611+0.0772696im    -0.0333406+0.147174im      -0.190494+0.0128583im   -0.180767-0.00925079im    -0.0179756-0.154706im    -0.0174285+0.0457935im     -0.257363-0.156415im     -0.0125452+0.0513873im   0.0943786-0.176667im      0.023236+0.152937im      -0.105152-0.120095im      -0.0710498-0.0451343im       0.120538+0.142095im
  -0.214032-0.0821482im      0.192805+0.0102334im     0.0114412-0.177537im    -0.0355444+0.173346im      0.117681+0.0863927im    0.0902739+0.0574623im      0.12995+0.0335013im    0.0623602+0.0206375im     0.0631041+0.021205im        0.052695+0.189031im    -0.0985565-0.125441im       0.149781-0.0109538im   -0.00426437-0.014745im     -0.175197+0.168119im      0.122714+0.0727274im    -0.148214+0.0696828im     -0.0989084-0.196958im    -0.00692333+0.339943im    -0.0184405-0.0621039im      0.281595-0.0431545im    -0.0941981+0.0576301im       0.18816+0.246467im    0.0320909-0.118774im       0.0580597-0.0555941im     0.139389+0.110774im     -0.0106514+0.222458im      -0.245073-0.080113im   -0.0295188+0.106791im    -0.0344692+0.00333407im    0.0325845-0.076632im      -0.0164759-0.141198im        0.151854-0.0621625im
  0.0646231+0.34898im        0.291823-0.0791496im    -0.0544196+0.264144im     0.0158085-0.0739552im    0.0525869+0.0782292im     0.177161+0.194879im     0.0818845-0.122767im    -0.0596623-0.101353im       0.204299+0.136236im        -0.10384-0.227636im      0.080131-0.082037im     -0.0779666+0.0136605im     -0.157824+0.183154im     -0.015227+0.02288im     -0.0329931-0.155085im     -0.147437-0.0640059im       0.147859+0.014503im      0.0161506-0.00854579im   -0.109328-0.0335633im     0.0259658-0.0451085im   -0.00453237+0.00530845im   -0.0290824-0.0201624im    0.151072-0.0913062im     -0.0472581-0.021658im     -0.101773+0.127145im      -0.262428+0.0947789im     -0.103027+0.0439047im    0.220993-0.021708im     -0.101967+0.100406im    -0.00417406-0.186838im       -0.059889+0.0236394im      0.0334916+0.193768im
   0.136941-0.0859905im     -0.121078-0.104388im     -0.0314766-0.0187931im   -0.0232577+0.28757im      0.0796821-0.0277237im    -0.146597+0.0921349im     0.126454+0.151326im      0.045234-0.126513im     -0.0553204-0.000667721im     0.147964+0.173375im      0.263556-0.000533336im   0.0281341+0.0550934im    -0.0928002+0.0102608im    0.0222069+0.223124im     -0.150437+0.0144239im    -0.116123-0.0706197im      0.0905024+0.153585im     -0.0287025+0.130976im      -0.14256-0.0636184im     -0.175894-0.178749im       -0.00694+0.0757878im     -0.183181-0.06858im    -0.0757124+0.0473306im      0.0350492+0.305554im      0.181017+0.101274im      -0.223653+0.08475im      -0.0744906+0.186725im   -0.0788902+0.143919im       0.14381-0.045353im      -0.140047+0.00888043im    -0.0172962+0.0584387im      -0.158612+0.136213im
  0.0724062+0.0812156im      0.156478-0.110132im      0.0503685+0.0570961im  -0.00342092+0.00125856im   0.0705697+0.0518691im     0.068739+0.0906229im   -0.0525192+0.0453505im    0.0787332+0.222421im    -0.00188161-0.24047im        0.0971957+0.0624962im     0.112408+0.0473813im    -0.0329858+0.0247976im     0.0233562+0.0674832im      0.12487+0.137817im     0.0973223-0.0333718im     0.173374-0.0565601im     -0.0324678+0.251413im     -0.0824615+0.0169818im   -0.0855569+0.0742538im      0.233495+0.0083504im     -0.170975-0.0581442im     -0.278288-0.0167113im   0.0794361-0.160058im      -0.0577847-0.156833im     -0.134813-0.351822im      0.0924955+0.130523im      0.0922512+0.0094266im  -0.0615599+0.244851im      0.240443-0.119134im      0.0725989-0.00676395im      0.130527-0.158253im        0.109533+0.114403im
   0.082455+0.0108064im   0.000552497-0.0987939im    -0.0202193+0.0711182im   -0.0353845+0.187303im    -0.0063498-0.0143874im   -0.0261381-0.0289223im    -0.147521+0.159318im    -0.0759702+0.212588im     -0.0665838+0.126972im       0.0742677-0.0632507im    0.0384454-0.249996im     -0.0134105+0.157998im      -0.210692+0.192248im     0.0866336-0.0104782im     0.077527-0.0558056im     0.333845+0.0480013im      0.0740689-0.14668im       0.0824997+0.16177im     -0.0910896+0.0102723im    -0.0300025+0.0422689im      0.209313+0.131615im        0.19255+0.0495043im    0.227937-0.100905im       -0.129447+0.130104im     0.0979097-0.111948im      -0.130087-0.192231im      0.0795962-0.0395164im  -0.0648877-0.193931im     0.0332625+0.0140233im     0.0139153+0.0628224im       0.056468-0.302914im      -0.0745042-0.10682im
 0.00318498+0.133474im    -3.16229e-5-0.109013im      -0.166857+0.0658137im    -0.136712+0.0416644im    0.0793172+0.193875im     -0.125435-0.0224338im    0.0410726+0.0651901im   -0.0204306-0.12041im        0.127325-0.146769im        0.101575+0.068439im      0.247039-0.220929im      -0.094145-0.00931751im   -0.0400249-0.0579548im    0.0830447-0.0144469im     0.134259-0.242558im    -0.0844416-0.0343535im     -0.0187538-0.205518im     -0.0338858+0.00813591im    0.234086+0.253872im       0.141472+0.17856im      0.00159064-0.260088im        0.25948+0.107137im    -0.141479+0.150503im       0.0127625+0.158438im     -0.149171-0.0444686im       0.10316+0.0323236im       0.11392+0.132702im    -0.138616-0.056313im     0.0940749-0.0682283im   -0.00034531-0.0403775im   -0.000217892+0.174568im      -0.0549582+0.0329734im
  0.0276646+0.137161im     -0.0189866-0.188542im      -0.119797+0.0529046im    0.0503562+0.0555962im    -0.113182-0.181889im     -0.179549-0.0676966im   0.00448001-0.0936464im    -0.109398-0.190751im     -0.0303489+0.0430135im      -0.195143+0.275261im     0.0442915+0.126336im       0.170645+0.0251999im      -0.11744+0.199779im      0.161069-0.0305364im     0.152123+0.153852im       0.07083-0.117267im       0.0188847-0.209943im      0.0260696+0.26832im      0.0834954-0.0788069im     0.0628257-0.059885im      0.0711441-0.130404im      -0.241519-0.193637im      0.10324+0.0637209im      0.0319937-0.0684081im   -0.0434176+0.136055im       0.175405-0.0132973im    0.00909834-0.0176665im  0.00617582-0.0477563im   -0.0476772-0.127903im       0.310805+0.0354839im     -0.0716707+0.036331im         0.12571+0.0497673im
 -0.0783167-0.160317im      0.0826875-0.0317686im     -0.198544+0.106256im    -0.0570929-0.141906im     0.0375316+0.200119im    -0.0281428+0.0734069im     0.120599-0.00746433im    0.260546-0.0398167im    -0.0733476+0.067262im      -0.0100622+0.0737647im    0.0629461-0.0747813im     0.0952347+0.242265im      -0.102212-0.0393435im     0.343713-0.0200213im    -0.141012+0.0383645im   -0.0365825+0.128808im       -0.050901-0.0249644im     0.0526473-0.181775im     0.0629887+0.0404828im    -0.0039017+0.0336423im      0.122853-0.107005im      -0.117303-0.045194im   -0.0585629-0.236111im       -0.125522-0.263583im      0.181743+0.249542im       0.116806-0.0696479im     0.0303087+0.0678236im   -0.203648+0.0617221im    -0.173617+0.0895315im     -0.148209-0.0332053im      0.0807041-0.158242im      -0.0050163+0.0445194im
  0.0635238+0.0495238im     0.0166873-0.0428146im      -0.29395+0.225011im     0.0535735-0.284018im     -0.103964+0.0449105im    0.0514861-0.192086im     -0.119624+0.0613323im   -0.0738692+0.130997im      -0.221054-0.12879im         0.119639-0.0340111im    0.0504515-0.096669im       0.106784-0.151132im      -0.150463+0.0842302im    -0.214991-0.0110148im   -0.0438049+0.123022im    -0.0714683+0.0136645im      -0.282994-0.177538im      -0.200501+0.00983064im   -0.106509+0.142284im      -0.106904-0.00575024im   -0.0477189+0.0635836im    -0.0962906-0.0404013im  -0.0527421+0.0413247im   -0.000124339+0.133758im    -0.0484283+0.0320973im     0.0773465+0.198712im      -0.152304-0.132449im     0.030302+0.0954135im    -0.131184-0.0953535im      -0.12154+0.0901025im     -0.0644488-0.167644im       -0.181842+0.0600419im
  0.0167423-0.195586im       0.132995-0.183018im       -0.11942-0.0462778im    -0.159979+0.188574im      0.114665-0.0981828im     0.136952+0.0684868im     -0.14315-0.0336243im   -0.0383722+0.239934im      0.0761406+0.234463im            0.26+0.055302im    -0.0200317+0.13804im       0.0227756+0.166692im     -0.0155041-0.0325487im   -0.0190203-0.00569474im   -0.074394-0.147726im     -0.178887+0.0221574im      -0.096186-0.0175762im   -0.00193608-0.156666im      0.106654-0.177817im     -0.0964058+0.169348im     -0.0360994-0.0216335im    -0.0593226-0.0349212im   -0.133178+0.112208im      -0.0640804-0.0939571im    0.0350999-0.0379749im     0.0971337+0.115506im      0.0308522-0.0922876im    0.176902-0.249356im     0.0468705-0.16852im        0.206085-0.00700103im     -0.220926-0.0531463im     -0.0993536+0.192972im
  -0.020391-0.0141421im     0.0273123-0.0278291im      0.125775-0.233092im      0.178005-0.0931098im   0.00110725+0.178005im    -0.0691252-0.202649im    -0.0351153+0.109383im      0.145499+0.208825im     -0.0748716+0.0910909im      -0.101034+0.00251111im    0.277017-0.106501im        0.12246-0.110628im     -0.0572829+0.111817im     0.0602143-0.113272im     -0.170941+0.0188337im   -0.0821792+0.0412683im    -0.00455874-0.0487404im     0.0107611-0.119701im        0.1521-0.0999078im      0.213868-0.0930576im     0.0387153-0.0354434im    -0.0400772-0.0844901im   0.0774913+0.22383im         0.101835+0.0788125im     0.118619-0.0672449im     0.0147881+0.0740013im     0.0936255+0.165698im     0.332339+0.0724467im    0.0819991+0.276017im       0.143401-0.188599im      -0.0180273-0.105894im      -0.0487289-0.0666257im
 0.00569913-0.123685im       0.098749-0.0124127im      0.101716-0.025959im      0.100079+0.0643211im     0.355253+0.150642im      0.111501-0.145843im    -0.0726802+0.155864im     0.0287113-0.132684im      0.0612521+0.176192im       -0.137993+0.061084im     0.0775418+0.107034im     -0.0221671-0.101943im      -0.101655+0.0294306im    0.0928135-0.214734im      0.244521-0.11479im     -0.0260908-0.00287001im    -0.0910933-0.156339im       0.202749-0.0743603im   -0.0227834-0.12564im      -0.0341411+0.06447im      -0.0623491+0.172614im      -0.187081-0.0662363im   0.0337378+0.0482596im       0.132044+0.0605401im    -0.175499-0.14608im       0.0716495-0.0771207im     -0.249879-0.0108145im  -0.0647986-0.0205335im   -0.0566934-0.074244im      -0.298965+0.144544im        0.190021+0.0343075im      0.0154394+0.0890007im
 -0.0484157+0.0992126im    -0.0168529+0.250425im      0.0861518+0.142075im      0.116644+0.0614407im    0.0958468-0.0323582im     0.193618+0.0788298im     0.014533+0.219045im    -0.0430519-0.0677108im     -0.124943-0.11455im        -0.214462+0.157984im     0.0179127+0.077217im      0.0927809+0.0302113im     -0.071786-0.124922im      0.124682-0.045273im     0.0952924+0.0129916im   -0.0298502+0.276357im       -0.273337+0.209147im    -0.00547136+0.00723731im    -0.11815-0.140211im     -0.0993479+0.103676im       0.141929-0.177494im      0.0846913+0.109537im   -0.0310973-0.158256im       0.0101632+0.255244im     -0.167411+0.16893im       0.0457701+0.0620734im      0.150445+0.0235434im    0.157819-0.0987936im     0.107289-0.0924905im       0.13312-0.14916im       -0.0192359-0.100554im      -0.0710499-0.0106737im
 -0.0823757+0.0425891im     -0.276252-0.0670153im    -0.0162201+0.0578864im   -0.0292422-0.119506im      0.211649+0.0144846im    0.0593283+0.0427133im     0.104554-0.069632im     -0.192044+0.0793045im    -0.0858632-0.0937711im      -0.174267-0.0647736im    0.0659988+0.115081im       0.227569-0.106507im      0.0297739-0.0636633im     0.152171+0.111002im      -0.08034-0.0362144im    0.0752887-0.14312im         0.101382-0.0390916im    -0.0966277+0.0686359im    0.0630274-0.0837947im     -0.109175-0.0276951im     -0.194974+0.0047079im     0.0927133+0.198386im   -0.0866218+0.0466334im        0.20932-0.21731im      -0.026032-0.113498im     -0.0765331-0.0692107im     -0.189981+0.147297im    -0.158116-0.242288im    0.00552595+0.0866446im     0.0889298-0.137133im       0.0273954-0.274084im       -0.216612+0.133275im
 -0.0790242+0.221285im      -0.150945+0.125671im     -0.0372967+0.115371im      0.137157+0.0750463im     0.204908+0.245787im      0.189096-0.221931im     -0.101591-0.16211im      0.0122583-0.0363792im    -0.0227704+0.110687im        0.155625+0.103738im      0.168863-0.0804912im    -0.0528595+0.131242im       0.272763+0.0419351im   -0.0846851+0.103077im    -0.0362965+0.111791im     0.0589061-0.125761im      -0.0774638+0.0916073im      -0.17842+0.0500469im     0.156592-0.0237667im   -0.00537318+0.126557im       0.197219+0.0760409im    -0.0549637-0.170148im   -0.0705652-0.0400486im       0.101875-0.149003im     0.0608304+0.0512939im     -0.199192-0.0791462im     -0.036619+0.0576491im   0.0668072-0.0686054im    0.0209411-0.257839im     -0.0286168-0.0356101im    -0.00238991-0.00618641im      0.153733-0.217479im
 -0.0656307-0.0477775im     0.0750396+0.170396im    -0.00736248-0.100869im     -0.177193+0.0790706im    0.0519646+0.141105im    -0.0299882-0.12669im     -0.0378013-0.313963im     0.0587504+0.145134im      -0.102905-0.291311im        0.182486-0.00186097im    -0.13736-0.0670409im      0.163421-0.0342715im    -0.0439223+0.138369im     0.0444097-0.122346im     -0.112832-0.0138333im     0.197021+0.082768im        0.117191-0.0636614im      0.080651+0.0206133im   -0.0620904-0.160715im       0.030806+0.0951653im     0.0339288-0.0757157im     -0.130167+0.0814429im    0.113874-0.167981im     -0.00554104+0.0745729im     -0.18394+0.118873im     -0.0394796-0.0340207im     -0.209794+0.260195im    0.0943393-0.0188611im     0.023399-0.040679im      0.0505909+0.0841232im     -0.0557389+0.312848im         -0.2055+0.0428821im
    0.14075-0.0338052im     0.0573946+0.11206im      0.00904625+0.0716113im     0.117408-0.315213im      -0.06851-0.114801im    -0.0553024+0.163686im      -0.18287+0.220861im     0.0324876-0.179027im       0.120689+0.108444im       0.0832875+0.0349727im     0.002156+0.0427488im      0.263468-0.0568671im     0.0103045-0.0082015im    0.0170715+0.0196683im    -0.241216-0.0936065im    -0.053603-0.0341332im      0.0805375-0.0511298im    -0.0504346+0.109674im      0.093608+0.00983514im    0.0994387+0.235443im      -0.135705+0.175276im       0.174685-0.0764471im   0.0594778-0.237311im      -0.0286067+0.00368794im    0.120084-0.00650542im     0.133017-0.167518im      -0.153786+0.175575im     0.125356+0.00677729im    0.284868-0.173837im      0.0236414+0.0902233im      0.0309436+0.0699687im     0.00178027-0.0238487im
   0.167231-0.042948im     -0.0156556-0.051065im      -0.119181-0.0857696im    -0.124673+0.157171im     0.0857637-0.0105897im   -0.0332575-0.133334im     0.0553864+0.201568im     -0.109243-0.278834im      -0.044949-0.00690482im   -0.00590669-0.0680986im   -0.0702332-0.0430021im     -0.194635-0.161827im     -0.0547302+0.0885036im    0.0437741+0.0922259im    -0.233746+0.0110128im     0.197074-0.0207898im    -0.00653364-0.0761935im    -0.0107875-0.0411186im   -0.0774496-0.147522im      -0.155371+0.39803im      -0.0123118+0.000385365im  -0.0239145+0.0178022im  -0.0581028-0.0694398im     0.00917607-0.169356im    -0.0411184-0.0713255im     0.0747059+0.11376im      -0.0617694-0.111046im    0.0573096+0.267356im    -0.0617663+0.1211im         0.118128-0.32674im       -0.0115294+0.0200676im     0.00948913-0.202258im
  0.0822887+0.00131602im    -0.111579-0.104717im      0.0931791-0.184818im     0.0486986+0.00878405im  -0.0644691-0.0328757im     0.169346+0.268069im     0.0676696+0.085513im     0.0192538-0.0475543im     -0.156379+0.0853551im      -0.113037-0.0475im       0.0747504-0.260592im     -0.0558123-0.0289364im      0.115911-0.263075im     0.0163912-0.00792877im    0.186858-0.0281826im     0.344984+0.0272655im      -0.143052-0.119594im      -0.136519-0.169235im    -0.0426124+0.0575253im     0.0387758+0.0320667im     -0.162562-0.065668im     -0.0597754-0.14803im        0.1289+0.0786859im      -0.205636-0.054357im       0.11702+0.0898589im    -0.0636772+0.141223im      -0.226098+0.231282im    0.0786961-0.0478349im    -0.128582-0.132351im      0.0733976+0.0812043im      -0.116324+0.0893409im     -0.0271351+0.0210787im
 -0.0194466-0.0134588im     -0.030004-0.0329345im     -0.170057+0.0569377im   -0.0727696+0.149386im    -0.0643839-0.0348911im    -0.103627-0.0512126im    0.0110738+0.0532158im    0.0404659-0.0122893im     -0.177301-0.286307im      -0.0669925+0.0122949im   -0.0354502+0.0867423im     -0.113988-0.0699309im      0.106956-0.0581443im    -0.022973-0.192557im      0.153771-0.136267im     -0.279583-0.043394im        0.237822+0.077397im      -0.124867-0.0478177im     0.014417-0.143312im      0.0418247+0.159692im     -0.0251046-0.111719im      0.0674386-0.164026im     0.207891-0.21191im         0.110527+0.0946265im     0.262007-0.190142im     0.00288004-0.0107276im    -0.0634184+0.134109im     0.130816-0.0758028im    -0.232691-0.0384084im     -0.125595+0.0398778im      -0.133347-0.216088im        0.158736-0.00911992im
  0.0246547+0.0421995im    -0.0712171+0.209512im     -0.0223509-0.181794im    -0.0640994-0.036175im      0.270075+0.198117im     0.0280292+0.057934im     -0.041326+0.213681im     -0.329715-0.0507347im    -0.0385546-0.0593874im       0.157785-0.317309im     0.0559791+0.144967im     -0.0505899+0.160808im     -0.0326206+0.0547133im   -0.0370983-0.207138im     0.0156071+0.0817794im   -0.0475705-0.0315568im      0.0822858+0.00103161im  0.000150131-0.00391146im   -0.109384+0.154396im      0.0578216-0.199242im       0.072666+0.0108643im    -0.0531985-0.0965328im    0.103131-0.0293146im     0.00171736-0.00973434im    0.101395+0.152301im       0.263876+0.0635779im    -0.0605163+0.0205277im   -0.193536-0.0177381im     0.136889+0.0442654im      0.140858-0.0239454im      -0.263419-0.0153967im       0.134664+0.0187361im
  -0.112539+0.160786im       0.118075+0.0827134im     -0.072989-0.0882229im   0.00213577-0.169049im      0.039077-0.037527im      -0.10044-0.0498099im    0.0363285+0.00605212im  0.00449537-0.00127525im   -0.0179619+0.0504864im     -0.0305035+0.0666125im   -0.0915326-0.0115438im     -0.153366+0.279093im       0.187255+0.240654im      0.117385+0.075462im    -0.0155825+0.196294im    -0.0587266+0.15355im        0.0349366-0.00904828im     0.140118-0.120417im     0.0507778-0.00643718im   -0.0565083+0.128928im      -0.462918+0.159214im     -0.0447101+0.0101053im  -0.0421749+0.0819778im     -0.0994757+0.351435im    -0.0470219-0.0627177im    -0.0843364+0.0157269im    -0.0190703+0.151259im    -0.175385-0.0489292im    -0.124751-0.0670174im      0.151578-0.0607569im     -0.0450781-0.120124im       0.0305583-0.100853im
   0.240926+0.0974446im    -0.0252476+0.0867851im      0.100427-0.0703152im    0.0156154+0.122226im     -0.187379-0.0398013im     0.178264-0.0160191im    0.0579433-0.199323im     0.0959855-0.188521im     -0.0075838+0.0714598im       0.055925-0.158241im    -0.0267817-0.00613766im    0.0325482-0.0252899im    -0.0968814+0.034029im     -0.296856+0.236929im      0.108349+0.0727575im   -0.0723717+0.000982935im     0.045957-0.105256im      0.0849939-0.202503im      0.100133-0.143127im       0.124773+0.0975724im     0.0643146-0.132505im      -0.157929+0.0987315im    0.026353+0.0428014im      0.0351386+0.0718038im   -0.0449335+0.0502842im      0.250321-0.164731im      0.0293781+0.201943im    -0.168546+0.0155451im     0.140205-0.0502048im     -0.115804-0.0437009im       -0.04645-0.357362im       -0.101551+0.00322215im
   0.233258-0.0375661im     0.0842434+0.167138im      0.0297703-0.0282572im    0.0915365+0.00289447im    0.131826+0.141522im    -0.0971215+0.12666im      0.0516016-0.0858209im    0.0935371-0.104565im       0.102666-0.256646im       -0.064488+0.137642im      0.239138+0.0505939im     0.0742754+0.210187im      0.0225256-0.00622871im   -0.266492+0.0409727im    -0.149507+0.119034im      0.209182-0.14792im        -0.106809-0.0079727im      0.164411+0.0398092im   -0.0318084-0.0488677im    -0.0953011-0.00730637im    0.0196553+0.0665464im      0.198941+0.0468917im  -0.0170818+0.060286im        -0.11507-0.00860288im   0.0251636-0.20967im        0.170018-0.0629078im     0.0679395-0.0335972im    0.156512-0.060904im      -0.34834+0.0381664im     0.0186395+0.0505754im     -0.0871163-0.0308222im      0.0618086+0.237069im
 -0.0720499-0.156987im     0.00973575+0.081466im      -0.182451+0.16062im       0.109834+0.0241108im   -0.0948065-0.0371322im     0.173264-0.304173im       0.03328+0.123353im    -0.0368789-0.114165im      0.0659461-0.113131im       0.0142982-0.0268081im     0.089232-0.166145im     -0.0798045+0.0118122im      0.330808-0.110606im     -0.114826-0.0128853im     0.165604-0.0705678im     0.113078+0.104984im        0.183843-0.020189im       0.202958+0.122274im      0.129241-0.0848273im     0.0123005-0.0311204im     -0.106438+0.111156im     -0.0724996-0.119667im   -0.0574917-0.0812761im      -0.114277-0.0494784im    0.0396366+0.149774im    -0.00798243-0.0184414im     0.0454882-0.0878429im   0.0289984+0.0363324im      0.17003+0.232442im        0.15881+0.0117091im      0.0279213-0.0602273im      -0.152668+0.346822im
   0.189301+0.133932im      0.0112921-0.0242556im     -0.171118+0.0897345im    0.0620154+0.110548im     0.0779595-0.0376147im    0.0475674-0.034448im     0.0964147-0.035677im     0.0482496+0.144264im       0.111942+0.0163321im      0.0259278-0.00907697im    0.132801+0.0851527im     -0.173056-0.226763im     -0.0955715-0.318636im      0.153895-0.0232191im      -0.1886+0.285372im     0.0672744-0.0851255im     -0.0694004-0.00856763im     0.191129-0.103142im      0.177353+0.0136125im      0.124369+0.0181312im     -0.145638-0.0170332im    -0.0582405+0.205386im     0.130695-0.182565im        0.127755+0.139448im     0.0650612+0.10501im      -0.0751424-0.0276405im    -0.0474976-0.179279im    -0.005744-0.0898056im    0.0668035+0.100864im      0.0763712+0.291806im       -0.150146+0.0190519im      0.0804628-0.109868im
   0.259957+0.155428im      -0.153505+0.14396im       -0.190888-0.0274667im    -0.116745-0.0144365im    0.0246078-0.0818934im     0.182995-0.103546im      0.036279+0.124124im     0.0782763-0.119239im      -0.242136+0.0361285im     -0.0140021+0.191781im     -0.183477+0.0374822im     0.0477392+0.0969501im     0.0483547+0.0895606im    0.0523303+0.0222475im   -0.0743203-0.0415373im    -0.128469+0.13339im          0.02654-0.0025545im      0.107361-0.173227im    -0.0794605+0.170173im       0.288782-0.0955972im      0.180237-0.0286437im     0.0153998+0.178987im    0.0538923+0.179216im      -0.0346102-0.0869596im     0.120689-0.233458im      -0.184287-0.0852913im     -0.191551-0.125482im    0.0276181-0.015232im     0.0104619-0.0270505im      0.123497+0.00725607im      0.104402+0.135562im    -0.000995891+0.192319im
   0.245649-0.00203861im   -0.0877758+0.142059im     -0.0157882-0.0104126im   -0.0731239-0.0465906im     0.108208+0.049436im    -0.0468287-0.0729888im     0.385467-0.173324im      0.221326+0.0893205im     0.0576443+0.0153212im       0.102159-0.172434im      0.064671+0.107215im      0.0736507-0.0810425im      0.104351+0.0515658im      0.14946+0.0385176im       0.1663-0.158692im    -0.0955027-0.00984878im    -0.0888599-0.186362im      -0.174742+0.0673871im    -0.360714-0.0698919im    -0.0286265+0.0948596im    -0.0891384+0.0402243im      0.056726-0.170548im    -0.089016+0.0519496im     -0.0980387+0.081363im     0.0609323+0.0985277im      0.029427-0.0644383im     0.0725509-0.121211im    0.0842893-0.0722161im    0.0861522+0.0649653im      0.200239+0.139432im        0.204508-0.0606311im      0.0899158-0.0953124im</code></pre><p>and then generate the state <span>$ψ$</span></p><pre><code class="language-julia hljs">psi = P[:, 3]</code></pre><pre><code class="nohighlight hljs">32-element Vector{ComplexF64}:
  0.018453276972839532 + 0.010069253889918356im
  -0.04902645815453573 - 0.052214025962949065im
 -0.007643455148380004 + 0.05558114808284925im
   0.12279430228507278 + 0.003808699124914987im
  -0.19721476568109492 + 0.07321094317605872im
  -0.09877392819015841 - 0.050260723795273694im
   -0.3008271690754603 - 0.036033856411850126im
  0.059970883817726875 + 0.03561638485706278im
   0.04208534165278938 + 0.08692767008006344im
   0.19554233217725553 - 0.053189762959303194im
  -0.05428927116163328 + 0.0073239312318150685im
   0.04285353179548412 + 0.03162730269488937im
   0.07689443530174944 + 0.08112852845117033im
   0.08972535465763075 + 0.1249033296883342im
  -0.07785323820022672 + 0.12385690923518662im
  -0.04384241475965567 - 0.26358448853822913im
    0.0840099085370505 + 0.0824735701659035im
   0.01197710781345524 - 0.11369530914526994im
  -0.16610604176691887 - 0.14290126172368076im
 -0.036066376418913935 + 0.10152923128764639im
   0.18683717465136956 + 0.21827680016148537im
   0.09707264988995162 - 0.09039068059285701im
   0.18366414950977955 + 0.10310321413609462im
 -0.009793929418872733 + 0.2152614826434505im
    0.2608418905978553 + 0.06764906994562678im
   0.08749084768802831 - 0.2976517202496444im
 -0.035353281310115406 - 0.10604124544769428im
   0.31384366682967135 + 0.0im
   0.06260675740144268 + 0.06028504255661771im
  0.058646000210294244 - 0.1073862724883235im
  -0.09575971130939176 + 0.14040476120546058im
  -0.12657040063153024 - 0.11416180142139522im</code></pre><p>In the phase estimation process, we will feed the state to circuit and measure the first <code>n</code> qubits processed by iQFT.</p><pre><code class="language-julia hljs">r = join(ArrayReg(psi), zero_state(N))
r |&gt; PE(N, M, U)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 8/8
    nlevel: 2</code></pre><p>Since our phase can be represented by 3 qubits precisely, we only need to measure once</p><pre><code class="language-julia hljs">results = measure(r, 1:N; nshots=1)</code></pre><pre><code class="nohighlight hljs">1-element Vector{BitBasis.BitStr64{3}}:
 011 ₍₂₎</code></pre><p>Recall that our QFT&#39;s bit numbering is reversed, let&#39;s reverse it back</p><pre><code class="language-julia hljs">using BitBasis
estimated_phase = bfloat(results[]; nbits=N)</code></pre><pre><code class="nohighlight hljs">0.75</code></pre><p>the phase is exactly <code>0.75</code>!</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../1.prepare-ghz-state/index.html">« Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a><a class="docs-footer-nextpage" href="../3.grover-search/index.html">Grover Search »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.15 on <span class="colophon-date" title="Wednesday 13 April 2022 20:45">Wednesday 13 April 2022</span>. Using Julia version 1.7.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
