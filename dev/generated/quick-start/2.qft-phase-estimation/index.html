<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quantum Fourier Transformation and Phase Estimation · Documentation | Yao</title><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/indigo.css" rel="stylesheet" type="text/css"/><link href="https://yaoquantum.org/assets/favicon-light.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../index.html"><img src="../../../assets/logo.png" alt="Documentation | Yao logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../index.html">Documentation | Yao</a></span></div><form class="docs-search" action="../../../search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../index.html">Home</a></li><li><span class="tocitem">Quick Start</span><ul><li><a class="tocitem" href="../1.prepare-ghz-state/index.html">Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a></li><li class="is-active"><a class="tocitem" href="index.html">Quantum Fourier Transformation and Phase Estimation</a><ul class="internal"><li><a class="tocitem" href="#Quantum-Fourier-Transformation"><span>Quantum Fourier Transformation</span></a></li><li><a class="tocitem" href="#Wrap-QFT-to-an-external-block"><span>Wrap QFT to an external block</span></a></li><li><a class="tocitem" href="#Phase-Estimation"><span>Phase Estimation</span></a></li><li class="toplevel"><a class="tocitem" href="#using-LinearAlgebra"><span>using LinearAlgebra</span></a></li></ul></li><li><a class="tocitem" href="../3.grover-search/index.html">Grover Search</a></li><li><a class="tocitem" href="../4.shor-algorithm/index.html">Shor&#39;s Algorithm</a></li><li><a class="tocitem" href="../5.shor-9-code/index.html">Shor&#39;s 9 qubit code</a></li><li><a class="tocitem" href="../6.quantum-circuit-born-machine/index.html">Quantum Circuit Born Machine</a></li><li><a class="tocitem" href="../7.variation-quantum-eigen-solver/index.html">Variational Quantum Eigen Solver</a></li></ul></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../../man/array_registers.html">Array Registers</a></li><li><a class="tocitem" href="../../../man/symbolic.html">Symbolic Computation</a></li><li><a class="tocitem" href="../../../man/blocks.html">Blocks</a></li><li><a class="tocitem" href="../../../man/automatic_differentiation.html">Automatic Differentiation</a></li><li><a class="tocitem" href="../../../man/simplification.html">Simplification</a></li><li><a class="tocitem" href="../../../man/base.html">Base</a></li><li><a class="tocitem" href="../../../man/registers.html">Abstract Registers</a></li><li><a class="tocitem" href="../../../man/bitbasis.html">BitBasis</a></li><li><a class="tocitem" href="../../../man/extending_blocks.html">Extending Blocks</a></li></ul></li><li><a class="tocitem" href="../../../benchmarks.html">Benchmark</a></li><li><a class="tocitem" href="../../../dev/index.html">Developer Notes</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Quick Start</a></li><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/QuantumBFS/Yao.jl/blob/master/docs/src/quick-start/2.qft-phase-estimation/main.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><p><a href="https://mybinder.org/v2/gh/QuantumBFS/Yao.jl/gh-pages?filepath=dev/generated/quick-start/2.qft-phase-estimation/main.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a> <a href="https://nbviewer.jupyter.org/github/QuantumBFS/Yao.jl/blob/gh-pages/dev/generated/quick-start/2.qft-phase-estimation/main.ipynb"><img src="https://img.shields.io/badge/show-nbviewer-579ACA.svg" alt/></a> <a href="https://minhaskamal.github.io/DownGit/#/home?url=https://github.com/QuantumBFS/tutorials/tree/gh-pages/dev/generated/quick-start/2.qft-phase-estimation"><img src="https://img.shields.io/badge/download-project-orange" alt/></a></p><h1 id="example-qft"><a class="docs-heading-anchor" href="#example-qft">Quantum Fourier Transformation and Phase Estimation</a><a id="example-qft-1"></a><a class="docs-heading-anchor-permalink" href="#example-qft" title="Permalink"></a></h1><p>Let&#39;s use Yao first</p><pre><code class="language-julia hljs">using Yao</code></pre><h2 id="Quantum-Fourier-Transformation"><a class="docs-heading-anchor" href="#Quantum-Fourier-Transformation">Quantum Fourier Transformation</a><a id="Quantum-Fourier-Transformation-1"></a><a class="docs-heading-anchor-permalink" href="#Quantum-Fourier-Transformation" title="Permalink"></a></h2><p>The Quantum Fourier Transformation (QFT) circuit is to repeat two kinds of blocks repeatly:</p><p><img src="assets/qft.png" alt="qft-circuit"/></p><p>The basic building block control phase shift gate is defined as</p><p class="math-container">\[R(k)=\begin{bmatrix}
1 &amp; 0\\
0 &amp; \exp\left(\frac{2\pi i}{2^k}\right)
\end{bmatrix}\]</p><p>Let&#39;s define block <code>A</code> and block <code>B</code>, block <code>A</code> is actually a control block.</p><pre><code class="language-julia hljs">A(i, j) = control(i, j=&gt;shift(2π/(1&lt;&lt;(i-j+1))))</code></pre><pre><code class="nohighlight hljs">A (generic function with 1 method)</code></pre><p>Once you construct the blockl you can inspect its matrix using <code>mat</code> function. Let&#39;s construct the circuit in dash box A, and see the matrix of <span>$R_4$</span> gate.</p><pre><code class="language-julia hljs">R4 = A(4, 1)</code></pre><pre><code class="nohighlight hljs">(n -&gt; control(n, 4, 1 =&gt; shift(0.39269908169872414)))</code></pre><p>If you have read about <a href="generated/quick-start/2.qft-phase-estimation/@ref example-ghz">preparing GHZ state</a>, you probably know that in Yao, we could just leave the number of qubits, and it will be evaluated when possible.</p><pre><code class="language-julia hljs">R4(5)</code></pre><pre><code class="nohighlight hljs">nqubits: 5
control(4)
└─ (1,) shift(0.39269908169872414)</code></pre><p>its matrix will be</p><pre><code class="language-julia hljs">mat(R4(5))</code></pre><pre><code class="nohighlight hljs">32×32 LinearAlgebra.Diagonal{ComplexF64, Vector{ComplexF64}}:
 1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im</code></pre><p>Then we repeat this control block over and over on different qubits, and put a Hadamard gate to <code>i</code>th qubit to construct <code>i</code>-th <code>B</code> block.</p><pre><code class="language-julia hljs">B(n, k) = chain(n, j==k ? put(k=&gt;H) : A(j, k) for j in k:n)</code></pre><pre><code class="nohighlight hljs">B (generic function with 1 method)</code></pre><p>We need to input the total number of qubits <code>n</code> here because we have to iterate through from <code>k</code>-th location to the last.</p><p>Now, let&#39;s construct the circuit by chaining all the <code>B</code> blocks together</p><pre><code class="language-julia hljs">qft(n) = chain(B(n, k) for k in 1:n)
qft(4)</code></pre><pre><code class="nohighlight hljs">nqubits: 4
chain
├─ chain
│  ├─ put on (1)
│  │  └─ H
│  ├─ control(2)
│  │  └─ (1,) shift(1.5707963267948966)
│  ├─ control(3)
│  │  └─ (1,) shift(0.7853981633974483)
│  └─ control(4)
│     └─ (1,) shift(0.39269908169872414)
├─ chain
│  ├─ put on (2)
│  │  └─ H
│  ├─ control(3)
│  │  └─ (2,) shift(1.5707963267948966)
│  └─ control(4)
│     └─ (2,) shift(0.7853981633974483)
├─ chain
│  ├─ put on (3)
│  │  └─ H
│  └─ control(4)
│     └─ (3,) shift(1.5707963267948966)
└─ chain
   └─ put on (4)
      └─ H
</code></pre><h2 id="Wrap-QFT-to-an-external-block"><a class="docs-heading-anchor" href="#Wrap-QFT-to-an-external-block">Wrap QFT to an external block</a><a id="Wrap-QFT-to-an-external-block-1"></a><a class="docs-heading-anchor-permalink" href="#Wrap-QFT-to-an-external-block" title="Permalink"></a></h2><p>In most cases, <code>function</code>s are enough to wrap quantum circuits, like <code>A</code> and <code>B</code> we defined above, but sometimes, we need to dispatch specialized methods on certain kinds of quantum circuit, or we want to define an external block to export, thus, it&#39;s useful to be able to wrap circuit to custom blocks.</p><p>First, we define a new type as subtype of <code>PrimitiveBlock</code> since we are not going to use the subblocks of <code>QFT</code>, if you need to use its subblocks, it&#39;d be better to define it under <code>CompositeBlock</code>.</p><pre><code class="language-julia hljs">struct QFT{N} &lt;: PrimitiveBlock{N} end
QFT(n::Int) = QFT{n}()</code></pre><pre><code class="nohighlight hljs">Main.##276.QFT</code></pre><p>Now, let&#39;s define its circuit</p><pre><code class="language-julia hljs">circuit(::QFT{N}) where N = qft(N)</code></pre><pre><code class="nohighlight hljs">circuit (generic function with 1 method)</code></pre><p>And forward <code>mat</code> to its circuit&#39;s matrix</p><pre><code class="language-julia hljs">YaoBlocks.mat(::Type{T}, x::QFT) where T = mat(T, circuit(x))</code></pre><p>You may notice, it is a little ugly to print <code>QFT</code> at the moment, this is because we print the type summary by default, you can define your own printing by overloading <code>print_block</code></p><pre><code class="language-julia hljs">YaoBlocks.print_block(io::IO, x::QFT{N}) where N = print(io, &quot;QFT($N)&quot;)</code></pre><p>Since it is possible to use FFT to simulate the results of QFT (like cheating), we could define our custom <code>apply!</code> method:</p><pre><code class="language-julia hljs">using FFTW, LinearAlgebra

function YaoBlocks.apply!(r::ArrayReg, x::QFT)
    α = sqrt(length(statevec(r)))
    invorder!(r)
    lmul!(α, ifft!(statevec(r)))
    return r
end</code></pre><p>Now let&#39;s check if our <code>apply!</code> method is correct:</p><pre><code class="language-julia hljs">r = rand_state(5)
r1 = r |&gt; copy |&gt; QFT(5)
r2 = r |&gt; copy |&gt; circuit(QFT(5))
r1 ≈ r2</code></pre><pre><code class="nohighlight hljs">true</code></pre><p>We can get iQFT (inverse QFT) directly by calling <code>adjoint</code></p><pre><code class="language-julia hljs">QFT(5)&#39;</code></pre><pre><code class="nohighlight hljs"> [†]QFT(5)</code></pre><p>QFT and iQFT are different from FFT and IFFT in three ways,</p><ol><li>they are different by a factor of <span>$\sqrt{2^n}$</span> with <span>$n$</span> the number of qubits.</li><li>the <a href="https://quantumbfs.github.io/BitBasis.jl/stable/tutorial/#Conventions-1">bit numbering</a> will exchange after applying QFT or iQFT.</li><li>due to the convention, QFT is more related to IFFT rather than FFT.</li></ol><h2 id="Phase-Estimation"><a class="docs-heading-anchor" href="#Phase-Estimation">Phase Estimation</a><a id="Phase-Estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Phase-Estimation" title="Permalink"></a></h2><p>Since we have QFT and iQFT blocks we can then use them to realize phase estimation circuit, what we want to realize is the following circuit:</p><p><img src="assets/phaseest.png" alt="phase estimation"/></p><pre><code class="language-julia hljs">using Yao</code></pre><p>First we call Hadamard gates repeatly on first <code>n</code> qubits.</p><pre><code class="language-julia hljs">Hadamards(n) = repeat(H, 1:n)</code></pre><pre><code class="nohighlight hljs">Hadamards (generic function with 1 method)</code></pre><p>Then in dashed box <code>B</code>, we have controlled unitaries:</p><pre><code class="language-julia hljs">ControlU(n, m, U) = chain(n+m, control(k, n+1:n+m=&gt;matblock(U^(2^(k-1)))) for k in 1:n)</code></pre><pre><code class="nohighlight hljs">ControlU (generic function with 1 method)</code></pre><p>each of them is a <code>U</code> of power <span>$2^(k-1)$</span>.</p><p>Since we will only apply the qft and Hadamard on first <code>n</code> qubits, we could use <code>Subroutine</code>, which creates a context of a sub-scope of the qubits.</p><pre><code class="language-julia hljs">PE(n, m, U) =
    chain(n+m, # total number of the qubits
        subroutine(Hadamards(n), 1:n), # apply H in local scope
        ControlU(n, m, U),
        subroutine(QFT(n)&#39;, 1:n))</code></pre><pre><code class="nohighlight hljs">PE (generic function with 1 method)</code></pre><p>we use the first <code>n</code> qubits as the output space to store phase <span>$ϕ$</span>, and the other <code>m</code> qubits as the input state which corresponds to an eigenvector of oracle matrix <code>U</code>.</p><p>The concentrator here uses <code>focus!</code> and <code>relax!</code> to manage a local scope of quantum circuit, and only active the first <code>n</code> qubits while applying the block inside the concentrator context, and the scope will be <code>relax!</code>ed back, after the context. This is equivalent to manually <code>focus!</code> then <code>relax!</code></p><p>fullly activated</p><pre><code class="language-julia hljs">r = rand_state(5)</code></pre><pre><code class="nohighlight hljs">ArrayReg{1, ComplexF64, Array...}
    active qubits: 5/5</code></pre><p>first 3 qubits activated</p><pre><code class="language-julia hljs">focus!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{1, ComplexF64, Array...}
    active qubits: 3/5</code></pre><p>relax back to the original</p><pre><code class="language-julia hljs">relax!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{1, ComplexF64, Array...}
    active qubits: 5/5</code></pre><p>In this way, we will be able to apply small operator directly on the subset of the qubits.</p><p>Details about the algorithm can be found here: <a href="ttps://en.wikipedia.org/wiki/Quantum_phase_estimation_algorithm">Quantum Phase Estimation Algorithm</a></p><p>Now let&#39;s check the results of our phase estimation.</p><p>First we need to set up a unitary with known phase, we set the phase to be 0.75, which is <code>0.75 * 2^3 == 6 == 0b110</code> .</p><h1 id="using-LinearAlgebra"><a class="docs-heading-anchor" href="#using-LinearAlgebra">using LinearAlgebra</a><a id="using-LinearAlgebra-1"></a><a class="docs-heading-anchor-permalink" href="#using-LinearAlgebra" title="Permalink"></a></h1><pre><code class="language-julia hljs">N, M = 3, 5
P = eigen(rand_unitary(1&lt;&lt;M)).vectors
θ = Int(0b110) / 1&lt;&lt;N
phases = rand(1&lt;&lt;M)
phases[0b010+1] = θ
U = P * Diagonal(exp.(2π * im * phases)) * P&#39;</code></pre><pre><code class="nohighlight hljs">32×32 Matrix{ComplexF64}:
    0.183514+0.208143im       -0.12739-0.083937im       -0.12534+0.000698986im    -0.125906+0.156747im     0.00445452+0.0469105im     -0.149244-0.114137im      0.240654-0.0634738im     -0.107272+0.112019im       0.128456-0.226348im      0.0729496-0.0357965im    0.0511262+0.0751745im    -0.0159045-0.0144717im    0.0203452-0.0862959im      0.170211-0.283441im     0.134342+0.11864im      0.00358843+0.0411866im      0.029257+0.0177964im     0.0310284-0.279843im     -0.0985579+0.058192im     -0.0182069-0.0783728im     0.0138604+0.0522064im     0.135517-0.00852326im   -0.0714082-0.0852772im     0.218197-0.0401807im      0.142245-0.0990665im   -0.0361271-0.119751im      -0.112824+0.125063im     -0.175619+0.0241388im      0.267991+0.103636im    -0.0690486+0.0865046im    0.0728575-0.186023im      0.106831+0.226733im
  -0.0627944-6.18999e-5im    0.0670059+0.142414im     -0.0895918-0.249539im        0.252397-0.00700988im    0.0123944-0.0623076im     -0.130671-0.378879im     0.0805379+0.045196im     -0.0746764+0.0792697im    -0.0437623-0.185417im      -0.215346+0.0975263im    -0.120543+0.0546455im     0.0649388+0.0621411im     0.107426+0.117952im      0.0943132-0.158378im    -0.019811-0.0384679im      0.175519+0.238547im     -0.0866272+0.0223135im    -0.0569323+0.178567im       0.234403-0.0357596im       0.01329-0.259867im     -0.0985729-0.0676439im   -0.0296806-0.0782785im     0.0531381+0.0108548im    -0.200895+0.0130855im     0.0483793-0.101443im      -0.13942+0.147634im      -0.100541-0.0862766im   0.00325887-0.134053im       0.109483+0.0567608im     0.142603+0.0546696im    0.0647402+0.0732588im    0.0765561-0.101063im
    0.131378-0.0994741im     0.0911772+0.0765176im    0.00534143-0.0375044im     -0.0713929-0.153291im    -0.00381721-0.091822im      0.0730835+0.00519872im   0.0230068+0.172077im     -0.0309472-0.226932im       0.232028+0.0790255im    -0.0769955+0.0643192im   -0.0449827-0.0218197im     -0.107094+0.197161im     -0.148555-0.00905032im    -0.230873+0.0427125im   0.0733549+0.216471im       0.327513+0.0916519im    -0.0600984+0.0822248im     0.0539531-0.226124im     -0.0606823+0.0268423im     -0.341699+0.108648im     -0.0524596-0.0039711im   -0.0694743+0.0864282im     -0.101938+0.0853848im   -0.0274727-0.0528902im     0.0709181+0.108761im     -0.205016-0.0523402im     0.0230029-0.112582im      0.135397+0.00178282im     0.083134+0.0077854im     0.247364-0.0758169im    0.0509822-0.00711125im    0.189473+0.157345im
   -0.158281-0.0974762im     -0.153293-0.0871385im     -0.115062-0.0418237im    -0.00591419+0.0908888im     0.0261786+0.0789902im     -0.102866-0.150798im     0.0868401+0.0383833im    -0.0440035-0.0391327im     -0.131336+0.189125im       0.215846+0.0410423im     0.287215+0.263685im      -0.215409-0.050363im     -0.124084+0.103099im       0.120056-0.0202489im   -0.157513-0.00890569im     0.129216-0.0747694im    -0.0797525+0.0271072im    -0.0336748-0.19672im      -0.0597736-0.00654639im     0.222238-0.0403644im     0.0970766+0.0738212im    -0.120159+0.0823099im      0.202057-0.00294613im   -0.205438-0.0688965im      0.114745+0.019535im     0.0389576-0.0889391im      0.130167+0.170302im      0.186806+0.143758im      0.0108147-0.0959078im     0.242171+0.0275973im      0.13295+0.152084im     0.0905481-0.0203505im
    0.117346-0.0151356im     -0.113991-0.0126191im      0.297866-0.0200467im      -0.258667-0.0380607im      0.121489+0.0583824im      -0.17758-0.205284im    -0.0358232-0.0239105im    -0.0828709+0.0742907im     -0.098973+0.144031im      -0.104032+0.0918827im    -0.155225-0.228734im      0.0980531+0.15268im        0.11551-0.00194687im    0.0813382-0.091291im   -0.0214566+0.0907711im    -0.0708831-0.157605im     -0.0998505+0.0658515im   -0.00977321+0.0390729im    -0.0918803-0.100434im      -0.135724-0.00674223im    -0.171268+0.321864im      0.189939+0.00706905im     0.146296-0.0756997im   -0.0848838-0.157829im      0.0323493+0.0889292im     0.126681+0.0663528im     0.0305512-0.114681im      0.246608+0.202123im       0.021211-0.0940062im   -0.0505747+0.188105im     0.0430424-0.0422443im     0.014458-0.0762231im
    0.150685-0.208611im       0.227225+0.243911im     -0.0282928+0.119745im      -0.0115775+0.0142396im     -0.303623-0.08248im      -0.0608236-0.0281314im   -0.0162701-0.00625467im     0.114484+0.000456707im    -0.20559+0.135425im       -0.10295+0.26644im     -0.0563076+0.0577225im    -0.0979776-0.0301478im   0.00219357+0.0522327im    0.00365963+0.0411852im   -0.052163+0.126536im     -0.0806058-0.0372344im      0.161969+0.185957im       -0.24744-0.146326im      -0.164741+0.113282im       0.185991-0.21021im      -0.0618501+0.0015068im     0.139298+0.19596im        0.108375-0.08449im       0.116586-0.0628526im      0.080567+0.0859645im   -0.0119225-0.127241im      -0.021033-0.142734im     -0.139949-0.132001im      0.0973131+0.101244im    -0.0234387-0.00561754im   -0.129123+0.0658326im    -0.100124-0.0195697im
   -0.186243-0.0486796im    -0.0326995-0.0388431im      0.219186-0.169491im      -0.0196383-0.0366671im      0.183353-0.172583im       0.165384+0.0957817im     0.194064-0.0126939im       0.17998+0.082956im      0.0877013-0.0598604im       0.15691-0.0304816im   -0.0153531+0.0547131im     0.0788154-0.0432838im     0.257238-0.109213im       0.058426-0.0241259im    0.167737-0.117289im       0.179804+0.0873144im     -0.143299+0.0829979im     -0.109041-0.0529285im     -0.204206+0.0990467im     -0.154922-0.157009im     -0.0207004-0.0719763im   -0.0148014+0.176197im       0.157749+7.34707e-6im  -0.0340303-0.053129im        0.10661+0.182747im     0.0528943+0.0904266im      0.293406+0.0753422im    -0.205156-0.0112744im     0.0998596-0.0478521im    0.0364922-0.0150304im    -0.200365-0.0325232im    -0.167586-0.109174im
   0.0697842-0.108373im       0.165378-0.161528im      0.0909706-0.101202im       -0.158691+0.109559im      0.0297564-0.154606im      -0.147154-0.201415im     0.0520131+0.229266im      0.0907567-0.0562862im     0.0418235-0.0207801im    -0.0113653-0.0884887im     0.205941+0.00838182im  0.000131406-0.243306im     0.0964035-0.0996581im     -0.163139+0.152675im    -0.091715+0.0260794im    -0.0893207-0.00865107im     -0.14147-0.0607124im    -0.0492348-0.143473im       0.218787-0.191531im      0.0483992+0.0191197im   -0.00939062-0.235012im       0.18051+0.0565325im     -0.224551-0.342161im    -0.0955058-0.147194im      -0.208967+0.0347591im   -0.0209893-0.0128121im    -0.0199608+0.00746576im     0.03575+0.038417im       0.100557-0.014918im    -0.0320917-0.106096im    -0.0401048-0.112493im    -0.0259522-0.11334im
  -0.0416364+0.173902im      0.0216266+0.0463956im     0.0510679-0.0968408im       0.076644+0.0735265im      0.101134-0.0527239im       0.10721+0.0469237im    -0.127269+0.0812813im     -0.113282-0.220732im     -0.0931541-0.00831767im    -0.024873-0.0613727im      0.10197+0.14893im      -0.0209024+0.095418im     0.0750323+0.289101im      0.0339913+0.121955im    -0.103943-0.00703727im     0.160526-0.0665581im     0.0371126+0.15565im         0.19495+0.0208174im     -0.224127+0.146984im     -0.0398974-0.0961746im     -0.117745+0.0201327im     0.209489-0.205028im      -0.136207-0.0704223im    0.0495233-0.00890634im   -0.0589173-0.0475666im     0.147389-0.248724im      -0.164592+0.0273146im    -0.145326+0.00678327im  -0.00254814-0.139824im     0.0553577+0.0705778im    -0.133977-0.176286im      0.160142-0.340555im
 -0.00069089-0.0500953im     0.0861353+0.035746im      0.0352912+0.086802im       -0.194213+0.0156939im     -0.123289-0.0378524im     0.0860773-0.00731477im  -0.0798559+0.121504im    0.000301728+0.0219847im     0.0093719-0.239615im      0.0789495+0.0961628im     0.217796-0.01411im        0.115937-0.0187127im    0.0178122+0.0589075im     0.0313322-0.0154766im  -0.0568933+0.363618im       0.167214+0.129795im      -0.102037+0.0989186im     -0.111798+0.118884im       0.195977-0.0597865im    0.00248549-0.0290971im      0.179062-0.00250143im   -0.232441-0.139916im      0.0617306-0.0168586im    0.0574589+0.165902im       0.154085-0.00286624im    0.147478-0.13121im        0.111619-0.0857429im    0.0469816-0.0282411im    -0.0327199-0.346729im     -0.262644+0.235453im    -0.0917386-0.0518623im   0.00166275+0.06356im
  -0.0259213+0.120248im     -0.0412556+0.299214im     -0.0487779+0.122975im        -0.14203+0.0827151im    -0.0398397+0.0410723im     0.0457315+0.12016im       0.310374+0.0950609im      0.046915-0.00897335im     0.139262+0.0608282im     -0.175539+0.0646712im     0.178469+0.0797799im    -0.0854581+0.0957634im     0.101785-0.202171im      -0.193653+0.132782im   0.00438791-0.132545im     -0.0413753-0.153436im       0.040607+0.0477969im      0.258783+0.0494182im     0.0897742-0.0172751im    -0.0157624-0.187589im     0.00430657-0.0465156im    0.0701674-0.0809521im       0.14341-0.0216041im    -0.134797-0.15312im        0.118042+0.00840868im  -0.0484592+0.165405im     -0.0874103+0.187887im     0.0809125-0.131971im     -0.0810473-0.0152256im    -0.202516+0.186974im     -0.131127+0.153777im       0.17491+0.0374912im
   0.0711743+0.243156im        0.05147+0.0482165im    0.00406505+0.0540075im      0.0314176-0.142977im      -0.137512+0.00156446im    -0.143154+0.057808im      0.116089+0.179527im       0.307929+0.0288976im     0.0769868-0.0184871im     0.0522409+0.0942337im    -0.144193-0.0318902im      0.286696+0.0126428im    -0.133039+0.00885651im     0.233712+0.110602im   -0.0188152-0.160247im     -0.0222929-0.154394im     -0.0415283+0.0215861im    -0.0227035+0.137059im      -0.147029+0.0844491im     0.0557851+0.0177748im    -0.0109246-0.328129im    -0.0542796-0.0705774im    -0.0438164+0.0329206im    0.0398351-0.0803204im    0.00759478+0.0353138im     -0.17609-0.214474im      0.0764207+0.0494454im     0.215443+0.108871im       0.210314-0.1745im       0.0284389+0.0730926im     0.229593+0.0180874im   0.00284879-0.0784257im
    0.127256-0.0381059im      0.137865-0.020272im      0.0146495+0.0170725im       0.100348-0.0342936im     -0.146904+0.268913im     -0.0668833+0.124857im     0.0136949+0.034905im    -0.00667256-0.12002im        0.106393-0.094657im      -0.273224-0.165197im     -0.230619+0.0651653im     0.0434373+0.032253im      0.319453+0.166611im      0.0280534+0.077412im   -0.0682202-0.0745193im     0.0771322-0.113615im     -0.0714831-0.0426386im    -0.0420797-0.123977im     -0.0607715-0.166787im       0.137744-0.0490654im      0.176981-0.0265508im    0.0464332-0.0512168im    -0.0524156-0.15008im     -0.0845237+0.128729im       0.237548-0.0744874im    0.0967555+0.0617688im      0.172249+0.0755702im   -0.0301275+0.269103im        -0.1346-0.0283662im     0.175947-0.0301691im     -0.12919-0.0424474im   -0.0112711+0.23899im
    0.249977-0.0103413im    -0.0438149+0.0993068im     0.0596934-0.0798092im      -0.131007+0.0344449im    0.00378925-0.0311883im     0.0375319-0.159838im     -0.133496-0.0750912im     0.0251103-0.100677im       0.223793+0.289031im     -0.0960759+0.0723721im     0.136936+0.0448618im      0.215024-0.0353387im    -0.128673-0.145791im       0.120762-0.151816im    0.0128168+0.0154191im      0.227164-0.0255323im   -0.00240644-0.18461im      -0.0973005+0.162752im      -0.103973-0.178275im       0.122557-0.0485747im      0.034556-0.0520628im      0.18444+0.165422im      -0.153152+0.293402im    -0.0802172+0.0323089im     0.0269227-0.215163im     0.0530933-0.0389958im      0.019321+0.218252im     -0.157171-0.0857811im     -0.165043-0.0872157im   -0.0100571-0.0643247im   -0.0629232+0.0170398im   -0.0454034-0.0398411im
   0.0779154-0.117796im     -0.0614105-0.051127im      0.0551633+0.251762im          0.1467+0.0503215im     -0.120728-0.0987609im      -0.12172-0.124392im    0.00856658+0.00355524im   0.00149407+0.114339im       0.149511-0.114995im      -0.167581-0.0984882im    0.0908371+0.172812im      0.0316033+0.0335088im   -0.0207696-0.0750523im      0.118691+0.0493477im   0.0814654+0.117882im      0.0515852-0.00491834im     0.101094-0.0924913im      0.023439+0.275105im      -0.178156+0.218139im     -0.0596474+0.0681363im     -0.177357+0.0167973im    -0.274455+0.0366179im    -0.0113446-0.233412im     -0.200122-0.256633im      -0.086002+0.151786im      0.281585-0.0580192im  -0.000775282+0.0382242im    -0.059783-0.0411899im     -0.186816+0.0568127im    0.0508217-0.108844im     0.0507337-0.0995428im    0.0689827+0.122175im
    0.101345+0.0106717im     0.0239596+0.119297im      0.0335375-0.130772im       -0.124229-0.0732469im      0.187527+0.110555im      -0.145598+0.114347im     -0.102638-0.184253im      -0.188948-0.00789812im     0.011019-0.111861im     -0.0693904-0.0798149im   0.00918482+0.11059im      -0.0219282-0.0711132im    -0.205921-0.0225896im    -0.0720094+0.310249im     0.265577-0.106811im       0.126799-0.0280759im    -0.0438206-0.0276139im   -0.00122278-0.0834812im     0.0888703-0.0461144im     0.0455942-0.358053im     0.00512992+0.0473149im    -0.176183-0.0336776im    -0.0144518-0.00597236im   0.0362459-0.225017im       0.153441-0.0185286im    0.0253048-0.151394im     -0.0600542-0.139137im      0.018443+0.0478147im    -0.0434365-0.0136112im    -0.108591-0.102876im      0.212068-0.0163655im    -0.323987-0.0689817im
     0.11129+0.242701im       0.183543-0.0377475im      0.147715-0.178776im        0.149859-0.196972im       0.042102-0.00208611im    -0.242374+0.0491314im    0.0390981+0.207125im     -0.0286954-0.0982356im    -0.0165439-0.135882im      -0.102023-0.0401504im     0.299242+0.144848im       -0.13842-0.0372599im    -0.122417-0.0276837im     0.0786906+0.0107658im   0.0613501-0.0198137im    -0.0799591+0.103339im       0.292605-0.0869439im     -0.140768+0.0480863im     -0.136175-0.015626im     -0.0474598+0.0936746im        0.2617+0.103116im     0.0993938+0.0970351im      0.100215+0.137033im      0.089292-0.014493im     -0.0507251+0.0792451im    0.0188311+0.260226im      0.0983884-0.134236im     0.0882473+0.0218735im    -0.0825864+0.0647182im   -0.0116241+0.192319im    -0.0517799-0.0798673im    0.0124284-0.069468im
    -0.11863-0.0689958im    -0.0230572+0.177038im      -0.175349+0.10026im         0.159864-0.0636885im     0.0505658+0.09645im        0.197288-0.07127im      0.0907952+0.137158im      0.0120911+0.0230056im     -0.141417-0.118507im      0.0594349+0.0614369im  -0.00141946+0.161219im      0.0843841+0.130328im      -0.11792-0.0130848im     0.0771215-0.217045im     0.061386-0.0202377im    -0.0816361-0.125751im     -0.0614572-0.299469im      0.0249562-0.107465im      -0.036247-0.328083im      -0.122097+0.0366368im     0.0529004+0.0588188im      0.24647-0.145302im     -0.0838458-0.0925165im    0.0206403-0.191403im      0.0480121+0.241695im    -0.0306683-0.125339im       0.152021-0.202283im    -0.0598487-0.165847im      -0.167337-0.142043im    -0.0122282-0.0960786im    0.0216735-0.0267426im   -0.0848979-0.00304291im
   -0.174962-0.0361753im    -0.0788187-0.142553im      -0.325305+0.0023514im     -0.0276401-0.0141911im      0.111777+0.166641im       0.102734+0.0826482im    -0.121045+0.0442351im      0.146652-0.169013im       0.152553+0.0311123im     -0.269728+0.0944675im     0.055041+0.0144983im       0.10303-0.00931615im   0.0189206+0.0286962im     -0.153844-0.177274im    0.0588795+0.0405048im     0.0709149-0.126963im      0.0562209+0.0650045im     -0.226188-0.0583222im     0.0206334+0.0469689im     0.0765435+0.129618im      -0.130432+0.00318806im  -0.0876781+0.0308552im    -0.0891398-0.101864im    -0.0595215-0.0833563im     0.0425751+0.0267401im    0.0197405+0.0530602im     0.0569684+0.0301342im   -0.0366628-0.00623339im    0.0389935+0.23221im     -0.0615792+0.420466im      0.164487-0.12821im      -0.174554-0.212268im
  -0.0190725+0.201636im      -0.219656-0.274377im     -0.0686748+0.0460806im     -0.0840748+0.0318328im     -0.156124+0.198923im     -0.0371341-0.00816341im   -0.286037+0.0898195im     0.0821594+0.254879im      0.0723308-0.192436im      -0.078445+0.0167455im  -0.00583498+0.0196451im     0.0725827-0.0311009im      -0.1635-0.000435439im    -0.13431+0.104812im    -0.171165+0.134983im      -0.100522+0.0869301im     -0.073022-0.111192im       0.044447-0.0973771im     -0.175438+0.0392281im     -0.160118-0.127521im      -0.023508-0.0177174im    0.0481866+0.145541im      0.0843157-0.038183im    -0.0899738-0.0433463im      0.183983-0.0783289im    -0.184705+0.0880074im    -0.0867671-0.0599277im   -0.0329946-0.090975im     -0.0538794-0.0940374im     0.132614-0.0639713im     -0.26211+0.158921im    -0.0546957-0.195604im
   -0.234786+0.0550182im     0.0911202+0.13781im        0.145756-0.144974im      -0.0327234+0.0874387im     -0.143682+0.0408489im     0.0696817+0.0312475im   -0.0571109-0.185134im     0.00497129+0.0337373im    -0.0156971-0.187116im      -0.105542+0.124096im      0.143397-0.0513925im    -0.0578621+0.0516339im     0.211734+0.156086im      -0.112812-0.127115im   -0.0466897+0.173578im     -0.0243938+0.0844143im      0.123751+0.0261934im      0.227909-0.00461577im    -0.217825-0.0826867im     0.0782535+0.202562im      0.0516519-0.105862im     0.0123784+0.0712203im    -0.0979563+0.119842im    -0.0446962-0.351966im     -0.0678044-0.183958im     0.0228193+0.0486186im     0.0448882+0.0640378im     0.123169+0.00866867im     0.162297-0.0992691im   -0.0135921-0.132819im      0.171306+0.0761259im    -0.258218+0.10366im
   0.0707622+0.148084im       0.218479-0.191529im       0.066572+0.147083im       0.0258058+0.18442im        0.194135-0.154445im     0.00384857+0.118301im     0.0394679-0.137657im       0.133867-0.0425445im    -0.0406715-0.0415171im     -0.243278-0.0572917im    -0.104192+0.110039im      -0.290844-0.033689im      0.118789-0.0854317im     0.0270684+0.0217113im   0.0030836+0.203391im       0.104476-0.131898im      -0.197562-0.223279im     -0.0347493+0.173531im      0.0102872-0.0330867im     0.0590801+0.163593im      0.0554603+0.166025im     0.0740656-0.030084im       0.235798+0.0350603im   -0.0550333+0.0560103im     0.0389651-0.011518im     -0.254625-0.234428im    -0.00243852-0.00287609im  -0.0558304-0.129472im       0.110702-0.0301612im  -0.00906256-0.00846696im      0.1191+0.120453im    -0.0282327-0.0972086im
   0.0152864-0.158845im       0.132788+0.00308211im    0.0166461+0.0192723im     -0.0966186+0.0970454im    -0.0762367+0.251568im      0.0644969-0.370406im     0.0679461+0.0711794im      0.165769-0.0273464im    -0.0722362-0.0513787im    -0.0835922-0.14001im      0.0345127+0.0135946im     -0.219652+0.240515im    -0.0569198-0.0885386im     -0.114686-0.0309687im   0.0613619-0.249548im    -0.00352526+0.0229752im    -0.0630639-0.105697im      0.0317087+0.044785im      -0.171616+0.142477im     -0.0943187-0.013369im     0.00943535+0.0405381im    -0.100909-0.0116154im    -0.0214686+0.0144522im     0.163132+0.297369im    -0.00767964-0.0511881im    0.0727434-0.0328222im    -0.0533354+0.153284im      0.251655-0.129963im      0.0986216-0.0701524im   -0.0293956-0.0323788im   -0.0520741-0.179049im     -0.276826-0.0843418im
 -0.00722615-0.0800897im   -0.00203126-0.0870282im     -0.052378+0.142117im        0.188327-0.0700303im     0.0352966-0.236861im      -0.146874-0.0225782im    0.0410207+0.201236im       -0.11453-0.0678211im     0.0671642+0.0359887im     0.0847268+0.102247im     -0.264909-0.0352926im     -0.255758+0.0465199im    0.0594728-0.0386847im    -0.0539062-0.0638208im  0.00371165-0.0525462im     -0.148102+0.101183im    -0.00284944-0.104167im      0.0861582-0.128814im      0.0523208+0.074978im     -0.0658246+0.0694982im    -0.0326755-0.166938im    0.00577601+0.176608im    -0.00817704+0.115622im    -0.0345123-0.112556im       0.311886-0.354845im      0.217331-0.0675923im     0.0573822-0.00902373im  -0.0219613+0.0544748im     -0.140515-0.162706im     -0.224483+0.0632843im    0.0783835-0.0627591im   -0.0335564-0.201072im
    0.227424+0.130438im      -0.013883-0.0206532im      0.217362-0.0396711im      0.0572536+0.329246im     0.00101561+0.189158im      -0.057857+0.110247im     -0.127727+0.196081im     -0.0706014+0.090916im     -0.0276885+0.0670053im      0.170478+0.0696767im    0.0702534+0.110233im     -0.0505424+0.197615im     0.0217687-0.0670324im     -0.101023-0.132786im    -0.132874-0.144702im      0.0895278-0.0340957im      0.112986+0.142339im      -0.042213+0.0880181im      0.134649-0.185714im    -0.00212509+0.17805im       -0.220752-0.189035im     -0.118234-0.135462im       0.102527+0.0740411im   -0.0654061-0.0110624im      0.212916+0.0722459im    0.0279983-0.0644934im      0.129512-0.136443im    -0.0803581-0.0286502im      0.114762+0.241471im    -0.0388674-0.152098im    -0.0466109-0.0683857im   -0.0822528-0.0207477im
   -0.120166-0.0153743im      0.152869-0.13462im       0.0533354-0.0124924im     -0.0248666-0.0938353im      0.180346-0.080207im       0.107965-0.0220382im     0.100233+0.045423im      0.0125456+0.239062im        -0.1971+0.0490536im     -0.210914-0.0987061im   -0.0700406+0.0580416im     0.0762224-0.0134031im    -0.359358+0.0345191im     -0.109318-0.0309248im    0.097931+0.273368im     -0.0815464-0.0128127im      0.228999+0.196301im      0.0841837+0.0530173im      0.119391+0.0170208im     0.0326653-0.0482391im    -0.0966158-0.17804im       0.233952-0.112517im      0.0875638+0.0382771im   -0.0658367+0.0941502im      0.196849+0.0013172im     0.042773-0.0111913im      0.116951+0.304008im     0.0444389+0.10234im      -0.0595132+0.0116184im      0.08703-0.0929663im   0.00158771-0.153072im    -0.0740641+0.0956003im
   0.0415482-0.0890002im    -0.0322639-0.181072im      0.0534903+0.220796im       0.0761674+0.187456im      -0.163523-0.0554012im     0.0661175+0.101197im     0.0579276+0.133093im      -0.237003+0.041857im      -0.101495+0.126195im      -0.248792-0.137964im      0.170556+0.0302463im       0.32594-0.174628im     0.0975879+0.00573515im    -0.128748-0.0286409im   0.0715157-0.252742im      0.0392136+0.239658im      0.0259001+0.0686631im     0.0723129-0.0847719im    -0.0534342+0.0329049im    -0.0945883-0.0455032im    0.00792838+0.0835342im     0.160651+0.0628557im      0.035855+0.0984831im    0.0198474+0.136813im      0.0171303+0.0552018im    0.0389137-0.0594025im     0.0643591-0.126256im     0.0378639-0.0806488im      0.102822-0.133355im     0.0129939+0.0434764im     0.346916+0.156629im    -0.0192813+0.00411931im
  -0.0192749+0.0217606im      0.138085-0.091174im    -0.00837168+0.251497im      -0.0111369+0.103948im      0.0655088-0.113246im      0.0392058+0.0378871im    0.0120696+0.066041im     -0.0470593+0.0276571im    -0.0708575-0.0604287im      0.143346+0.0504674im    -0.127847-0.142869im      0.0443287-0.0147301im    -0.133173-0.0795875im     0.0695549-0.0715737im   -0.156258-0.078893im       0.468591+0.106684im       0.122061-0.00260288im     0.135953+0.0128874im      -0.12132+0.0803814im      0.211505-0.0989044im      0.104577+0.179271im     0.0667993-0.0565883im     -0.198399-0.21745im     0.00595922-0.10376im       0.0223657-0.0843463im    -0.172031+0.207737im       0.146104-0.0123395im     0.228164+0.0303656im     -0.086444+0.189624im     -0.164144-0.0559202im   -0.0846762+0.00257328im  -0.0746062-0.0713403im
   -0.298972-0.040745im      0.0646858+0.155412im       0.179102+0.0436628im      -0.209788-0.0350551im     0.0174464-0.104976im      -0.140268+0.166844im      -0.18199+0.271664im     -0.0292775-0.020775im     -0.0262273+0.0143585im     -0.177053-0.11936im      0.0460917-0.111781im      -0.058238-0.00488435im   -0.102823-0.202058im        0.21683-0.176612im    0.0514929-0.068168im      0.0177288-0.0840722im     0.0256606-0.157029im     -0.0222773-0.222614im     -0.0251871+0.0377598im      0.163037+0.0223168im     -0.230965-0.00323174im   -0.154121-0.216481im      0.0422961-0.0654757im    0.0599317+0.0645622im   -0.00783392-0.171809im     0.0151173+0.152904im      -0.063591-0.0699319im    -0.175509-0.0768382im     0.0956423-0.15998im       0.199334-0.020703im    -0.0167299+0.0661632im    0.0224665+0.0657488im
 -0.00610672-0.0370353im     0.0601569+0.136096im      -0.212725-0.123355im       -0.177246+0.109557im      -0.114163+0.0895227im   0.000767373+0.0240388im    0.0797335+0.0848504im    -0.0363603+0.249409im      -0.136708+0.201525im    -0.00875623-0.103469im   0.000945828+0.0783349im    -0.0395228+0.0405811im    0.0296514-0.0746043im     0.0507727+0.243773im   -0.0427503+0.143614im       -0.06969+0.0217604im     -0.194248-0.071205im       0.149941+0.197223im     0.00923312+0.156647im     0.00590687+0.0517044im     0.0283881+0.107973im     -0.013328+0.0285844im     -0.206342+0.115024im      0.076051-0.0702347im     0.0363927-0.14232im     -0.0623337+0.165714im       0.378638-0.188918im     -0.219843+0.05875im       0.0611923+0.057652im      0.102859+0.0714845im     0.119094-0.223945im     0.0878252-0.0901392im
   0.0893765+0.0208632im      0.118252+0.0481187im     0.0205048+0.0131671im       -0.03098+0.0163333im      0.223999-0.0240377im     -0.037196-0.0114853im   -0.0316758-0.107651im      -0.059065+0.406674im       0.210245+0.0199581im     0.0262088+0.13038im      0.0375424+0.18396im       -0.174022+0.0646293im    0.0289528+0.180223im     -0.0694067-0.0568671im   0.0301589-0.096058im      0.0504204-0.0272021im    0.00911527-0.0432698im     0.0488013-0.0259115im   -0.00496551+0.117093im       0.161501+0.105026im      -0.200353-0.140293im       0.08157+0.122649im       -0.27673-0.0870154im     0.091979+0.232133im       -0.02665+0.217776im    -0.0409376+0.0986224im    -0.0286424-0.128165im    0.00883697+0.0969968im     -0.134979-0.247217im     0.0188134+0.206918im     0.0202319+0.228555im    -0.0534518+0.0691492im
    0.121878-0.0967035im    -0.0593798-0.197183im     -0.0106232+0.0253971im      -0.245486-0.231588im       0.123387+0.0802134im      0.023577-0.112685im     0.0619926+0.115859im       0.160501+0.085302im      0.0913894-0.119997im     -0.0436034-0.064465im     -0.074158-0.0971174im      -0.18501+0.111377im     0.0130568+0.042231im     -0.0238247-0.0545783im  -0.0747487-0.189639im      -0.048439+0.0155893im      0.257308+0.330957im      0.0461994+0.0440139im    -0.0104019-0.0679856im      0.109898-0.0522808im      0.207307+0.136153im    -0.0438922-0.0854177im    -0.0866704+0.0629706im    -0.205388-0.0779856im     -0.157976-0.0614122im   -0.0196242-0.159662im       0.140747-0.100776im     -0.318061-0.157097im    -0.00524916-0.115451im     0.0102767-0.0551359im     0.111333+0.14044im      0.0668187-0.0132037im</code></pre><p>and then generate the state <span>$ψ$</span></p><pre><code class="language-julia hljs">psi = P[:, 3]</code></pre><pre><code class="nohighlight hljs">32-element Vector{ComplexF64}:
  -0.017325481856264657 + 0.08168555241432594im
   -0.23078032058455597 - 0.12474888334960958im
    0.07151185441671679 - 0.127422476963497im
   -0.22587291839648044 + 0.11473276547779737im
   -0.06459242506975232 + 0.01897446319051947im
   -0.20587863845159884 + 0.037630287053127195im
   -0.07454568335277569 + 0.19006564592461372im
    0.21629191825015984 - 0.05219432442290768im
   0.020895294092724555 - 0.24235933722650943im
    0.21406235495075232 + 0.12516093209793544im
      0.181383574936397 - 0.14809164220516866im
    0.07738394547445492 + 0.06050169576185876im
    0.13756865982143937 - 0.06127776062090981im
    0.12227909172123792 + 0.09403613205006835im
 -0.0013417520201980586 - 0.052450073855054485im
    0.01839955043365913 - 0.03072853461437565im
   0.020592882444413804 + 0.01521993003685129im
    -0.1213963864333342 - 0.15363928240608068im
   0.017574683523505406 - 0.07487254316995501im
    -0.1766852120332357 - 0.02962274920017854im
    0.34345974171122334 + 0.0im
   -0.05312247091871818 - 0.030995290065180675im
    0.06612613579650521 + 0.06635062467384292im
     0.0869061507574627 - 0.19708007020745552im
     0.0865550822577799 - 0.020610142761715907im
  -0.054250852737877615 - 0.15130696316152778im
   0.020708410455698767 + 0.020898111442440612im
   -0.10286581753597028 - 0.10634408930218571im
     0.3006483112166811 - 0.018892438194567828im
  -0.020494349499672306 + 0.1099130062611588im
    0.08664727272597382 - 0.038340705547129865im
   -0.20185226822044433 - 0.009735291552007329im</code></pre><p>In the phase estimation process, we will feed the state to circuit and measure the first <code>n</code> qubits processed by iQFT.</p><pre><code class="language-julia hljs">r = join(ArrayReg(psi), zero_state(N))
r |&gt; PE(N, M, U)</code></pre><pre><code class="nohighlight hljs">ArrayReg{1, ComplexF64, Array...}
    active qubits: 8/8</code></pre><p>Since our phase can be represented by 3 qubits precisely, we only need to measure once</p><pre><code class="language-julia hljs">results = measure(r, 1:N; nshots=1)</code></pre><pre><code class="nohighlight hljs">1-element Vector{BitBasis.BitStr64{3}}:
 011 ₍₂₎</code></pre><p>Recall that our QFT&#39;s bit numbering is reversed, let&#39;s reverse it back</p><pre><code class="language-julia hljs">using BitBasis
estimated_phase = bfloat(results[]; nbits=N)</code></pre><pre><code class="nohighlight hljs">0.75</code></pre><p>the phase is exactly <code>0.75</code>!</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../1.prepare-ghz-state/index.html">« Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a><a class="docs-footer-nextpage" href="../3.grover-search/index.html">Grover Search »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.10 on <span class="colophon-date" title="Monday 20 December 2021 00:06">Monday 20 December 2021</span>. Using Julia version 1.7.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
