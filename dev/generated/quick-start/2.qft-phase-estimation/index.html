<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quantum Fourier Transformation and Phase Estimation · Documentation | Yao</title><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/indigo.css" rel="stylesheet" type="text/css"/><link href="https://yaoquantum.org/assets/favicon-light.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../index.html"><img src="../../../assets/logo.png" alt="Documentation | Yao logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../index.html">Documentation | Yao</a></span></div><form class="docs-search" action="../../../search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../index.html">Home</a></li><li><span class="tocitem">Quick Start</span><ul><li><a class="tocitem" href="../1.prepare-ghz-state/index.html">Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a></li><li class="is-active"><a class="tocitem" href="index.html">Quantum Fourier Transformation and Phase Estimation</a><ul class="internal"><li><a class="tocitem" href="#Quantum-Fourier-Transformation"><span>Quantum Fourier Transformation</span></a></li><li><a class="tocitem" href="#Wrap-QFT-to-an-external-block"><span>Wrap QFT to an external block</span></a></li><li><a class="tocitem" href="#Phase-Estimation"><span>Phase Estimation</span></a></li><li class="toplevel"><a class="tocitem" href="#using-LinearAlgebra"><span>using LinearAlgebra</span></a></li></ul></li><li><a class="tocitem" href="../3.grover-search/index.html">Grover Search</a></li><li><a class="tocitem" href="../4.shor-algorithm/index.html">Shor&#39;s Algorithm</a></li><li><a class="tocitem" href="../5.shor-9-code/index.html">Shor&#39;s 9 qubit code</a></li><li><a class="tocitem" href="../6.quantum-circuit-born-machine/index.html">Quantum Circuit Born Machine</a></li><li><a class="tocitem" href="../7.variation-quantum-eigen-solver/index.html">Variational Quantum Eigen Solver</a></li></ul></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../../man/array_registers.html">Array Registers</a></li><li><a class="tocitem" href="../../../man/symbolic.html">Symbolic Computation</a></li><li><a class="tocitem" href="../../../man/blocks.html">Blocks</a></li><li><a class="tocitem" href="../../../man/automatic_differentiation.html">Automatic Differentiation</a></li><li><a class="tocitem" href="../../../man/simplification.html">Simplification</a></li><li><a class="tocitem" href="../../../man/base.html">Base</a></li><li><a class="tocitem" href="../../../man/registers.html">Abstract Registers</a></li><li><a class="tocitem" href="../../../man/bitbasis.html">BitBasis</a></li><li><a class="tocitem" href="../../../man/extending_blocks.html">Extending Blocks</a></li></ul></li><li><a class="tocitem" href="../../../benchmarks.html">Benchmark</a></li><li><a class="tocitem" href="../../../dev/index.html">Developer Notes</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Quick Start</a></li><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/QuantumBFS/Yao.jl/blob/master/docs/src/quick-start/2.qft-phase-estimation/main.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><p><a href="https://mybinder.org/v2/gh/QuantumBFS/Yao.jl/gh-pages?filepath=dev/generated/quick-start/2.qft-phase-estimation/main.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a> <a href="https://nbviewer.jupyter.org/github/QuantumBFS/Yao.jl/blob/gh-pages/dev/generated/quick-start/2.qft-phase-estimation/main.ipynb"><img src="https://img.shields.io/badge/show-nbviewer-579ACA.svg" alt/></a> <a href="https://minhaskamal.github.io/DownGit/#/home?url=https://github.com/QuantumBFS/tutorials/tree/gh-pages/dev/generated/quick-start/2.qft-phase-estimation"><img src="https://img.shields.io/badge/download-project-orange" alt/></a></p><h1 id="example-qft"><a class="docs-heading-anchor" href="#example-qft">Quantum Fourier Transformation and Phase Estimation</a><a id="example-qft-1"></a><a class="docs-heading-anchor-permalink" href="#example-qft" title="Permalink"></a></h1><p>Let&#39;s use Yao first</p><pre><code class="language-julia hljs">using Yao</code></pre><h2 id="Quantum-Fourier-Transformation"><a class="docs-heading-anchor" href="#Quantum-Fourier-Transformation">Quantum Fourier Transformation</a><a id="Quantum-Fourier-Transformation-1"></a><a class="docs-heading-anchor-permalink" href="#Quantum-Fourier-Transformation" title="Permalink"></a></h2><p>The Quantum Fourier Transformation (QFT) circuit is to repeat two kinds of blocks repeatly:</p><p><img src="assets/qft.png" alt="qft-circuit"/></p><p>The basic building block control phase shift gate is defined as</p><p class="math-container">\[R(k)=\begin{bmatrix}
1 &amp; 0\\
0 &amp; \exp\left(\frac{2\pi i}{2^k}\right)
\end{bmatrix}\]</p><p>Let&#39;s define block <code>A</code> and block <code>B</code>, block <code>A</code> is actually a control block.</p><pre><code class="language-julia hljs">A(i, j) = control(i, j=&gt;shift(2π/(1&lt;&lt;(i-j+1))))</code></pre><pre><code class="nohighlight hljs">A (generic function with 1 method)</code></pre><p>Once you construct the blockl you can inspect its matrix using <code>mat</code> function. Let&#39;s construct the circuit in dash box A, and see the matrix of <span>$R_4$</span> gate.</p><pre><code class="language-julia hljs">R4 = A(4, 1)</code></pre><pre><code class="nohighlight hljs">(n -&gt; control(n, 4, 1 =&gt; shift(0.39269908169872414)))</code></pre><p>If you have read about <a href="generated/quick-start/2.qft-phase-estimation/@ref example-ghz">preparing GHZ state</a>, you probably know that in Yao, we could just leave the number of qubits, and it will be evaluated when possible.</p><pre><code class="language-julia hljs">R4(5)</code></pre><pre><code class="nohighlight hljs">nqubits: 5
control(4)
└─ (1,) shift(0.39269908169872414)</code></pre><p>its matrix will be</p><pre><code class="language-julia hljs">mat(R4(5))</code></pre><pre><code class="nohighlight hljs">32×32 LinearAlgebra.Diagonal{ComplexF64, Vector{ComplexF64}}:
 1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im</code></pre><p>Then we repeat this control block over and over on different qubits, and put a Hadamard gate to <code>i</code>th qubit to construct <code>i</code>-th <code>B</code> block.</p><pre><code class="language-julia hljs">B(n, k) = chain(n, j==k ? put(k=&gt;H) : A(j, k) for j in k:n)</code></pre><pre><code class="nohighlight hljs">B (generic function with 1 method)</code></pre><p>We need to input the total number of qubits <code>n</code> here because we have to iterate through from <code>k</code>-th location to the last.</p><p>Now, let&#39;s construct the circuit by chaining all the <code>B</code> blocks together</p><pre><code class="language-julia hljs">qft(n) = chain(B(n, k) for k in 1:n)
qft(4)</code></pre><pre><code class="nohighlight hljs">nqubits: 4
chain
├─ chain
│  ├─ put on (1)
│  │  └─ H
│  ├─ control(2)
│  │  └─ (1,) shift(1.5707963267948966)
│  ├─ control(3)
│  │  └─ (1,) shift(0.7853981633974483)
│  └─ control(4)
│     └─ (1,) shift(0.39269908169872414)
├─ chain
│  ├─ put on (2)
│  │  └─ H
│  ├─ control(3)
│  │  └─ (2,) shift(1.5707963267948966)
│  └─ control(4)
│     └─ (2,) shift(0.7853981633974483)
├─ chain
│  ├─ put on (3)
│  │  └─ H
│  └─ control(4)
│     └─ (3,) shift(1.5707963267948966)
└─ chain
   └─ put on (4)
      └─ H
</code></pre><h2 id="Wrap-QFT-to-an-external-block"><a class="docs-heading-anchor" href="#Wrap-QFT-to-an-external-block">Wrap QFT to an external block</a><a id="Wrap-QFT-to-an-external-block-1"></a><a class="docs-heading-anchor-permalink" href="#Wrap-QFT-to-an-external-block" title="Permalink"></a></h2><p>In most cases, <code>function</code>s are enough to wrap quantum circuits, like <code>A</code> and <code>B</code> we defined above, but sometimes, we need to dispatch specialized methods on certain kinds of quantum circuit, or we want to define an external block to export, thus, it&#39;s useful to be able to wrap circuit to custom blocks.</p><p>First, we define a new type as subtype of <code>PrimitiveBlock</code> since we are not going to use the subblocks of <code>QFT</code>, if you need to use its subblocks, it&#39;d be better to define it under <code>CompositeBlock</code>.</p><pre><code class="language-julia hljs">struct QFT{N} &lt;: PrimitiveBlock{N} end
QFT(n::Int) = QFT{n}()</code></pre><pre><code class="nohighlight hljs">Main.##276.QFT</code></pre><p>Now, let&#39;s define its circuit</p><pre><code class="language-julia hljs">circuit(::QFT{N}) where N = qft(N)</code></pre><pre><code class="nohighlight hljs">circuit (generic function with 1 method)</code></pre><p>And forward <code>mat</code> to its circuit&#39;s matrix</p><pre><code class="language-julia hljs">YaoBlocks.mat(::Type{T}, x::QFT) where T = mat(T, circuit(x))</code></pre><p>You may notice, it is a little ugly to print <code>QFT</code> at the moment, this is because we print the type summary by default, you can define your own printing by overloading <code>print_block</code></p><pre><code class="language-julia hljs">YaoBlocks.print_block(io::IO, x::QFT{N}) where N = print(io, &quot;QFT($N)&quot;)</code></pre><p>Since it is possible to use FFT to simulate the results of QFT (like cheating), we could define our custom <code>apply!</code> method:</p><pre><code class="language-julia hljs">using FFTW, LinearAlgebra

function YaoBlocks.apply!(r::ArrayReg, x::QFT)
    α = sqrt(length(statevec(r)))
    invorder!(r)
    lmul!(α, ifft!(statevec(r)))
    return r
end</code></pre><p>Now let&#39;s check if our <code>apply!</code> method is correct:</p><pre><code class="language-julia hljs">r = rand_state(5)
r1 = r |&gt; copy |&gt; QFT(5)
r2 = r |&gt; copy |&gt; circuit(QFT(5))
r1 ≈ r2</code></pre><pre><code class="nohighlight hljs">true</code></pre><p>We can get iQFT (inverse QFT) directly by calling <code>adjoint</code></p><pre><code class="language-julia hljs">QFT(5)&#39;</code></pre><pre><code class="nohighlight hljs"> [†]QFT(5)</code></pre><p>QFT and iQFT are different from FFT and IFFT in three ways,</p><ol><li>they are different by a factor of <span>$\sqrt{2^n}$</span> with <span>$n$</span> the number of qubits.</li><li>the <a href="https://quantumbfs.github.io/BitBasis.jl/stable/tutorial/#Conventions-1">bit numbering</a> will exchange after applying QFT or iQFT.</li><li>due to the convention, QFT is more related to IFFT rather than FFT.</li></ol><h2 id="Phase-Estimation"><a class="docs-heading-anchor" href="#Phase-Estimation">Phase Estimation</a><a id="Phase-Estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Phase-Estimation" title="Permalink"></a></h2><p>Since we have QFT and iQFT blocks we can then use them to realize phase estimation circuit, what we want to realize is the following circuit:</p><p><img src="assets/phaseest.png" alt="phase estimation"/></p><pre><code class="language-julia hljs">using Yao</code></pre><p>First we call Hadamard gates repeatly on first <code>n</code> qubits.</p><pre><code class="language-julia hljs">Hadamards(n) = repeat(H, 1:n)</code></pre><pre><code class="nohighlight hljs">Hadamards (generic function with 1 method)</code></pre><p>Then in dashed box <code>B</code>, we have controlled unitaries:</p><pre><code class="language-julia hljs">ControlU(n, m, U) = chain(n+m, control(k, n+1:n+m=&gt;matblock(U^(2^(k-1)))) for k in 1:n)</code></pre><pre><code class="nohighlight hljs">ControlU (generic function with 1 method)</code></pre><p>each of them is a <code>U</code> of power <span>$2^(k-1)$</span>.</p><p>Since we will only apply the qft and Hadamard on first <code>n</code> qubits, we could use <code>Subroutine</code>, which creates a context of a sub-scope of the qubits.</p><pre><code class="language-julia hljs">PE(n, m, U) =
    chain(n+m, # total number of the qubits
        subroutine(Hadamards(n), 1:n), # apply H in local scope
        ControlU(n, m, U),
        subroutine(QFT(n)&#39;, 1:n))</code></pre><pre><code class="nohighlight hljs">PE (generic function with 1 method)</code></pre><p>we use the first <code>n</code> qubits as the output space to store phase <span>$ϕ$</span>, and the other <code>m</code> qubits as the input state which corresponds to an eigenvector of oracle matrix <code>U</code>.</p><p>The concentrator here uses <code>focus!</code> and <code>relax!</code> to manage a local scope of quantum circuit, and only active the first <code>n</code> qubits while applying the block inside the concentrator context, and the scope will be <code>relax!</code>ed back, after the context. This is equivalent to manually <code>focus!</code> then <code>relax!</code></p><p>fullly activated</p><pre><code class="language-julia hljs">r = rand_state(5)</code></pre><pre><code class="nohighlight hljs">ArrayReg{1, ComplexF64, Array...}
    active qubits: 5/5</code></pre><p>first 3 qubits activated</p><pre><code class="language-julia hljs">focus!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{1, ComplexF64, Array...}
    active qubits: 3/5</code></pre><p>relax back to the original</p><pre><code class="language-julia hljs">relax!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{1, ComplexF64, Array...}
    active qubits: 5/5</code></pre><p>In this way, we will be able to apply small operator directly on the subset of the qubits.</p><p>Details about the algorithm can be found here: <a href="ttps://en.wikipedia.org/wiki/Quantum_phase_estimation_algorithm">Quantum Phase Estimation Algorithm</a></p><p>Now let&#39;s check the results of our phase estimation.</p><p>First we need to set up a unitary with known phase, we set the phase to be 0.75, which is <code>0.75 * 2^3 == 6 == 0b110</code> .</p><h1 id="using-LinearAlgebra"><a class="docs-heading-anchor" href="#using-LinearAlgebra">using LinearAlgebra</a><a id="using-LinearAlgebra-1"></a><a class="docs-heading-anchor-permalink" href="#using-LinearAlgebra" title="Permalink"></a></h1><pre><code class="language-julia hljs">N, M = 3, 5
P = eigen(rand_unitary(1&lt;&lt;M)).vectors
θ = Int(0b110) / 1&lt;&lt;N
phases = rand(1&lt;&lt;M)
phases[0b010+1] = θ
U = P * Diagonal(exp.(2π * im * phases)) * P&#39;</code></pre><pre><code class="nohighlight hljs">32×32 Matrix{ComplexF64}:
  -0.250009+0.12688im       -0.103988+0.219526im      0.339074+0.0457167im     -0.150218+0.042728im    -0.0177444+0.129203im      0.0751668-0.225624im     0.0225078+0.122833im      0.106184+0.0815739im     0.0158637-0.00365502im    0.0903662-0.0413233im      0.267605+0.103952im     -0.0869309+0.177979im      0.069829-0.145886im        0.0258506-0.008048im     0.0182817+0.165361im     -0.0123917-0.153201im         0.14481+0.0364583im     0.275742-0.231608im     -0.0778969+0.00728502im    0.0135437-0.187817im       0.127282-0.0647628im     0.120144+0.261622im       0.113438-0.0123338im    0.00967587-0.0361736im    -0.0701532-0.0241375im    -0.0159602-0.0389777im    -0.109948-0.139716im      -0.0225228+0.0640153im      0.114963+0.108891im       0.0391937-0.112259im      0.0321056+0.0790818im        0.03311-0.0390752im
 -0.0711492+0.167282im      -0.096953-0.038945im    0.00804184-0.0925123im       0.19902-0.114284im   -0.00722752-0.0688454im   0.000813216+0.0277347im   -0.0173061+0.0825839im     -0.19026-0.0972868im     -0.014455+0.0715022im    -0.0726219+0.0480916im      0.198925+0.0137951im     -0.176001-0.12214im      0.0497458+0.0244197im       0.0116989-0.0365042im     0.333304-0.139525im      0.0757925-0.357118im       -0.133449-0.102772im    -0.0801719+0.0670265im     0.0116477-0.187694im     -0.0781437+0.0787899im      0.068626+0.0232785im   1.91703e-5+0.0308507im     -0.152789-0.0938635im     -0.150155-0.182065im     -0.0199723+0.0350327im      0.124956-0.131299im     -0.133884+0.0881474im      -0.246092-0.20751im      -0.0853581+0.157111im        0.152761-0.211784im     -0.0670902+0.00573692im    -0.0360471+0.136561im
  -0.112972+0.102671im      -0.266484-0.10757im     -0.0364627+0.125351im       0.194286-0.0652004im   -0.0553731-0.192617im       0.210755-0.314981im     0.0581098+0.0741844im    0.0740775-0.265743im       0.132961+0.145734im     -0.0120776+0.041999im     -0.0652637-0.112185im      -0.062701-0.0765895im   -0.0256352+0.106241im        0.0505776+0.0249899im   -0.0678568+0.0647573im    -0.0467095+0.162266im      -0.0628297+0.152298im     0.0183926-0.047173im     -0.0901182-0.0493142im     -0.104732+0.126785im     0.00304144-0.0508275im     0.138276+0.0272862im     -0.105757-0.285313im       -0.16822+0.151414im      0.0729608+0.205303im        0.13119+0.0481481im    -0.103082-0.04951im         0.217198+0.121126im     -0.0319322+0.093282im       -0.138306+0.0833311im    -0.0263472-0.104364im        0.115209-0.101143im
  0.0382722+0.193707im       0.189467-0.0448564im     0.223503+0.0601537im    -0.0886127-0.152554im    -0.0654941+0.0263341im      0.192019+0.160232im    -0.0171073+0.121269im      0.011335+0.000218013im    0.269989+0.080315im       0.185579-0.130806im    -0.00752313-0.120125im      0.0155186-0.0130011im     0.131009-0.130448im         0.145105-0.137974im     -0.099404-0.0482088im    -0.0837364-0.147493im       -0.158982-0.0357261im   -0.0217311-0.0329011im    -0.0843076+0.0730014im     -0.194241+0.118414im     -0.0304612-0.0544204im   -0.0931508-0.188837im     -0.0806985+0.0618818im      0.112918-0.0779705im   0.000212732-0.0388761im   -0.00887202+0.0257867im    0.0708932-0.320378im         0.27338-0.0515731im      -0.14958+0.0130698im      0.0181832+0.0961897im   -0.00881883-0.0370693im      -0.101289+0.306373im
  -0.139176-0.00426331im   0.00373724+0.144786im     0.0295853+0.115121im     -0.0145159+0.172883im     -0.127298-0.0906405im    -0.0735428+0.122568im     0.0715647-0.0686794im     0.137782+0.184801im        0.17102-0.356359im      -0.117686-0.0623901im    -0.0554497+0.000146583im   -0.181739-0.109575im     -0.182841+0.114818im        0.0149701-0.149305im    -0.0422542-0.0586686im     0.0867044-0.312566im       -0.121727-0.0214588im   -0.0535549+0.0322808im      0.133835-0.137031im       0.232964+0.0520823im      0.105955-0.0757603im    0.0479043-0.124436im      0.0243937-0.063242im     -0.0184964-0.026139im    -0.00048026+0.102374im       0.172422+0.17545im     -0.0458626+0.099713im        0.219345+0.150851im        0.14371+0.0701519im     -0.0906244+0.0527738im      0.240783+0.0332989im     -0.0171423+0.0532223im
 -0.0146475-0.0683607im     -0.251076+0.0754064im   -0.0265246+0.0182467im      0.158434-0.0226798im    0.0688562+0.0317564im    -0.0517864-0.223141im     -0.142593+0.173148im     0.0709546+0.023968im     -0.0498563-0.0824269im    -0.0263458+0.100493im      -0.184754-0.100623im       0.272923+0.204861im    -0.0470228-0.0157674im       0.0915659-0.0121896im     0.114037-0.0853355im    0.00554888-0.0734403im       0.048518+0.0773257im     0.068768+0.205625im       0.127064-0.0372864im     -0.126153+0.175593im     -0.0209195-0.426432im    -0.0547489+0.03464im       0.0740521+0.0800614im    -0.0127117-0.142514im      0.0262497-0.0739105im     -0.026625-0.119628im     0.0839578-0.0459658im      0.0404494-0.0355216im    -0.0880459-0.131014im       0.0844246+0.0451356im      0.322709+0.220627im       -0.054666+0.080677im
  -0.204395+0.0563358im      0.194637-0.0824169im     0.044343-0.18424im        0.131612+0.0814474im     0.133775-0.100389im      -0.162718+0.0898193im   -0.0638105+0.145321im    -0.0925483-0.193839im       0.233935+0.0516481im     0.0959882-0.0512164im    -0.0526931-6.45926e-5im    0.0651187+0.173814im    -0.0342557-0.0248625im       -0.141473+0.107925im     -0.227318+0.0481896im      0.102232-0.016119im      -0.0530794+0.017643im     0.0605318+0.249094im      -0.172072+0.111772im        0.18459-0.0505461im     0.0824392-0.0967847im   -0.0559089-0.214681im       0.261668-0.0358778im    -0.0506115-0.0684958im     0.0817894+0.00764056im    0.0376478-0.245444im    -0.0565296+0.0637864im      0.0241583+0.132043im      0.0147566+0.266953im        0.164727-0.0490551im    -0.0419705-0.00351939im   -0.00433956-0.15992im
   0.141377+0.186824im      -0.150787-0.160287im    -0.0113128-0.0990568im     0.0367895+0.198608im     0.0472338+0.0105758im       0.12403+0.0106405im     -0.16708+0.00790947im  -0.0952049+0.218822im       0.147187+0.128253im     -0.0594061+0.151094im     -0.0607237-0.166687im      0.0383687-0.0574982im     0.074001-0.0428258im        0.104766+0.133238im     -0.182788+0.220859im      0.0446497-0.293456im        0.286766-0.00715511im   0.0660104-0.11984im       -0.192394-0.127076im       0.164084+0.00580825im    -0.256099+0.0460307im    0.0196457-0.133906im     -0.0581238+0.162935im     -0.0309801-0.00926248im    -0.096244+0.0030706im      0.163736+0.0887803im   -0.0766451+0.0947972im      -0.110429-0.00866041im    -0.125947-0.132358im    -0.000381555+0.0825838im     0.0994741-0.0354659im    0.000211137-0.124693im
    0.24536-0.0466201im    -0.0683705-0.0852843im    0.0390273+0.0174075im     -0.142846+0.13264im       0.099447-0.137234im      0.0212425-0.0492599im     0.142371+0.122388im     -0.123016-0.0652497im     -0.241004+0.100336im      -0.241292-0.122227im      0.0486067+0.139005im      -0.117273+0.118725im    -0.0286147-0.131315im        0.0895623-0.142093im     0.0842995-0.167315im     0.00645529-0.0952711im      0.0868211+0.117148im     0.0219598+0.0768617im     -0.123119-0.126261im      0.0465172-0.0186201im    -0.0878028+0.168091im     0.0712456-0.100576im        0.18234-0.139822im     -0.0812156+0.159875im      0.0896231-0.224576im      0.0261387-0.0674605im   -0.0916116-0.0205338im       0.256418+0.25492im      -0.0603195-0.120436im        0.188271+0.0425814im    -0.0455006+0.107088im       -0.194744+0.10386im
  -0.109495-0.18528im        0.247911+0.0904711im    0.0308511-0.0250312im    -0.0545728-0.0806676im     0.121968-0.221049im     -0.0165449-0.1846im        0.217593-0.0249037im   -0.0266874+0.0458909im     0.0176298+0.0402679im     0.0864346+0.116243im       0.206503+0.0190637im      0.100041+0.138505im     -0.043553-0.0857496im        0.241838+0.171852im     0.0651283+0.182046im      -0.127355-0.080925im      -0.0180403+0.0798649im    -0.122279+0.172846im      0.0961818-0.152867im       0.105359+0.0884419im     -0.048319-0.104776im     -0.325273-0.0459475im    0.00419039+0.00380661im    0.0306486+0.182958im     0.00598863+0.0157551im      0.272644+0.169275im    -0.0621272-0.0977561im     -0.0822188-0.0374433im     0.0188529-0.12781im        -0.155165-0.122647im      -0.144275-0.0480598im     -0.0937416-0.0157389im
   0.311592-0.0179284im     0.0876068+0.13555im      -0.191705+0.00528939im    0.0266342+0.11985im     -0.0218003+0.121073im      0.0128552+0.0673723im  -0.00574144-0.0674536im     0.109064-0.135988im       0.143771+0.25639im        0.269843+0.0658929im     -0.153243+0.117124im       0.151335-0.0474537im     0.153711-0.0557552im      -0.0558317+0.0784928im     0.140937+0.0123234im    -0.0413479-0.0714988im     -0.0978268+0.0544072im     0.317901+0.0854079im     0.0470089-0.0537787im      0.017118+0.0219261im      0.166677-0.00682948im   0.0899394+0.083679im     0.00261325-0.051958im    -0.00897984-0.0179297im    -0.0248605-0.0684116im      0.235635+0.146303im      -0.21352+0.1357im         0.0483849-0.00408537im     0.326962-0.0351825im      0.0982543+0.0887727im    -0.0340987+0.0353598im      0.0213464+0.176593im
  -0.114349+0.0697071im   -0.00771963+0.0124867im    -0.177758-0.212589im       0.242568+0.182465im     0.0148711-0.037685im    -0.00826866-0.122386im     -0.011873+0.0551064im    0.0218621+0.0308168im     0.0743494-0.167281im       0.110449+0.025931im    -0.00608406+0.0515092im     0.0880688+0.00174395im    0.210739-0.0924064im       -0.223916-0.288266im   -0.00402336-0.0565015im      0.160331-0.00951148im    -0.0483177+0.239037im    0.00280369-0.132507im    0.000980329-0.265949im     0.00511692+0.0470994im      0.119941+0.0332609im    -0.125922+0.0174928im    -0.0539319+0.159422im      0.0892911+0.23992im       -0.177982+0.13004im       -0.250659+0.00245008im   0.0034552-0.074286im     -0.00984361+0.133073im     -0.0233364-0.15109im         0.043303-0.0353499im     -0.175355-0.138849im       -0.165292+0.0739965im
   0.141961-0.0746076im     0.0713933+0.175984im    -0.0135574-0.180939im      0.0438994-0.0757346im    -0.249647-0.0771923im      0.132415+0.0708671im     -0.11837+0.0907772im    0.0862702-0.209888im      0.0555694-0.0318726im     -0.141915-0.0971729im      0.159447-0.0287276im     0.0351467-0.0427665im   -0.0567429+0.151279im         0.144198-0.0530825im    0.0532078+0.14802im      -0.0934815-0.0787706im      0.0222768+0.0551632im     0.102224-0.0329017im    -0.0681713-0.201305im      0.0571676+0.129373im       0.126955-0.0760639im    0.0831765-0.132801im       0.218444-0.128429im       0.192354+0.151139im     -0.0442992-0.181651im       -0.22348+0.118031im      0.159466+0.0523643im      -0.232581-0.101813im      -0.115283+0.131816im      -0.0365984+0.241017im     -0.0790582+0.139588im        0.113966-0.0979742im
 -0.0650366-0.232923im     -0.0530763-0.0063562im     0.144007-0.086549im      -0.109063-0.182686im     -0.219009+0.148634im      0.0538193+0.0288571im   -0.0760211+0.0254527im   0.00016823+0.0220883im        0.2126+0.109011im      -0.115176-0.161428im     0.00804986-0.0112392im      0.128944+0.0244964im   -0.0419524+0.112655im        -0.328417+0.103077im      0.303106-0.0525054im    -0.0544616-0.00458232im      0.184499+0.0175124im     0.100044+0.057057im     -0.0203522-0.206914im      -0.143914-0.0694596im   -0.00596611+0.149541im     -0.171172-0.185916im       0.073676+0.106856im      -0.145219-0.123358im       0.122757+0.12997im      -0.0651651+0.0336057im    -0.175001+0.00945904im      0.115547+0.0747226im    -0.0047426-0.0955722im      -0.200102-0.0216921im     0.0522592-0.103052im       -0.136969-0.12462im
  0.0140534-0.0545831im      0.108414-0.162874im      0.101216+0.314152im      0.0361593+0.0553733im    -0.239351+0.0134666im     0.0144202-0.0454687im     0.121635+0.0539758im     0.184191-0.0879021im      0.142228-0.0733647im     -0.328162+0.180241im      0.0987365+0.121611im       0.261231-0.00417058im    0.155697-0.10769im        -0.0249725+0.0832337im    -0.146989+0.0727592im     -0.081066-0.00168215im    -0.0921419-0.226138im     -0.104413+0.0603752im     0.0643515-0.0428568im     0.0414902-0.0432512im    -0.0857505-0.0768946im     0.159837-0.0216196im     -0.116441+0.0852367im    -0.0130945+0.0607339im     0.0853382+0.0793579im     -0.187895-0.136592im     -0.247374+0.0452969im      -0.204651+0.108894im      0.0366011-0.0219686im       0.126433+0.0670318im    -0.0661462+0.0567089im       -0.10381+0.133295im
  -0.146296+0.0544979im     -0.137137+0.0153635im    -0.134199+0.191227im    -0.00669414+0.141058im     0.0741791+0.136263im      -0.040828+0.0817838im    0.0300988-0.184372im     -0.221611+0.0322341im     -0.113604-0.0817952im    0.00620129-0.216757im     -0.0160375+0.0158575im     0.0850596+0.0680375im     0.150598+0.145681im        0.0902851-0.169975im    -0.0521447+0.205444im       -0.26058+0.138865im       -0.016396-0.00243615im     0.15888+0.0254148im    -0.0984259+0.0299049im    -0.0772493+0.135253im       0.178592-0.0273865im       0.1681-0.264522im       0.146201+0.0241369im    -0.0149569+0.0543395im      0.152264+0.089281im      0.0751366+0.12451im      -0.149518-0.0135276im      -0.180321-0.101784im      -0.162182+0.00567591im    -0.0287104-0.232551im      0.0621346-0.0388695im      -0.200256+0.105338im
 -0.0930285-0.0533831im    0.00838486+0.118563im     0.0401759-0.0792163im      0.314179-0.0453877im    -0.050391-0.0311552im      0.231039+0.0141292im     0.258657-0.105583im     -0.114605-0.0642508im     0.0388784-0.0103477im     0.0402249-0.0453208im      0.178241-0.0834166im     0.0294373-0.0541731im     0.111002+0.108032im        -0.134934+0.032842im    -0.0562318-0.0611334im     0.0952036-0.059499im       0.0437373+0.148712im     -0.120304-0.00702585im     0.034071+0.308182im     -0.0324001+0.0484006im     -0.118936+0.254408im     0.0483522+0.092253im       0.227327+0.11924im     -0.00925718+0.086981im      0.0881092-0.0923657im      0.149068-0.0771439im   -0.0128025-0.082076im       -0.193035+0.0140534im      0.131679-0.0976836im     -0.0391805+0.217211im       0.321115+0.0959091im     -0.0863549+0.131026im
 -0.0376817-0.112822im     -0.0938631+0.241967im    -0.0569944-0.0355895im    -0.0503448+0.0508359im   -0.0356028-0.046634im       0.155286-0.0673629im    -0.210357+0.0804782im    -0.208381-0.0704991im     -0.316498-0.0574136im    0.00845286-0.22274im        0.248924-0.137876im       0.227636-0.0259235im   -0.0870084-0.172614im        0.0662017+0.0699403im     -0.10868+0.0480856im     0.0224369+0.0173979im      -0.118418-0.147884im     0.0966691+0.130943im     -0.0422237+0.033886im       0.144992+0.0701636im    -0.0293858+0.120137im    0.00961945-0.0407162im     -0.178648+0.0900045im    -0.0506565-0.122601im      -0.172377+0.290756im    -0.00230969-0.08882im      0.0258758+0.109177im        0.138548+0.0147691im      0.152667+0.0633788im     -0.0226144+0.22669im      -0.0615777-0.0884613im     -0.0766282+0.112597im
 0.00158087+0.00144163im     0.154875-0.100679im     -0.108604+0.0825437im     0.0217089-0.0747996im    0.0961128-0.0574007im    -0.0407329-0.197758im     0.0630819-0.136185im      0.158217+0.146991im     -0.0761574+9.54784e-5im    0.0813419-0.0272474im     0.0810742+0.095461im     -0.0733244+0.0782484im     0.126079+0.190809im          0.03747+0.18589im       0.245777+0.0907429im     0.0990219-0.0331934im      -0.310181+0.0850355im    0.0536225-0.0610403im     -0.286746+0.126316im       0.210713+0.0919552im     0.0248785+0.045767im     0.0421119-0.141149im     -0.0520933+0.0796812im      -0.12977-0.146792im      -0.200814-0.0996159im     -0.287316-0.054141im     -0.186286+0.0132878im       0.134771-0.0610671im     -0.156422-0.0549696im     -0.0961658+0.127181im       0.139732+0.101105im       0.0104082-0.0486597im
  0.0240651-0.139242im        0.20979+0.0211923im   -0.0529501+0.0862587im      -0.12163+0.0161583im    0.0933564-0.135105im     -0.0465986-0.0182309im    -0.104195-0.200102im     -0.259972-0.092489im     -0.0320255-0.0421895im     -0.169311+0.193713im      -0.121631+0.0905935im     0.0833909+0.108071im      0.179246-0.00526647im      0.0541012-0.102959im     0.0160451+0.142494im      0.0288071-0.273366im       -0.076858+0.0468579im   0.00602981-0.202087im     -0.0659642-0.0589209im      -0.38267+0.113869im     -0.0700015+0.0805638im   -0.0724756+0.167053im       0.168112+0.0884882im     0.0642917-0.0326158im     0.0761885+0.192277im     -0.0361605-0.100133im     0.0232846+0.0955384im       0.132694+0.0716462im     0.0540391+0.226737im      -0.0900676+0.0522836im     0.0912776-0.00723074im       0.18963-0.0569591im
  -0.138211-0.126323im      -0.182448-0.0371072im   -0.0440727-0.137529im     -0.0952006-0.293044im      0.104189+0.136922im     -0.0201965+0.0676112im    -0.106791-0.135082im      0.202657-0.0336238im    -0.0257362+0.119099im    0.000134281-0.133754im      -0.114116+0.00482281im      0.28189+0.0321484im    0.0521345+0.0261439im          0.1149-0.132342im     -0.139519+0.131545im       0.115155-0.0900621im     -0.0605073+0.00905477im   -0.346795-0.187441im      -0.217961-0.178002im       0.181386-0.046576im      0.0540738+0.0979744im   -0.0410621+0.000687831im  -0.0540914-0.14487im       -0.131832+0.0624193im      0.123962-0.0637408im     0.0235697-0.0616855im    0.0310906-0.0333083im      -0.012458-0.0218319im      0.236092-0.0162328im      0.0556007-0.114891im       0.043487+0.171264im       0.0464559+0.15663im
  0.0817431-0.0518037im    -0.0757285+0.10306im     0.00162031-0.186733im       0.196142+0.10054im      -0.236004+0.00653987im    -0.137298-0.0539331im    -0.195456-0.179888im     0.0371108+0.139771im     -0.0550028+0.119135im     -0.0632022-0.232563im       0.104228+0.127428im      -0.156732-0.206643im      0.128482-0.0545456im        0.188707+0.0911177im    -0.158359-0.122244im     -0.0590444+0.0414235im      -0.192434-0.116595im     -0.031525+0.0520706im     -0.129681+0.0396542im     -0.173861+0.0244033im     -0.103539-0.169315im     -0.241496+0.0613255im     0.0269303+0.00514996im    0.0938882+0.0752134im      0.101003+6.93277e-5im   -0.0324668+0.0323571im    -0.237418-0.163667im       0.0339165+0.101343im       0.101041-0.0556077im       0.145769-0.104629im       0.116251+0.000591016im    0.0482692-0.234755im
  0.0506862+0.126898im      -0.029609+0.18397im      -0.234376+0.0712198im    -0.0190842+0.0108061im    0.0204369-0.0612873im     -0.100256+0.0683417im   -0.0710656-0.140237im     0.0222905+0.089282im       0.187696-0.127261im     -0.0805864+0.0350911im      0.359133-0.0796476im       0.18389+2.84374e-5im   0.0409527-0.011458im         -0.12919+0.0539118im    0.0113716+0.0805704im     -0.128575+0.1734im        -0.0700685+0.150323im    -0.0397738-0.0483144im      0.111791-0.148422im     -0.0628476-0.0824025im    -0.0595645+0.1011im       0.0168962+0.0293642im    -0.0793485+0.105366im      -0.285013-0.0981513im      0.068293-0.218034im       0.170557+0.0363024im     0.145347-0.163948im        0.166199+0.0673528im     -0.169667+0.160971im        0.288085+0.0283846im    -0.0308186+0.103894im       0.0761789-0.111538im
  -0.112739-0.100117im      -0.119667+0.0935663im    -0.109352+0.0397467im     -0.116998+0.0782397im    -0.205105+0.065713im      0.0130642+0.160777im      -0.17912-0.0278943im    -0.104516+0.0435072im     0.0501334-0.0716016im        0.1297+0.0893236im    -0.0112882-0.108534im     -0.0617299+0.262493im    -0.0995774+0.0812705im      -0.0917962+0.0736992im     0.212549+0.0304659im       0.13438-0.0733476im      -0.139304-0.0661068im   -0.0586071-0.0604441im    -0.0211218+0.175359im       0.014206-0.00615582im     -0.33591-0.142092im     0.0682134-0.0338483im      0.185628-0.151781im     -0.0967148+0.263808im     -0.0475868+0.0669im       0.00317994-0.00463044im   -0.130511-0.132933im      -0.0324034+0.0329108im    -0.0684527-0.165347im        0.135526+0.013179im      -0.242812-0.0648721im       0.230608+0.194128im
  0.0597987+0.0219387im     0.0275306-0.149952im     0.0379298-0.0504504im      0.127496-0.186924im      0.177499-0.0467413im     -0.156682-0.0761823im    -0.108263+0.0328548im     0.125317+0.0399199im      0.060788-0.206065im      -0.184011+0.0592019im      0.141462-0.0139053im     0.0669899+0.0696356im     0.155983-0.0519851im    -0.000252215-0.182339im      0.048037-0.118756im       0.122983-0.0133306im      0.0198334-0.263462im      0.345007+0.193047im     -0.0930988+0.111769im    -0.00226032+0.0434634im    -0.0169409+0.22622im        0.10833-0.113706im      0.0246384-0.0467363im    -0.0183834+0.102409im      0.0509244+0.129832im       0.125502+0.170692im      0.125241-0.229769im     -0.00535868-0.0995644im      0.161584-0.172637im      -0.0767066-0.0444168im    -0.0547139+0.0738748im       0.244544-0.0681121im
   0.137899+0.139451im       0.067233+0.0381026im   -0.0476388+0.18117im      -0.0526273+0.146902im     0.0764543+0.038661im     -0.0402152-0.0814891im    -0.129195-0.115801im     0.0864505-0.0884731im      0.119137-0.0398577im     0.0833491+0.0154491im      0.092466+0.0402988im    -0.0820006+0.163336im     -0.394425-0.0967004im       -0.020887+0.0892246im  -0.00846592+0.00385482im     0.114299+0.0277839im    -0.00164866+0.094319im      0.085109-0.00295372im    -0.152428-0.0900538im    -0.0791945+0.0579158im    -0.0116766+0.217814im     -0.232901-0.028264im      -0.153016-0.248955im      0.0612228-0.00222589im       0.2359+0.146377im      -0.162524-0.011805im     0.0648298-0.104342im       -0.297442-0.016906im      0.0344366-0.0272889im      0.0960799+0.0575222im       0.28453-0.0859704im     -0.0931515+0.116088im
 -0.0403683-0.0272787im      0.137158+0.00391939im    0.209576-0.00767211im    0.0273099-0.0971278im   -0.0371813-0.252303im      0.0154714-0.0047353im   -0.0526022+0.107234im     -0.136064+0.0970496im    -0.0136741-0.0590548im     0.0992313-0.196735im      -0.203612-0.0980236im    -0.0639831+0.171522im      0.116353-0.112842im        -0.233665-0.0182477im   -0.0405304+0.145042im     -0.0123086+0.127332im       -0.169021-0.20324im     0.00180989+0.0510954im    -0.0799323-0.143185im     -0.0942602-0.0913034im    -0.0130765+0.0367961im   0.00442272+0.235274im      -0.115873-0.0951549im     -0.152113+0.177431im      -0.029657-0.0775601im     0.0151991+0.30749im     0.00223687+0.279154im      -0.0735228-0.0564793im     -0.135176-0.0803552im       0.150904+0.0695851im      0.216787+0.140391im      -0.0450053-0.0143529im
  -0.207661-0.124968im       0.145665+0.0308821im     -0.19573-0.119319im    -0.00279552+0.171222im     -0.315911-0.169311im     -0.0495029-0.171908im     -0.104667+0.0926168im     0.122637-0.106162im      -0.127227-0.0989229im     0.0961395+0.00504412im    -0.135405+0.0114389im      -0.13806+0.0094762im      0.13688-0.191064im        0.0906268+0.0465415im   -0.0763719+0.010823im      0.0521249-0.0190408im       0.195032+0.0532386im    0.0469992-0.0529468im     0.0389539+0.073392im      -0.135122-0.0627307im    -0.0796826+0.134457im     0.0421877-0.247321im      -0.149704+0.0071314im     -0.191745-0.215562im       0.178736-0.24565im     -0.00249739+0.0696863im    0.0196275+0.000774318im   -0.0759725+0.0216745im   0.000684248+0.0387846im      -0.179768-0.125902im     -0.0319297+0.0823203im      0.0983198+0.210782im
   0.104478-0.13895im      -0.0105227-0.244402im     -0.199759-0.0231587im     -0.136905-0.0239786im    0.0840184+0.102935im      -0.115515-0.126728im    -0.0152638+0.352416im    0.00708528+0.213291im     -0.0380047+0.0109468im      0.229612-0.0415798im      0.351627-0.0177638im    -0.0552679-0.0690632im    0.0953399+0.173871im       -0.0746397-0.0649041im   -0.0777504+0.0746834im     0.0951741+0.00466183im    0.00745806-0.0346114im   -0.0602391+0.0404737im     0.0966157-0.110685im         -0.148-0.158657im     -0.0380575-0.105309im     0.0449499-0.089935im     0.00186106-0.0159864im       0.14136+0.197646im       0.170436-0.0215055im     0.0470284-0.0790304im   -0.0976198+0.114424im       0.0401814-0.0647017im     0.0356259+0.203157im      -0.0631284+0.12965im        0.212641-0.116498im        0.104426+0.137788im
   0.118755-0.0287189im     -0.103564+0.00318623im  0.00903094+0.0991038im      0.129025+0.137467im    -0.0620926+0.0822906im     -0.136599-0.103723im    -0.0367064+0.0863396im     -0.29731-0.0650744im      0.132392-0.030397im     -0.0890945-0.0266161im    -0.0969107-0.0945354im     0.0634983+0.0903489im     0.102399-0.151315im        0.0720361+0.136374im     0.0150476-0.101552im    -0.00510708+0.0406105im      -0.292338+0.0174437im    -0.122042-0.0259192im   -0.00577368-0.202321im       0.216905-0.331812im      0.0306704+0.0945301im    0.0967284+0.109367im       0.175326-0.079455im       0.111665-0.131424im      0.0200215-0.148725im      -0.019932+0.0382391im    0.0454752-0.225686im      0.00438865-0.170289im    -0.00504704+0.00292818im     -0.343189-0.0175155im     0.0733128-0.17632im        0.0317284+0.0314275im
   0.082832+0.007867im     -0.0590311-0.0166233im     0.198283-0.00494387im   -0.0726472+0.0664568im   -0.0214345+0.0207602im     -0.434968-0.037258im     -0.132875+0.177156im    0.00140992-0.0314258im    0.00705279+0.00260989im   -0.0644486-0.0362714im   -0.00666807+0.0100381im       -0.1041-0.14116im       0.144994+0.233581im        -0.136895+0.205397im     -0.134178+0.174802im      -0.197224-0.0108291im     -0.0415736+0.183118im    -0.0327922-0.0185087im     0.0757345+0.0344977im    -0.0700657+0.156437im     -0.0132539+0.158322im    -0.0890851+0.0128997im     0.0368984-0.180265im     -0.0240348-0.0319675im     -0.299133+0.140763im      0.0977875-0.109447im      0.133831-0.061713im      -0.0636734+0.093963im      0.0266347-0.126698im      -0.0671988+0.00192012im   -0.0603757+0.225959im      -0.0679568+0.224564im
    0.28025+0.0211736im     0.0621671+0.0732461im    0.0465755+0.055325im      -0.117106+0.115206im     -0.273155+0.150883im      0.0415232-0.0683096im     0.221027+0.00228941im   0.0285886+0.0296411im    -0.0334067-0.0337139im      0.125267-0.00629591im     0.133328-0.0543593im      0.157528-0.0431307im     0.174319-0.000580748im   0.000384601-0.173393im     -0.116316+0.0551019im      0.319349-0.0578022im   -0.000789561-0.00173641im  -0.0896956+0.132248im       -0.10703+0.0769263im   -0.00909624+0.0719591im      0.128008-0.0770239im    -0.107159+0.0907121im      0.128909-0.237669im      -0.251711-0.163671im      0.0607665+0.118599im      0.0567083-0.0701998im     0.177638+0.139347im      -0.0143858+0.0105529im     -0.227592-0.183687im      -0.0759773-0.141674im     -0.0403452-0.0675846im      0.0597386-0.160353im</code></pre><p>and then generate the state <span>$ψ$</span></p><pre><code class="language-julia hljs">psi = P[:, 3]</code></pre><pre><code class="nohighlight hljs">32-element Vector{ComplexF64}:
   0.05314149991073517 + 0.12750385880760134im
  -0.00885166075618792 - 0.17692214430665387im
 -0.009564588061825936 + 0.10184161085215837im
 -0.053635020156099424 + 0.26688840955387577im
   0.12471441227790038 + 0.06850149175588842im
   0.30830059188324566 + 0.0im
  -0.08617097580330799 + 0.07942908247662304im
  -0.13507905213145593 - 0.06033836661666928im
   0.15232422074997296 - 0.08746328595786139im
     0.192102417940844 + 0.1922006732049604im
  -0.11159454161081941 + 0.08060707316109943im
   -0.1582265089600954 - 0.13818235287791797im
  -0.04267047024314881 + 0.0748966452365948im
   0.19830063075044468 - 0.05480525662425066im
 -0.023055440110042603 - 0.3045975585878832im
  -0.02031073565376426 - 0.00874885077154236im
  -0.10149493990908595 - 0.06665537963771352im
   -0.1326205378764287 + 0.12061743642764082im
  0.061233110724344855 - 0.040552937621912956im
   0.10194265497421363 + 0.10103708106095469im
   0.10799720569401582 + 0.23298359812453667im
 -0.010383863843971494 + 0.015925659819856608im
   0.14675330444696896 - 0.012127119175552058im
    0.1066039882127553 + 0.11975497226540448im
   0.11150422219166406 - 0.18899573233263128im
  0.048506842995994205 - 0.1410178510945582im
   0.09276435056098879 + 0.05782811155785095im
   0.24536952453697783 - 0.09685162917307666im
   0.10691608432438705 - 0.05860460422596959im
    0.0607166282733449 + 0.0183460840060919im
   -0.1271848800857782 - 0.1341949121322818im
  0.061146249546199634 - 0.08606601323077284im</code></pre><p>In the phase estimation process, we will feed the state to circuit and measure the first <code>n</code> qubits processed by iQFT.</p><pre><code class="language-julia hljs">r = join(ArrayReg(psi), zero_state(N))
r |&gt; PE(N, M, U)</code></pre><pre><code class="nohighlight hljs">ArrayReg{1, ComplexF64, Array...}
    active qubits: 8/8</code></pre><p>Since our phase can be represented by 3 qubits precisely, we only need to measure once</p><pre><code class="language-julia hljs">results = measure(r, 1:N; nshots=1)</code></pre><pre><code class="nohighlight hljs">1-element Vector{BitBasis.BitStr64{3}}:
 011 ₍₂₎</code></pre><p>Recall that our QFT&#39;s bit numbering is reversed, let&#39;s reverse it back</p><pre><code class="language-julia hljs">using BitBasis
estimated_phase = bfloat(results[]; nbits=N)</code></pre><pre><code class="nohighlight hljs">0.75</code></pre><p>the phase is exactly <code>0.75</code>!</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../1.prepare-ghz-state/index.html">« Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a><a class="docs-footer-nextpage" href="../3.grover-search/index.html">Grover Search »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.10 on <span class="colophon-date" title="Sunday 19 December 2021 23:08">Sunday 19 December 2021</span>. Using Julia version 1.7.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
