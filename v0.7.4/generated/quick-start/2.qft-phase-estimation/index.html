<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quantum Fourier Transformation and Phase Estimation · Documentation | Yao</title><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/indigo.css" rel="stylesheet" type="text/css"/><link href="https://yaoquantum.org/assets/favicon-light.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../index.html"><img src="../../../assets/logo.png" alt="Documentation | Yao logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../index.html">Documentation | Yao</a></span></div><form class="docs-search" action="../../../search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../index.html">Home</a></li><li><span class="tocitem">Quick Start</span><ul><li><a class="tocitem" href="../1.prepare-ghz-state/index.html">Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a></li><li class="is-active"><a class="tocitem" href="index.html">Quantum Fourier Transformation and Phase Estimation</a><ul class="internal"><li><a class="tocitem" href="#Quantum-Fourier-Transformation"><span>Quantum Fourier Transformation</span></a></li><li><a class="tocitem" href="#Wrap-QFT-to-an-external-block"><span>Wrap QFT to an external block</span></a></li><li><a class="tocitem" href="#Phase-Estimation"><span>Phase Estimation</span></a></li></ul></li><li><a class="tocitem" href="../3.grover-search/index.html">Grover Search</a></li><li><a class="tocitem" href="../4.shor-algorithm/index.html">Shor&#39;s Algorithm</a></li><li><a class="tocitem" href="../5.shor-9-code/index.html">Shor&#39;s 9 qubit code</a></li><li><a class="tocitem" href="../6.quantum-circuit-born-machine/index.html">Quantum Circuit Born Machine</a></li><li><a class="tocitem" href="../7.variation-quantum-eigen-solver/index.html">Variational Quantum Eigen Solver</a></li></ul></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../../man/array_registers.html">Array Registers</a></li><li><a class="tocitem" href="../../../man/symbolic.html">Symbolic Computation</a></li><li><a class="tocitem" href="../../../man/blocks.html">Blocks</a></li><li><a class="tocitem" href="../../../man/automatic_differentiation.html">Automatic Differentiation</a></li><li><a class="tocitem" href="../../../man/simplification.html">Simplification</a></li><li><a class="tocitem" href="../../../man/base.html">Base</a></li><li><a class="tocitem" href="../../../man/registers.html">Abstract Registers</a></li><li><a class="tocitem" href="../../../man/bitbasis.html">BitBasis</a></li><li><a class="tocitem" href="../../../man/extending_blocks.html">Extending Blocks</a></li></ul></li><li><a class="tocitem" href="../../../benchmarks.html">Benchmark</a></li><li><a class="tocitem" href="../../../dev/index.html">Developer Notes</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Quick Start</a></li><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/QuantumBFS/Yao.jl/blob/master/docs/src/quick-start/2.qft-phase-estimation/main.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><p><a href="https://mybinder.org/v2/gh/QuantumBFS/Yao.jl/gh-pages?filepath=v0.7.4/generated/quick-start/2.qft-phase-estimation/main.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a> <a href="https://nbviewer.jupyter.org/github/QuantumBFS/Yao.jl/blob/gh-pages/v0.7.4/generated/quick-start/2.qft-phase-estimation/main.ipynb"><img src="https://img.shields.io/badge/show-nbviewer-579ACA.svg" alt/></a> <a href="https://minhaskamal.github.io/DownGit/#/home?url=https://github.com/QuantumBFS/tutorials/tree/gh-pages/dev/generated/quick-start/2.qft-phase-estimation"><img src="https://img.shields.io/badge/download-project-orange" alt/></a></p><h1 id="example-qft"><a class="docs-heading-anchor" href="#example-qft">Quantum Fourier Transformation and Phase Estimation</a><a id="example-qft-1"></a><a class="docs-heading-anchor-permalink" href="#example-qft" title="Permalink"></a></h1><p>Let&#39;s use Yao first</p><pre><code class="language-julia hljs">using Yao</code></pre><h2 id="Quantum-Fourier-Transformation"><a class="docs-heading-anchor" href="#Quantum-Fourier-Transformation">Quantum Fourier Transformation</a><a id="Quantum-Fourier-Transformation-1"></a><a class="docs-heading-anchor-permalink" href="#Quantum-Fourier-Transformation" title="Permalink"></a></h2><p>The Quantum Fourier Transformation (QFT) circuit is to repeat two kinds of blocks repeatly:</p><p><img src="assets/qft.png" alt="qft-circuit"/></p><p>The basic building block control phase shift gate is defined as</p><p class="math-container">\[R(k)=\begin{bmatrix}
1 &amp; 0\\
0 &amp; \exp\left(\frac{2\pi i}{2^k}\right)
\end{bmatrix}\]</p><p>Let&#39;s define block <code>A</code> and block <code>B</code>, block <code>A</code> is actually a control block.</p><pre><code class="language-julia hljs">A(i, j) = control(i, j=&gt;shift(2π/(1&lt;&lt;(i-j+1))))</code></pre><pre><code class="nohighlight hljs">A (generic function with 1 method)</code></pre><p>Once you construct the blockl you can inspect its matrix using <code>mat</code> function. Let&#39;s construct the circuit in dash box A, and see the matrix of <span>$R_4$</span> gate.</p><pre><code class="language-julia hljs">R4 = A(4, 1)</code></pre><pre><code class="nohighlight hljs">(n -&gt; control(n, 4, 1 =&gt; shift(0.39269908169872414)))</code></pre><p>If you have read about <a href="generated/quick-start/2.qft-phase-estimation/@ref example-ghz">preparing GHZ state</a>, you probably know that in Yao, we could just leave the number of qubits, and it will be evaluated when possible.</p><pre><code class="language-julia hljs">R4(5)</code></pre><pre><code class="nohighlight hljs">nqubits: 5
control(4)
└─ (1,) shift(0.39269908169872414)</code></pre><p>its matrix will be</p><pre><code class="language-julia hljs">mat(R4(5))</code></pre><pre><code class="nohighlight hljs">32×32 LinearAlgebra.Diagonal{ComplexF64, Vector{ComplexF64}}:
 1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im</code></pre><p>Then we repeat this control block over and over on different qubits, and put a Hadamard gate to <code>i</code>th qubit to construct <code>i</code>-th <code>B</code> block.</p><pre><code class="language-julia hljs">B(n, k) = chain(n, j==k ? put(k=&gt;H) : A(j, k) for j in k:n)</code></pre><pre><code class="nohighlight hljs">B (generic function with 1 method)</code></pre><p>We need to input the total number of qubits <code>n</code> here because we have to iterate through from <code>k</code>-th location to the last.</p><p>Now, let&#39;s construct the circuit by chaining all the <code>B</code> blocks together</p><pre><code class="language-julia hljs">qft(n) = chain(B(n, k) for k in 1:n)
qft(4)</code></pre><pre><code class="nohighlight hljs">nqubits: 4
chain
├─ chain
│  ├─ put on (1)
│  │  └─ H
│  ├─ control(2)
│  │  └─ (1,) shift(1.5707963267948966)
│  ├─ control(3)
│  │  └─ (1,) shift(0.7853981633974483)
│  └─ control(4)
│     └─ (1,) shift(0.39269908169872414)
├─ chain
│  ├─ put on (2)
│  │  └─ H
│  ├─ control(3)
│  │  └─ (2,) shift(1.5707963267948966)
│  └─ control(4)
│     └─ (2,) shift(0.7853981633974483)
├─ chain
│  ├─ put on (3)
│  │  └─ H
│  └─ control(4)
│     └─ (3,) shift(1.5707963267948966)
└─ chain
   └─ put on (4)
      └─ H
</code></pre><h2 id="Wrap-QFT-to-an-external-block"><a class="docs-heading-anchor" href="#Wrap-QFT-to-an-external-block">Wrap QFT to an external block</a><a id="Wrap-QFT-to-an-external-block-1"></a><a class="docs-heading-anchor-permalink" href="#Wrap-QFT-to-an-external-block" title="Permalink"></a></h2><p>In most cases, <code>function</code>s are enough to wrap quantum circuits, like <code>A</code> and <code>B</code> we defined above, but sometimes, we need to dispatch specialized methods on certain kinds of quantum circuit, or we want to define an external block to export, thus, it&#39;s useful to be able to wrap circuit to custom blocks.</p><p>First, we define a new type as subtype of <code>PrimitiveBlock</code> since we are not going to use the subblocks of <code>QFT</code>, if you need to use its subblocks, it&#39;d be better to define it under <code>CompositeBlock</code>.</p><pre><code class="language-julia hljs">struct QFT &lt;: PrimitiveBlock{2}
    n::Int
end

YaoBlocks.nqudits(q::QFT) = q.n</code></pre><p>Now, let&#39;s define its circuit</p><pre><code class="language-julia hljs">circuit(q::QFT) = qft(q.n)</code></pre><pre><code class="nohighlight hljs">circuit (generic function with 1 method)</code></pre><p>And forward <code>mat</code> to its circuit&#39;s matrix</p><pre><code class="language-julia hljs">YaoBlocks.mat(::Type{T}, x::QFT) where T = mat(T, circuit(x))</code></pre><p>You may notice, it is a little ugly to print <code>QFT</code> at the moment, this is because we print the type summary by default, you can define your own printing by overloading <code>print_block</code></p><pre><code class="language-julia hljs">YaoBlocks.print_block(io::IO, x::QFT) = print(io, &quot;QFT($(x.n))&quot;)</code></pre><p>Since it is possible to use FFT to simulate the results of QFT (like cheating), we could define our custom <code>apply!</code> method:</p><pre><code class="language-julia hljs">using FFTW, LinearAlgebra

function YaoBlocks.apply!(r::ArrayReg, x::QFT)
    α = sqrt(length(statevec(r)))
    invorder!(r)
    lmul!(α, ifft!(statevec(r)))
    return r
end</code></pre><p>Now let&#39;s check if our <code>apply!</code> method is correct:</p><pre><code class="language-julia hljs">r = rand_state(5)
r1 = r |&gt; copy |&gt; QFT(5)
r2 = r |&gt; copy |&gt; circuit(QFT(5))
r1 ≈ r2</code></pre><pre><code class="nohighlight hljs">true</code></pre><p>We can get iQFT (inverse QFT) directly by calling <code>adjoint</code></p><pre><code class="language-julia hljs">QFT(5)&#39;</code></pre><pre><code class="nohighlight hljs"> [†]QFT(5)</code></pre><p>QFT and iQFT are different from FFT and IFFT in three ways,</p><ol><li>they are different by a factor of <span>$\sqrt{2^n}$</span> with <span>$n$</span> the number of qubits.</li><li>the <a href="https://quantumbfs.github.io/BitBasis.jl/stable/tutorial/#Conventions-1">bit numbering</a> will exchange after applying QFT or iQFT.</li><li>due to the convention, QFT is more related to IFFT rather than FFT.</li></ol><h2 id="Phase-Estimation"><a class="docs-heading-anchor" href="#Phase-Estimation">Phase Estimation</a><a id="Phase-Estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Phase-Estimation" title="Permalink"></a></h2><p>Since we have QFT and iQFT blocks we can then use them to realize phase estimation circuit, what we want to realize is the following circuit:</p><p><img src="assets/phaseest.png" alt="phase estimation"/></p><p>First we call Hadamard gates repeatly on first <code>n</code> qubits.</p><pre><code class="language-julia hljs">Hadamards(n) = repeat(H, 1:n)</code></pre><pre><code class="nohighlight hljs">Hadamards (generic function with 1 method)</code></pre><p>Then in dashed box <code>B</code>, we have controlled unitaries:</p><pre><code class="language-julia hljs">ControlU(n, m, U) = chain(n+m, control(k, n+1:n+m=&gt;matblock(U^(2^(k-1)))) for k in 1:n)</code></pre><pre><code class="nohighlight hljs">ControlU (generic function with 1 method)</code></pre><p>each of them is a <code>U</code> of power <span>$2^{(k-1)}$</span>.</p><p>Since we will only apply the qft and Hadamard on first <code>n</code> qubits, we could use <code>Subroutine</code>, which creates a context of a sub-scope of the qubits.</p><pre><code class="language-julia hljs">PE(n, m, U) =
    chain(n+m, # total number of the qubits
        subroutine(Hadamards(n), 1:n), # apply H in local scope
        ControlU(n, m, U),
        subroutine(QFT(n)&#39;, 1:n))</code></pre><pre><code class="nohighlight hljs">PE (generic function with 1 method)</code></pre><p>we use the first <code>n</code> qubits as the output space to store phase <span>$ϕ$</span>, and the other <code>m</code> qubits as the input state which corresponds to an eigenvector of oracle matrix <code>U</code>.</p><p>The subroutine here uses <code>focus!</code> and <code>relax!</code> to manage a local scope of quantum circuit, and only activate the first <code>n</code> qubits while applying the block inside the subroutine context, and the scope will be <code>relax!</code>ed back, after the context. This is equivalent to manually <code>focus!</code> then <code>relax!</code></p><p>fullly activated</p><pre><code class="language-julia hljs">r = rand_state(5)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>first 3 qubits activated</p><pre><code class="language-julia hljs">focus!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 3/5
    nlevel: 2</code></pre><p>relax back to the original</p><pre><code class="language-julia hljs">relax!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>In this way, we will be able to apply small operator directly on the subset of the qubits.</p><p>Details about the algorithm can be found here: <a href="https://en.wikipedia.org/wiki/Quantum_phase_estimation_algorithm">Quantum Phase Estimation Algorithm</a></p><p>Now let&#39;s check the results of our phase estimation.</p><p>First we need to set up a unitary with known phase, we set the phase to be 0.75, which is <code>0.75 * 2^3 == 6 == 0b110</code> .</p><pre><code class="language-julia hljs">N, M = 3, 5
P = eigen(rand_unitary(1&lt;&lt;M)).vectors
θ = Int(0b110) / 1&lt;&lt;N
phases = rand(1&lt;&lt;M)
phases[0b010+1] = θ
U = P * Diagonal(exp.(2π * im * phases)) * P&#39;</code></pre><pre><code class="nohighlight hljs">32×32 Matrix{ComplexF64}:
  -0.0524104-0.163381im      -0.139621+0.0336388im    -0.0176007+0.112621im      0.131329-0.205887im   -0.00516769+0.0222748im    -0.0197875+0.205372im    -0.00593111+0.058437im     0.00178687-0.0260645im      -0.258458+0.0879912im    -0.0460076-0.0317548im   -0.212306+0.109836im     0.0476509+0.0655049im     0.0511084+0.0317222im    0.0558962-0.0957178im     0.0215081-0.0921586im    0.0175775+0.152849im     0.0293109-0.101554im    0.0193691-0.156579im        0.196849+0.0536991im     0.154065+0.0569726im    -0.0745418+0.16961im       0.180431-0.0201734im   -0.0928075-0.309071im       0.165527+0.0301265im   0.0839095+0.110169im       0.124956+0.181192im       -0.123259-0.0851916im     -0.325787-0.133504im       0.164103+0.0803915im     0.0389942-0.184275im     -0.0189171+0.134842im    -0.0784432-0.167843im
    0.118871+0.168402im     -0.0610295+0.170943im     -0.0384941-0.0553895im     0.256225-0.0366118im    -0.173269-0.0468877im      0.122629-0.119814im      -0.124732-0.221231im       0.246805+0.10686im        0.0397557+0.114522im      -0.127078-0.257668im    0.0412045+0.025089im      0.145723+0.00108058im    -0.129948+0.120647im      0.107688+0.0334583im   -0.00388614+0.0369768im   -0.0708265+0.0962387im    -0.142896+0.161944im    -0.126496+0.000157308im    -0.144755+0.0498733im   0.00446264-0.0809511im     0.0848636-0.00105624im     0.22695-0.17072im      0.0354664-0.000377808im   0.0613706+0.024319im   -0.0232933+0.0669585im     -0.125993-0.159722im      -0.0292928+0.0223716im     -0.196094+0.110979im      -0.100645+0.0727487im     -0.141261+0.048307im      -0.142872+0.0616299im     0.295123-0.200667im
   0.0673404-0.144316im      -0.126191-0.0308456im    -0.0346758-0.121386im     -0.099532+0.114911im      0.126165+0.0115516im     0.0441772-0.134371im    -0.00375283+0.0305353im    -0.0716824+0.193336im        0.186854-0.065521im      -0.210606-0.251106im    0.0623175-0.0404062im    -0.201094+0.0117686im      -0.21527+0.0856505im    0.0512828-0.222521im      0.0478163+0.281943im     -0.106953-0.113444im      0.102873+0.0522554im   0.0411697-0.00615305im      0.172438-0.202536im    -0.0205003+0.0908974im     0.0929131-0.121215im    -0.0450152+0.137943im    -0.0945725-0.414416im     -0.0465609+0.0525847im   -0.122667-0.139019im      0.0463983-0.0172744im     0.00766524-0.041693im     -0.0630341+0.185107im       0.130299-0.0326784im   -0.00552067-0.083923im      0.0272886-0.0198689im    0.0077087-0.0831408im
  -0.0810235-0.105928im      -0.168579+0.0476068im      0.124311-0.183588im     -0.135855+0.0677156im    0.0229788-0.088295im     -0.0357992-0.0320065im      0.166772+0.0570386im      0.134773+0.136352im        0.111238+0.0606254im     -0.105235+0.0259619im  -0.0893352+0.0386893im    -0.104708+0.000689541im   0.0375095+0.00864568im  -0.0343887+0.112349im      0.0206598-0.264735im     0.0901729+0.0971137im    0.0373723+0.035418im   -0.0832028+0.0482706im      0.0055199+0.349258im     -0.258441+0.0883807im    -0.0757419-0.1686im      -0.0991757+0.0534236im   -0.0133143-0.137069im      0.0947708-0.126952im   -0.0212993+0.0123262im    -0.0776947-0.151917im        0.294344-0.081052im      -0.306703-0.133499im     -0.0853839-0.145566im      -0.181341+0.148241im     -0.0299965+0.0753633im    -0.141074+0.0721434im
    0.113714-0.172084im     -0.0626274+0.118566im       0.185132+0.213869im    -0.0368417-0.0743989im   -0.0724041-0.137652im      -0.119729-0.107796im      0.0803185-0.182789im      -0.107516-0.0672824im     -0.0371145-0.217098im     -0.0734988+0.0923538im   0.0237497-0.212161im      0.228925-0.0688045im     -0.154322+0.111874im    -0.0103999-0.0738884im     -0.152292-0.239066im      0.166039-0.192152im     0.0884575-0.0629722im     0.12245-0.062139im       -0.136755-0.0588928im    -0.234099+0.151094im     -0.0204615+0.0612228im    0.0403817-0.00643422im   0.0719673-0.072505im     -0.0239058-0.112589im    0.0994445-0.170676im      0.0885267-0.0510014im      -0.191996+0.0502917im    -0.0254449+0.0476808im      0.038705-0.253012im     0.00615325-0.0669598im    -0.0553322+0.144965im      0.219787+0.0205876im
    0.028534-0.0664571im     -0.236367-0.087403im     -0.0492948+0.0833246im   0.00114653+0.0181007im   -0.0226114-0.0411105im     0.0365736-0.215116im      -0.163671-0.171216im     -0.0428394-0.172516im        0.168571+0.0791476im    -0.0820709+0.116414im    -0.089082+0.0856345im    0.0211215-0.0903735im     -0.052156-0.0714033im    0.0334095-0.0440664im    0.00617227+0.0235634im    -0.240056-0.0974783im    -0.286078-0.29119im     0.0387569+0.0714637im      0.0287854+0.174257im    0.00695865+0.164717im        0.29083+0.0277791im    0.0815704+0.0339306im   -0.0340391+0.065017im      0.0129918-0.278012im   0.00670092+0.187002im     -0.0582429-0.171749im      -0.0320429-0.20063im        0.128198-0.128332im       0.182609-0.0181151im     0.0763689-0.0677769im   -0.00723441-0.100566im     -0.146063-0.0358635im
   -0.100489+0.101379im      -0.065224-0.269949im     -0.0334226-0.0728549im    -0.150796-0.183302im    -0.0845315+0.0354016im     0.0642265-0.0400332im     0.0207042-0.13943im         0.11928-0.0832786im       -0.15489-0.107562im      -0.115619+0.0240019im   0.0998125-0.0737787im   0.00731366+0.0661024im    -0.0387605-0.332291im     -0.225809-0.025378im       0.050799-0.18762im     -0.0773006-0.0547317im    -0.321304-0.0912669im  -0.0513655-0.105904im       0.0690265-0.0761335im    0.0773944-0.126046im     -0.0496392-0.230653im     -0.041597+0.0238441im   -0.0652978-0.218743im      0.0427709+0.0875572im    0.158412-0.19051im       -0.206813+0.0604259im      0.0784178+0.0392665im     0.0688183-0.0138191im    -0.0220813+0.00130347im    0.0953788+0.107383im       0.122095+0.171101im         0.175-0.105596im
  -0.0262056-0.106883im     -0.0300298-0.103722im       0.117067-0.281794im     -0.218976-0.0526802im    0.0635323+0.0680046im     -0.177633-0.0474036im    -0.0170213-0.177938im       0.130411-0.248854im        0.082894-0.0151285im     0.0302252-0.0713295im   -0.079284-0.00771642im    0.108975+0.150164im     0.00806684-0.0833109im    0.0533669+0.00579384im   0.00814784+0.0320985im   -0.0120339-0.00266882im   0.0296285+0.158145im    0.0521651-0.119197im       -0.255744+0.114434im       0.16164-0.114191im     0.00306778-0.096138im      0.158369+0.2037im        0.140037-0.154084im      0.0364784-0.0778665im    0.025024+0.1773im         0.217528+0.0843152im      -0.311915+0.120103im     -0.0252698+0.16585im       -0.115372+0.0383579im    -0.0404559+0.136689im     -0.0507573-0.171328im     -0.156553+0.0953258im
    0.248158-0.0445389im       0.25783+0.183581im      0.0953951+0.0273331im     -0.21213+0.152487im      0.139811-0.00717626im    -0.156197-0.11124im      0.00229465-0.276178im      -0.021661+0.0897698im     -0.0767641-0.0511698im     -0.062772-0.0472656im  -0.0942634+0.233202im     -0.150029-0.255531im     -0.0540705-0.0153002im    -0.214446+0.129445im     -0.0408939-0.130035im    -0.0748666+0.138545im    -0.0012444-0.160698im   -0.0334869-0.113986im       0.0494398-0.0362239im     0.123446-0.250261im     -0.0521702+0.105151im     -0.114418+0.0134886im    0.0381995-0.0427915im     0.0454098-0.0166075im  -0.0522404+0.16449im      -0.0489821+0.153766im        0.106734-0.116389im      0.0185913+0.119493im       0.145993+0.0229919im     0.0128496-0.0176062im     -0.225394-0.00107288im    0.125536+0.0584769im
   -0.236018-0.116644im       0.108676+0.0109368im     -0.204328+0.130629im      0.013398-0.045705im    -0.0176758-0.151915im       0.104203+0.00866684im   -0.0139569+0.0589971im    -0.0278066-0.0278068im        0.24705+0.0749325im   -0.00457996-0.108599im    -0.277327-0.0538626im    -0.133568-0.301582im       0.100995-0.214177im      0.019285+0.0681396im    -0.0889714-0.045345im     -0.108726+0.0960685im    0.0566039+0.257077im      0.21452+0.0812948im      -0.229955-0.192622im      0.133372+0.0121006im    -0.0452806+0.0636619im   -0.0428551-0.0148126im    -0.124701-0.11875im       0.0844844-0.0709289im    0.104027-0.00685752im    0.0947087-0.08132im       -0.0184969-0.110173im      0.0156022-0.107347im     -0.0817949-0.155024im       0.157768+0.202214im     -0.0674075+0.0430889im     0.151719-0.0501832im
   0.0307516+0.0821539im    -0.0251125-0.146606im      0.0459187+0.00953465im   0.0136064+0.121583im    -0.0362746-0.218648im      0.0206687-0.129002im       0.198477+0.142594im       0.241263+0.0292421im      -0.268356-0.191339im      0.0803454+0.0774377im  0.00329039-0.264272im    -0.0659255-0.20381im       0.0892183-0.0694803im     0.143172+0.0179331im     0.0121026+0.12335im      -0.185767-0.0766486im     0.014353+0.0884319im   -0.146209+0.060007im         0.13302+0.120004im    0.00281672-0.12236im       0.0676347+0.0595703im   -0.0579668-0.0300207im    -0.145966+0.0729293im      -0.12636-0.169393im    0.0562395+0.115674im      0.0601425+0.116839im      -0.0832445+0.205824im      -0.234527+0.0865267im       0.22645-0.13521im        0.113142+0.0965149im    -0.0951377-0.139016im     0.0250807-0.10881im
  -0.0648698+0.193173im       0.223521-0.0635302im      0.103795+0.182931im     0.0709386-0.124857im      0.171206+0.0174782im    0.00974246-0.0280972im      -0.12322-0.144507im      -0.168506-0.0699233im    -0.00351136+0.115701im       0.234716+0.0193564im   0.0499259-0.264424im     -0.115883+0.0159718im     -0.199074+0.18947im      0.0214639+0.140433im       0.191782+0.077014im      -0.12705-0.0590632im   -0.0759269-0.0582322im    0.190221-0.169847im       0.0233599+0.0677631im    -0.144588+0.104369im     -0.0342453-0.182975im    -0.0515277-0.0114953im     -0.23832-0.0339443im      0.143797+0.0452852im   0.0818098+0.138847im      0.0951915-0.0308137im      0.0686183-0.0143689im     -0.204411+0.141994im     -0.0330535+0.115507im      0.0317109+0.178619im     -0.0830114+0.14404im     -0.0818222+0.113983im
    0.187369-0.0728152im      0.231676-0.0162447im     0.0334586-0.123687im      0.259154+0.0485563im     0.118858-0.0820072im    -0.0116295+0.181894im       0.113417+0.0968913im     -0.103396-0.180471im       0.0999508-0.0437317im     -0.155433-0.0455651im    0.146087-0.0643523im     0.199649-0.174764im      -0.116918-0.104162im     0.0280025-0.127836im      -0.141956-0.1709im       -0.171998+0.189341im      -0.05634-0.0563282im   -0.017996-0.119793im       -0.106837+0.0875479im     0.123029-0.0431747im      0.119894-0.0803239im     0.081356+0.217298im    -0.0688082+0.167709im      -0.124815+0.194575im    -0.154991-0.150903im      0.0656769-0.0878512im      0.0950805-0.0675997im     -0.200519+0.0252248im     0.0819429-0.0408336im     0.0908435+0.0665502im      0.157664+0.068598im     -0.163425-0.0315265im
    0.276982+0.013453im       0.130064-0.126432im     -0.0590437+0.00575878im    0.129793+0.0671513im   -0.0791948+0.111406im     -0.0264804-0.149871im      0.0471389+0.00397914im    0.0323488-0.0708862im      0.0527075-0.0351483im      0.231435+0.125613im     -0.23622+0.092287im     -0.145449+0.117767im     -0.0809634+0.0813562im   -0.0514467-0.285704im      -0.224766-0.0151072im     0.170119-0.0136996im   -0.0217131+0.0618982im   0.0144769-0.0267978im     -0.0291116+0.0868216im    0.0776672+0.00878297im    0.0235876-0.0357718im    0.0752479+0.0135776im    -0.264234-0.0703059im     0.0571118+0.10063im      0.223367-0.0455349im     0.0522892-0.027302im        0.123281+0.0414859im     0.0480855-0.149248im       0.175659-0.00455773im    -0.320641+0.171176im       0.114061-0.217746im      0.169301+0.0237411im
   0.0366322-0.0824429im     0.0857943-0.0387027im      0.025355-0.00390305im   0.0311951-0.220769im    -0.0408769+0.261265im     -0.0265318+0.0346304im     0.0840151+0.0214413im     0.0696035+0.168383im        0.128443-0.148834im     -0.0974693+0.0568659im   0.0132699+0.0242924im    0.0141192+0.0394887im     -0.118766+0.152889im     -0.224663+0.141947im       0.029645-0.0334976im  -0.00913625+0.0732419im    -0.210735+0.0753929im  -0.0310407+0.21278im       -0.0345045-0.0956813im   -0.0581724+0.124792im      0.0576974+0.320652im     0.0837611+0.196983im    -0.0227978-0.077693im       -0.19418-0.0896252im    0.169665+0.122292im       0.121229-0.068824im        0.230274+0.258298im      -0.110477-0.000151867im  -0.0606165+0.144067im       0.289658-0.00805241im    0.0223359-0.119201im    0.00746526+0.04946im
  0.00383202+0.0282426im      0.100524+0.143858im       0.136457+0.207411im     0.0498647-0.0147688im  -0.00389466+0.0248247im   -0.00669879-0.184591im      -0.095066+0.075092im      0.0315956+0.0884426im      -0.117934+0.244982im      -0.374315-0.0522622im   0.0742752-0.156346im      -0.13318+0.217749im       0.189649-0.15258im      0.0047938+0.00737461im    -0.235418+0.0437586im   -0.0312233-0.0759219im   -0.0583444+0.138252im     0.178045-0.16313im         0.147661+0.177894im     0.0166067-0.0261788im   0.000600188+0.100404im      0.277051+0.0495027im     0.027907-0.00584622im     0.052629+0.0115797im  -0.0800055-0.116882im      0.0100731+0.0544448im       0.138816+0.115775im        0.14047-0.0242221im     0.0441275-0.100912im      0.0947938+0.0979847im    -0.0745337-0.075571im     -0.062549+0.245465im
   -0.253957-0.131397im       0.213559-0.0241889im      -0.12772-0.145704im     0.0177152-0.0675857im    0.0806831+0.236134im      0.0627383-0.326624im     -0.0110297-0.0404132im     0.0617352+0.0282737im      0.0508706+0.0433415im    -0.0465682-0.135104im   0.00352118-0.0641594im    0.0756752+0.0409266im     -0.144976+0.0115447im     0.296235+0.132189im      -0.126288-0.120865im      0.073059+0.0736993im   0.00923512-0.252779im    -0.142473-0.0971071im      0.0368294-0.0315841im    0.0724437+0.137248im      -0.238391-0.102065im     -0.121976-0.0922064im   -0.0458704+0.114475im     -0.0581598+0.131149im    0.0746518-0.0207438im    0.00741655-0.00286756im    -0.0301918+0.139785im    -0.00163479-0.140838im       0.081538-0.18066im       0.0670526-0.152297im      -0.190996-0.199336im    -0.0531877-0.0854407im
  -0.0667736+0.00288956im    -0.115052-0.0394174im    -0.0443852-0.0516971im   -0.0988703-0.0310209im   -0.0118291+0.0312156im      0.279099-0.0221768im     0.0616303+0.229965im       0.197949-0.10943im      -0.00381516+0.0141563im     0.0875361+0.0846668im    0.232232+0.0834698im   -0.0936829-0.118701im      -0.202683+0.101676im     -0.204063-0.129127im      -0.127948-0.0363im       -0.132932+0.0637493im    0.0621982+0.0978184im   0.0221438-0.316081im       0.0388295+0.00452326im    0.044129+0.259302im     -0.0985407+0.0647571im    0.0724675+0.119136im      0.163994+0.152507im     0.00979917-0.0983943im   0.0123104+0.0799164im       0.17493+0.0615415im      0.0850161-0.0161859im      0.191094+0.0402532im      0.021762+0.0353452im     -0.143669+0.0560568im     -0.291337+0.204433im     0.0360389-0.110433im
   -0.119806+0.0426735im      0.121959-0.0206387im     0.0654806-0.0580297im   -0.0183311+0.117195im      0.004937-0.0210027im     0.0386429-0.104101im     -0.0831135+0.15916im        0.072198-0.040661im       -0.238817-0.126875im     -0.0194223-0.0567329im   -0.261035-0.032937im      0.102377+0.157074im     0.00384187-0.0510589im     -0.19105-0.0644008im     -0.215768+0.0665085im     0.045353+0.234009im      -0.16512-0.0577133im    0.147292+0.0947386im      -0.022808-0.172394im     -0.226422+0.0166896im    -0.0208503-0.0658026im    -0.117678-0.140664im      0.129128-0.0376824im    -0.0714184-0.058373im    -0.164406-0.0946143im      0.098944-0.309878im        -0.14405-0.0778561im    -0.0732408+0.0394345im      0.200529+0.312686im    0.000497392+0.100393im      -0.136848+0.0249681im    -0.105652+0.0239333im
 -0.00774577-0.0709475im     0.0854627+0.0998955im    -0.0613158+0.0536141im   -0.0903073-0.044342im     -0.193248-0.145495im     -0.0391695-0.0242505im     -0.106229-0.0640665im       0.04843+0.115422im       -0.105104+0.0221241im     0.0849261+0.207992im    0.0790218+0.0374394im     0.189374+0.0222591im    -0.0958456+0.0796621im     0.189538+0.0558107im   -0.00500176+0.0417989im   0.00400107+0.0517679im     0.153293+0.0483147im    0.146056-0.0542538im       0.248759-0.177809im      0.174972-0.200269im     0.00637216-0.113601im    -0.0772772+0.382991im      0.137539+0.0112197im      0.252994-0.135884im    0.0527609-0.00452769im   -0.0561191-0.358311im        0.143427+0.136561im   -0.000573376-0.0870043im     0.0544627+0.0315508im     0.0134736+0.065737im      0.0806764-0.0473398im   -0.0720171-0.138378im
   0.0184062+0.0815788im    -0.0357141-0.0706376im      0.166366-0.0502035im    0.0751036-0.0863236im    -0.088173+0.0499094im      0.173555+0.0261643im    -0.0424099-0.112346im     -0.0397539-0.154425im        0.164724-0.103825im      -0.141409-0.0188062im  -0.0481694-0.025143im      0.133469-0.0536827im      0.203689+0.0103714im    -0.110504+0.235393im      -0.130807+0.361105im     -0.210857+0.161223im      0.141451-0.117677im      0.10269+0.161998im       0.0508889+0.0322084im   -0.0761637-0.0767047im     -0.279403-0.0455015im    0.0030459+0.220025im    -0.0888065+0.0395411im    -0.0240284-0.0568417im    0.164415-0.105901im     -0.0131913+0.108367im       0.0142567+0.0378265im    -0.0456908-0.0569517im      0.105753-0.0377217im     -0.307856-0.198225im      -0.011933+0.100241im     0.0712452+0.0812278im
   0.0209332-0.0555121im     -0.118222-0.109001im      -0.164487-0.0329778im   -0.0135499+0.191493im     -0.249419+0.117148im      0.0967201+0.0255293im     -0.230141+0.0369704im     0.0222979-0.00639327im     0.0324325-0.0575749im     -0.116432+0.162619im   -0.0870577+0.00647741im  -0.0404418+0.0878872im    -0.0457574+0.107805im    -0.0352729+0.12194im      -0.0307103-0.0664586im    -0.249685-0.0798346im     0.158619-0.0689394im  -0.0366486-0.139206im       -0.142559-0.13634im      0.0395358+0.0162034im      0.180309+0.15393im      -0.145473-0.145877im       0.20955+0.0496655im      0.172505+0.223755im     0.144239-0.109353im     -0.0894703+0.097921im     -0.00602132+0.0627143im     -0.294633+0.0895561im      0.094107-0.0901297im     0.0167633+0.134227im      0.0234144+0.0117044im    -0.104794+0.295366im
    0.105277-0.0846041im    -0.0374897-0.139311im       0.210245+0.0712114im   -0.0373623-0.0911773im   -0.0354415+0.0360681im      0.188612-0.08376im      -0.0536971-0.0702783im      0.108409-0.112273im       -0.146822-0.00455172im    0.0394583+0.0064328im    0.167491+0.108112im     0.0886342-0.0979965im     0.0244032+0.123407im      0.136593-0.105306im      0.0472388-0.0611537im    -0.146632+0.167394im     0.0537958+0.124415im   -0.0799194+0.0167689im       0.111919+0.0311703im   -0.0491101-0.0604302im    -0.0386523+0.271977im     -0.219409+0.00928451im   -0.241689-0.220232im     -0.0880774+0.207841im    -0.101918-0.0349278im    -0.0750031-0.213262im       -0.185061-0.133226im       0.139539-0.158754im      -0.245114-0.0412455im     0.0279308+0.088651im     -0.0924198-0.074348im    -0.0570174+0.264392im
    -0.10542-0.177332im    -0.00615977-0.218913im      -0.170963+0.142221im      0.277648+0.0813158im     0.181496+0.142762im    0.000885267-0.118595im       0.139495-0.180329im     -0.0254834+0.110412im      -0.0100963+0.143888im      -0.118329+0.0947846im   -0.191752-0.0178038im    0.0433577-0.118253im      0.0332767+0.0389621im   -0.0408411+0.0940607im      0.108268-0.147181im    -0.0113752-0.0530596im    0.0578844+0.187005im   -0.0515097-0.224077im         0.16211-0.0240678im   -0.0358354-0.097685im       0.107207-0.018594im    -0.0669546+0.101144im     0.0433889+0.0796971im     -0.230554-0.232196im   -0.0175805-0.207047im     -0.0578853+0.0483639im      -0.151834+0.0577608im    0.00715082+0.0252431im     -0.100823+0.280001im      -0.240925+0.00278638im    0.0216795+0.048541im    -0.0174124+0.0385631im
  -0.0518176-0.108979im       0.160167+0.0177863im     -0.073037-0.109274im    -0.0852013-0.0578186im  -0.00204695-0.0999916im    -0.0466177-0.0271063im      0.189835-0.16612im        0.229969-0.000902653im   -0.0736484+0.0300712im      0.033471-0.0746854im   0.0477237+0.22318im     -0.0596442-0.0664495im     -0.138325+0.199829im      0.137498-0.11355im       0.0758024+0.101751im     -0.165588+0.0753215im   -0.0584395+0.0117621im    0.138365+0.153014im      -0.0435741+0.0356991im   -0.0349807+0.0575412im    -0.0114551-0.0847495im     0.108843-0.19507im        0.01443+0.100384im        0.15357-0.178906im   -0.0929986-0.256322im      0.0539336+0.200191im      -0.0304882+0.159093im      0.0391133-0.230838im       0.110666+0.0764745im      0.126175+0.00416477im     0.228911+0.201727im     0.0209877+0.293515im
    0.121706+0.0768459im     0.0477438-0.150114im     -0.0478042+0.0248115im    0.0736359+0.025491im      0.117506+0.312456im      -0.198853+0.0698427im   -0.00470312+0.00127703im    0.0769579+0.00203425im     0.0693155-0.118278im       0.164664-0.0438265im    0.115885-0.0207895im    -0.187839-0.00718291im     0.029398-0.226021im    -0.0428788+0.105795im     -0.0480285-0.228302im     -0.203392-0.00362929im    0.120201+0.0727981im   0.0432838+0.143233im        0.144819-0.0484756im   -0.0065545+0.0964276im    -0.0893419+0.0918897im     0.184615-0.113145im    0.00275457-0.0204975im      0.260441-0.0838774im   -0.210051+0.0285944im    -0.0780973-0.325025im       -0.183743+0.173307im    -0.00709781+0.0794086im     0.0688655-0.144954im      -0.129549-0.161914im      0.0490895+0.113601im    -0.0334321-0.021194im
  -0.0404712+0.0222453im     -0.200744+0.157051im      0.0159449-0.183465im      0.188668-0.106607im      0.259473+0.0686473im      -0.19523-0.107076im     -0.0556817+0.127269im       0.236747+0.0569695im      -0.109749+0.0974247im    -0.0448719+0.0147702im   0.0669653-0.0138563im    -0.096223-0.207335im     -0.0502711+0.00245792im  -0.0950356-0.0623565im    -0.0643427+0.0804397im   -0.0856419-0.132606im     0.0608317-0.0907585im    0.161753-0.140491im      -0.0593628+0.0144093im    -0.101297-0.198972im        -0.1788+0.0564428im   -0.0957969-0.0501285im    0.0840437+0.0732916im    -0.0169931+0.0654789im    0.318387+0.0673704im     0.0853387-0.210879im      -0.0530905-0.1806im       -0.0169083+0.00403219im   -0.0458835+0.0316426im     0.0763624-0.0798693im      0.337083-0.0957337im    0.0910194+0.0712466im
   0.0764367+0.0920346im     0.0117986+0.10306im        0.059745-0.305705im      0.307107-0.0528825im     0.194887-0.0935195im      0.206214-0.0310027im     -0.229915-0.279333im     -0.0523235+0.10286im       -0.0530449-0.0386701im      0.124526+0.22494im     0.0717863-0.0700446im    -0.104482+0.0657979im     0.0620268-0.147824im     -0.112226-0.187069im       0.067438+0.0167089im     0.123335+0.0174921im    0.0981603+0.125512im   -0.0932705+0.0241462im      -0.175742-0.00551im       0.139677+0.0865562im    -0.0677911+0.0886822im    -0.108251-0.00619753im   0.0302808-0.0925818im     0.0535114-0.247717im    0.0325498-0.208352im     -0.0509136+0.0264167im      0.0587168+0.0184255im    -0.0382697-0.060552im       0.078473-0.048893im        0.16349-0.106652im      -0.172181+0.0123312im    -0.181129+0.0237308im
  -0.0449786+0.0916733im     0.0903479+0.00738281im  -0.00244942+0.234531im     -0.177758+0.166697im      0.209898+0.13861im       0.0998951+0.1948im        -0.211019-0.118944im       0.298883+0.16226im      -0.00808957+0.0873551im    -0.0107245-0.0509837im   -0.143442-0.135484im      0.143102-0.067309im      -0.172583-0.0673769im    -0.201673-0.126929im       0.123079+0.1277im        0.144588+0.207867im      0.129088-0.0385843im  -0.0987733+0.116601im        0.105959+0.194217im     0.0132317+0.159705im       0.104155-0.0339352im    0.0473648+0.150966im     0.0896472+0.0906617im    -0.0314262+0.0860373im    0.122903-0.0502263im     -0.025981+0.0111332im      -0.190966-0.0234062im     0.0123217-0.0476527im     0.0300565-0.227973im      0.0601612+0.104871im       0.125578+0.00316127im   0.0371353-0.00830524im
    0.138006-0.414809im      -0.158411+0.0816736im     0.0703678+0.206775im    -0.0792807+0.111102im    -0.0368942+0.0548194im     0.0649341+0.14239im       0.0141505-0.000587165im    0.184803-0.0335566im       0.165917+0.117621im      0.0814194+0.143778im     0.023921-0.16335im      -0.156893+0.0436244im    -0.0424714-0.131435im      0.105598-0.00623295im    0.0733316+0.149344im      0.116401-0.0672893im    -0.190643-0.0935322im  -0.0105571+0.0220966im      -0.138892+0.101915im      0.237821-0.0858275im     -0.308501+0.00474589im  -0.0777419-0.0408211im   -0.0470954+0.0819488im     -0.105011+0.0775395im  -0.0805453-0.0852174im    -0.0507958-0.179312im    -0.000139719+0.109264im     -0.0889957+0.0926978im      0.101558+0.221511im      0.0296379-0.0365506im    -0.0922074+0.150423im     0.0735133+0.0689011im
   0.0237555+0.0818745im    -0.0246824-0.135691im     -0.0340226-0.129945im     -0.102986+0.0528325im      0.12721-0.0322845im     0.0867952-0.0573672im      0.143564+0.0113371im     -0.131156+0.228522im        0.143159+0.306303im      0.0824715+0.280984im    0.0393201+0.00782826im   0.0674131+0.171588im      0.0572345+0.216972im    -0.0316355-0.0857035im     -0.096462-0.132078im     -0.172647+0.114497im      0.027741-0.149265im     0.340712+0.169211im     -0.00895968+0.122065im     0.0163497-0.199441im     -0.0824279+0.0927514im    0.0849289-0.0746166im    0.0610335-0.0812029im     -0.166308+0.0836495im  0.00777713-0.0360958im      -0.11605+0.0457879im         -0.179+0.0622908im    -0.0168037+0.0791344im    0.00972095-0.0954619im      0.112124+0.110431im     -0.0668204+0.0543594im    0.0574963-0.244935im
    0.238419-0.0110806im     0.0812119+0.165211im       -0.21373+0.00183243im   -0.154905-0.064893im       0.25552+0.113167im       0.330807+0.0238144im    -0.0218214-0.0355665im    0.00549062-0.113473im      -0.0625914-0.1082im       -0.0371836+0.092042im    -0.203972+0.133017im    -0.0888554+0.134867im       0.231555+0.0602478im    0.0986586-0.0801612im    -0.0680809+0.0421692im   -0.0700334-0.195567im    -0.0898236+0.0740144im  -0.0788661-0.133549im     -0.00260012-0.110603im     -0.239871-0.0885311im    -0.0166256-0.16813im      0.0356547+0.131379im     0.0253803+0.0943117im    -0.0976348+0.0216488im  -0.0829701+0.202939im    -0.00977164-0.0918788im     -0.0587335+0.104816im      -0.152709-0.155155im      -0.113988-0.15802im         0.13218-0.0483685im     0.0479165+0.183351im     0.0668061-0.0160122im</code></pre><p>and then generate the state <span>$ψ$</span></p><pre><code class="language-julia hljs">psi = P[:, 3]</code></pre><pre><code class="nohighlight hljs">32-element Vector{ComplexF64}:
   0.06359553670474942 + 0.14737887515436307im
   -0.1038873894903046 + 0.011902337890917804im
       0.0358802394243 - 0.03773406410160183im
 -0.040436726046845506 + 0.08771787660073344im
 -0.012270429597049999 + 0.11305878839309616im
  -0.18891792306832697 + 0.05438665962343462im
  -0.29629679862199176 - 0.027438491258098635im
  -0.10454644595123339 - 0.027563776145370582im
   -0.1771855119696369 + 0.08456319235232175im
 -0.025871983718832547 - 0.07490335548399973im
 -0.035151024136028095 - 0.004771037535225986im
   -0.1208522533648257 + 0.09553392696913787im
  -0.17670481152745637 + 0.020044759425639908im
  -0.12080627742203151 - 0.07033174028503687im
  -0.04501553439213209 + 0.0656229050465261im
  -0.02993073928479153 + 0.1065829925704623im
  0.010728595446292052 - 0.24611222945532235im
 -0.025887351972561895 + 0.1653330433363732im
   0.13539935730775407 + 0.08001875272219158im
  -0.21624120006681413 + 0.10284612299284243im
   -0.1895499510431338 - 0.05815103902063158im
   0.40104436676362526 + 0.0im
    0.1044331281603457 - 0.16397426825903696im
  -0.14438920607390124 + 0.12704001643607968im
   0.08349326638943483 - 0.09271193939706623im
  0.029191999427357722 + 0.05232422062845684im
   0.15206011650415277 + 0.22322256012336258im
  -0.14550818936517967 - 0.026567875840444205im
   0.05069787527596994 - 0.12073089377448953im
  -0.04465003014071328 - 0.03649271754921339im
    0.0940059175493276 - 0.16879396939841024im
  -0.19309802746171034 + 0.07146407900546992im</code></pre><p>In the phase estimation process, we will feed the state to circuit and measure the first <code>n</code> qubits processed by iQFT.</p><pre><code class="language-julia hljs">r = join(ArrayReg(psi), zero_state(N))
r |&gt; PE(N, M, U)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 8/8
    nlevel: 2</code></pre><p>Since our phase can be represented by 3 qubits precisely, we only need to measure once</p><pre><code class="language-julia hljs">results = measure(r, 1:N; nshots=1)</code></pre><pre><code class="nohighlight hljs">1-element Vector{BitBasis.BitStr64{3}}:
 011 ₍₂₎</code></pre><p>Recall that our QFT&#39;s bit numbering is reversed, let&#39;s reverse it back</p><pre><code class="language-julia hljs">using BitBasis
estimated_phase = bfloat(results[]; nbits=N)</code></pre><pre><code class="nohighlight hljs">0.75</code></pre><p>the phase is exactly <code>0.75</code>!</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../1.prepare-ghz-state/index.html">« Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a><a class="docs-footer-nextpage" href="../3.grover-search/index.html">Grover Search »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.15 on <span class="colophon-date" title="Wednesday 13 April 2022 21:01">Wednesday 13 April 2022</span>. Using Julia version 1.7.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
