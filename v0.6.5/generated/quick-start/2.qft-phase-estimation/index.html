<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quantum Fourier Transformation and Phase Estimation · Documentation | Yao</title><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/indigo.css" rel="stylesheet" type="text/css"/><link href="https://yaoquantum.org/assets/favicon-light.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../index.html"><img src="../../../assets/logo.png" alt="Documentation | Yao logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../index.html">Documentation | Yao</a></span></div><form class="docs-search" action="../../../search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../index.html">Home</a></li><li><span class="tocitem">Quick Start</span><ul><li><a class="tocitem" href="../1.prepare-ghz-state/index.html">Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a></li><li class="is-active"><a class="tocitem" href="index.html">Quantum Fourier Transformation and Phase Estimation</a><ul class="internal"><li><a class="tocitem" href="#Quantum-Fourier-Transformation"><span>Quantum Fourier Transformation</span></a></li><li><a class="tocitem" href="#Wrap-QFT-to-an-external-block"><span>Wrap QFT to an external block</span></a></li><li><a class="tocitem" href="#Phase-Estimation"><span>Phase Estimation</span></a></li><li class="toplevel"><a class="tocitem" href="#using-LinearAlgebra"><span>using LinearAlgebra</span></a></li></ul></li><li><a class="tocitem" href="../3.grover-search/index.html">Grover Search</a></li><li><a class="tocitem" href="../4.shor-algorithm/index.html">Shor&#39;s Algorithm</a></li><li><a class="tocitem" href="../5.shor-9-code/index.html">Shor&#39;s 9 qubit code</a></li><li><a class="tocitem" href="../6.quantum-circuit-born-machine/index.html">Quantum Circuit Born Machine</a></li><li><a class="tocitem" href="../7.variation-quantum-eigen-solver/index.html">Variational Quantum Eigen Solver</a></li></ul></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../../man/array_registers.html">Array Registers</a></li><li><a class="tocitem" href="../../../man/symbolic.html">Symbolic Computation</a></li><li><a class="tocitem" href="../../../man/blocks.html">Blocks</a></li><li><a class="tocitem" href="../../../man/automatic_differentiation.html">Automatic Differentiation</a></li><li><a class="tocitem" href="../../../man/simplification.html">Simplification</a></li><li><a class="tocitem" href="../../../man/base.html">Base</a></li><li><a class="tocitem" href="../../../man/registers.html">Abstract Registers</a></li><li><a class="tocitem" href="../../../man/bitbasis.html">BitBasis</a></li><li><a class="tocitem" href="../../../man/extending_blocks.html">Extending Blocks</a></li></ul></li><li><a class="tocitem" href="../../../benchmarks.html">Benchmark</a></li><li><a class="tocitem" href="../../../dev/index.html">Developer Notes</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Quick Start</a></li><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/QuantumBFS/Yao.jl/blob/master/docs/src/quick-start/2.qft-phase-estimation/main.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><p><a href="https://mybinder.org/v2/gh/QuantumBFS/Yao.jl/gh-pages?filepath=v0.6.5/generated/quick-start/2.qft-phase-estimation/main.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a> <a href="https://nbviewer.jupyter.org/github/QuantumBFS/Yao.jl/blob/gh-pages/v0.6.5/generated/quick-start/2.qft-phase-estimation/main.ipynb"><img src="https://img.shields.io/badge/show-nbviewer-579ACA.svg" alt/></a> <a href="https://minhaskamal.github.io/DownGit/#/home?url=https://github.com/QuantumBFS/tutorials/tree/gh-pages/dev/generated/quick-start/2.qft-phase-estimation"><img src="https://img.shields.io/badge/download-project-orange" alt/></a></p><h1 id="example-qft"><a class="docs-heading-anchor" href="#example-qft">Quantum Fourier Transformation and Phase Estimation</a><a id="example-qft-1"></a><a class="docs-heading-anchor-permalink" href="#example-qft" title="Permalink"></a></h1><p>Let&#39;s use Yao first</p><pre><code class="language-julia hljs">using Yao</code></pre><h2 id="Quantum-Fourier-Transformation"><a class="docs-heading-anchor" href="#Quantum-Fourier-Transformation">Quantum Fourier Transformation</a><a id="Quantum-Fourier-Transformation-1"></a><a class="docs-heading-anchor-permalink" href="#Quantum-Fourier-Transformation" title="Permalink"></a></h2><p>The Quantum Fourier Transformation (QFT) circuit is to repeat two kinds of blocks repeatly:</p><p><img src="assets/qft.png" alt="qft-circuit"/></p><p>The basic building block control phase shift gate is defined as</p><p class="math-container">\[R(k)=\begin{bmatrix}
1 &amp; 0\\
0 &amp; \exp\left(\frac{2\pi i}{2^k}\right)
\end{bmatrix}\]</p><p>Let&#39;s define block <code>A</code> and block <code>B</code>, block <code>A</code> is actually a control block.</p><pre><code class="language-julia hljs">A(i, j) = control(i, j=&gt;shift(2π/(1&lt;&lt;(i-j+1))))</code></pre><pre><code class="nohighlight hljs">A (generic function with 1 method)</code></pre><p>Once you construct the blockl you can inspect its matrix using <code>mat</code> function. Let&#39;s construct the circuit in dash box A, and see the matrix of <span>$R_4$</span> gate.</p><pre><code class="language-julia hljs">R4 = A(4, 1)</code></pre><pre><code class="nohighlight hljs">(n -&gt; control(n, 4, 1 =&gt; shift(0.39269908169872414)))</code></pre><p>If you have read about <a href="generated/quick-start/2.qft-phase-estimation/@ref example-ghz">preparing GHZ state</a>, you probably know that in Yao, we could just leave the number of qubits, and it will be evaluated when possible.</p><pre><code class="language-julia hljs">R4(5)</code></pre><pre><code class="nohighlight hljs">nqubits: 5
control(4)
└─ (1,) shift(0.39269908169872414)</code></pre><p>its matrix will be</p><pre><code class="language-julia hljs">mat(R4(5))</code></pre><pre><code class="nohighlight hljs">32×32 LinearAlgebra.Diagonal{ComplexF64, Vector{ComplexF64}}:
 1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im</code></pre><p>Then we repeat this control block over and over on different qubits, and put a Hadamard gate to <code>i</code>th qubit to construct <code>i</code>-th <code>B</code> block.</p><pre><code class="language-julia hljs">B(n, k) = chain(n, j==k ? put(k=&gt;H) : A(j, k) for j in k:n)</code></pre><pre><code class="nohighlight hljs">B (generic function with 1 method)</code></pre><p>We need to input the total number of qubits <code>n</code> here because we have to iterate through from <code>k</code>-th location to the last.</p><p>Now, let&#39;s construct the circuit by chaining all the <code>B</code> blocks together</p><pre><code class="language-julia hljs">qft(n) = chain(B(n, k) for k in 1:n)
qft(4)</code></pre><pre><code class="nohighlight hljs">nqubits: 4
chain
├─ chain
│  ├─ put on (1)
│  │  └─ H
│  ├─ control(2)
│  │  └─ (1,) shift(1.5707963267948966)
│  ├─ control(3)
│  │  └─ (1,) shift(0.7853981633974483)
│  └─ control(4)
│     └─ (1,) shift(0.39269908169872414)
├─ chain
│  ├─ put on (2)
│  │  └─ H
│  ├─ control(3)
│  │  └─ (2,) shift(1.5707963267948966)
│  └─ control(4)
│     └─ (2,) shift(0.7853981633974483)
├─ chain
│  ├─ put on (3)
│  │  └─ H
│  └─ control(4)
│     └─ (3,) shift(1.5707963267948966)
└─ chain
   └─ put on (4)
      └─ H
</code></pre><h2 id="Wrap-QFT-to-an-external-block"><a class="docs-heading-anchor" href="#Wrap-QFT-to-an-external-block">Wrap QFT to an external block</a><a id="Wrap-QFT-to-an-external-block-1"></a><a class="docs-heading-anchor-permalink" href="#Wrap-QFT-to-an-external-block" title="Permalink"></a></h2><p>In most cases, <code>function</code>s are enough to wrap quantum circuits, like <code>A</code> and <code>B</code> we defined above, but sometimes, we need to dispatch specialized methods on certain kinds of quantum circuit, or we want to define an external block to export, thus, it&#39;s useful to be able to wrap circuit to custom blocks.</p><p>First, we define a new type as subtype of <code>PrimitiveBlock</code> since we are not going to use the subblocks of <code>QFT</code>, if you need to use its subblocks, it&#39;d be better to define it under <code>CompositeBlock</code>.</p><pre><code class="language-julia hljs">struct QFT{N} &lt;: PrimitiveBlock{N} end
QFT(n::Int) = QFT{n}()</code></pre><pre><code class="nohighlight hljs">Main.##276.QFT</code></pre><p>Now, let&#39;s define its circuit</p><pre><code class="language-julia hljs">circuit(::QFT{N}) where N = qft(N)</code></pre><pre><code class="nohighlight hljs">circuit (generic function with 1 method)</code></pre><p>And forward <code>mat</code> to its circuit&#39;s matrix</p><pre><code class="language-julia hljs">YaoBlocks.mat(::Type{T}, x::QFT) where T = mat(T, circuit(x))</code></pre><p>You may notice, it is a little ugly to print <code>QFT</code> at the moment, this is because we print the type summary by default, you can define your own printing by overloading <code>print_block</code></p><pre><code class="language-julia hljs">YaoBlocks.print_block(io::IO, x::QFT{N}) where N = print(io, &quot;QFT($N)&quot;)</code></pre><p>Since it is possible to use FFT to simulate the results of QFT (like cheating), we could define our custom <code>apply!</code> method:</p><pre><code class="language-julia hljs">using FFTW, LinearAlgebra

function YaoBlocks.apply!(r::ArrayReg, x::QFT)
    α = sqrt(length(statevec(r)))
    invorder!(r)
    lmul!(α, ifft!(statevec(r)))
    return r
end</code></pre><p>Now let&#39;s check if our <code>apply!</code> method is correct:</p><pre><code class="language-julia hljs">r = rand_state(5)
r1 = r |&gt; copy |&gt; QFT(5)
r2 = r |&gt; copy |&gt; circuit(QFT(5))
r1 ≈ r2</code></pre><pre><code class="nohighlight hljs">true</code></pre><p>We can get iQFT (inverse QFT) directly by calling <code>adjoint</code></p><pre><code class="language-julia hljs">QFT(5)&#39;</code></pre><pre><code class="nohighlight hljs"> [†]QFT(5)</code></pre><p>QFT and iQFT are different from FFT and IFFT in three ways,</p><ol><li>they are different by a factor of <span>$\sqrt{2^n}$</span> with <span>$n$</span> the number of qubits.</li><li>the <a href="https://quantumbfs.github.io/BitBasis.jl/stable/tutorial/#Conventions-1">bit numbering</a> will exchange after applying QFT or iQFT.</li><li>due to the convention, QFT is more related to IFFT rather than FFT.</li></ol><h2 id="Phase-Estimation"><a class="docs-heading-anchor" href="#Phase-Estimation">Phase Estimation</a><a id="Phase-Estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Phase-Estimation" title="Permalink"></a></h2><p>Since we have QFT and iQFT blocks we can then use them to realize phase estimation circuit, what we want to realize is the following circuit:</p><p><img src="assets/phaseest.png" alt="phase estimation"/></p><pre><code class="language-julia hljs">using Yao</code></pre><p>First we call Hadamard gates repeatly on first <code>n</code> qubits.</p><pre><code class="language-julia hljs">Hadamards(n) = repeat(H, 1:n)</code></pre><pre><code class="nohighlight hljs">Hadamards (generic function with 1 method)</code></pre><p>Then in dashed box <code>B</code>, we have controlled unitaries:</p><pre><code class="language-julia hljs">ControlU(n, m, U) = chain(n+m, control(k, n+1:n+m=&gt;matblock(U^(2^(k-1)))) for k in 1:n)</code></pre><pre><code class="nohighlight hljs">ControlU (generic function with 1 method)</code></pre><p>each of them is a <code>U</code> of power <span>$2^(k-1)$</span>.</p><p>Since we will only apply the qft and Hadamard on first <code>n</code> qubits, we could use <code>Subroutine</code>, which creates a context of a sub-scope of the qubits.</p><pre><code class="language-julia hljs">PE(n, m, U) =
    chain(n+m, # total number of the qubits
        subroutine(Hadamards(n), 1:n), # apply H in local scope
        ControlU(n, m, U),
        subroutine(QFT(n)&#39;, 1:n))</code></pre><pre><code class="nohighlight hljs">PE (generic function with 1 method)</code></pre><p>we use the first <code>n</code> qubits as the output space to store phase <span>$ϕ$</span>, and the other <code>m</code> qubits as the input state which corresponds to an eigenvector of oracle matrix <code>U</code>.</p><p>The concentrator here uses <code>focus!</code> and <code>relax!</code> to manage a local scope of quantum circuit, and only active the first <code>n</code> qubits while applying the block inside the concentrator context, and the scope will be <code>relax!</code>ed back, after the context. This is equivalent to manually <code>focus!</code> then <code>relax!</code></p><p>fullly activated</p><pre><code class="language-julia hljs">r = rand_state(5)</code></pre><pre><code class="nohighlight hljs">ArrayReg{1, ComplexF64, Array...}
    active qubits: 5/5</code></pre><p>first 3 qubits activated</p><pre><code class="language-julia hljs">focus!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{1, ComplexF64, Array...}
    active qubits: 3/5</code></pre><p>relax back to the original</p><pre><code class="language-julia hljs">relax!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{1, ComplexF64, Array...}
    active qubits: 5/5</code></pre><p>In this way, we will be able to apply small operator directly on the subset of the qubits.</p><p>Details about the algorithm can be found here: <a href="ttps://en.wikipedia.org/wiki/Quantum_phase_estimation_algorithm">Quantum Phase Estimation Algorithm</a></p><p>Now let&#39;s check the results of our phase estimation.</p><p>First we need to set up a unitary with known phase, we set the phase to be 0.75, which is <code>0.75 * 2^3 == 6 == 0b110</code> .</p><h1 id="using-LinearAlgebra"><a class="docs-heading-anchor" href="#using-LinearAlgebra">using LinearAlgebra</a><a id="using-LinearAlgebra-1"></a><a class="docs-heading-anchor-permalink" href="#using-LinearAlgebra" title="Permalink"></a></h1><pre><code class="language-julia hljs">N, M = 3, 5
P = eigen(rand_unitary(1&lt;&lt;M)).vectors
θ = Int(0b110) / 1&lt;&lt;N
phases = rand(1&lt;&lt;M)
phases[0b010+1] = θ
U = P * Diagonal(exp.(2π * im * phases)) * P&#39;</code></pre><pre><code class="nohighlight hljs">32×32 Matrix{ComplexF64}:
  -0.128363+0.160869im     0.0358734-0.0207238im    0.188055-0.0753407im   -0.154093+0.103162im       0.161164+0.0163758im      0.0395447-0.178222im       0.0547625-0.247661im     -0.0916866+0.0892794im      0.117017+0.103905im       0.117701+0.00244726im    0.0563681+0.120869im      -0.129345-0.039846im    -0.00346222-0.202516im     0.116438-0.00270835im    -0.227115+0.384119im     -0.0890417-0.121348im      0.292356+0.0776423im   -0.0563917+0.110604im     -0.216465-0.144918im     -0.0486555-0.0911932im   -0.0935275+0.0852567im     0.0299736+0.080937im      -0.0289447-0.0970824im     -0.186643-0.0655165im      0.082125-0.142234im      0.116261+0.0831421im   -0.0173244-0.0659848im  -0.000925228-0.0475715im   0.000431137-0.0151654im     -0.104892+0.097606im       0.0725867+0.0146077im      0.031093-0.222599im
    0.03034-0.145338im     -0.182204+0.248912im    -0.051352-0.205201im    -0.199836-0.0710175im       0.12968-0.0740561im       0.144914-0.160685im       0.0292439+0.124689im    -0.00302335+0.0309514im      0.124566+0.00981894im   -0.0715805-0.105608im      0.0781838-0.0177551im   -0.00172429+0.209834im      -0.203625+0.134259im    -0.239248-0.0603467im    -0.0902679-0.0415686im   -0.00404662-0.114684im      0.145771+0.106156im     0.0348557-0.0430466im     -0.19328+0.0233388im      0.153401+0.0728917im      0.15983-0.0512876im    -0.0318358-0.0857242im      0.0651564+0.0298374im     0.0463849+0.0495099im     -0.139294+0.00239676im   0.0188727+0.277589im     0.0218376-0.0377296im    -0.0548028-0.102374im      -0.252764+0.31243im      -0.0481487+0.0492378im     0.00965052+0.065452im       0.132693+0.178266im
  -0.139029-0.280586im      0.092789+0.375458im   -0.0265873+0.256313im    0.0846796+0.0652338im     0.0012861+0.160731im       -0.094013-0.0325395im      0.0284047+0.091463im     -0.0988708+0.124254im      0.0844359-0.0337773im      0.136233+0.0611405im      0.239914+0.0121177im     0.0378154+0.127144im      0.0163728-0.0455792im   -0.196843-0.0307801im      0.113529+0.0216846im    -0.0433104+0.136697im    -0.0362194+0.0623537im   -0.0193072+0.228698im    -0.0582951+0.0150516im     -0.158445+0.0754154im     0.126384+0.222409im      -0.155067-0.0476143im      0.0192936-0.121877im      -0.103602-0.101963im     0.00230857-0.0826917im   -0.0448256-0.11476im     -0.0553631-0.14607im        0.133791+0.120162im     -0.0109628-0.197383im      -0.124425+0.0956684im      -0.213504-0.00885912im     0.112366+0.0376606im
 -0.0745987-0.090938im      0.122222+0.0491952im    0.151282-0.068409im     0.140864+0.055078im       0.260404+0.0553076im     -0.0462205-0.0366172im      -0.109826+0.0518203im     0.0933018+0.0735568im      0.066129+0.107112im      0.0928468+0.0842756im      0.212053-0.185062im      -0.106813+0.0216293im     0.0221259+0.167942im    0.0365052-0.128721im    -0.00979645+0.031258im    -0.00362097+0.0265741im    -0.214388+0.0765019im     -0.13245-0.0818666im      0.16443+0.126883im      -0.230845-0.0510351im   -0.0277827-0.0237476im      0.239072-0.0149807im      0.0797414+0.178405im      0.0948131-0.332358im      0.0505018+0.0333701im      0.19633+0.219376im      0.263185+0.152047im     0.00290805-0.0351641im    -0.0878186+0.0809427im      0.103144+0.0141192im     -0.0335541+0.0431537im      -0.11424-0.166002im
  -0.353315-0.180039im     0.0170666-0.116244im    -0.135741+0.0668725im   -0.273497+0.0534028im     0.0944702+0.2604im         0.0854968-0.0303465im      -0.185408+0.0743291im     -0.132189+0.00850984im    -0.160278-0.0449919im    -0.0330965-0.105957im      -0.154463+0.0109068im     -0.137017-0.0577148im     -0.128042-0.169874im    0.0292252+0.102064im      0.0948379+0.134174im    -0.00435698+0.160874im    -0.0195058-0.0697817im     0.037056-0.0453856im     0.197389-0.128921im      -0.270718-0.0249838im   -0.0191462-0.139091im     -0.0116273-0.187191im        0.113526+0.167081im      0.0118783+0.17066im      -0.0903602+0.048722im     0.0254302-0.0655862im     -0.06245-0.0725804im    -0.0835092+0.109325im         -0.145+0.218489im     -0.0302177+0.0640116im      0.0221598-0.073963im     -0.0273344-0.0570244im
 -0.0512764-0.174713im    -0.0744982-0.0724811im   0.0606273-0.139209im   -0.0553354+0.00446595im    -0.120273+0.193658im       -0.144077+0.447197im      -0.0324969-0.0029547im     0.0828609+0.196844im     -0.0229662-0.0245117im     -0.227168-0.0631784im      0.152888+0.153373im     -0.0315908-0.070627im       0.135792-0.158037im    -0.053264-0.0488956im      0.134271+0.0707209im    -0.0295954-0.157066im      0.070108-0.00949922im  -0.0818488-0.0873712im   -0.0581798-0.0395341im    -0.0115536+0.309811im    -0.0146468-0.124574im     0.00946514+0.151035im      -0.0651145-0.0267628im   -0.00940201-0.243131im      -0.113755-0.037189im     0.0363251+0.0436147im    0.0218136-0.134746im      0.0523927-0.16483im        0.163486+0.148182im       0.142224+0.0440157im      0.0385609-0.136376im       0.151626+0.0218092im
   0.289747+0.06103im      -0.189714+0.0130385im  -0.0621774+0.0736358im   0.0319141-0.135819im      0.0995774+0.0626023im    -0.00662028-0.0500598im      -0.202613-0.0490861im    -0.0978535+0.0566851im     0.0644457+0.181068im      -0.126085+0.238565im       0.174978-0.102733im     -0.0210567-0.0200072im      0.124778-0.154051im   -0.0710027+0.258576im     -0.0931274+0.0450458im      0.189924+0.101547im      0.149617+0.00038158im  -0.0659136+0.0608866im     0.100488-0.0101175im    -0.0518004+0.0539926im     0.259127-0.0354498im    -0.0937248-0.0373194im     -0.0789969-0.127375im     -0.0629351+0.0864959im    -0.0937705+0.19026im      -0.166613-0.020174im      0.190744-0.042218im     0.00220004+0.145787im       0.107678+0.188652im       0.174716-0.00943654im     0.0166816+0.157216im     -0.0888138-0.229631im
 -0.0144674+0.0315034im    -0.103778-0.0581433im    0.027312+0.0512018im  -0.0373707-0.40891im      -0.0167314-0.00433216im    -0.0187181+0.0883823im     -0.0884405-0.0988769im     0.0119876-0.0102951im    -0.0140206-0.00609775im    0.0228137-0.119034im       0.173475-0.071227im       0.232558-0.155004im      -0.174958+0.0509432im  -0.0633394-0.0779379im      0.116836+0.0699456im      0.102342+0.164362im      0.174577+0.219404im     0.0732891+0.0973236im    0.0296864+0.0546726im      0.051982+0.0338161im    -0.299105+0.0603346im    0.00762873+0.0848024im      0.0518448-0.0171695im      0.120917+0.00871099im    0.0315747+0.302281im      0.215394+0.176096im    -0.0904462+0.0225866im     0.0450935+0.242402im      0.0881069-0.0356659im     -0.188492+0.192262im      0.00896045-0.125553im     -0.0510084-0.0201079im
   0.133614+0.0575174im   -0.0495082-0.0724609im   0.0396476-0.159257im    0.0104556-0.0078926im   -0.00269782+0.133299im      -0.0956803-0.0137444im     0.00436576+0.254984im      -0.164675-0.128057im     -0.0750539-0.0756087im       0.15125+0.162038im     -0.0606285-0.0305412im     -0.157313-0.160006im      -0.183463+0.150489im    0.0590107+0.128355im      0.0211973-0.0302215im     -0.223908+0.104987im      0.116014+0.00531653im    0.229748-0.0805928im    0.0010272+0.0236535im     0.0466331+0.253586im        0.1113-0.135718im      0.0869438-0.00274803im     -0.018545-0.167948im      0.0945892-0.311621im     -0.0500226-0.157306im     0.0126273-0.0640132im   -0.0284426-0.022646im      -0.159919+0.135785im      0.0808038-0.022697im      -0.331286+0.0194528im     -0.0163315+0.168763im      0.0543253-0.125058im
  -0.133965+0.0363748im     0.102175+0.228048im   -0.0187838-0.174155im    0.0394688-0.184012im    -0.00187066+0.0143256im      0.0372809-0.0458479im      0.0391375+0.00735516im   -0.0493959-0.00742662im    0.0631799+0.1122im       -0.0173563-0.0248227im    -0.0119435+0.182076im     -0.0422877-0.00297852im    -0.148202+0.0728302im    0.196718-0.0726164im     -0.258467+0.200665im      -0.187113+0.0855929im    0.0823168+0.0292875im     0.116857+0.184016im      0.245045+0.169652im      0.0507027+0.198105im     -0.138136-0.0713448im     0.0580217+0.0138653im       -0.12646-0.00860056im     0.127035+0.0519965im     -0.039231+0.127036im     -0.131742-0.339831im      0.198545+0.0470332im      0.112372-0.0546795im   -0.00697348+0.0155589im      0.258064-0.0336807im      -0.118239-0.049108im      0.0543908+0.1661im
 -0.0299803-0.0514257im    -0.018261-0.0092986im   -0.113992+0.106382im     0.195273-0.0327278im      0.210048-0.111045im       0.0460382+0.25152im        0.0791084+0.094132im     -0.0703097-0.0661495im     -0.127218-0.167343im       0.148979+0.113837im       -0.15103+0.261743im       0.139068-0.204677im      -0.108329+0.0160614im   -0.063839-0.0907038im      0.126806+0.00179178im    -0.196607-0.183955im      0.130258-0.0328912im    -0.058132+0.100587im     -0.105635+0.0227712im    -0.0581191-0.097926im     0.0575618+0.195792im      0.0231996-0.0107472im     -0.0866764+0.178522im     -0.0560559-0.0188721im      0.238838+0.147961im     -0.171434+0.0132499im     0.144407-0.0343183im     0.0133659+0.00957194im     -0.03002+0.261601im      0.0705707+0.172691im       0.0846933+0.231039im     -0.0237327-0.06368im
  -0.194217+0.0745899im   -0.0217291-0.0142631im   0.0420422+0.0409147im    0.196666-0.00552023im   -0.0257119+0.242517im       -0.115597-0.0327091im      -0.394847+0.0850844im     0.0437797-0.0310013im      0.147688-0.0805527im      0.200459+0.0853292im     -0.068342+0.297647im      -0.142308+0.0365587im     0.0639401-0.023527im     -0.10903+0.0300632im    -0.0129939+0.0418716im        0.1067+0.0700588im    0.0164739+0.131052im      0.110619-0.170181im     -0.033171+0.0954407im      0.287846-0.137018im     0.0373195-0.0260399im     0.0193293-0.0597943im      0.0721621-0.150574im      -0.059039+0.0409748im      0.139621+0.0283312im     0.169507+0.0946105im   -0.0631746-0.0166367im     -0.076575+0.032781im      0.0316938-0.0588572im      0.271059+0.0105159im       0.141058+0.119265im      0.0481978+0.233378im
  0.0743629+0.133994im     0.0205515+0.0154021im    0.105169-0.0723349im   -0.347028+0.0292306im    -0.0599639-0.0984997im      -0.180066+0.058513im        0.085761-0.0143277im     0.0217084+0.0640418im    -0.0997123+0.0693043im      0.111911+0.121361im      0.0573514+0.169663im      0.0611715+0.0500052im    -0.0320122+0.0500402im   -0.121642+0.0754284im      0.169789+0.0254147im     -0.152724-0.0869813im    -0.165798+0.158723im     -0.195462+0.126414im      0.105612-0.181838im        0.13328+0.0353204im     0.133611-0.227474im     -0.0233731-0.00704646im     -0.042087+0.125598im      0.0623347+0.134802im      0.0713043+0.0351479im     0.112862-0.00150494im    0.102526-0.0453668im     -0.253539+0.180169im      -0.157803-0.273553im         0.2046+0.192552im       -0.140564+0.0517775im    0.00718464-0.0536629im
   0.120987-0.192143im      0.231254+0.0534993im   -0.171699-0.0472103im   0.0576537-0.0366391im      0.120691-0.103007im       0.0019194+0.0557238im      -0.153997+0.0610165im     0.0968065-0.139047im      -0.085212+0.327319im      -0.152524-0.127404im      -0.102197+0.122562im     -0.0352513-0.176672im     -0.0438544+0.173461im   -0.0391541-0.0546214im       0.06214+0.236138im       0.124785-0.256179im    -0.0901711+0.173283im     0.0647688+0.0168892im   -0.0656561+0.0753698im   -0.00573928+0.044288im     0.0513235-0.160138im       0.032858-0.139086im       0.0949414-0.113949im      -0.190498+0.0760042im     0.0725145-0.119593im    -0.0964162+0.0605187im    -0.205711+0.115904im       0.104533+0.173543im      0.0543519-0.0895298im     0.0191765-0.0895217im     -0.0861024-0.0410443im      0.106909-0.213418im
   0.116541+0.125242im      0.231311+0.186258im   -0.0143827+0.141814im   -0.0909061-0.0394885im    -0.0720558+0.175204im       -0.149004+0.0838793im       0.145517+0.145216im     -0.0601493-0.355009im       0.100246+0.156938im      -0.049294-0.0695014im      0.102553-0.0308871im     0.0131119+0.0795047im     0.0873514-0.257618im     0.233612-0.0815616im    -0.0119851-0.0772916im     0.0334914+0.00239072im   0.0546997+0.0572872im     0.053007+0.0168094im    -0.141552+0.0826165im     0.0822702+0.126402im     0.0511596+0.114368im      0.0286569-0.308327im       0.0753379+0.172279im       0.115713-0.0440322im     0.0623217+0.0283034im   0.00469807+0.0246836im    -0.140988+0.0313795im     -0.203085-0.126851im      0.0048193+0.0762564im     0.0922016+0.188375im        0.146727-0.086964im      -0.143397-0.0935375im
  0.0683102-0.142421im     0.0527771-0.0263208im    0.210936-0.178608im    0.0296899+0.0345078im     0.0123132+0.029268im        0.167107+0.116856im       0.0902047+0.07829im       0.0693072+0.0053751im     0.0132605+0.116643im      0.0330263+0.155515im       -0.34495+0.0546347im     0.0827108+0.262039im      0.0849276+0.0867595im   0.0798896+0.00599336im     0.163483+0.0635813im    -0.0898468+0.293352im      0.126415+0.16583im      0.0206711+0.0710247im     0.105137-0.144988im     -0.0134157-0.113747im      0.248126+0.252122im      0.0982083+0.0316042im     -0.0869705-0.0931547im      0.165568+0.0917264im     -0.063275+0.011731im     0.0612735+0.136133im     -0.116234+0.0410972im     0.0857667+0.00733856im     0.120316+0.0725349im     0.0846197-0.0218515im      0.0572932-0.250186im      0.0927279-0.126286im
  -0.175395-0.0771295im   -0.0452185-0.0280084im   -0.220617-0.138776im   -0.0339635+0.154229im       0.253826-0.307695im       -0.179732+0.133884im       -0.100919-0.1717im        0.0560808-0.073768im    -0.00205128-0.0915453im      0.014891+0.09266im        0.119472-0.033529im     -0.0804448-0.174323im     -0.0236917-0.0676116im   0.0688159+0.069558im      -0.225991-0.128387im      0.0273577+0.080966im    -0.0286375+0.236147im    -0.0267051-0.175033im     0.0872659+0.0971153im     0.0542068+0.0460286im    0.0755841+0.201071im      -0.114203-0.122436im       -0.234389-0.0307217im      0.257159+0.0670687im     0.0208656-0.170892im    -0.0819948+0.0725244im   -0.0515194-0.201289im     -0.0144786+0.0304992im   -0.00173131-0.0766737im    -0.0277724+0.0589008im    -0.00463309-0.208772im     -0.0244284+0.00141164im
  -0.174715-0.0824215im    -0.178994+0.122194im     0.158835-0.230319im    0.0138257+0.0504491im    -0.0563956+0.0628247im      -0.166414+0.091464im       -0.100427+0.0111325im     -0.110745-0.110021im      0.0104125-0.242923im       0.081735-0.0262915im     0.0489903-0.0702898im     -0.033483+0.080058im       0.174371+0.211345im    -0.121556-0.117327im      -0.124261-0.040745im      0.0914338-0.0126732im     0.185834-0.0408031im    -0.147471+0.152508im     0.0757482-0.0138447im     0.0533853+0.0502967im   -0.0628811-0.0746488im   -0.00172927+0.0846933im       0.267068+0.0810434im     0.0112974+0.220235im       0.144256-0.0744896im    -0.333797-0.0297902im    -0.099319+0.208538im      -0.104408-0.0373001im      0.108824-0.010311im     -0.0369475-0.00771077im  -0.000961969-0.0670372im     -0.122745-0.270827im
  0.0258642+0.0653902im   -0.0645796+0.0110619im     0.19207+0.137118im    -0.194487+0.117663im      0.0599533-0.0568941im     -0.0360833+0.19927im       -0.0431909+0.0083505im    -0.0165503+0.0909657im    0.00785597+0.00105188im   0.00246195-0.199375im      -0.119228+0.0851205im     0.0534908-0.0396083im     0.0690668-0.0697775im    0.186972+0.0528956im     0.0537444+0.0491341im     0.0299834+0.201249im      0.064524+0.0419861im    -0.221505+0.00609888im  -0.0472728+0.395223im        0.16066-0.0575024im    0.0908308-0.0582513im      0.190344-0.185543im        0.140491+0.0124182im    0.00745487+0.106645im     -0.0105746-0.0182394im   -0.0225044+0.071475im      0.171853-0.0860283im      0.128003-0.0566831im       0.11669+0.028682im      -0.248465-0.138057im       -0.330342+0.192216im      0.0242091+0.0676646im
   0.150112-0.149389im      0.140652+0.0334751im   0.0733615-0.0951186im    0.136385-0.0966171im      0.107958-0.231035im        0.186731+0.127156im       -0.251828-0.0437222im    -0.0962302+0.113457im     -0.0626635+0.00221241im    0.0200182+0.0674091im     0.0552305-0.0200866im     0.0168673+0.183532im       0.195977-0.127513im     0.115482+0.107745im     -0.0464538+0.0371446im    -0.0949205+0.0804568im   0.00698407-0.103894im      0.114877-0.250594im     -0.147013-0.12992im      0.00706036+0.174714im      -0.12125-0.00175275im    -0.192462-0.0415271im       0.200516+0.172789im      0.0958836+0.136814im       0.196004+0.0346689im     0.144589-0.150433im     0.0630783+0.131458im     -0.0671135-0.0443651im    -0.0248323-0.0732485im     -0.117551+0.140635im      -0.0875234+0.0986213im      0.261127-0.00543805im
  0.0373095-0.0290392im    0.0821339-0.034607im     0.193677+0.0115696im   -0.183922+0.111776im     -0.0630302+0.0177375im       0.119134+0.00410175im    -0.0915283-0.086055im        0.21457-0.373649im       -0.15375-0.0621504im      0.348531+0.00938354im     0.125309+0.159269im      0.0490898+0.123288im      0.0671269+0.0178057im  0.00921034-0.0737221im    -0.0807228+0.00365226im    0.0336927-0.229082im    -0.0505097-0.216027im     0.0863708-0.111521im      0.138626+0.0627013im     0.0292428+0.181687im    -0.0408429+0.19535im        -0.14747+0.000994749im    0.0198061-0.081366im     -0.0602717+0.0309576im     -0.266942+0.0994859im    0.0330197+0.0715841im     0.115549-0.0796937im      0.142943+0.217886im      0.0173109+0.135769im     -0.0159286-0.0393755im        -0.0827-0.00695718im   -0.0155092-0.0757386im
  0.0889124-0.0438112im     0.114093+0.0887058im  0.00041722+0.0197415im   0.0158142+0.0133569im    -0.0687048-0.0331718im      -0.178615-0.0282557im     -0.0321472-0.0504064im     0.0942242-0.173537im      -0.330642+0.101143im      0.0609391+0.00396006im   -0.0520175-0.0606408im     -0.220707+0.109197im      -0.189925-0.199258im    -0.148256-0.173629im      0.0713403-0.155626im    -0.00081044+0.235178im      0.119918+0.0290086im   0.00702965-0.0173524im   -0.0240457-0.0520464im     0.0153087-0.132035im     -0.138914-0.217139im       -0.15294+0.0900043im      -0.166173-0.222478im      -0.106375+0.0314769im      0.246634-0.0192385im    0.0134799+0.0794183im     0.222404+0.0399527im     0.0222287-0.229271im      0.0141263+0.18204im      -0.0242769+0.019517im       -0.200419-0.107294im    -0.00960262-0.0528287im
   0.105155+0.166362im      0.157091-0.21618im     -0.121249-0.115118im    0.0815189+0.0788565im    -0.0785973+0.281158im       0.0716963-0.132796im       0.0301008+0.0765781im       0.18918+0.0528989im     0.0427728-0.0223222im     0.0626242+0.0229416im    -0.0860536-0.112911im     -0.0467285+0.0256593im    -0.0646734-0.037189im    -0.264576+0.0230063im     -0.116449+0.0121782im    -0.0525098-0.0195922im     0.141385-0.00395467im   -0.197967+0.0184921im   -0.0647713+0.0991791im    -0.0233913+0.116878im   -0.00708881-0.0857866im     -0.089876-0.19526im       -0.0323057+0.302888im       0.127652+0.0883077im     0.0924839-0.0606176im   -0.0917449+0.0962815im     0.153075-0.0211998im      0.356234+0.105387im       0.162392-0.151949im     -0.0663514+0.176361im       0.0822163-0.0969757im      0.142297+0.0388315im
   0.097864+0.0709589im     0.124775-0.0156408im   -0.221213-0.0769937im  -0.0414127-0.0708967im     -0.071698+0.209496im       0.0264865+0.115373im       0.0870959+0.0723668im      -0.10709+0.0788979im    -0.0653102-0.220102im    0.000141433+0.192508im      0.0798486+0.015361im     -0.0894872-0.15023im      -0.0144451+0.222396im     0.210415-0.218128im      -0.156423+0.0326721im      0.134705+0.120901im     -0.182287+0.0232715im    -0.114078+0.10164im      -0.155959-0.0438097im    -0.0243248+0.131512im     0.0759718+0.0757137im     -0.113962+0.0766235im    -0.00365929-0.0670201im    -0.0515628+0.347163im     0.00805624-0.0416433im     0.365787+0.0843096im   -0.0174444-0.0574603im      0.114109-0.122346im     -0.0668104+0.0909263im     0.0194726-0.109934im      -0.0549748+0.11956im      -0.0395895-0.0997881im
   0.157455+0.00709993im    0.369888-0.0321285im     0.11679-0.0629312im  -0.0236273-0.0882607im       0.11717-0.144151im      -0.0337149-0.158365im       -0.164516+0.118916im      -0.174758+0.107054im     -0.0467516-0.0600711im    -0.0576403+0.0860204im    -0.0931627+0.197017im       -0.15988-0.0706717im      0.121092-0.0626753im   -0.192141-0.0393225im    -0.0734872-0.240328im     -0.0148732+0.0321378im    0.0893903-0.125213im     -0.247575+0.0770955im   -0.0684024+0.0667524im    0.00530131+0.0307395im    -0.155311+0.00764714im     0.168657+0.0785389im      0.0384074-0.0220175im     0.0840368-0.0890043im     -0.156354+0.221933im    -0.0459229-0.00364801im   -0.285913-0.248233im        0.03097+0.011903im      -0.158434-0.00283465im    0.0105191-0.0622887im     -0.0514415-0.113495im     -0.0969825-0.017856im
  0.0113341+0.0792582im     0.087441+0.0601173im   -0.176592-0.149979im    -0.190435-0.125531im     -0.0272269-0.000743367im   -0.0787133+0.136079im      -0.0713941-0.0723523im     0.0191444+0.119846im       0.132485-0.0671695im     0.0834569-0.188679im       -0.12307+0.0662491im     -0.284979+0.143718im       -0.13501-0.0534511im   0.0135827+0.046335im     -0.0150822-0.225449im     -0.0694442-0.114559im     -0.135467+0.201638im      0.165164+0.0388094im   -0.0876673+0.0264712im     -0.130669-0.253086im     0.0768101+0.122179im      -0.176592+0.113438im        0.177879+0.0685024im      0.026382-0.100993im      -0.201212+0.222355im    -0.0455328-0.0636622im    0.0854499+0.0556383im     0.0519315-0.0665867im      0.271577-0.106155im     -0.0157781-0.0205693im      0.0134875+0.132935im     0.00372936-0.202733im
  0.0632133-0.0296724im    0.0661962+0.0797701im  -0.0576063+0.0234315im   -0.149814+0.0372801im      0.120927-0.0786525im       0.111086-0.0409315im     -0.0636222-0.120449im     -0.0270452-0.284781im       0.136307-0.239371im      -0.136634-0.148217im     -0.0865201+0.124873im      -0.118428+0.0609607im     0.0234469-0.136697im   -0.0716694+0.0996272im      0.100997+0.0450371im       0.10315+0.236856im     -0.175539+0.026818im     -0.201484+0.213168im     0.0213545+0.00530422im    0.0148428+0.246245im    -0.0314335+0.0192016im   0.000185927+0.236088im       -0.199927+0.0591776im     0.0113659-0.149325im      0.0851512-0.126657im     0.0365452+0.065438im    0.00203056+0.320434im      0.0280233+0.148443im      0.0410865+0.0325673im    -0.0147911-0.051896im        0.205927+0.181334im      0.0766175+0.0878891im
 -0.0217635-0.0266622im    -0.143172+0.0078649im  -0.0659679-0.0112186im   0.0585596+0.011497im      0.0284104+0.0922031im      -0.126398-0.248289im     -0.00391625+0.0563739im    0.00259693+0.225532im      -0.152348+0.0626849im     -0.115655-0.184804im       -0.15249-0.00385619im    0.0166366+0.0794923im      0.170057-0.137705im     0.137863-0.199626im     0.00805092-0.208295im      -0.118048-0.108935im      0.181782+0.0237612im     0.139602+0.04136im       0.192368+0.166428im      0.0669915+0.17021im     -0.0115752+0.15975im       -0.150991+0.10354im        -0.153488+0.216537im     -0.0638654+0.0121291im      0.142449-0.0538247im     0.155126+0.176458im    -0.0599655-0.0351496im     -0.108907+0.231463im     -0.0307358-0.0402428im     0.0790902-0.214422im       -0.100135+0.136266im      0.0527193-0.164469im
   0.237609+0.135754im     0.0706955+0.143427im   -0.0759505+0.021115im    -0.040278+0.00422469im   -0.0296641+0.117788im        0.189269-0.0677672im      -0.168007-0.0327263im    -0.0101071+0.229639im      0.0936058-0.106521im        0.14116-0.00843095im   0.00382493+0.151548im       0.242293+0.0086093im    -0.0323291-0.0110078im  -0.0040637+0.146102im       0.034307-0.0679806im    -0.0658938-0.0940476im    -0.108056+0.236607im    -0.0058149-0.108683im      0.305094-0.00499443im    0.0672597+0.0157737im    -0.117437-0.0234951im    -0.0389076+0.0263438im     -0.0453529+0.0483156im      -0.10724-0.0529016im     0.0818659-0.292257im    -0.0402069-0.0542402im    -0.182626+0.049243im      0.0521598-0.180861im      0.0673978+0.283217im     -0.0866544+0.132216im       -0.143686-0.112167im      -0.253569-0.0568091im
   0.096926-0.0143505im    0.0376146-0.0373529im    -0.20496+0.14288im      0.171606+0.0838832im    -0.0226355-0.0371704im      0.0226938+0.029598im        0.158384-0.0775023im    -0.0364655+0.0391431im      0.309052-0.0305681im      0.186095-0.192525im      0.0172278-0.0199333im     -0.201786-0.0165145im    -0.0762735-0.121292im    0.0459148-0.0163598im      0.025298-0.158763im      0.0745758-0.139891im     0.0530099-0.0938725im   -0.0221831-0.0148745im     0.239635-0.119485im      0.0210469+0.122202im     0.0612997-0.0139359im      0.393835+0.149075im        0.149941-0.191735im      0.0734134+0.219818im      0.0808576+0.0387644im    0.0467193+0.0594303im    0.0655911-0.031579im     -0.0886897+0.0997573im    -0.0203293+0.0848898im   0.000503087+0.151579im       -0.117165-0.106378im       0.276275-0.0724106im
  -0.038244+0.0784349im   -0.0712307-0.0990785im   -0.184958+0.0222837im   -0.227167-0.095954im       0.128221-0.0387484im      -0.106156+0.000988355im    -0.176121-0.112093im      -0.165315-0.0811422im    -0.0712597+0.0849308im      0.122619+0.22858im       0.0204242-0.137108im       0.239909+0.184431im      0.0478391-0.0616386im    0.114369-0.269535im     0.00931843-0.179577im      -0.147796-0.0345141im     0.036363-0.0409909im   -0.0194987+0.0748122im     0.050622+0.0152807im     -0.169469-0.0235639im   -0.0360865-0.149123im       0.190492-0.0314972im      0.0621837-0.116707im     -0.0207398-0.0191813im    -0.0862836-0.166188im    -0.0474577+0.0748895im     -0.21016+0.0691713im      0.226764-0.0657002im      0.130491-0.0315881im      0.152047+0.100808im       0.0544608+0.199815im       0.234649+0.143848im
  -0.032335-0.0906535im     0.106063+0.123976im   -0.0810056-0.0695941im   0.0719011-0.0259391im     -0.114991+0.0836243im      -0.078755-0.0220847im      0.0730153-0.343837im     -0.0889834+0.0981401im     -0.224774+0.0889009im      0.124103+0.0309623im   -0.00368297+0.00490611im  -0.00716172+0.0535085im     -0.258809+0.0297277im   0.0182189+0.206001im       0.205549-0.012951im      0.0576188-0.118335im      0.228448+0.0209322im    -0.314537-0.172949im      0.107151-0.00658919im    0.0207196+0.1858im     -0.00210303+0.18334im       0.0281163-0.182343im        0.102695-0.0890776im     0.0890034-0.0145544im   -0.00431155+0.0650238im     0.040333-0.0058619im   -0.0509322+0.14663im       0.0200115-0.134414im     -0.0721425-0.101368im    -0.00154692-0.26819im         0.197625+0.164907im     -0.0700102+0.0386708im</code></pre><p>and then generate the state <span>$ψ$</span></p><pre><code class="language-julia hljs">psi = P[:, 3]</code></pre><pre><code class="nohighlight hljs">32-element Vector{ComplexF64}:
  -0.06651877761323122 + 0.061577130508039396im
    -0.058517915018145 - 0.13377294927334493im
   0.07788269704789665 - 0.03846921582696363im
  -0.07563995586361011 + 0.12095176682610392im
   0.19770415646915668 + 0.18917236811718868im
  -0.11943731950122664 - 0.16885795206399304im
  -0.25624617971666264 + 0.11022560732646437im
  -0.05138011313025943 + 0.073691399013788im
 -0.029604729116285988 - 0.07735314758735494im
   0.27313595854902606 - 0.13685088829543873im
 -0.047093693994164715 + 0.08754322256955731im
  -0.02164932210942067 + 0.11210413564490254im
  0.022558938377760213 + 0.2720104682260499im
  0.044563280583140005 - 0.21281590155610802im
 -0.029483438733959182 + 0.07204001278196791im
   -0.0571778019983968 - 0.0770464579166749im
  -0.10409807362205016 + 0.23017311125535705im
   -0.1255164103809578 - 0.08304048586409296im
  0.031833312700979145 + 0.09070356971124588im
   0.10390535600583219 + 0.239539126608664im
 0.0013633853998797159 + 0.042237650649748576im
  -0.11571793855274051 + 0.11712046959304802im
  -0.08598332793474792 - 0.19051518566067507im
  0.039473383400194136 - 0.055269310317102444im
  0.004474199562102431 + 0.03452234532129234im
    0.3708921637812475 + 0.0im
   0.06976345321347127 + 0.023346264208856993im
  -0.17781676755240314 - 0.06612805631986202im
 -0.010930827008131652 - 3.059833199124871e-5im
 -0.009206307924878093 - 0.10771850964027245im
 -0.052153117845555895 + 0.012032040601806968im
  -0.20398371276799965 - 0.03673782434434224im</code></pre><p>In the phase estimation process, we will feed the state to circuit and measure the first <code>n</code> qubits processed by iQFT.</p><pre><code class="language-julia hljs">r = join(ArrayReg(psi), zero_state(N))
r |&gt; PE(N, M, U)</code></pre><pre><code class="nohighlight hljs">ArrayReg{1, ComplexF64, Array...}
    active qubits: 8/8</code></pre><p>Since our phase can be represented by 3 qubits precisely, we only need to measure once</p><pre><code class="language-julia hljs">results = measure(r, 1:N; nshots=1)</code></pre><pre><code class="nohighlight hljs">1-element Vector{BitBasis.BitStr64{3}}:
 011 ₍₂₎</code></pre><p>Recall that our QFT&#39;s bit numbering is reversed, let&#39;s reverse it back</p><pre><code class="language-julia hljs">using BitBasis
estimated_phase = bfloat(results[]; nbits=N)</code></pre><pre><code class="nohighlight hljs">0.75</code></pre><p>the phase is exactly <code>0.75</code>!</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../1.prepare-ghz-state/index.html">« Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a><a class="docs-footer-nextpage" href="../3.grover-search/index.html">Grover Search »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.10 on <span class="colophon-date" title="Tuesday 21 December 2021 17:53">Tuesday 21 December 2021</span>. Using Julia version 1.7.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
