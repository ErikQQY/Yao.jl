<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quantum Fourier Transformation and Phase Estimation · Documentation | Yao</title><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.044/juliamono.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/indigo.css" rel="stylesheet" type="text/css"/><link href="https://yaoquantum.org/assets/favicon-light.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../index.html"><img src="../../../assets/logo.png" alt="Documentation | Yao logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../index.html">Documentation | Yao</a></span></div><form class="docs-search" action="../../../search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../index.html">Home</a></li><li><a class="tocitem" href="../../../quick-start.html">Quick Start</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../../man/registers.html">Quantum Registers</a></li><li><a class="tocitem" href="../../../man/blocks.html">Blocks</a></li><li><a class="tocitem" href="../../../man/symbolic.html">Symbolic Computation</a></li><li><a class="tocitem" href="../../../man/automatic_differentiation.html">Automatic Differentiation</a></li><li><a class="tocitem" href="../../../man/simplification.html">Simplification</a></li><li><a class="tocitem" href="../../../man/bitbasis.html">BitBasis</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../1.prepare-ghz-state/index.html">Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a></li><li class="is-active"><a class="tocitem" href="index.html">Quantum Fourier Transformation and Phase Estimation</a><ul class="internal"><li><a class="tocitem" href="#Quantum-Fourier-Transformation"><span>Quantum Fourier Transformation</span></a></li><li><a class="tocitem" href="#Wrap-QFT-to-an-external-block"><span>Wrap QFT to an external block</span></a></li><li><a class="tocitem" href="#Phase-Estimation"><span>Phase Estimation</span></a></li></ul></li><li><a class="tocitem" href="../3.grover-search/index.html">Grover Search</a></li><li><a class="tocitem" href="../4.shor-algorithm/index.html">Shor&#39;s Algorithm</a></li><li><a class="tocitem" href="../5.shor-9-code/index.html">Shor&#39;s 9 qubit code</a></li><li><a class="tocitem" href="../6.quantum-circuit-born-machine/index.html">Quantum Circuit Born Machine</a></li><li><a class="tocitem" href="../7.variation-quantum-eigen-solver/index.html">Variational Quantum Eigen Solver</a></li></ul></li><li><a class="tocitem" href="../../../performancetips.html">Performance Tips</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/QuantumBFS/Yao.jl/blob/master/docs/src/examples/2.qft-phase-estimation/main.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><p><a href="https://mybinder.org/v2/gh/QuantumBFS/Yao.jl/gh-pages?filepath=v0.8.1/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a> <a href="https://nbviewer.jupyter.org/github/QuantumBFS/Yao.jl/blob/gh-pages/v0.8.1/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://img.shields.io/badge/show-nbviewer-579ACA.svg" alt/></a> <a href="https://minhaskamal.github.io/DownGit/#/home?url=https://github.com/QuantumBFS/tutorials/tree/gh-pages/dev/generated/examples/2.qft-phase-estimation"><img src="https://img.shields.io/badge/download-project-orange" alt/></a></p><h1 id="example-qft"><a class="docs-heading-anchor" href="#example-qft">Quantum Fourier Transformation and Phase Estimation</a><a id="example-qft-1"></a><a class="docs-heading-anchor-permalink" href="#example-qft" title="Permalink"></a></h1><p>Let&#39;s use Yao first</p><pre><code class="language-julia hljs">using Yao</code></pre><h2 id="Quantum-Fourier-Transformation"><a class="docs-heading-anchor" href="#Quantum-Fourier-Transformation">Quantum Fourier Transformation</a><a id="Quantum-Fourier-Transformation-1"></a><a class="docs-heading-anchor-permalink" href="#Quantum-Fourier-Transformation" title="Permalink"></a></h2><p>The Quantum Fourier Transformation (QFT) circuit is to repeat two kinds of blocks repeatly:</p><p><img src="assets/qft.png" alt="qft-circuit"/></p><p>The basic building block control phase shift gate is defined as</p><p class="math-container">\[R(k)=\begin{bmatrix}
1 &amp; 0\\
0 &amp; \exp\left(\frac{2\pi i}{2^k}\right)
\end{bmatrix}\]</p><p>Let&#39;s define block <code>A</code> and block <code>B</code>, block <code>A</code> is actually a control block.</p><pre><code class="language-julia hljs">A(i, j) = control(i, j=&gt;shift(2π/(1&lt;&lt;(i-j+1))))</code></pre><pre><code class="nohighlight hljs">A (generic function with 1 method)</code></pre><p>Once you construct the blockl you can inspect its matrix using <code>mat</code> function. Let&#39;s construct the circuit in dash box A, and see the matrix of <span>$R_4$</span> gate.</p><pre><code class="language-julia hljs">R4 = A(4, 1)</code></pre><pre><code class="nohighlight hljs">(n -&gt; control(n, 4, 1 =&gt; shift(0.39269908169872414)))</code></pre><p>If you have read about <a href="generated/examples/2.qft-phase-estimation/@ref example-ghz">preparing GHZ state</a>, you probably know that in Yao, we could just leave the number of qubits, and it will be evaluated when possible.</p><pre><code class="language-julia hljs">R4(5)</code></pre><pre><code class="nohighlight hljs">nqubits: 5
control(4)
└─ (1,) shift(0.39269908169872414)</code></pre><p>its matrix will be</p><pre><code class="language-julia hljs">mat(R4(5))</code></pre><pre><code class="nohighlight hljs">32×32 Diagonal{ComplexF64, Vector{ComplexF64}}:
 1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im</code></pre><p>Then we repeat this control block over and over on different qubits, and put a Hadamard gate to <code>i</code>th qubit to construct <code>i</code>-th <code>B</code> block.</p><pre><code class="language-julia hljs">B(n, k) = chain(n, j==k ? put(k=&gt;H) : A(j, k) for j in k:n)</code></pre><pre><code class="nohighlight hljs">B (generic function with 1 method)</code></pre><p>We need to input the total number of qubits <code>n</code> here because we have to iterate through from <code>k</code>-th location to the last.</p><p>Now, let&#39;s construct the circuit by chaining all the <code>B</code> blocks together</p><pre><code class="language-julia hljs">qft(n) = chain(B(n, k) for k in 1:n)
qft(4)</code></pre><pre><code class="nohighlight hljs">nqubits: 4
chain
├─ chain
│  ├─ put on (1)
│  │  └─ H
│  ├─ control(2)
│  │  └─ (1,) shift(1.5707963267948966)
│  ├─ control(3)
│  │  └─ (1,) shift(0.7853981633974483)
│  └─ control(4)
│     └─ (1,) shift(0.39269908169872414)
├─ chain
│  ├─ put on (2)
│  │  └─ H
│  ├─ control(3)
│  │  └─ (2,) shift(1.5707963267948966)
│  └─ control(4)
│     └─ (2,) shift(0.7853981633974483)
├─ chain
│  ├─ put on (3)
│  │  └─ H
│  └─ control(4)
│     └─ (3,) shift(1.5707963267948966)
└─ chain
   └─ put on (4)
      └─ H
</code></pre><h2 id="Wrap-QFT-to-an-external-block"><a class="docs-heading-anchor" href="#Wrap-QFT-to-an-external-block">Wrap QFT to an external block</a><a id="Wrap-QFT-to-an-external-block-1"></a><a class="docs-heading-anchor-permalink" href="#Wrap-QFT-to-an-external-block" title="Permalink"></a></h2><p>In most cases, <code>function</code>s are enough to wrap quantum circuits, like <code>A</code> and <code>B</code> we defined above, but sometimes, we need to dispatch specialized methods on certain kinds of quantum circuit, or we want to define an external block to export, thus, it&#39;s useful to be able to wrap circuit to custom blocks.</p><p>First, we define a new type as subtype of <code>PrimitiveBlock</code> since we are not going to use the subblocks of <code>QFT</code>, if you need to use its subblocks, it&#39;d be better to define it under <code>CompositeBlock</code>.</p><pre><code class="language-julia hljs">struct QFT &lt;: PrimitiveBlock{2}
    n::Int
end

YaoBlocks.nqudits(q::QFT) = q.n</code></pre><p>Now, let&#39;s define its circuit</p><pre><code class="language-julia hljs">circuit(q::QFT) = qft(q.n)</code></pre><pre><code class="nohighlight hljs">circuit (generic function with 1 method)</code></pre><p>And forward <code>mat</code> to its circuit&#39;s matrix</p><pre><code class="language-julia hljs">YaoBlocks.mat(::Type{T}, x::QFT) where T = mat(T, circuit(x))</code></pre><p>You may notice, it is a little ugly to print <code>QFT</code> at the moment, this is because we print the type summary by default, you can define your own printing by overloading <code>print_block</code></p><pre><code class="language-julia hljs">YaoBlocks.print_block(io::IO, x::QFT) = print(io, &quot;QFT($(x.n))&quot;)</code></pre><p>Since it is possible to use FFT to simulate the results of QFT (like cheating), we could define our custom <code>apply!</code> method:</p><pre><code class="language-julia hljs">using FFTW, LinearAlgebra

function YaoBlocks.apply!(r::ArrayReg, x::QFT)
    α = sqrt(length(statevec(r)))
    invorder!(r)
    lmul!(α, ifft!(statevec(r)))
    return r
end</code></pre><p>Now let&#39;s check if our <code>apply!</code> method is correct:</p><pre><code class="language-julia hljs">r = rand_state(5)
r1 = r |&gt; copy |&gt; QFT(5)
r2 = r |&gt; copy |&gt; circuit(QFT(5))
r1 ≈ r2</code></pre><pre><code class="nohighlight hljs">true</code></pre><p>We can get iQFT (inverse QFT) directly by calling <code>adjoint</code></p><pre><code class="language-julia hljs">QFT(5)&#39;</code></pre><pre><code class="nohighlight hljs"> [†]QFT(5)</code></pre><p>QFT and iQFT are different from FFT and IFFT in three ways,</p><ol><li>they are different by a factor of <span>$\sqrt{2^n}$</span> with <span>$n$</span> the number of qubits.</li><li>the <a href="https://quantumbfs.github.io/BitBasis.jl/stable/tutorial/#Conventions-1">bit numbering</a> will exchange after applying QFT or iQFT.</li><li>due to the convention, QFT is more related to IFFT rather than FFT.</li></ol><h2 id="Phase-Estimation"><a class="docs-heading-anchor" href="#Phase-Estimation">Phase Estimation</a><a id="Phase-Estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Phase-Estimation" title="Permalink"></a></h2><p>Since we have QFT and iQFT blocks we can then use them to realize phase estimation circuit, what we want to realize is the following circuit:</p><p><img src="assets/phaseest.png" alt="phase estimation"/></p><p>First we call Hadamard gates repeatly on first <code>n</code> qubits.</p><pre><code class="language-julia hljs">Hadamards(n) = repeat(H, 1:n)</code></pre><pre><code class="nohighlight hljs">Hadamards (generic function with 1 method)</code></pre><p>Then in dashed box <code>B</code>, we have controlled unitaries:</p><pre><code class="language-julia hljs">ControlU(n, m, U) = chain(n+m, control(k, n+1:n+m=&gt;matblock(U^(2^(k-1)))) for k in 1:n)</code></pre><pre><code class="nohighlight hljs">ControlU (generic function with 1 method)</code></pre><p>each of them is a <code>U</code> of power <span>$2^{(k-1)}$</span>.</p><p>Since we will only apply the qft and Hadamard on first <code>n</code> qubits, we could use <code>Subroutine</code>, which creates a context of a sub-scope of the qubits.</p><pre><code class="language-julia hljs">PE(n, m, U) =
    chain(n+m, # total number of the qubits
        subroutine(Hadamards(n), 1:n), # apply H in local scope
        ControlU(n, m, U),
        subroutine(QFT(n)&#39;, 1:n))</code></pre><pre><code class="nohighlight hljs">PE (generic function with 1 method)</code></pre><p>we use the first <code>n</code> qubits as the output space to store phase <span>$ϕ$</span>, and the other <code>m</code> qubits as the input state which corresponds to an eigenvector of oracle matrix <code>U</code>.</p><p>The subroutine here uses <code>focus!</code> and <code>relax!</code> to manage a local scope of quantum circuit, and only activate the first <code>n</code> qubits while applying the block inside the subroutine context, and the scope will be <code>relax!</code>ed back, after the context. This is equivalent to manually <code>focus!</code> then <code>relax!</code></p><p>fullly activated</p><pre><code class="language-julia hljs">r = rand_state(5)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>first 3 qubits activated</p><pre><code class="language-julia hljs">focus!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 3/5
    nlevel: 2</code></pre><p>relax back to the original</p><pre><code class="language-julia hljs">relax!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>In this way, we will be able to apply small operator directly on the subset of the qubits.</p><p>Details about the algorithm can be found here: <a href="https://en.wikipedia.org/wiki/Quantum_phase_estimation_algorithm">Quantum Phase Estimation Algorithm</a></p><p>Now let&#39;s check the results of our phase estimation.</p><p>First we need to set up a unitary with known phase, we set the phase to be 0.75, which is <code>0.75 * 2^3 == 6 == 0b110</code> .</p><pre><code class="language-julia hljs">N, M = 3, 5
P = eigen(rand_unitary(1&lt;&lt;M)).vectors
θ = Int(0b110) / 1&lt;&lt;N
phases = rand(1&lt;&lt;M)
phases[0b010+1] = θ
U = P * Diagonal(exp.(2π * im * phases)) * P&#39;</code></pre><pre><code class="nohighlight hljs">32×32 Matrix{ComplexF64}:
 -0.00968149-0.106053im     0.0312774-0.0676028im      0.212036-0.116343im    0.0882754+0.0390779im      0.140391-0.117568im       0.273048-0.0686514im   -0.0537266-0.0766848im     0.216925+0.0344479im     0.0163068-0.201357im     -0.0175051+0.245239im    0.00244771-0.0335421im      0.241181-0.122555im      0.0112467-0.0789601im   -0.0624836-0.191256im       -0.164711-0.0419277im      0.0159292+0.0683824im     -0.173642-0.0126663im      -0.153396+0.0829677im     0.0580833-0.0529726im    0.156207-0.0808975im     0.132658+0.157443im     0.0790641+0.15658im     -0.0364966+0.032898im        0.178949+0.151711im       -0.181541+0.18554im        0.0533743-0.0306058im  -0.0777912+0.171312im     0.0700218+0.208057im     -0.156988-0.122049im      0.0565781+0.00136963im   -0.0971894-0.168373im       0.138518+0.0793927im
   0.0272935+0.0204275im    0.0801666-0.254264im       0.153042+0.0344155im    0.118531-0.195167im       0.154019-0.275073im      -0.131879-0.214882im      0.205616+0.0160161im   -0.0262021+0.059468im      0.0462187-0.0471841im    -0.0378386+0.0588456im    -0.071483-0.203127im    0.000917184+0.0192982im     0.0420006+0.0364635im    -0.103976-0.0436115im      -0.054355-0.171809im     -0.00545587+0.0145856im    -0.0342911-0.0989046im      -0.042994-0.00525243im   0.00700964-0.111189im     0.130769+0.140347im     -0.125954-0.120958im     0.0770287-0.299952im      0.109711-0.116028im       0.0346493+0.187342im        0.241448-0.176264im        0.215259-0.0364715im  -0.0447182-0.19358im     -0.0599449-0.107719im    -0.0233318+0.16547im       0.0645711-0.0401724im     0.0680222-0.0767309im       0.21164-0.0763107im
  -0.0799473+0.0118387im     0.054632-0.24545im       0.0200802-0.236205im   -0.0800959+0.0117299im    -0.0295827+0.116085im       0.186117-0.0917165im   -0.0536163+0.00266552im    0.106619+0.126982im       0.120142-0.108858im     -0.0531495-0.155195im     0.0110975+0.0526166im     0.0330837-0.0212152im      0.167431-0.232081im     -0.032449+0.106524im       -0.144396+0.0530281im       0.175202+0.1459im         0.195458-0.18908im         0.313675+0.0207962im    0.00158194+0.222525im    0.0154057+0.0764556im   -0.0671718-0.0965223im    0.0905012-0.0590594im   -0.0461125+0.200783im      -0.0191489-0.0650666im     -0.0893641+0.0877721im      0.0759856-0.169301im     0.136607-0.0444683im   -0.0514524-0.0904304im       0.2856-0.131518im      -0.096266-0.00652911im     0.109167+0.0239597im      0.219508-0.0277983im
    -0.19229+0.140092im      0.110474-0.0982259im      0.075748+0.0306537im   0.0421705-0.206135im       0.143024+0.192222im     -0.0444665-0.100982im     -0.186134+0.0805756im     0.134352-0.0601792im    -0.0452931+0.0866196im     0.0572389+0.00641094im  -0.0809976-0.0933031im     0.0251188+0.196083im      -0.105206-0.248139im    -0.0950505-0.149307im       0.0646178-0.089234im         0.19753-0.0254389im     -0.208726+0.15627im       -0.0655548+0.131822im     -0.0371808-0.11861im     -0.272262-0.039145im       0.10233+0.107253im    -0.0192051-0.0100344im   -0.0825734-0.0327002im      -0.250552+0.0767246im      -0.103733-0.170255im       -0.179274-0.266401im    0.0970677+0.00064215im  -0.0798692+0.0343292im     0.172365+0.083694im       0.169049+0.0547637im     0.0619172-0.00289579im   -0.0554921+0.0201384im
     0.23012-0.0730341im     0.129467-0.0771737im      0.019557-0.117432im    -0.120455+0.030311im     -0.0299429-0.32816im       0.0831372+0.140202im      0.109522-0.151728im      0.204298-0.0897052im      0.119216+0.14283im      -0.0982564-0.105235im    -0.0199168-0.141299im      0.0832874+0.0485593im      -0.13779-0.0446381im    0.0274764-0.148379im       0.0669434+0.188068im       0.0772946-0.0416517im     -0.169369-0.0144338im      -0.081816+0.0831637im    -0.0733804+0.0355934im   -0.212339-0.0154891im    0.0475144+0.0790675im   0.00321381+0.0357138im   -0.0161702+0.119421im      0.00979253-0.124679im         0.17638+0.0602364im      0.0533018-0.0352616im  -0.0653039-0.282631im      0.229513+0.039257im     0.0923444+0.0354508im     -0.275334+0.158901im       0.194516+0.0765431im     -0.146968+0.0732335im
   -0.147318-0.0708539im   -0.0772813+0.135297im       0.216608+0.0809473im   -0.107112+0.0970737im     0.0169635+0.0545039im      0.116297-0.413264im     -0.118847-0.0336858im     0.105788-0.125562im       0.151063+0.161651im     -0.0720273-0.0445789im      0.13649+0.0504243im      0.107364-0.0560811im    -0.0310064+0.0250307im   -0.0159037+0.0960916im      0.0326039+0.184572im       -0.168279-0.170056im    -0.00507938+0.112496im       -0.238293+0.0866382im      0.120587+0.142372im      0.11322-0.166409im     -0.143479-0.0668232im    -0.107764-0.260366im    -0.0812061-0.147121im      -0.0398308+0.100414im       -0.112007+0.073651im      -0.0249259+0.136614im    0.0194606-0.0335409im   -0.0687214-0.043627im      0.189348+0.129397im      -0.197799-0.0308044im      0.106487+0.0315001im     0.0328874+0.0361974im
   0.0630645-0.0377647im   -0.0111933+0.0419261im      0.227364-0.13738im     -0.217151+0.207485im     -0.0698702+0.0516646im    -0.0255268-0.1152im      -0.0032541-0.285529im     0.0687041+0.0065576im     0.0119957-0.0336966im      0.135695+0.0649893im     0.241522-0.0661886im    -0.0313673+0.0385178im    -0.0443147+0.0675698im   0.00676313-0.305047im       0.0299299-0.367916im       -0.053506-0.0404868im    -0.0545865+0.0135005im      0.0728321-0.169064im     -0.0594794-0.0683655im  -0.0752245+0.0357722im   -0.0545756-0.229915im     -0.261862-0.0837876im     0.118112+0.20125im        -0.055861-0.141518im       -0.053629+0.080857im     -0.00192316-0.0104779im     0.14738-0.0251749im    0.0810873-0.0594999im  0.000476082-0.0200316im      0.210796-0.157259im    -0.00773829+0.0284857im    -0.0882335-0.11502im
   -0.033815+0.0422455im   -0.0883297-0.11301im      0.00962445+0.172241im   -0.0714759-0.165889im     -0.0397832+0.0106691im    0.00119881+0.00884422im  -0.0506226-0.109313im     -0.213485-0.375034im       0.262658-0.126767im      0.0101658-0.063917im    -0.0876618-0.0606359im    -0.0688201+0.135785im    -0.00517127-0.266883im     -0.159132-0.00251279im      0.244746+0.000880327im     0.129421+0.12863im       0.0100757-0.14727im       -0.0625136+0.00801222im    0.0947632+0.148806im   -0.0322583+0.047113im    -0.0363623+0.0694942im   -0.0993199+0.0224153im    0.0456899-0.000529714im  -0.00373472-0.0947396im      -0.100483+0.114974im        0.189657+0.136125im   -0.0999214+0.0657152im    0.0960453+0.170844im     -0.181639+0.0574154im    0.00275799-0.369437im       0.013522+0.0796627im     0.0172305+0.0124868im
    0.120277-0.0768324im   -0.0754611+0.118346im      0.0845222-0.0993446im  -0.0129055-0.266872im      0.0073461+0.0159868im      0.246858-0.0585943im    0.0447055+0.179349im    -0.0921236+0.084759im      0.0493351-0.396357im      -0.013457-0.111749im     -0.110349-0.0803872im     -0.198058-0.0374499im    -0.0791998+0.0592246im   -0.0868991-0.132269im      -0.0476723+0.132429im       -0.139206+0.0359533im    -0.0274302+0.125935im      -0.0871891-0.0802681im     0.0862541+0.0343843im   -0.118813-0.0678804im    -0.212023-0.0438064im    0.0122876-0.126489im    -0.0927442+0.123434im       0.0505712-0.0641888im      0.0706766-0.29021im       -0.0472352+0.0369992im     0.23777+0.0304247im   0.00678342+0.061418im   -0.00614016-0.210331im     -0.0244246-0.0694364im   -0.00598336-0.0966371im     -0.227147+0.184207im
   0.0622051+0.12559im      -0.213726+0.20528im      -0.0075601+0.0740958im   0.0901511+0.0226991im    -0.0294306-0.182591im     -0.0211087-0.03868im      -0.116002-0.196615im     -0.123882+0.125566im      0.0622339+0.119652im       0.284505-0.131817im      -0.03968-0.0311391im      0.178756+0.121223im      0.0253967-0.193585im    -0.0654031-0.0139467im     -0.0241575+0.18295im        0.0120195-0.0402909im      0.139638+0.0720257im     0.00213273-0.180798im       0.069294-0.0524275im   0.0183182+0.103406im     -0.179146-0.0236748im   -0.0897181+0.103235im     -0.217176+0.00499216im   -0.00618647+0.0199217im      0.0142922-0.0179889im      0.0292106-0.0693263im    0.201399-0.0388952im     0.179417+0.0465615im     -0.16021+0.0231334im      0.199713+0.273614im       0.134303-0.134263im       0.268608+0.0901623im
  -0.0478352-0.195543im     0.0813427-0.0468238im    0.00985245-0.0134547im   -0.110201-0.050028im       0.109601+0.00862198im  0.000790275-0.13675im     -0.0572984-0.267222im     -0.257657+0.0364304im    0.00295164+0.0250651im     -0.107683-0.247738im    -0.0450386-0.372603im     -0.0943586-0.176978im     -0.0967983-0.0102863im     0.119523+0.0293768im     -0.0789135-0.116009im        0.229218-0.171215im       0.208605-0.0121426im     -0.0436685+0.0698876im    -0.0448789-0.0293444im   0.0374786-0.124598im      0.108835-0.0346643im     0.129163+0.114829im     0.0188414-0.174938im        0.137075-0.0578231im      -0.243684-0.110309im       -0.029276+0.111662im    0.0602454-0.0537382im   -0.0847116+0.0726434im    -0.100281-0.127282im      0.0542847+0.216158im      0.0381165+0.0929568im    -0.0887734-0.132949im
  -0.0643156+0.0470866im     0.108973-0.144667im       0.180584-0.0287712im   0.0999878+0.149913im     -0.0136131+0.199271im      -0.060051-0.207624im      0.314185-0.173822im     -0.100427+0.172238im       0.249846-0.0817631im   -0.00721023+0.032497im     -0.184361+0.211765im     0.00564404-0.133788im     -0.0435519-0.072105im   -0.00174468-4.9997e-5im      -0.197421+0.264143im       0.0837571-0.0779228im     0.0266758+0.0349106im     -0.0294365-0.115568im      0.0440517-0.168511im   -0.0842621+0.087762im     0.0329818+0.153147im       -0.1096+0.114344im     0.0278116+0.0614886im     -0.0548055+0.00630908im      0.160455-0.0723082im      -0.149236+0.111534im    -0.114147+0.0711842im    0.0773742-0.0181228im   -0.0147622+0.0968998im     0.0975529-0.0296595im    -0.0604508+0.326942im     -0.0618922+0.0271734im
   0.0176376-0.220491im     0.0658926+0.0533984im      -0.13644+0.0751974im   0.0358552-0.034411im       0.126744+0.0566564im     0.0309889-0.077406im     0.0858014+0.0449959im    0.0642422-0.109002im      0.0391931-0.159401im       0.311575-0.279376im    -0.0250276+0.122455im     -0.0963763+0.0867497im     -0.057704-0.260332im      0.138551-0.048866im       -0.099817-0.125131im       -0.316618-0.350404im     -0.0524089-0.134942im        0.175211+0.234652im      -0.223231-0.0679661im    0.102272+0.0554073im   -0.0783487+0.11987im     -0.0958112-0.0384015im     0.111035+0.0548729im      0.0288784+0.022428im       0.0026624+0.0748869im      0.0712321-0.0650139im   -0.103483+0.031672im    -0.0245942+0.0416763im   -0.0216984+0.0592371im    -0.0363104+0.129431im     -0.0589481+0.0128385im     0.0004286+0.111689im
  0.00228603-0.328315im     0.0206059-0.000133622im  -0.0462153+0.13066im      0.116838+0.0339739im    -0.0100011-0.25573im        -0.26765-0.168235im    -0.0756036+0.0329738im    -0.158066+0.0828467im     0.0178896+0.0226587im    -0.0903841+0.081751im      0.024415-0.00147634im  -0.00398867-0.0201415im       0.10673-0.177367im      0.289128-0.203627im       0.0463375+0.146754im        0.179727+0.0954463im     0.0617424+0.073413im     -0.00433328-0.0074191im     -0.176515+0.0721646im    0.101008+0.1978im        0.042389-0.0283541im   -0.0351377-0.0548833im   -0.0014113+0.079962im       -0.142554+0.123117im      -0.0547213+0.0352267im      -0.131656-0.0478874im    0.150191+0.141244im        0.1315-0.0418416im     0.120379-0.00984477im    -0.158946-0.153556im      -0.208534-0.186748im      -0.170102+0.0643103im
   0.0268967+0.0666086im    -0.114058+0.10194im       0.0680873-0.140132im    0.0680877+0.128239im      0.0437933+0.0328693im     -0.122364-0.00518571im    0.144778-0.114669im    -0.0369326-0.0383946im     0.0911616-0.0494611im      0.167408+0.132838im    -0.0306469-0.215145im      -0.085727+0.125851im      -0.175272-0.0629462im    0.0149226+0.257582im      -0.0592826-0.0205534im      -0.110088+0.121562im      -0.031503-0.107843im      -0.0341547-0.120819im     -0.0503029+0.283162im   -0.0171756-0.201352im      0.132113-0.0519792im     0.279368-0.0674404im    0.0282595+0.284131im       -0.196194+0.152334im       -0.189523-0.124637im       0.0134851+0.0412283im    -0.10315-0.058167im     0.0557318+0.0150088im    0.0504399+0.207585im    -0.00706504+0.15194im       -0.235261-0.0788329im    -0.0597224+0.0985226im
   -0.175578-0.0571178im      0.29433+0.260913im      0.0388611-0.129034im     0.159188-0.0467986im     0.0697052-0.161536im       0.133586+0.0692216im    -0.102718-0.00121612im      0.1277-0.00549579im    0.0230973-0.053474im     -0.0142721+0.0647146im     0.149619-0.0351131im     -0.209353+0.0717322im    -0.0965238+0.0880128im    0.0127814+0.164327im      -0.0655032+0.0363996im       0.232638-0.160523im     -0.0368813+0.124652im        0.361103-0.0630247im        0.1457+0.178141im    0.0795283+0.151784im     0.0518025+0.0443811im      -0.2515-0.0467089im    -0.151847-0.0016491im     -0.0177351+0.115308im      -0.0184218-0.171668im       0.0507268+0.0612801im   -0.132132+0.00467396im    0.114827+0.0614284im     -0.15087+0.118059im    0.000866373-0.0854288im       0.05908+0.0163645im     -0.033993-0.122815im
  -0.0243438-0.0281247im    0.0668718+0.00788801im      0.12313-0.0351947im   -0.150316+0.142797im      0.0597431-0.288834im       0.038734+0.124679im    -0.0341398+0.260615im     -0.157993-0.122061im      -0.211474-0.0388236im     0.0352218+0.0297792im    0.0661843+0.131865im      -0.125303-0.134154im        0.10535-0.223069im    -0.0700785+0.0277853im      -0.046505-0.00239756im    -0.0230487+0.00391249im     0.179335-0.000809299im    -0.291924-0.0278582im     0.0040048+0.0618078im    0.127471-0.080658im     0.0147859-0.00381781im  -0.0347593-0.0655826im    0.0544169+0.129594im       -0.182894+0.133494im      -0.0124585-0.0480417im       0.068514-0.159736im     -0.13698+0.0625082im     0.101386-0.0317824im    0.0248264-0.121655im       0.250952+0.111661im       0.236155+0.314044im       -0.11081-0.054292im
  -0.0936174+0.0780103im  -0.00165717+0.0116114im     0.0645581+0.128434im     0.077409-0.00298055im   -0.0225246-0.238725im      0.0818952+0.130031im    -0.0531439-0.0588772im    -0.121814+0.195351im       0.171318+0.0992108im    -0.0890728-0.0392498im     0.135125-0.0383808im     -0.260225-0.00812742im    0.0713195-0.0342412im    -0.234115+0.122017im      -0.0283962+0.0697968im     -0.0757789-0.155565im     -0.0635569+0.235765im     -0.00165036-0.0981285im    -0.0379003-0.240927im     -0.14005-0.0081919im    0.0470718+0.167152im     0.0270349-0.113516im      0.373722+0.192564im      -0.0617357-0.118023im       -0.147694+0.131885im       0.0686193-0.0137387im  0.00823145+0.0922331im    -0.170729+0.110318im      0.132787-0.080761im      -0.116272+0.0218361im    -0.0973221-0.108105im       0.156222-0.0760979im
    0.197592+0.0316448im    -0.133332-0.0794993im    -0.0126909+0.11132im     0.0335559-0.055332im       -0.23203+0.0459777im     -0.147529-0.158969im     -0.181879+0.135008im    -0.0383079+0.193543im     -0.0823969-0.0199397im      0.044469+0.0260166im     0.366993-0.171634im       0.193073+0.0479893im     0.0710324-0.0398122im    0.0597853-0.0130334im      -0.141955+0.0323004im    -0.00674423-0.093983im     -0.0245166+0.0871002im        0.18112+0.139027im       0.180296+0.0127102im   0.0334891-0.0386033im      0.08312+0.147027im      0.128829-0.0690146im    0.0663762+0.0357215im      0.0246898-0.120626im    -0.000754092-0.146537im       0.0793505+0.0629973im   -0.222644-0.174942im      0.116962+0.190496im     0.0722674-0.0757138im      0.136445-0.143036im    -0.00570117+0.217336im     -0.0391975+0.211751im
   0.0648899-0.0782069im    0.0973941+0.168794im      -0.275358-0.0504319im   0.0227561+0.167896im     -0.0841395-0.0302116im    -0.0387844-0.178208im     0.0743163+0.0477001im   -0.0324179+0.0982537im      0.216882-0.0395224im    -0.0315546-0.0799935im   -0.0718926+0.0970296im     -0.167852+0.217761im      0.0540683-0.0463438im    -0.194778-0.0580257im       0.149428-0.127547im       0.0172255+0.101783im      -0.233633+0.116095im       0.0250755-0.128144im     -0.0645234-0.20771im      0.211184-0.1652im       0.0866535-0.21509im        0.17456+0.0458693im    -0.201962-0.0958432im      0.0819882+0.146375im      -0.0827117+0.0110719im     -0.0667453-0.0595766im  -0.0983045-0.111115im     0.0868803+0.136128im       0.11549-0.175163im     -0.0526532-0.0801038im     0.0745115+0.202141im      0.0981166-0.0444816im
   0.0320434+0.0277728im     0.231887-0.117122im       0.130426+0.181937im   -0.0768395+0.162621im     -0.0663487-0.0266118im     0.0113374+0.102742im     -0.137082-0.197749im     -0.008563+0.0312256im     -0.216395-0.173293im      0.0954121-0.0629647im   -0.0397472+0.0435968im   -0.00455536-0.22616im        0.115667-0.236603im     0.0230748+0.0794108im       0.127323+0.103778im       -0.176103-0.017651im    -0.00329773+0.0497612im       0.111075-0.0304072im      0.153066-0.0381641im    -0.20854-0.0576464im    0.0549086-0.340953im      0.012672+0.0525464im   -0.0177084-0.0648089im    -0.00336192+0.207294im       0.0648967-0.0780989im      -0.144773-0.0797432im   -0.103007-0.231502im     -0.163086+0.171476im     -0.120961+0.0420947im     -0.142777-0.129806im     -0.0797507-0.126705im      0.0085971+0.0578219im
    0.139883+0.124729im      0.160994-0.131364im      -0.140491-0.194132im     0.174955-0.0748318im   -0.00460928+0.0242437im    -0.0806981+0.02152im     -0.0202602-0.0784308im   -0.0701548+0.122219im       0.066134+0.098391im      -0.010745-0.149326im      0.052264+0.093715im      0.0785882-0.198227im      0.0811267-0.104786im     -0.184112+0.000938749im    0.0514062-0.222816im       -0.205556+0.0380555im    -0.0391384-0.0569027im     -0.0986315-0.0795676im      0.196641+0.118818im    0.0926213+0.12888im       0.238072+0.139048im     -0.100162-0.381448im     -0.129173-0.0920928im     -0.0407167-0.129902im        -0.15394+0.0390234im       -0.17109-0.0464926im   0.0760647+0.0564182im    0.0848642-0.0256963im    -0.199835+0.02128im       -0.134681+0.112813im    -0.00713193-0.00919082im     -0.17794+0.0507174im
  0.00806621+0.141839im    -0.0080385+0.084284im      -0.158006+0.0285161im   -0.177766-0.0589012im      0.362053+0.0381544im      0.053228-0.0176573im   0.00538156-0.0381488im   -0.0212746+0.208293im       0.162752-0.00536134im    -0.105327+0.114055im      0.200191-0.0894628im   -0.00528003-0.0287308im     0.0527557-0.0567004im    -0.189173-0.0358907im       0.145706+0.122526im      -0.0164385-0.00494375im     0.110666-0.00957277im     0.0384368+0.104644im    -0.00968508+0.084131im   -0.0192197-0.0271301im    -0.191652-0.153187im    -0.0467378+0.0947846im     0.154307-0.111648im         0.23717-0.0224339im     -0.0142899+0.000727145im    -0.112762-0.326134im    -0.251567+0.0700937im     0.205039-0.186957im    -0.0019401+0.117297im       0.058144+0.0423723im     -0.200905-0.000527622im   -0.159793+0.0698598im
  -0.0721385+0.148408im       0.12583-0.0469908im      0.181424+0.150059im     0.135755+0.0157328im     0.0655374+0.0148289im     0.0213146-0.0693645im    -0.036869+0.0998133im    -0.118255+0.0574647im    -0.0669944-0.030591im       0.242984-0.0860884im   -0.0448515-0.0800715im    -0.0200348+0.00176625im   0.00266261+0.287959im    -0.0198198+0.0776773im      0.0576511+0.155529im        0.122976+0.0312568im     -0.195463-0.244362im       -0.155439+0.10698im       -0.190834+0.0676193im    0.230005+0.0640752im    0.0977416-0.233181im     -0.222314+0.0116795im    0.0160895+0.111396im      -0.0404135-0.345438im      -0.0443056-0.0226227im      -0.199372-0.0524017im   -0.161881-0.0558276im    0.0683014+0.116837im      0.052672-0.172257im     -0.0477069+0.0434333im     0.0228824-0.0773567im       0.10447+0.0573023im
   0.0102979-0.0334966im    0.0104432-0.311176im      -0.121905+0.0512154im  -0.0303511+0.314511im        0.16687+0.0286194im    -0.0124727+0.161634im    -0.0681406+0.0511711im    0.0744763-0.0027865im      0.221598+0.0293974im     0.0507907+0.00999143im  -0.0510355+0.0389589im     -0.105372+0.0414736im     -0.143086+0.137355im       0.21828-0.0213431im      0.0199495-0.0410097im     -0.0555671-0.0558182im      0.135334+0.213025im       -0.117995+0.111713im       0.135754+0.107836im     0.105392-0.175086im    -0.0112475+0.100308im     -0.041506-0.0479578im     0.033966-0.00385714im    -0.0245264-0.102913im       0.0366689-0.278761im      0.00815126-0.228611im     0.224732-0.0478953im     0.169719+0.0950145im    -0.121964-0.0261113im    -0.0312041-0.157688im      -0.112326+0.0206028im      0.292447-0.0310296im
  -0.0169971+0.328418im     -0.108252+0.23959im       0.0876917+0.0710327im   0.0899888-0.152936im      -0.107216-0.0969872im    -0.0596128-0.16207im      0.0337032-0.114295im       0.17069-0.0954525im      0.055299+0.0497038im     -0.143703-0.0884035im   -0.0651536+0.0800617im     -0.218716-0.120726im     -0.0412416-0.0280375im     0.274251-0.0774922im      -0.172205-0.224247im       0.0175319+0.0361522im     0.0915393+0.153179im       -0.118752+0.0167541im     0.0281116+0.0949496im   0.0226513+0.119522im     0.0602742-0.0700678im    0.0876427+0.142976im   -0.00388502+0.0977623im      0.0257481-0.0830211im     -0.0174281+0.0182226im     0.00582653-0.29118im     -0.169745-0.0357243im    -0.129286-0.126148im     -0.157959-0.0965505im     -0.145121-0.0961844im     0.0452987+0.0860862im     0.0763218+0.224388im
   -0.160437-0.171815im    -0.0696129-0.0470857im     0.0387039-0.208703im    -0.116905-0.136271im     -0.0391534-0.102602im     -0.0844226+0.0315178im   -0.0460477+0.065587im    -0.0243892-0.0659622im      0.161124-0.0462849im    0.00492986-0.163355im      0.292712+0.108959im     0.00574693+0.00513073im     0.145584+0.194684im      0.064623+0.111799im      -0.0277093-0.0970565im       0.134619-0.147714im       0.022805-0.271838im       -0.130256-0.249442im      -0.108553-0.076195im    -0.308862-0.144975im     0.0462512+0.0396738im    0.0054621-0.0177338im    -0.103482-0.144643im      -0.0604114+0.107079im        0.134975+0.00118961im      -0.15774-0.108776im   -0.0945181+0.0503887im    0.0569066+0.0660317im   -0.0757583-0.0144081im    0.00735371-0.0387257im     -0.119888-0.0384278im      0.195725+0.276472im
   0.0604359-0.100352im     0.0289964-0.0936278im      0.238238-0.103252im   -0.0359783-0.0140175im     0.0983903+0.0293681im    0.00582142+0.0752823im     -0.17772-0.00105397im   -0.164394-0.0973317im      0.073559+0.11212im       0.0274785+0.0565478im    0.0757998+0.0238855im   -0.00688416+0.286147im     -0.0148755-0.0969156im     0.095752+0.121343im      -0.0606204+0.214346im       -0.109726+0.0448445im     -0.202955+0.0407308im      0.0378649+0.0255209im    -0.0126573-0.161283im    0.0193239+0.0493787im    0.0722909-0.0153327im    0.0585202-0.0564677im    -0.153784+0.0033198im       0.101018-0.0381044im      -0.055607+0.00814237im     0.0594498-0.0240602im  -0.0167823-0.125872im     -0.129329-0.510274im     -0.274314-0.279476im    -0.00298747-0.0313022im     -0.169809+0.102465im     -0.0205877-0.0127646im
   -0.272352+0.185315im     0.0668747+0.0232046im     -0.191396-0.0512579im  -0.0840447-0.138032im     -0.0345107-0.0820198im      0.153124+0.0826321im   -0.0439224-0.279841im     -0.035209-0.012795im    -0.00703921+0.0514634im     0.0142309+0.04099im      0.0376402-0.0843485im      0.160014-0.0830042im      -0.15875+0.0577765im    0.0825944-0.000327336im   -0.0135667+0.00561689im     -0.108251+0.104241im      0.0986681-0.106696im       0.0763534+0.17748im      -0.0324529-0.343691im      0.17907-0.0445184im    -0.228651+0.0033314im     0.113036-0.142879im    -0.0989887+0.088882im        -0.38711+0.0852243im      0.0843085-0.038567im      -0.0547217+0.0519815im   -0.069853+0.0680851im     0.131324+0.0417189im   -0.0179608-0.201866im     -0.0906124-0.121509im     -0.0942574+0.0804983im    -0.0573591+0.0047498im
   0.0234813-0.190215im     0.0172124-0.0320531im    -0.0853282-0.0369446im  -0.0196992-0.335124im       0.089604+0.0514725im      0.115348-0.088116im    -0.0818955-0.10108im      -0.221116+0.195009im     -0.0571125+0.14003im        0.194923+0.336249im    -0.0920526-0.00283453im    -0.131491-0.0518505im    -0.0174708-0.0123193im     0.105138-0.0279629im       0.033236-0.106506im       -0.219869+0.0157036im      0.019927+0.0568146im     -0.0373591-0.10336im      -0.0291265+0.247727im    -0.106147-0.0740436im  -0.00744973+0.186736im     -0.050108+0.115397im    -0.0354735+0.0602411im     -0.0182473+0.0225786im       0.109243+0.155586im       -0.212635+0.0351662im   -0.149679-0.191106im     0.0448467-0.0321119im    0.0862501-0.071027im     -0.0596923-0.10903im         0.18563+0.0400523im      0.216934-0.150062im
    0.171039+0.148448im     0.0141802+0.069807im      -0.104946-0.098575im      0.11458+0.0992653im     0.0956389-0.0635657im      0.161064-0.0786733im   -0.0458491-0.0267291im   -0.0546209+0.0501521im     -0.180403+0.0566807im     -0.131316-0.037676im    -0.0914688+0.039166im      0.0701631+0.146898im     -0.0922967-0.198217im    -0.0719315-0.187312im     -0.00778059-0.0399165im      0.0758614-0.140384im       0.242677-0.0463598im      -0.055404-0.0306508im    -0.0976228+0.0461972im  -0.0846124-0.253362im      0.235242-0.0643558im    -0.227015-0.0800265im    -0.103887-0.0361452im     -0.0483855-0.112954im        0.194386-0.138477im         0.15651+0.226009im    -0.205386+0.114498im     -0.107129-0.118627im      0.138072-0.0973863im    -0.0276405-0.102186im      -0.242176-0.103514im       0.155625+0.029603im
    0.117614+0.0921032im    0.0991793-0.165492im     -0.0968322+0.0801907im  -0.0475071+0.0472595im     -0.113165+0.0323511im     0.0182803+0.00603566im    0.187138+0.0372801im   -0.0346646+0.0675443im    -0.0434084-0.1756im         0.201622-0.0532774im     0.230455-0.0198952im     -0.176735-0.139251im      -0.228872+0.105351im     -0.016368-0.183296im       -0.047637+0.146509im        0.109243+0.00154647im   -0.0148111+0.139038im      -0.0924943-0.0392375im    -0.0536887+0.105228im   -0.0866952+0.0862159im    -0.133833+0.0782839im    0.0586661-0.0061195im    -0.284926-0.27732im        -0.246934+0.0208502im       -0.21488+0.248469im         0.23644-0.0572918im   -0.147872-0.0517455im   -0.0766161-0.117463im     0.0414961-0.0115822im     0.0428838+0.0210849im      -0.10884-0.0977361im     0.0540744-0.0711864im</code></pre><p>and then generate the state <span>$ψ$</span></p><pre><code class="language-julia hljs">psi = P[:, 3]</code></pre><pre><code class="nohighlight hljs">32-element Vector{ComplexF64}:
    -0.2241936650029661 + 0.14326374829369376im
    0.11973674043353826 - 0.004887526072975411im
    0.34670231090649584 + 0.0im
   -0.07477505597856073 - 0.051840465149265026im
   -0.09002872686283231 - 0.0021348987804715937im
   -0.09778552213515608 + 0.08106840828568623im
   -0.08497447487366108 + 0.010420218622153364im
   -0.10388648736373379 + 0.028008820303290327im
  -0.014980142287012471 - 0.027354761187672206im
    0.01393720315294623 - 0.17967511244304726im
   -0.22207252699032487 + 0.1555050350886446im
    0.14243179961214902 + 0.11632119013000204im
   0.027844649902148102 - 0.24388206428233994im
   -0.26458089963244524 + 0.06655857138061266im
   0.023851208578578507 + 0.006421174764764538im
   0.045469526121707876 - 0.0700638643298451im
    0.11887858680051082 + 0.02343909725340312im
   0.027837093655048235 - 0.12733486553615572im
  -0.024295526099893598 - 0.07690428272047665im
   -0.06030169679938589 - 0.11441357068441696im
   0.049724151437255476 - 0.08617316516748408im
     0.2830568758158938 + 0.015447908581220951im
    -0.1639461718470033 - 0.03469892117496096im
    0.14598993459886686 - 0.041513305179499756im
 -0.0022824586972032762 - 0.2622163486996593im
    0.02948313527875255 - 0.06475515536410505im
    0.08404970078500726 - 0.08983360879143375im
   -0.01826699143648409 + 0.18992613048504012im
   -0.07891525562940042 + 0.022552077010106513im
    -0.0704095689754073 - 0.011384398424266345im
   -0.06462119243617455 - 0.2325373413078518im
   -0.26065668382477364 - 0.022870704078645106im</code></pre><p>In the phase estimation process, we will feed the state to circuit and measure the first <code>n</code> qubits processed by iQFT.</p><pre><code class="language-julia hljs">r = join(ArrayReg(psi), zero_state(N))
r |&gt; PE(N, M, U)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 8/8
    nlevel: 2</code></pre><p>Since our phase can be represented by 3 qubits precisely, we only need to measure once</p><pre><code class="language-julia hljs">results = measure(r, 1:N; nshots=1)</code></pre><pre><code class="nohighlight hljs">1-element Vector{DitStr{2, 3, Int64}}:
 011 ₍₂₎</code></pre><p>Recall that our QFT&#39;s bit numbering is reversed, let&#39;s reverse it back</p><pre><code class="language-julia hljs">using BitBasis
estimated_phase = bfloat(results[]; nbits=N)</code></pre><pre><code class="nohighlight hljs">0.75</code></pre><p>the phase is exactly <code>0.75</code>!</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../1.prepare-ghz-state/index.html">« Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a><a class="docs-footer-nextpage" href="../3.grover-search/index.html">Grover Search »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.18 on <span class="colophon-date" title="Wednesday 1 June 2022 21:22">Wednesday 1 June 2022</span>. Using Julia version 1.7.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
